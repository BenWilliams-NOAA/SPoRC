<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Description of Model Equations ‚Ä¢ SPoRC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Description of Model Equations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SPoRC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Description of Model Equations</h1>
            
      

      <div class="d-none name"><code>c_model_equations.Rmd</code></div>
    </div>

    
    
<p>The Stochastic Population over Regional Components
(<code>SPoRC</code>) model is a generalized integrated population model
written in <code>R-TMB</code> (R bindings for Template Model Builder;
Kristensen et al., 2016) that supports age, sex, and
spatially-structured dynamics. Currently, <code>SPoRC</code> assumes
that population dynamics operate following an annual time step, and in
sequential order:</p>
<ol style="list-style-type: decimal">
<li>Recruitment and tag releases initially occur (tag releases only
occur if tagging data are used),</li>
<li>Markovian movement of individuals then follow (movement only occurs
in the spatial model), and</li>
<li>Total mortality, chronic tag loss (if applicable), and ageing
processes occur.</li>
</ol>
<p>These processes are modeled across four primary model partitions:
region
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>),
year
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>),
age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mo>+</mo></msub><annotation encoding="application/x-tex">a_{+}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mo>+</mo></msub><annotation encoding="application/x-tex">a_{+}</annotation></semantics></math>
is the plus group), and sex
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>).
In single-region and/or single-sex models, these equations generally
reduce by setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>
and/or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s = 1</annotation></semantics></math>.
In general, the same equations are used for both simulation and
estimation.</p>
<div class="section level3">
<h3 id="process-equations">Process Equations<a class="anchor" aria-label="anchor" href="#process-equations"></a>
</h3>
<div class="section level4">
<h4 id="population-initialization">Population Initialization<a class="anchor" aria-label="anchor" href="#population-initialization"></a>
</h4>
<p>In <code>SPoRC</code>, three primary methods exist to initialize the
equilibrium population of the model. The first method derives the
equilibrium population using the following process:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><msub><mi>Œ∂</mi><mi>r</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>‚â§</mo><mi>a</mi><mo>&lt;</mo><msub><mi>a</mi><mo>+</mo></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,a,s}^{'} = \mu^{\text{Rec}}\exp\left( - (a - 1) \cdot \left( Z_{r,a,s}^{'} \right) \right)\psi_{r,y = 1,s}\zeta_{r},\quad\text{for }2 \leq a &lt; a_{+} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><msub><mtext mathvariant="normal">Natmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>+</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><msup><mtext mathvariant="normal">Fmort</mtext><mtext mathvariant="normal">InitProp</mtext></msup><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mrow><annotation encoding="application/x-tex">Z_{r,a,s}^{'} = \text{Natmort}_{r,y = 1,a,s} + \mu_{r,f = 1}^{\text{Fsh}}\text{Fmort}^{\text{InitProp}}\text{Sel}_{r,y = 1,a,s,f = 1}^{\text{Fsh}}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">N_{r,a,s}^{'}</annotation></semantics></math>
are the equilibrium numbers-at-age,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><annotation encoding="application/x-tex">\mu^{\text{Rec}}</annotation></semantics></math>
is a global recruitment parameter (either virgin or mean recruitment
depending on the parameterization of stock recruitment dynamics),</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">Z_{r,a,s}^{'}</annotation></semantics></math>
is the initial instantaneous total mortality rate,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Natmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\text{Natmort}_{r,y = 1,a,s}</annotation></semantics></math>
is the instantaneous natural mortality rate,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><annotation encoding="application/x-tex">\mu_{r,f = 1}^{\text{Fsh}}</annotation></semantics></math>
is the mean fishing mortality rate from the first fleet
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
denotes fishery fleet),</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mtext mathvariant="normal">Fmort</mtext><mtext mathvariant="normal">InitProp</mtext></msup><annotation encoding="application/x-tex">\text{Fmort}^{\text{InitProp}}</annotation></semantics></math>
is a user-defined value describing the proportion of the mean fishing
mortality from the first fleet applied during the initialization
stage,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><annotation encoding="application/x-tex">\text{Sel}_{r,y = 1,a,s,f = 1}^{\text{Fsh}}</annotation></semantics></math>
is the fishery selectivity-at-age for the first fleet,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\psi_{r,y,s}</annotation></semantics></math>
describes the recruitment sex-ratio,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∂</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\zeta_{r}</annotation></semantics></math>
apportions the global recruitment parameter across regions (estimated
using a multinomial logit transform to ensure proportions sum to
one).</li>
</ul>
<p>The plus group
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mo>+</mo></msub><annotation encoding="application/x-tex">a_{+}</annotation></semantics></math>)
of the initial population is then computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><msub><mi>a</mi><mo>+</mo></msub><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mfrac displaystyle="true"><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,a_{+},s}^{'} = N_{r,a_{+} - 1,s}^{'}\dfrac{\exp\left( - Z_{r,a = a_{+} - 1,s}^{'} \right)}{1 - \exp\left( Z_{r,a = a_{+},s}^{'} \right)} \\
\end{matrix}</annotation></semantics></math></p>
<p>However, this scalar geometric series solution assumes that the plus
group accumulates in a closed system. Therefore, when movement dynamics
are present, this solution does not correctly accumulate individuals
into the plus group.</p>
<p>To address this, additional methods are provided to explicitly
incorporate movement dynamics into the plus group calculation. In
particular, the initial population can be derived by iterating the
population to equilibrium. Here, the total instantaneous mortality in
each region is defined similarly as in the first method. An exponential
decay model is used to first initialize the age structure at the first
iteration:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><mspace width="0.167em"></mspace><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mspace width="0.167em"></mspace><msub><mi>Œ∂</mi><mi>r</mi></msub><mo>,</mo></mtd><mtd columnalign="center" style="text-align: center"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><mspace width="0.167em"></mspace><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mspace width="0.167em"></mspace><msub><mi>Œ∂</mi><mi>r</mi></msub><mspace width="0.167em"></mspace><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><munderover><mo>‚àë</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>a</mi></msub></munderover><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="center" style="text-align: center"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>&gt;</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mrow><mspace width="0.222em"></mspace></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,a,s}^{'} = \left\{ \begin{matrix}
\mu^{\text{Rec}}\,\psi_{r,y = 1,s}\,\zeta_{r}, &amp; \text{if }a = 1 \\
\mu^{\text{Rec}}\,\psi_{r,y = 1,s}\,\zeta_{r}\,\exp\left( - \sum_{a = 1}^{n_{a}}Z_{r,a,s}^{'} \right), &amp; \text{if }a &gt; 1 \\
\end{matrix} \right.\  \\
\end{matrix}</annotation></semantics></math></p>
<p>The initialized age structure is then iterated forward to equilibrium
by applying recruitment, movement, and mortality and ageing processes in
order (see Population Projection section for equations).</p>
<p>While the iterative method correctly accumulates the plus group when
movement is present, it can be computationally inefficient due to the
potentially large number of iterations required to propagate the initial
population. Therefore, SPoRC enables users to compute the plus group
using the matrix formulation of the geometric series, which correctly
accounts for movement processes. Individuals are first initialized
through recruitment processes, after which movement, mortality, and
ageing processes are applied sequentially (up to the number of ages in
the model). The population (or cohort) is then projected forward to the
penultimate age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">N_{r,a_{+} - 1,s}^{'}</annotation></semantics></math>),
which is used to derive the plus group. Specifically, the penultimate
age is projected forward once more:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêó</mi><mi>s</mi></msub><mo mathvariant="bold">=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùêç</mi><mrow><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>ùêô</mi><mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X}_{s}\mathbf{=}\left( \left( \mathbf{N}_{a_{+} - 1,s}^{'} \right)^{T}\mathbf{M}_{y = 1,a_{+} - 1,s} \right) \text{diag}\left( \exp\left( - \mathbf{Z}_{a = a_{+}-1,s}^{'} \right)\right)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêå</mi><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math>
is a first-order Markov matrix representing movement, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêó</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\mathbf{X}_{s}</annotation></semantics></math>
represents the culmination of processes applied to the penultimate age.
A transition matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="false" form="prefix" mathvariant="bold">(</mo><mi>ùêÜ</mi></mrow><mi>s</mi></msub><annotation encoding="application/x-tex">\mathbf{(G}_{s}</annotation></semantics></math>)
is the constructed to represent the combined effects of survival and
movement on the plus group:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÜ</mi><mi>s</mi></msub><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>ùêô</mi><mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>a</mi><mo>+</mo></msub><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{G}_{s} = \text{diag}\left( \exp\left( - \mathbf{Z}_{a = a_{+},s}^{'} \right) \right)\left( \mathbf{M}_{y = 1,a_{+},s} \right)^{T}</annotation></semantics></math></p>
<p>The plus group solution incorporating movement is then given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ùêç</mi><mrow><msub><mi>a</mi><mo>+</mo></msub><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>ùêà</mi><mo mathvariant="bold">‚àí</mo></mrow><msub><mi>ùêÜ</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup><msub><mi>ùêó</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{N}_{a_{+},s}^{'} = \left( \mathbf{I -}\mathbf{G}_{s} \right)^{- 1}\mathbf{X}_{s}</annotation></semantics></math></p>
<p>When only a single region is modeled or no movement occurs (i.e., an
identity matrix), the matrix formulation simplifies to the standard
scalar geometric series solution.</p>
<p>Following the definition of equilibrium age structure, initial age
deviations can be applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>‚â†</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><mi>N</mi><msub><mi>‚Ä≤</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>‚â†</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mtext mathvariant="normal">exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi></mrow><mtext mathvariant="normal">Init</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,y = 1,a \neq 1,s} = N'_{r,a \neq 1,s}\text{exp}\left( \epsilon_{r,i}^{\text{Init}} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>‚â†</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">N_{r,y = 1,a \neq 1,s}</annotation></semantics></math>
are represents the numbers-at-age in the first model year except
recruits
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚â†</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a \neq 1</annotation></semantics></math>).
These values can then be treated as a stochastic process by applying
multiplicative lognormal deviations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi></mrow><mtext mathvariant="normal">Init</mtext></msubsup><annotation encoding="application/x-tex">\epsilon_{r,i}^{\text{Init}}</annotation></semantics></math>
to the initial equilibrium age structure. Note that the index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is introduced because users can determine whether initial age deviations
are estimated up to the penultimate age class, or across all classes
including the plus group.</p>
</div>
<div class="section level4">
<h4 id="recruitment-processes">Recruitment Processes<a class="anchor" aria-label="anchor" href="#recruitment-processes"></a>
</h4>
<p>In the current iteration of <code>SPoRC</code>, two stock recruitment
parameterizations can be specified. Recruitment can be specified to
arise about a mean parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><annotation encoding="application/x-tex">\mu^{\text{Rec}}</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mtext mathvariant="normal">Rec</mtext></msubsup><mo>‚àí</mo><mfrac><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><mn>2</mn></mfrac><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub><msub><mi>Œ∂</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,y,a = 1,s} = \mu^{\text{Rec}}\exp\left( \epsilon_{r,y}^{\text{Rec}} - \frac{\sigma_{\text{Rec}}^{2}}{2}b_{y} \right)\psi_{r,y,s}\zeta_{r} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{r,y}</annotation></semantics></math>
are annual, lognormally distributed recruitment deviations with a
lognormal bias correction term
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><mn>2</mn></mfrac><msub><mi>b</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\sigma_{\text{Rec}}^{2}}{2}b_{y}</annotation></semantics></math>),
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>y</mi></msub><annotation encoding="application/x-tex">b_{y}</annotation></semantics></math>
representing the bias correction ramp from Methot and Taylor (2011).
Recruitment can also be specified to arise from a Beverton-Holt stock
recruitment function to invoke density-dependent population dynamics,
which follows the steepness parameterization (Mace and Doonan, 1988).
Localized density-dependent recruitment is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><mfrac displaystyle="true"><mrow><mn>4</mn><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><msub><mi>Œ∂</mi><mi>r</mi></msub><msub><mi>h</mi><mi>r</mi></msub><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>h</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub><mo>+</mo><mn>5</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mi>r</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mtext mathvariant="normal">Rec</mtext></msubsup><mo>‚àí</mo><mfrac><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><mn>2</mn></mfrac><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,y,a = 1,s} = \dfrac{4\mu^{\text{Rec}}\zeta_{r}h_{r}{SSB}_{r,y - RecLag}}{\left( 1 - h_{r} \right)SSB0_{r} + 5\left( h_{r} - 1 \right){SSB}_{r,y - RecLag}}\exp\left( \epsilon_{r,y}^{\text{Rec}} - \frac{\sigma_{\text{Rec}}^{2}}{2}b_{y} \right)\psi_{r,y,s} \\
\end{matrix}</annotation></semantics></math></p>
<p>while global density-dependent recruitment can be defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><mfrac displaystyle="true"><mrow><mn>4</mn><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><msub><mi>Œ∂</mi><mi>r</mi></msub><mi>h</mi><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub></mrow><mo>+</mo><mn>5</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mtext mathvariant="normal">Rec</mtext></msubsup><mo>‚àí</mo><mfrac><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><mn>2</mn></mfrac><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>œà</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,y,a = 1,s} = \dfrac{4\mu^{\text{Rec}}\zeta_{r}h\sum_{r}^{}{SSB}_{r,y - RecLag}}{(1 - h)\sum_{r}^{}{SSB0_{r}} + 5(h - 1)\sum_{r}^{}{SSB}_{r,y - RecLag}}\exp\left( \epsilon_{r,y}^{\text{Rec}} - \frac{\sigma_{\text{Rec}}^{2}}{2}b_{y} \right)\psi_{r,y,s} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><annotation encoding="application/x-tex">\mu^{\text{Rec}}</annotation></semantics></math>
under this parameterization is the virgin unfished recruitment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>r</mi></msub><annotation encoding="application/x-tex">h_{r}</annotation></semantics></math>
(or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>)
is the steepness parameter representing the fraction of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><msub><mi>Œ∂</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\mu^{\text{Rec}}\zeta_{r}</annotation></semantics></math>
that would be produced when at 20% of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">SSB0_{r}</annotation></semantics></math>
(or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mi>r</mi><mrow></mrow></msubsup><mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\sum_{r}^{}{SSB0_{r}}</annotation></semantics></math>).
The steepness parameter is constrained to be between values of 0.2 and 1
and are estimated in bounded logit space.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">SSB0_{r}</annotation></semantics></math>
is a derived variable that represents the unfished spawning stock
biomass (i.e., derived by multiplying the unfished SSB per recruit by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><msub><mi>Œ∂</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\mu^{\text{Rec}}\zeta_{r}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">{SSB}_{r,y - RecLag}</annotation></semantics></math>
is the spawning stock biomass, which is the product of numbers-at-age,
spawning weight-at-age, and maturity-at-age for females:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>S</mi><mi>S</mi><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>w</mi><mi>n</mi></mrow></msubsup><msub><mrow><mi>M</mi><mi>a</mi><mi>t</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
SSB_{r,y} = \sum_{a = 1}^{a_{+}}{N_{r,y,a,s = 1}W_{r,y,a,s = 1}^{spawn}{Mat}_{r,y,a,s = 1}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">RecLag</annotation></semantics></math>
denotes the delay between spawning and when recruits enter the
population. Thus, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi><mo>&gt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">RecLag &gt; y</annotation></semantics></math>,
<code>SPoRC</code> utilizes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>B</mi><msub><mn>0</mn><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">SSB0_{r}</annotation></semantics></math>
instead of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>L</mi><mi>a</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">{SSB}_{r,y - RecLag}</annotation></semantics></math>
to compute deterministic recruitment.</p>
</div>
<div class="section level4">
<h4 id="population-projection">Population Projection<a class="anchor" aria-label="anchor" href="#population-projection"></a>
</h4>
<p>Following recruitment processes, the population can then be projected
forward. In the context of the spatial model, Markovian movement
dynamics are first applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ùêç</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêç</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{N}_{y,a,s} = \left( \mathbf{N}_{y,a,s} \right)^{T}\mathbf{M}_{y,a,s} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{M}_{y,a,s}</annotation></semantics></math>
is a first-order Markov matrix representing movement. In a single-region
case, no movement is applied (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{M}_{y,a,s}</annotation></semantics></math>
is an implied identity matrix). For each year, age, and sex combination,
the movement matrix specifies bulk-transfer coefficients, with
parameters transformed through a multinomial logit to ensure that
proportions within each origin region sum to one. Following movement
processes, the population undergoes mortality and ageing:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mn>1</mn><mo>‚â§</mo><mi>a</mi><mo>&lt;</mo><msub><mi>a</mi><mo>+</mo></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
N_{r,y + 1,a + 1,s} = N_{r,y,a,s}\exp\left( - Z_{r,y,a,s} \right),\quad\text{for }1 \leq a &lt; a_{+} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">N_{r,y + 1,a,s} = N_{r,y,a - 1,s}\exp\left( - Z_{r,y,a - 1,s} \right) + N_{r,y,a,s}\exp\left( - Z_{r,y,a,s} \right),\quad\text{for }a = a_{+}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">Z_{r,y,a,s}</annotation></semantics></math>
denotes the annual total instantaneous mortality rate and is defined as
the combination of natural mortality
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Natmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\text{Natmort}_{r,y,a,s}</annotation></semantics></math>)
and fishing mortality
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{Fmort}_{r,y,f}</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mtext mathvariant="normal">Natmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>+</mo><munderover><mo>‚àë</mo><mi>f</mi><mrow></mrow></munderover><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
Z_{r,y,a,s} = \text{Natmort}_{r,y,a,s} + \sum_{f}^{}\text{Sel}_{r,y,a,s,f}^{\text{Fsh}}\text{Fmort}_{r,y,f} \\
\end{matrix}</annotation></semantics></math></p>
<p>The annual instantaneous fishing mortality rate is then defined
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mtext mathvariant="normal">exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Fmort}_{r,y,f} = \mu_{r,f}^{\text{Fsh}}\text{exp}\left( \epsilon_{r,y,f}^{\text{Fsh}} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{Fmort}_{r,y,f}</annotation></semantics></math>
is parameterized based on lognormal deviations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\epsilon_{r,y,f}^{\text{Fsh}})</annotation></semantics></math>
about a mean fishing mortality parameter for a given fishery fleet
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><annotation encoding="application/x-tex">\mu_{r,f}^{\text{Fsh}}</annotation></semantics></math>).</p>
</div>
</div>
<div class="section level3">
<h3 id="observation-equations">Observation Equations<a class="anchor" aria-label="anchor" href="#observation-equations"></a>
</h3>
<div class="section level4">
<h4 id="fishery-observation-model">Fishery Observation Model<a class="anchor" aria-label="anchor" href="#fishery-observation-model"></a>
</h4>
<p>The fishery observation model describes the expected catch-at-age,
catch-at-length, catch (in units of biomass), and fishery indices.
Expected catch-at-age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>a</mi></msubsup><annotation encoding="application/x-tex">C_{r,y,a,s,f}^{a}</annotation></semantics></math>)
for a given fishery fleet is calculated using Baranov‚Äôs catch
equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>a</mi></msubsup><mo>=</mo><mfrac displaystyle="true"><mrow><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mrow><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mfrac><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
C_{r,y,a,s,f}^{a} = \dfrac{\text{Fmort}_{r,y,f}\text{Sel}_{r,y,a,s,f}^{\text{Fsh}}}{Z_{r,y,a,s}}N_{r,y,a,s}\left\lbrack 1 - \exp\left( - Z_{r,y,a,s} \right) \right\rbrack \\
\end{matrix}</annotation></semantics></math></p>
<p>To track length-based dynamics, catch-at-length
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>l</mi></msubsup><annotation encoding="application/x-tex">C_{r,y,l,s,f}^{l}</annotation></semantics></math>)
can then be derived using the following equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>l</mi></msubsup><mo>=</mo><msubsup><mi>ùêÄ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow><mi>l</mi></msubsup><msub><msup><mi>ùêÇ</mi><mi>ùêö</mi></msup><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
C_{r,y,l,s,f}^{l} = \mathbf{A}_{r,y,s}^{l}{\mathbf{C}^{\mathbf{a}}}_{r,y,s,f} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùêÄ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow><mi>l</mi></msubsup><annotation encoding="application/x-tex">\mathbf{A}_{r,y,s}^{l}</annotation></semantics></math>
is a user-defined size-age transition matrix to convert ages to lengths.
Expected catch
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Catch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{Catch}_{r,y,f}</annotation></semantics></math>)
can then be computed as either abundance or biomass. For catch in units
of abundance, this is given by the summation of the expected
catch-at-age across ages and sexes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">Catch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>a</mi></msubsup></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Catch}_{r,y,f} = \sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}C_{r,y,a,s,f}^{a}} \\
\end{matrix}</annotation></semantics></math></p>
<p>For catch in biomass, this is given by the summation of expected
catch-at-age, multiplied by their respective fishery weights-at-age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi></mrow></msubsup><annotation encoding="application/x-tex">W_{r,y,a,s,f}^{fish}</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">Catch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mi>a</mi></msubsup></mrow><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Catch}_{r,y,f} = \sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}C_{r,y,a,s,f}^{a}}W_{r,y,a,s,f}^{fish} \\
\end{matrix}</annotation></semantics></math></p>
<p>Similarly expected fishery indices
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">FshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{FshIdx}_{r,y,f}</annotation></semantics></math>)
can be computed as either abundance-based or biomass-based. For
abundance-based fishery indices, this is computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">FshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\begin{matrix}
\text{FshIdx}_{r,y,f} = q_{r,y,f}^{\text{Fsh}}\sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}N_{r,y,a,s}}\exp\left( - Z_{r,y,a,s} \right)\text{Sel}_{r,y,a,s,f}^{\text{Fsh}} \\
\end{matrix} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><annotation encoding="application/x-tex">q_{r,y,f}^{\text{Fsh}}</annotation></semantics></math>
is the catchability coefficient for a given fishery fleet. Biomass-based
fishery indices are computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">FshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\begin{matrix}
\text{FshIdx}_{r,y,f} = q_{r,y,f}^{\text{Fsh}}\sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}N_{r,y,a,s}}\exp\left( - Z_{r,y,a,s} \right)\text{Sel}_{r,y,a,s,f}^{\text{Fsh}}W_{r,y,a,s,f}^{fish} \\
\end{matrix} \\
\end{matrix}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="survey-observation-model">Survey Observation Model<a class="anchor" aria-label="anchor" href="#survey-observation-model"></a>
</h4>
<p>Likewise, the survey observation model describes the expected survey
catch-at-age, survey catch-at-length, and survey indices. Expected
survey catch-at-age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>a</mi></msubsup><annotation encoding="application/x-tex">I_{r,y,a,s,sf}^{a}</annotation></semantics></math>)
is calculated as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>a</mi></msubsup><mo>=</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><msup><mi>t</mi><mrow><mi>s</mi><mi>r</mi><mi>v</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
I_{r,y,a,s,sf}^{a} = N_{r,y,a,s}\exp\left( - Z_{r,y,a,s}t^{srv} \right)\text{Sel}_{r,y,a,s,sf}^{\text{Srv}} \\
\end{matrix}</annotation></semantics></math></p>
<p>where subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">sf</annotation></semantics></math>
denotes a given survey fleet and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><annotation encoding="application/x-tex">\text{Sel}_{r,y,a,s,sf}^{\text{Srv}}</annotation></semantics></math>
is the survey selectivity-at-age pattern. Expected survey
catch-at-length
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>l</mi></msubsup><annotation encoding="application/x-tex">I_{r,y,l,s,sf}^{l}</annotation></semantics></math>)
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>l</mi></msubsup><mo>=</mo><msubsup><mi>ùêÄ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow><mi>l</mi></msubsup><msub><msup><mi>ùêà</mi><mi>ùêö</mi></msup><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
I_{r,y,l,s,sf}^{l} = \mathbf{A}_{r,y,s}^{l}{\mathbf{I}^{\mathbf{a}}}_{r,y,s,f} \\
\end{matrix}</annotation></semantics></math></p>
<p>Survey indices
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">SrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{SrvIdx}_{r,y,sf}</annotation></semantics></math>)
can be computed as either abundance-based or biomass-based.
Abundance-based survey indices are calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">SrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo>=</mo><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>a</mi></msubsup></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{SrvIdx}_{r,y,sf} = q_{r,y,sf}^{\text{Srv}}\sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}I_{r,y,a,s,sf}^{a}} \\
\end{matrix}</annotation></semantics></math></p>
<p>while biomass-based indices are computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">SrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo>=</mo><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><munderover><mo>‚àë</mo><mi>a</mi><msub><mi>a</mi><mo>+</mo></msub></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mi>a</mi></msubsup></mrow><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mrow><mi>s</mi><mi>r</mi><mi>v</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{SrvIdx}_{r,y,sf} = q_{r,y,sf}^{\text{Srv}}\sum_{a}^{a_{+}}{\sum_{s}^{n_{s}}I_{r,y,a,s,sf}^{a}}W_{r,y,a,s,sf}^{srv} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mrow><mi>s</mi><mi>r</mi><mi>v</mi></mrow></msubsup><annotation encoding="application/x-tex">W_{r,y,a,s,sf}^{srv}</annotation></semantics></math>
is the weight-at-age for a given survey,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><annotation encoding="application/x-tex">q_{r,y,sf}^{\text{Srv}}</annotation></semantics></math>
represents the survey catchability coefficient in the aforementioned
equations.</p>
<p>For survey catchability, environmental linkage can be specified:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><mo>=</mo><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ùê±</mi><mi>T</mi></msup><mrow><mi>ùõÉ</mi><mo mathvariant="bold">+</mo></mrow><munderover><mo>‚àë</mo><mi>m</mi><mrow></mrow></munderover><mrow><msub><mi>Œπ</mi><mi>m</mi></msub><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q_{r,y,sf}^{\text{Srv}} = q_{r,sf}^{\text{Srv}}\exp\left( \mathbf{x}^{T}\mathbf{\beta +}\sum_{m}^{}{\iota_{m}p_{m}\left( z_{r,y,sf} \right)} \right)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow><mtext mathvariant="normal">Srv</mtext></msubsup><annotation encoding="application/x-tex">q_{r,sf}^{\text{Srv}}</annotation></semantics></math>
is the base survey catchability (i.e., intercept),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùê±</mi><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math>
is a matrix of covariates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">\mathbf{\beta}</annotation></semantics></math>
is a vector of regression coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œπ</mi><mi>m</mi></msub><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\iota_{m}p_{m}</annotation></semantics></math>
are orthogonal polynomial coefficients along with its basis functions,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">z_{r,y,sf}</annotation></semantics></math>
are the covariates for which a polynomial term is assumed for.</p>
</div>
</div>
<div class="section level3">
<h3 id="tagging-observation-model">Tagging Observation Model<a class="anchor" aria-label="anchor" href="#tagging-observation-model"></a>
</h3>
<p>The tagging observation model tracks tag cohorts
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><annotation encoding="application/x-tex">T_{r,y,a,s}^{k}</annotation></semantics></math>)
by the combination of release region and release year
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
and follows a Brownie tag attrition framework. Tag cohorts are tracked
for a pre-defined maximum duration (maximum tag liberty;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>L</mi></msub><annotation encoding="application/x-tex">n_{L}</annotation></semantics></math>),
after which calculations for the tag cohort are no longer computed. This
is done to aid with computation time. Additionally, tag cohorts also
have the option to undergo a fraction of mortality in the year of
release, such that if a given cohort is released during the middle of
the year, mortality processes are discounted. If mortality discounting
is specified, movement does not occur in the year of release. In
general, the process dynamics for the tagged cohort mimics those
specified for the overall population. Immediately following release, tag
cohorts are decremented by an initial tag-induced mortality rate:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mi>œÑ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
T_{r,y,a,s}^{k} = T_{r,y,a,s}^{k}\exp( - \tau) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÑ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
is the initial tag-induced mortality rate. If tagged cohorts are
released at the beginning of a calendar year, Markovian movement occurs
(movement does not occur otherwise):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ùêì</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùêì</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">T</mtext></msup><msub><mi>ùêå</mi><mrow><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{T}_{y,a,s}^{k} = \left( \mathbf{T}_{y,a,s}^{k} \right)^{\text{T}}\mathbf{M}_{y,a,s} \\
\end{matrix}</annotation></semantics></math></p>
<p>Mortality and ageing of the tagged cohort then occurs:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>‚â§</mo><mi>a</mi><mo>&lt;</mo><msub><mi>a</mi><mo>+</mo></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>+</mo></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\begin{matrix}
T_{r,y + 1,a + 1,s}^{k} = T_{r,y,a,s}^{k}\exp\left( - Z_{r,y,a,s}^{\text{Tag}} \right),\quad\text{for }2 \leq a &lt; a_{+} \\
T_{r,y + 1,a,s}^{k} = T_{r,y,a - 1,s}^{k}\exp\left( - Z_{r,y,a - 1,s}^{\text{Tag}} \right) + T_{r,y,a,s}^{k}\exp\left( - Z_{r,y,a,s}^{\text{Tag}} \right),\quad\text{for }a = a_{+} \\
\end{matrix} \\
\end{matrix}</annotation></semantics></math></p>
<p>where tagged cohorts follow an exponential mortality model, with
accumulation of individuals in the plus-group. Total mortality for the
tagged cohort
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><annotation encoding="application/x-tex">Z_{r,y,a,s}^{\text{Tag}}</annotation></semantics></math>)
is specified as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ∫</mi><mo>+</mo><msub><mtext mathvariant="normal">NatMort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>+</mo><munderover><mo>‚àë</mo><mi>f</mi><mrow></mrow></munderover><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><msub><mtext mathvariant="normal">Fmort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
Z_{r,y,a,s}^{\text{Tag}} = \left( \kappa + \text{NatMort}_{r,y,a,s} + \sum_{f}^{}\text{Sel}_{r,y,a,s,f}^{\text{Fsh}}\text{Fmort}_{r,y,f} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∫</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
is a parameter describing chronic tag loss (i.e., annual tag shedding).
Similar to computations for catch-at-age, tag recaptures are calculated
using a modified version of Baranov‚Äôs catch equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mtext mathvariant="normal">Recap</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mfrac displaystyle="true"><mrow><munderover><mo>‚àë</mo><mi>f</mi><mrow></mrow></munderover><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mrow><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup></mfrac><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mi>Z</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Tag</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Recap}_{r,y,a,s}^{k} = \beta_{r,y}\dfrac{\sum_{f}^{}\text{Sel}_{r,y,a,s,f}^{\text{Fsh}}}{Z_{r,y,a,s}^{\text{Tag}}}T_{r,y,a,s}^{k}\left\lbrack 1 - \exp\left( - Z_{r,y,a,s}^{\text{Tag}} \right) \right\rbrack \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{r,y}</annotation></semantics></math>
represents a tag reporting rate parameter that can vary across space and
time, which is estimated in logit space such that it is constrained
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\lbrack 0,1\rbrack</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="fishery-and-survey-selectivity">Fishery and Survey Selectivity<a class="anchor" aria-label="anchor" href="#fishery-and-survey-selectivity"></a>
</h3>
<p>In the following descriptions of selectivity, we omit subscripts for
sexes and fleets for brevity, although note that the equations remain
specific to those model partitions. Several approaches are available for
parameterizing fishery and survey selectivity. Selectivity can be
defined as either age- or length-based. For age-based selectivity, an
age vector is applied directly with a chosen functional form. For
length-based selectivity, a length vector is used to compute
selectivity, which is then combined with a size‚Äìage transition matrix
through a dot product to obtain selectivity-at-age.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mi>ùêí</mi><mi>ùêû</mi></mrow><msup><mi>ùê•</mi><mi>a</mi></msup><mo mathvariant="bold">=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùêÄ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow><mi>l</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">T</mtext></msup><mrow><mi>ùêí</mi><mi>ùêû</mi></mrow><msup><mi>ùê•</mi><mi>l</mi></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{Se}\mathbf{l}^{a}\mathbf{=}\left( \mathbf{A}_{r,y,s}^{l} \right)^{\text{T}}\mathbf{Se}\mathbf{l}^{l} \\
\end{matrix}</annotation></semantics></math></p>
<p>Given the age-based nature of the model, selectivity-at-age is
utilized for all subsequent calculations. Various functional forms can
also be specified for selectivity processes. In the following we use the
subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
to denote a generalized bin number.</p>
<p>Two forms of logistic selectivity can be specified. The first form is
defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mi>b</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>‚àí</mi><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><msup><mi>b</mi><mn>50</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{Sel}_{b} = \frac{1}{1 + \exp\left\lbrack - k\left( b - b^{50} \right) \right\rbrack} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
determines the slope/steepness of the logistic curve and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>50</mn></msup><annotation encoding="application/x-tex">b^{50}</annotation></semantics></math>
is the bin-at-50% selection. The second form can be expressed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mi>b</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mn>19</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>b</mi><mn>50</mn></msup><mo>‚àí</mo><mi>b</mi></mrow><msup><mi>b</mi><mn>95</mn></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{Sel}_{b} = \frac{1}{1 + 19^{\left( \frac{b^{50} - b}{b^{95}} \right)}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>50</mn></msup><annotation encoding="application/x-tex">b^{50}</annotation></semantics></math>
is also the bin-at-50% selection and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>95</mn></msup><annotation encoding="application/x-tex">b^{95}</annotation></semantics></math>
is the bin-at-95% selection. Beyond the specification of flat-topped
selectivity, <code>SPoRC</code> also allows for dome-shaped selectivity.
In particular, a reparametrized gamma function can be specified:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>p</mi><mo>=</mo><mn>0.5</mn><mrow><mo stretchy="true" form="prefix">[</mo><msqrt><mrow><msup><mi>b</mi><mo>max</mo></msup><mo>+</mo><mn>4</mn><msup><mi>Œ≥</mi><mn>2</mn></msup></mrow></msqrt><mo>‚àí</mo><msup><mi>b</mi><mo>max</mo></msup><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
p = 0.5\left\lbrack \sqrt{b^{\max} + 4\gamma^{2}} - b^{\max} \right\rbrack \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mi>b</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>b</mi><msup><mi>b</mi><mo>max</mo></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><msup><mi>b</mi><mo>max</mo></msup><mi>p</mi></mfrac></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>b</mi><mo>max</mo></msup><mo>‚àí</mo><mi>b</mi></mrow><mi>p</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{Sel}_{b} = \left( \frac{b}{b^{\max}} \right)^{\frac{b^{\max}}{p}}\exp\left( \frac{b^{\max} - b}{p} \right)</annotation></semantics></math></p>
<p>In this parameterization,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is a derived power parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is the shape parameter that describes the steepness of the descending
limb, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mo>max</mo></msup><annotation encoding="application/x-tex">b^{\max}</annotation></semantics></math>
describes the bin-at-maximum selection. Dome-shaped selectivity can also
be expressed as a power function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mi>b</mi></msub><mo>=</mo><mfrac><mn>1</mn><msup><mi>b</mi><mi>œï</mi></msup></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{Sel}_{b} = \frac{1}{b^{\phi}} \\
\end{matrix}</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œï</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
being a power parameter that determines the descending limb of the curve
(larger values are steeper). The last dome-shaped selectivity form that
can be specified includes a 6 parameter (denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">{\widehat{p}}_{1}</annotation></semantics></math>
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>6</mn></msub><annotation encoding="application/x-tex">{\widehat{p}}_{6}</annotation></semantics></math>)
double normal functional form with the following transformations
applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mspace width="0.222em"></mspace><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚ãÖ</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
p_{1} = \ \min(b) + \left\lbrack \max(b) - min(b) \right\rbrack \cdot \frac{1}{1 + \exp\left( {\widehat{p}}_{1} \right)} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><mspace width="0.222em"></mspace><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mn>0.99</mn><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub><mo>‚àí</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{2} = \ p_{1} + 1 + \frac{0.99 + max(b) - p_{1} - 1}{1 + exp({\widehat{p}}_{2})}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>p</mi><mn>4</mn></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>4</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{3} = \exp\left( {\widehat{p}}_{3} \right),\ \ p_{4} = \exp\left( {\widehat{p}}_{4} \right)</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>5</mn></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>5</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>p</mi><mn>6</mn></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{5} = \frac{1}{1 + \exp\left( {\widehat{p}}_{5} \right)},\ \ p_{6} = \frac{1}{1 + \exp\left( {\widehat{p}}_{6} \right)}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_{1}</annotation></semantics></math>
represents the beginning of the plateau,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_{2}</annotation></semantics></math>
describes the width of the plateau,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>3</mn></msub><annotation encoding="application/x-tex">p_{3}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>4</mn></msub><annotation encoding="application/x-tex">p_{4}</annotation></semantics></math>
are parameters controlling the ascending and descending widths, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>5</mn></msub><annotation encoding="application/x-tex">p_{5}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_{6}</annotation></semantics></math>
control the selectivity at the first and last bins. The double normal
function is then defined with a series of functions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>a</mi><mi>s</mi><mi>c</mi></mrow><mi>b</mi></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mi>p</mi><mn>3</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>a</mi><mi>s</mi><mi>c</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>d</mi></mrow><mi>b</mi></msub><mo>=</mo><msub><mi>p</mi><mn>5</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mn>5</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mrow><mi>a</mi><mi>s</mi><mi>c</mi></mrow><mi>b</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>c</mi></mrow><mi>b</mi></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mi>p</mi><mn>4</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>s</mi><mi>t</mi><mi>j</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>40</mn><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mi>p</mi><mn>4</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>c</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>d</mi></mrow><mi>b</mi></msub><mo>=</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>6</mn></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mfrac><mrow><msub><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>c</mi></mrow><mi>b</mi></msub><mo>‚àí</mo><mn>1</mn></mrow><mrow><mi>s</mi><mi>t</mi><mi>j</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>1</mn><mi>b</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mn>20</mn><mo>‚ãÖ</mo><mfrac><mrow><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub></mrow><mrow><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>2</mn><mi>b</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mn>20</mn><mo>‚ãÖ</mo><mfrac><mrow><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><mrow><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>b</mi><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{asc}_{b} = \exp\left( - \frac{\left( b - p_{1} \right)^{2}}{p_{3}} \right) \\
{ascscaled}_{b} = p_{5} + \left( 1 - p_{5} \right) \cdot {asc}_{b} \\
{desc}_{b} = \exp\left( - \frac{\left( b - p_{2} \right)^{2}}{p_{4}} \right) \\
stj = exp\left( - \frac{\left( 40 - p_{2} \right)^{2}}{p_{4}} \right) \\
{descscaled}_{b} = 1 + \left( p_{6} - 1 \right) \cdot \frac{{desc}_{b} - 1}{stj - 1} \\
join1_{b} = \frac{1}{1 + \exp\left( - 20 \cdot \frac{b - p_{1}}{1 + \left| b - p_{1} \right|} \right)} \\
join2_{b} = \frac{1}{1 + \exp\left( - 20 \cdot \frac{b - p_{2}}{1 + \left| b - p_{2} \right|} \right)} \\
\end{matrix}</annotation></semantics></math></p>
<p>and are joined together as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mi>b</mi></msub><mo>=</mo><msub><mrow><mi>a</mi><mi>s</mi><mi>c</mi></mrow><mi>b</mi></msub><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>1</mn><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>1</mn><mi>b</mi></msub><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>2</mn><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>c</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>d</mi></mrow><mi>b</mi></msub><mo>‚ãÖ</mo><mi>j</mi><mi>o</mi><mi>i</mi><mi>n</mi><msub><mn>2</mn><mi>b</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{Sel}_{b} = {asc}_{b} \cdot \left( 1 - join1_{b} \right) + join1_{b} \cdot \left\lbrack \left( 1 - join2_{b} \right) + {descscaled}_{b} \cdot join2_{b} \right\rbrack \\
\end{matrix}</annotation></semantics></math></p>
<p>The double normal functional form is incredibly flexible and is able
to reduce to both flat-topped and dome-shaped selectivity forms,
depending on the values of the parameters.</p>
<p>In addition to the functional forms that can be specified to describe
selectivity processes, several options exist to specify continuous
time-varying processes. In particular, options to specify time-varying
parametric selectivity and time-varying semi-parametric selectivity are
available. To illustrate, if logistic selectivity is specified and
parametric deviations are invoked, the following expression is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>‚àí</mi><msub><mi>k</mi><mi>y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><msubsup><mi>b</mi><mi>y</mi><mn>50</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msub><mi>k</mi><mi>y</mi></msub><mo>=</mo><mi>k</mi><mo>‚ãÖ</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>y</mi><mo>,</mo><mn>1</mn></mrow><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mi>b</mi><mi>y</mi><mn>50</mn></msubsup><mo>=</mo><msup><mi>b</mi><mn>50</mn></msup><mo>‚ãÖ</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>y</mi><mo>,</mo><mn>2</mn></mrow><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
{Sel}_{y,b} = \frac{1}{1 + \exp\left\lbrack - k_{y}\left( b - b_{y}^{50} \right) \right\rbrack} \\
\end{matrix}
}{k_{y} = k \cdot \exp\left( \epsilon_{y,1}^{Sel} \right)
}{b_{y}^{50} = b^{50} \cdot exp(\epsilon_{y,2}^{Sel})}</annotation></semantics></math></p>
<p>where the parameters of the logistic form are allowed to vary over
time. In the context of semi-parametric selectivity, the following
equation is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>b</mi><mo>‚àí</mo><msup><mi>b</mi><mn>50</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><msub><mi>œµ</mi><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow></msub><mo>=</mo><mfrac><msubsup><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow><mi>‚Ä≤</mi></msubsup><mrow><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>ùêí</mi><mi>ùêû</mi></mrow><msup><mi>ùê•</mi><mi mathvariant="bold">‚Ä≤</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
{Sel}_{y,b}^{'} = \frac{1}{1 + \exp\left( - k\left\lbrack b - b^{50} \right\rbrack \right)}\exp\left( {\epsilon_{y,b}}^{Sel} \right) \\
\end{matrix}
}{{Sel}_{y,b} = \frac{{Sel}_{y,b}^{'}}{mean(\mathbf{Se}\mathbf{l}^{\mathbf{'}})}}</annotation></semantics></math></p>
<p>where deviations are placed about the parametric form and selectivity
values are mean standardized to aid with interpretability. Importantly,
note that if age-based selectivity is specified and continuous
deviations are estimated, these deviations are placed on the ages
themselves. In the case where length-based selectivity is specified,
these deviations are placed on the length bins. Further details on how
selectivity deviations arise can be found in the ‚ÄúSelectivity Process
Error‚Äù section of this document.</p>
</div>
<div class="section level2">
<h2 id="likelihoods">Likelihoods<a class="anchor" aria-label="anchor" href="#likelihoods"></a>
</h2>
<p>Currently, <code>SPoRC</code> incorporates data likelihood components
for the following data sources:</p>
<ol style="list-style-type: decimal">
<li>fishery catches,</li>
<li>fishery indices,</li>
<li>fishery age compositions,</li>
<li>fishery length compositions,</li>
<li>survey indices,</li>
<li>survey age compositions,</li>
<li>survey length compositions, and</li>
<li>tagging data.</li>
</ol>
<p>The total likelihood (objective function) is the sum of the
individual likelihood contributions from these data sources along with
priors and penalties, where the objective function is minimized using a
non-linear optimization algorithm to estimate model parameters.</p>
<div class="section level3">
<h3 id="observation-likelihoods">Observation Likelihoods<a class="anchor" aria-label="anchor" href="#observation-likelihoods"></a>
</h3>
<div class="section level4">
<h4 id="fishery-catches">Fishery Catches<a class="anchor" aria-label="anchor" href="#fishery-catches"></a>
</h4>
<p>Fishery catches can be fit using a lognormal likelihood. The
log-likelihood for observed catch,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \log\left( \text{ObsCatch}_{r,y,f} \right) \right)</annotation></semantics></math>
is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( \log\left( \text{ObsCatch}_{r,y,f} \right) \right) = \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub></msub><mo>‚ãÖ</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">Catch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda_{\text{ObsCatch}_{r,y,f}} \cdot \frac{1}{\sqrt{2\pi\sigma_{\text{ObsCatch}_{r,,f}}^{2}}\,}\exp\left( - \frac{\left\lbrack \log\left( \text{ObsCatch}_{r,y,f} \right) - log\left( \text{Catch}_{r,y,f} \right) \right\rbrack^{2}}{2\sigma_{\text{ObsCatch}_{r,y,f}}^{2}} \right)</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub></msub><annotation encoding="application/x-tex">\lambda_{\text{ObsCatch}_{r,y,f}}</annotation></semantics></math>
is the likelihood weight,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{ObsCatch}_{r,y,f}</annotation></semantics></math>
is the observed catch,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">Catch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{Catch}_{r,y,f}</annotation></semantics></math>
is the predicted catch, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsCatch</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\text{ObsCatch}_{r,y,f}}^{2}</annotation></semantics></math>
is the variance of catch on the log scale.</p>
</div>
<div class="section level4">
<h4 id="fishery-and-survey-indices">Fishery and Survey Indices<a class="anchor" aria-label="anchor" href="#fishery-and-survey-indices"></a>
</h4>
<p>Fishery indices can also be fit assuming a lognormal likelihood. The
log-likelihood for observed fishery indices is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( \log\left( \text{ObsFshIdx}_{r,y,f} \right) \right) = \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub></msub><mo>‚ãÖ</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">FshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda_{\text{ObsFshIdx}_{r,y,f}} \cdot \frac{1}{\sqrt{2\pi\sigma_{\text{ObsFshIdx}_{r,y,f}}^{2}}\,}\exp\left( - \frac{\left\lbrack \log\left( \text{ObsFshIdx}_{r,y,f} \right) - log\left( \text{FshIdx}_{r,y,f} \right) \right\rbrack^{2}}{2\sigma_{\text{ObsFshIdx}_{r,y,f}}^{2}} \right)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub></msub><annotation encoding="application/x-tex">\lambda_{\text{ObsFshIdx}_{r,y,f}}</annotation></semantics></math>
controls the weight of fishery indices to the objective function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{ObsFshIdx}_{r,y,f}</annotation></semantics></math>
represents the observed fishery indices, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsFshIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow></msub><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\text{ObsFshIdx}_{r,y,f}}^{2}</annotation></semantics></math>
denotes the variance of the fishery index.</p>
<p>Likewise, survey indices can be fit assuming a lognormal likelihood
given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( \log\left( \text{ObsSrvIdx}_{r,y,sf} \right) \right) = \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub></msub><mo>‚ãÖ</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">SrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda_{\text{ObsSrvIdx}_{r,y,sf}} \cdot \frac{1}{\sqrt{2\pi\sigma_{\text{ObsSrvIdx}_{r,y,sf}}^{2}}\,}\exp\left( - \frac{\left\lbrack \log\left( \text{ObsSrvIdx}_{r,y,sf} \right) - log\left( \text{SrvIdx}_{r,y,sf} \right) \right\rbrack^{2}}{2\sigma_{\text{ObsSrvIdx}_{r,y,sf}}^{2}} \right)</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub></msub><annotation encoding="application/x-tex">\lambda_{\text{ObsSrvIdx}_{r,y,sf}}</annotation></semantics></math>
is the likelihood weight applied to survey indices,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">\text{ObsSrvIdx}_{r,y,sf}</annotation></semantics></math>
are the observed survey indices, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><msub><mtext mathvariant="normal">ObsSrvIdx</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mi>f</mi></mrow></msub><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\text{ObsSrvIdx}_{r,y,sf}}^{2}</annotation></semantics></math>
indicates the variance of the survey index.</p>
</div>
<div class="section level4">
<h4 id="fishery-and-survey-compositions">Fishery and Survey Compositions<a class="anchor" aria-label="anchor" href="#fishery-and-survey-compositions"></a>
</h4>
<p>Several options for fitting composition data are available in
<code>SPoRC</code>. These include the multinomial, the
Dirichlet-multinomial, and the logistic-normal likelihoods. In the case
of the multinomial likelihood, the following expression is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></msub><mo>‚ãÖ</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>‚ãÖ</mo><munderover><mo>‚àè</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>b</mi></msub></munderover><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
L\left( \text{ObsCompositionData}_{r,y,j} \right) = \\
\end{matrix}
}{\lambda_{\text{ObsCompositionData}_{r,y,j}} \cdot \text{ISS}_{r,y,j} \cdot \prod_{b = 1}^{n_{b}}E_{r,y,b,j}^{O_{r,y,b,j}}}</annotation></semantics></math></p>
<p>where subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is used to indicate a fishery or survey fleet and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
subscript generically indicates a bin number.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></msub><annotation encoding="application/x-tex">\lambda_{\text{ObsCompositionData}_{r,y,j}}</annotation></semantics></math>
are likelihood weights applied to composition data (can be derived using
iterative weighting methods),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>S</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">ISS_{r,y,j}</annotation></semantics></math>
is the input sample size,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">E_{r,y,b,j}</annotation></semantics></math>
denotes the expected composition proportions, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">O_{r,y,b,j}</annotation></semantics></math>
are the observed composition proportions.</p>
<p>If a Dirichlet-multinomial likelihood is assumed, the following
parameterization (linear) is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></msub><mo>‚ãÖ</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>‚ãÖ</mo><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>+</mo><mn>1</mn></mrow></mfrac><mo>‚ãÖ</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mtext mathvariant="normal">Œì(</mtext><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mtext mathvariant="normal">+</mtext><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mtext mathvariant="normal">)</mtext></mrow></mfrac><mo>‚ãÖ</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><munderover><mo>‚àè</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>b</mi></msub></munderover><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( \text{ObsCompositionData}_{r,y,j} \right) = \\
\lambda_{\text{ObsCompositionData}_{r,y,j}} \cdot \frac{\Gamma\left( \text{ISS}_{r,y,j} + 1 \right)}{\text{ISS}_{r,y,j} \cdot O_{r,y,b,j} + 1} \cdot \frac{\Gamma\left( \text{ISS}_{r,y,j}\theta_{r,j} \right)}{\text{Œì(}\text{ISS}_{r,y,j}\text{+}\text{ISS}_{r,y,j}\theta_{r,j}\text{)}} \cdot \\
\prod_{b = 1}^{n_{b}}\frac{\Gamma(\text{ISS}_{r,y,j}O_{r,y,b,j} + \text{ISS}_{r,y,j}\theta_{r,j}E_{r,y,b,j})}{\text{ISS}_{r,y,j}\theta_{r,j}E_{r,y,b,j}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{r,j}</annotation></semantics></math>
is the overdispersion parameter of the Dirichlet-multinomial that
adjusts the input sample size. The effective sample size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">ESS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{ESS}_{r,y,j})</annotation></semantics></math>
can then be derived as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mtext mathvariant="normal">ESS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace></mrow></mfrac><mo>+</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mfrac><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mn>1</mn><mo>+</mo><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{ESS}_{r,y,j} = \frac{1}{1 + \theta_{r,j}\ } + \text{ISS}_{r,y,j}\frac{\theta_{r,j}}{1 + \theta_{r,j}\ } \\
\end{matrix}</annotation></semantics></math></p>
<p>Therefore, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{r,j}</annotation></semantics></math>
was large such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>‚â´</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta_{r,j} \gg \text{ISS}_{r,y,j}</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">ESS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>‚Üí</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\text{ESS}_{r,y,j} \rightarrow \text{ISS}_{r,y,j}</annotation></semantics></math>.
By contrast, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{r,j}</annotation></semantics></math>
was estimated at a small value such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>‚â™</mo><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta_{r,j} \ll \text{ISS}_{r,y,j}</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{r,j}</annotation></semantics></math>
approximates the ratio of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">ESS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\text{ESS}_{r,y,j}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">ISS</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\text{ISS}_{r,y,j}</annotation></semantics></math>
(Thorson et al., 2017).</p>
<p>A multivariate logistic-normal likelihood can also be assumed, which
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">ObsCompositionData</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><mfrac><mn>1</mn><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>œÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>B</mi><mo>‚àí</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>ùö∫</mi><mo stretchy="true" form="postfix">|</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>ùêé</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><mo>‚àí</mo><msubsup><mi>ùêÑ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">}</mo></mrow><mi>T</mi></msup><msup><mi>ùö∫</mi><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>ùêé</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><mo>‚àí</mo><msubsup><mi>ùêÑ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
L\left( \text{ObsCompositionData}_{r,y,j} \right) = \\
\end{matrix}
}{\frac{1}{(2\pi)^{\frac{B - 1}{2}}\left| \mathbf{\Sigma} \right|^{\frac{1}{2}}}\exp\left( - \frac{1}{2}\left\{ \mathbf{O}_{r,y,j}^{\mathbf{'}} - \mathbf{E}_{r,y,j}^{\mathbf{'}} \right\}^{T}\mathbf{\Sigma}^{- 1}\left\{ \mathbf{O}_{r,y,j}^{\mathbf{'}} - \mathbf{E}_{r,y,j}^{\mathbf{'}} \right\} \right)}</annotation></semantics></math></p>
<p>Both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùêé</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">\mathbf{O}_{r,y,j}^{\mathbf{'}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùêÑ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">\mathbf{E}_{r,y,j}^{\mathbf{'}}</annotation></semantics></math>
are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(B - 1)</annotation></semantics></math>
dimensional vectors, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùö∫</mi><annotation encoding="application/x-tex">\mathbf{\Sigma}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(B - 1) \times (B - 1)</annotation></semantics></math>
covariance matrix (see below for further details).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùêé</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">\mathbf{O}_{r,y,j}^{\mathbf{'}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùêÑ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">\mathbf{E}_{r,y,j}^{\mathbf{'}}</annotation></semantics></math>
are derived via an additive logistic function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>‚àí</mi><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>‚àí</mi><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
O_{r,y,b,j}^{'} = \log\left( O_{r,y, - B,j} \right) - log(O_{r,y,B,j}) \\
E_{r,y,b,j}^{'} = \log\left( E_{r,y, - B,j} \right) - log(E_{r,y,B,j}) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>O</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow><mi>‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">O_{r,y,b,j}^{'}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>j</mi></mrow><mi>‚Ä≤</mi></msubsup><annotation encoding="application/x-tex">E_{r,y,b,j}^{'}</annotation></semantics></math>
are transformed proportions using the last bin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
as the reference category. Because the logarithm of zero is undefined,
all untransformed proportions must be strictly positive. If any observed
proportion is zero, both the observed and corresponding expected values
are removed, and the remaining proportions are renormalized to ensure
that they sum to one before applying the transformation. The covariance
matrix of the logistic-normal likelihood can be specified in various
ways. In the simplest case, the covariance matrix can be assumed to be
independent and identically distributed (iid):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mi>ùö∫</mi><mo mathvariant="bold">=</mo></mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêà</mi><mi>B</mi></msub><mo>‚ãÖ</mo><msup><mi>Œ∏</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi mathvariant="bold">‚àí</mi><mi>B</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{\Sigma =}\left( \mathbf{I}_{B} \cdot \theta^{2} \right)_{\mathbf{-}B} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêà</mi><mi>B</mi></msub><annotation encoding="application/x-tex">\mathbf{I}_{B}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>√ó</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">B \times B</annotation></semantics></math>
identity matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œ∏</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\theta^{2}</annotation></semantics></math>
is an estimated overdispersion parameter representing the variance. The
simple iid case can be further extended to incorporate a one-dimensional
lag-1 autoregressive structure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mi>ùö∫</mi><mo mathvariant="bold">=</mo></mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêë</mi><mi>B</mi></msub><mo>‚ãÖ</mo><msup><mi>Œ∏</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>‚àí</mi><mi>B</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêë</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo mathvariant="bold">=</mo><msubsup><mi>œÅ</mi><mi>B</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>i</mi><mo>‚àí</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow></msubsup><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mspace width="0.222em"></mspace><mn>1</mn><mo>,</mo><mspace width="0.222em"></mspace><mi>‚ãØ</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>B</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{\Sigma =}\left( \mathbf{R}_{B} \cdot \theta^{2} \right)_{- B} \\
\left( \mathbf{R}_{B} \right)_{i,j}\mathbf{=}\rho_{B}^{|i - j|},\ \ i,j = \ 1,\ \cdots,\ B \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêë</mi><mi>B</mi></msub><annotation encoding="application/x-tex">\mathbf{R}_{B}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>√ó</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">B \times B</annotation></semantics></math>
correlation matrix with a lag-1 autoregressive structure, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÅ</mi><mi>B</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>i</mi><mo>‚àí</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow></msubsup><annotation encoding="application/x-tex">\rho_{B}^{|i - j|}</annotation></semantics></math>
defines the correlation across bins. Lastly, if the model is specified
to be sex-structured and sex-composition data are utilized, a
two-dimensional autoregressive structure can be specified:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mi>ùö∫</mi><mo mathvariant="bold">=</mo></mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><msub><mi>ùêë</mi><mi>S</mi></msub><mrow><mspace width="0.222em"></mspace><mo mathvariant="bold">‚®Ç</mo><mspace width="0.222em"></mspace><mi>ùêë</mi></mrow></mrow><mi>C</mi></msub><mo>‚ãÖ</mo><msup><mi>Œ∏</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>‚àí</mi><mi>B</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{\Sigma =}\left( {\mathbf{R}_{S}\mathbf{\ \bigotimes\ R}}_{C} \cdot \theta^{2} \right)_{- B} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêë</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo mathvariant="bold">=</mo><msubsup><mi>œÅ</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>i</mi><mo>‚àí</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow></msubsup><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mspace width="0.222em"></mspace><mn>1</mn><mo>,</mo><mspace width="0.222em"></mspace><mi>‚ãØ</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>C</mi></mrow><annotation encoding="application/x-tex">\left( \mathbf{R}_{C} \right)_{i,j}\mathbf{=}\rho_{C}^{|i - j|},\ \ i,j = \ 1,\ \cdots,\ C</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêë</mi><mi>S</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo mathvariant="bold">=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>i</mi><mi>f</mi><mi>i</mi><mo>=</mo><mi>j</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>s</mi></msub><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>i</mi><mi>f</mi><mi>i</mi><mo>‚â†</mo><mi>j</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mrow><mspace width="0.222em"></mspace><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>n</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\left( \mathbf{R}_{S} \right)_{i,j}\mathbf{=}\left\{ \begin{matrix}
1,\ \ if i = j \\
\rho_{s},\ \ if i \neq j \\
\end{matrix} \right.\ ,\ \ i,j = 1,\ldots,n_{s}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêë</mi><mi>S</mi></msub><annotation encoding="application/x-tex">\mathbf{R}_{S}</annotation></semantics></math>
is a constant correlation matrix dimensioned by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>s</mi></msub><mo>√ó</mo><msub><mi>n</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">n_{s} \times n_{s}</annotation></semantics></math>for
sexes, with off-diagonal elements
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\rho_{s}</annotation></semantics></math>
controlling the correlation of age/length categories across sexes, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêë</mi><mi>C</mi></msub><annotation encoding="application/x-tex">\mathbf{R}_{C}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>c</mi></msub><mo>√ó</mo><msub><mi>n</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">n_{c} \times n_{c}</annotation></semantics></math>
lag-1 autoregressive correlation structure, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÅ</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>i</mi><mo>‚àí</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow></msubsup><annotation encoding="application/x-tex">\rho_{C}^{|i - j|}</annotation></semantics></math>
defines the correlation across age/length categories.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo mathvariant="bold">‚®Ç</mo><annotation encoding="application/x-tex">\mathbf{\bigotimes}</annotation></semantics></math>
denotes the Kronecker product. This structure implies that similar age
or size categories across sexes are correlated, while ensuring that very
different age or size categories remain uncorrelated.</p>
<div class="section level5">
<h5 id="structuring-compositions-and-ageing-error">Structuring Compositions and Ageing Error<a class="anchor" aria-label="anchor" href="#structuring-compositions-and-ageing-error"></a>
</h5>
<p>Related to the use of composition data likelihoods, composition data
can be structured differently depending on model assumptions and data
constraints. In particular, three options are available to fit to
composition data:</p>
<ol style="list-style-type: decimal">
<li><p>‚ÄòAggregated‚Äô compositions across regions and sexes,</p></li>
<li><p>‚ÄòSplit‚Äô compositions for each region and sex (i.e., no implicit
information about sex-ratios), and</p></li>
<li><p>‚ÄòJoint‚Äô compositions across sexes (i.e., implicit information is
provided about sex-ratios).</p></li>
</ol>
<p>The expected compositions (i.e., catch-at-age, catch-at-length,
survey catch-at-age, survey catch-at-length) when specified as
‚Äòaggregated‚Äô are derived with the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>E</mi><mrow><mi>y</mi><mo>,</mo><mi>b</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mfrac><mrow><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup></mrow></mrow><mrow><msub><mi>n</mi><mi>s</mi></msub><mo>‚ãÖ</mo><msub><mi>n</mi><mi>r</mi></msub></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msub><mi>ùêÑ</mi><mi>y</mi></msub><mo>=</mo><msubsup><mi>ùêÑ</mi><mi>y</mi><mi mathvariant="bold">‚Ä≤</mi></msubsup><msub><mi>ùöØ</mi><mi>y</mi></msub></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
E_{y,b}^{'} = \frac{\sum_{r = 1}^{n_{r}}{\sum_{s = 1}^{n_{s}}E_{r,y,b,s}^{'}}}{n_{s} \cdot n_{r}} \\
\end{matrix}
}{\mathbf{E}_{y} = \mathbf{E}_{y}^{\mathbf{'}}\mathbf{\Theta}_{y}}</annotation></semantics></math></p>
<p>where compositions are summed across regions and sexes and normalized
to sum to one. Ageing error
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùöØ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\mathbf{\Theta}_{y}</annotation></semantics></math>)
can then be applied using standard matrix multiplication. Expected
compositions that are specified as ‚ÄòSplit‚Äô by sexes and regions are
computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>E</mi><mrow><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mfrac><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mrow><munderover><mo>‚àë</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>B</mi></msub></munderover><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
E_{y,b,s}^{'} = \frac{E_{r,y,b,s}^{'}}{\sum_{b = 1}^{n_{B}}E_{r,y,b,s}^{'}} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mrow><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msubsup><mi>ùêÑ</mi><mrow><mi>y</mi><mo>,</mo><mi>s</mi></mrow><mi mathvariant="bold">‚Ä≤</mi></msubsup><msub><mi>ùöØ</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{E}_{y,s} = \mathbf{E}_{y,s}^{\mathbf{'}}\mathbf{\Theta}_{y}</annotation></semantics></math></p>
<p>Here, expected compositions sum to one within a given region and sex
combination and ageing error is similarly applied via matrix
multiplication. In the case where expected compositions are specified as
‚ÄòJoint‚Äô, they are calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>E</mi><mrow><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mo>=</mo><mfrac><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup><mrow><munderover><mo>‚àë</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>B</mi></msub></munderover><msubsup><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi></mrow><mi>‚Ä≤</mi></msubsup></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
E_{y,b,s}^{'} = \frac{E_{r,y,b,s}^{'}}{\sum_{s = 1}^{n_{s}}{\sum_{b = 1}^{n_{B}}E_{r,y,b,s}^{'}}} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mi>y</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêÑ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêà</mi><mi>s</mi></msub><msub><mrow><mspace width="0.222em"></mspace><mo mathvariant="bold">‚®Ç</mo><mspace width="0.222em"></mspace><mi>ùöØ</mi></mrow><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{E}_{y} = \left( \mathbf{E}_{y} \right)^{T}(\mathbf{I}_{s}\mathbf{\ \bigotimes\ \Theta}_{y})</annotation></semantics></math></p>
<p>where the expected compositions sum to one jointly across bins and
sexes, thus preserving implicit sex-ratio information. Ageing error is
then applied by taking the Kronecker product of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>s</mi></msub><mspace width="0.222em"></mspace><mi>x</mi><mspace width="0.222em"></mspace><msub><mi>n</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">n_{s}\ x\ n_{s}</annotation></semantics></math>
identity matrix with the ageing error matrix, followed by matrix
multiplication.</p>
</div>
</div>
<div class="section level4">
<h4 id="tagging">Tagging<a class="anchor" aria-label="anchor" href="#tagging"></a>
</h4>
<p><code>SPoRC</code> currently allows for various tagging likelihoods,
ranging from the Poisson, Negative Binomial, multinomial, and
Dirichlet-multinomial likelihood. Additionally, <code>SPoRC</code> also
allows for both release- and recapture-conditioned dynamics (McGarvey
and Feenstra, 2002). The Poisson tag likelihood is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œª</mi><mtext mathvariant="normal">Tagging</mtext></msub><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></msup></mrow><mrow><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mi>!</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( {ObsRecap}_{r,y,a,s}^{k} \right) = \lambda_{\text{Tagging}}\frac{\exp\left( - {Recap}_{r,y,a,s}^{k} \right)\left( {Recap}_{r,y,a,s}^{k} \right)^{{ObsRecap}_{r,y,a,s}^{k}}}{{ObsRecap}_{r,y,a,s}^{k}!} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><annotation encoding="application/x-tex">{ObsRecap}_{r,y,a,s}^{k}</annotation></semantics></math>
are the observed tag recaptures and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mtext mathvariant="normal">Tagging</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Tagging}}</annotation></semantics></math>
is the likelihood weight applied to tagging data. In the case where the
Negative Binomial is invoked, the following expression is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mtext mathvariant="normal">Tagging</mtext></msub><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>+</mo><mi>Œ∑</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ∑</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>Œ∑</mi><mrow><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>+</mo><mi>Œ∑</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ∑</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mrow><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>+</mo><mi>Œ∑</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( {ObsRecap}_{r,y,a,s}^{k} \right) = \\
\lambda_{\text{Tagging}}\frac{\Gamma\left( {ObsRecap}_{r,y,a,s}^{k} + \eta \right)}{\Gamma(\eta)\Gamma\left( {ObsRecap}_{r,y,a,s}^{k} + 1 \right)}\left( \frac{\eta}{{Recap}_{r,y,a,s}^{k} + \eta} \right)^{\eta}\left( \frac{{Recap}_{r,y,a,s}^{k}}{{Recap}_{r,y,a,s}^{k} + \eta} \right)^{{ObsRecap}_{r,y,a,s}^{k}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
represents the estimated overdispersion parameter for tagging data.</p>
<p>Under release conditioned dynamics, both recaptured and
non-recaptured states are fit to. Proportions of observed
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><annotation encoding="application/x-tex">{PObsRecap}_{r,y,a,s}^{k}</annotation></semantics></math>)
and expected recaptured
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mi>P</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">{PRecap}_{r,y,a,s}^{k})</annotation></semantics></math>individuals
are given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mfrac><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{PObsRecap}_{r,y,a,s}^{k} = \frac{{ObsRecap}_{r,y,a,s}^{k}}{{InitTag}^{k}} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mi>P</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mfrac><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">{PRecap}_{r,y,a,s}^{k} = \frac{{Recap}_{r,y,a,s}^{k}}{{InitTag}^{k}}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><annotation encoding="application/x-tex">{InitTag}^{k}</annotation></semantics></math>
denotes the total tags released for a given tag cohort (combination of
release region and year). Non-recaptured states can then be written
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mn>1</mn><mo>‚àí</mo><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>y</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>a</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><mrow></mrow></munderover><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
{PObsNonRecap}_{r,y,a,s}^{k} = 1 - \sum_{r}^{}{\sum_{y}^{}{\sum_{a}^{}{\sum_{s}^{}{PObsRecap}_{r,y,a,s}^{k}}}} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mi>P</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mn>1</mn><mo>‚àí</mo><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>y</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>a</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><mrow></mrow></munderover><msubsup><mrow><mi>P</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">{PNonRecap}_{r,y,a,s}^{k} = 1 - \sum_{r}^{}{\sum_{y}^{}{\sum_{a}^{}{\sum_{s}^{}{PRecap}_{r,y,a,s}^{k}}}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><annotation encoding="application/x-tex">{PObsNonRecap}_{r,y,a,s}^{k}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mi>P</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><annotation encoding="application/x-tex">{PNonRecap}_{r,y,a,s}^{k}</annotation></semantics></math>
are the observed and expected non-recaptured states, respectively. These
states are then combined into a single vector of observed and expected
values:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ùêé</mi><mrow><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mi>ùêè</mi><mi>ùêé</mi><mi>ùêõ</mi><mi>ùê¨</mi><mi>ùêë</mi><mi>ùêû</mi><mi>ùêú</mi><mi>ùêö</mi></mrow><msup><mi>ùê©</mi><mi>k</mi></msup><mo>,</mo><msup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{O}_{Tagging}^{k} = \left\{ \mathbf{PObsReca}\mathbf{p}^{k},{PObsNonRecap}^{k} \right\} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ùêÑ</mi><mrow><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mrow><mi>ùêè</mi><mi>ùêë</mi><mi>ùêû</mi><mi>ùêú</mi><mi>ùêö</mi></mrow><msup><mi>ùê©</mi><mi>k</mi></msup><mo>,</mo><msup><mrow><mi>P</mi><mi>N</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>k</mi></msup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbf{E}_{Tagging}^{k} = \{\mathbf{PReca}\mathbf{p}^{k},{PNonRecap}^{k}\}</annotation></semantics></math></p>
<p>If a Multinomial likelihood is assumed for release conditioned
dynamics, this is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><msub><mi>Œª</mi><mtext mathvariant="normal">Tagging</mtext></msub><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><munderover><mo>‚àè</mo><mi>i</mi><mrow></mrow></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>E</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>O</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( {ObsRecap}^{k} \right) = {\lambda_{\text{Tagging}}InitTag}^{k}\prod_{i}^{}\left( E_{i,Tagging}^{k} \right)^{O_{i,Tagging}^{k}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here, the subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is used to generically denote a given element. If a
Dirichlet-multinomial with released-condition dynamics was assumed, the
tagging likelihood would be written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mtext mathvariant="normal">Tagging</mtext></msub><mo>‚ãÖ</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mspace width="0.222em"></mspace><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mspace width="0.222em"></mspace><mo>‚ãÖ</mo><msubsup><mi>O</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo>+</mo><mn>1</mn></mrow></mfrac><mo>‚ãÖ</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mspace width="0.222em"></mspace><mi>Œ∑</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mtext mathvariant="normal">Œì(</mtext><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mtext mathvariant="normal">+</mtext><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mi>Œ∑</mi><mtext mathvariant="normal">)</mtext></mrow></mfrac><mo>‚ãÖ</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><munderover><mo>‚àè</mo><mi>i</mi><mrow></mrow></munderover><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mo>‚ãÖ</mo><msubsup><mi>O</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo>+</mo><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mo>‚ãÖ</mo><mi>Œ∑</mi><mo>‚ãÖ</mo><msubsup><mi>E</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mrow><mi>I</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>T</mi><mi>a</mi><mi>g</mi></mrow><mi>k</mi></msup><mo>‚ãÖ</mo><mi>Œ∑</mi><mo>‚ãÖ</mo><msubsup><mi>E</mi><mrow><mi>i</mi><mo>,</mo><mi>T</mi><mi>a</mi><mi>g</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mi>k</mi></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
L\left( {ObsRecap}^{k} \right) = \\
\lambda_{\text{Tagging}} \cdot \frac{\Gamma\left( {InitTag}^{k}\  + 1 \right)}{{InitTag}^{k}\  \cdot O_{i,Tagging}^{k} + 1} \cdot \frac{\Gamma\left( {InitTag}^{k}\ \eta \right)}{\text{Œì(}{InitTag}^{k}\text{+}{InitTag}^{k}\eta\text{)}} \cdot \\
\prod_{i}^{}\frac{\Gamma({InitTag}^{k} \cdot O_{i,Tagging}^{k} + {InitTag}^{k} \cdot \eta \cdot E_{i,Tagging}^{k})}{{InitTag}^{k} \cdot \eta \cdot E_{i,Tagging}^{k}} \\
\end{matrix}</annotation></semantics></math></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
parameter in the Dirichlet-multinomial likelihood represents the
overdispersion parameter for tagging data,</p>
<p>Under recapture-conditioned dynamics, tag shedding, tag induced
mortality, and tag reporting rates are assumed to be spatially-invariant
and do not need to be estimated, given that these terms cancel out in
the denominator (McGarvey and Feenstra, 2002). Unlike
release-conditioned dynamics, assuming recaptured-conditioned processes
does not require fitting to non-recaptured states. Thus, the observed
and expected recaptured proportions can be written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mrow><mi>P</mi><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mfrac><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mrow><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>a</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><mrow></mrow></munderover><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></mrow></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msubsup><mrow><mi>P</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mfrac><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup><mrow><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>a</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><mrow></mrow></munderover><msubsup><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></mrow></mrow></mrow></mfrac></mrow><mrow><msubsup><mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>y</mi><mi>k</mi></msubsup><munderover><mo>‚àë</mo><mi>r</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>a</mi><mrow></mrow></munderover><mrow><munderover><mo>‚àë</mo><mi>s</mi><mrow></mrow></munderover><msubsup><mrow><mi>O</mi><mi>b</mi><mi>s</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mi>k</mi></msubsup></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
{PObsRecap}_{r,y,a,s}^{k} = \frac{{ObsRecap}_{r,y,a,s}^{k}}{\sum_{r}^{}{\sum_{a}^{}{\sum_{s}^{}{ObsRecap}_{r,y,a,s}^{k}}}} \\
\end{matrix}
}{{PRecap}_{r,y,a,s}^{k} = \frac{{Recap}_{r,y,a,s}^{k}}{\sum_{r}^{}{\sum_{a}^{}{\sum_{s}^{}{Recap}_{r,y,a,s}^{k}}}}
}{{TotRecap}_{y}^{k}\sum_{r}^{}{\sum_{a}^{}{\sum_{s}^{}{ObsRecap}_{r,y,a,s}^{k}}}}</annotation></semantics></math></p>
<p>where recapture probabilities are normalized by the total number of
recaptures in a given year
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi></mrow><mi>y</mi><mi>k</mi></msubsup><annotation encoding="application/x-tex">{TotRecap}_{y}^{k}</annotation></semantics></math>).</p>
</div>
</div>
<div class="section level3">
<h3 id="parameter-priors-and-process-error-penalties">Parameter Priors and Process Error Penalties<a class="anchor" aria-label="anchor" href="#parameter-priors-and-process-error-penalties"></a>
</h3>
<div class="section level4">
<h4 id="parameter-priors">Parameter Priors<a class="anchor" aria-label="anchor" href="#parameter-priors"></a>
</h4>
<p>Considering the complexity of integrated population models, several
priors can be specified to help inform the estimation of parameters by
providing additional knowledge. Beyond that, priors can also be
specified to aid in model stabilization (i.e., regularizing priors).
Priors can currently be specified for natural mortality, fishery and
survey catchability, fishery and survey selectivity, steepness,
recruitment proportions, movement rates, and tag reporting rates.</p>
<div class="section level5">
<h5 id="natural-mortality">Natural Mortality<a class="anchor" aria-label="anchor" href="#natural-mortality"></a>
</h5>
<p>In the case of natural mortality, a lognormal prior is utilized:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">NatMort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mi>a</mi><mi>t</mi><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">NatMort</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">(NatMort)</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mtext mathvariant="normal">NatMort</mtext><mn>2</mn></msubsup><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mi>a</mi><mi>t</mi><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \log\left( \text{NatMort}_{r,y,a,s} \right) \right) = \frac{1}{\sqrt{2\pi\sigma_{r,y,a,s}^{2\ (Natmort)}}\,}\exp\left( - \frac{\left\lbrack \log\left( \text{NatMort}_{r,y,a,s} \right) - log\left( \mu_{r,y,a,s}^{\text{(NatMort)}} \right) \right\rbrack^{2}}{2\sigma_{\text{NatMort}}^{2}\sigma_{r,y,a,s}^{2\ (Natmort)}} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where the variance of the prior is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mi>a</mi><mi>t</mi><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r,y,a,s}^{2\ (Natmort)}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">(NatMort)</mtext></msubsup><annotation encoding="application/x-tex">\mu_{r,y,a,s}^{\text{(NatMort)}}</annotation></semantics></math>
denotes the prior mean.</p>
</div>
<div class="section level5">
<h5 id="fishery-and-survey-catchability">Fishery and Survey Catchability<a class="anchor" aria-label="anchor" href="#fishery-and-survey-catchability"></a>
</h5>
<p>For fishery and survey catchability, a lognormal prior can also be
specified:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mtext mathvariant="normal">(</mtext><msub><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mtext mathvariant="normal">)</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>q</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(qPrior)</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mtext mathvariant="normal">NatMort</mtext><mn>2</mn></msubsup><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \log\text{(}q_{r,y,j}\text{)} \right) = \frac{1}{\sqrt{2\pi\sigma_{r,y,j}^{2\ (qPrior)}}\,}\exp\left( - \frac{\left\lbrack \log\left( q_{r,y,j} \right) - log\left( \mu_{r,y,j}^{\text{(qPrior)}} \right) \right\rbrack^{2}}{2\sigma_{\text{NatMort}}^{2}\sigma_{r,y,j}^{2\ (qPrior)}} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
here represents either a fishery or survey fleet,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mrow><mn>2</mn><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r,y,j}^{2\ (qPrior)}</annotation></semantics></math>
is the variance of the prior, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(qPrior)</mtext></msubsup><annotation encoding="application/x-tex">\mu_{r,y,j}^{\text{(qPrior)}}</annotation></semantics></math>
indicates the prior mean for catchability.</p>
</div>
<div class="section level5">
<h5 id="fishery-and-survey-selectivity-1">Fishery and Survey Selectivity<a class="anchor" aria-label="anchor" href="#fishery-and-survey-selectivity-1"></a>
</h5>
<p>In general, selectivity priors can be utilized to serve as
regularizing priors to facilitate stable parameter estimation (Monnahan,
2024). These priors are assumed to be lognormal and are applied to the
selectivity parameters themselves:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><msup><mi>œÉ</mi><mn>2</mn></msup><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(Sel)</mtext></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(Sel)</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><msup><mi>œÉ</mi><mn>2</mn></msup><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(Sel)</mtext></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \log\left( \theta_{r,p,y,s,j} \right) \right) = \frac{1}{\sqrt{2\pi{\sigma^{2}}_{r,p,y,s,j}^{\text{(Sel)}}}\,}\exp\left( - \frac{\left\lbrack \ln\left( \theta_{r,p,y,s,j} \right) - ln\left( \mu_{r,p,y,s,j}^{\text{(Sel)}} \right) \right\rbrack^{2}}{2{\sigma^{2}}_{r,p,y,s,j}^{\text{(Sel)}}} \right) \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{r,p,y,s,j}</annotation></semantics></math>
is a selectivity parameter for a given functional form specified,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><msup><mi>œÉ</mi><mn>2</mn></msup><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(Sel)</mtext></msubsup><annotation encoding="application/x-tex">{\sigma^{2}}_{r,p,y,s,j}^{\text{(Sel)}}</annotation></semantics></math>
is the prior variance, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">(Sel)</mtext></msubsup><annotation encoding="application/x-tex">\mu_{r,p,y,s,j}^{\text{(Sel)}}</annotation></semantics></math>
is the prior mean for the specific selectivity parameter.</p>
</div>
<div class="section level5">
<h5 id="steepness">Steepness<a class="anchor" aria-label="anchor" href="#steepness"></a>
</h5>
<p>If a Beverton-Holt stock recruitment relationship is assumed, priors
for steepness can be specified. Currently, a scaled beta prior (bounded
between 0.2 and 1) can be invoked:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msubsup><mi>Œº</mi><mi>r</mi><mrow><mtext mathvariant="normal">(</mtext><mtext mathvariant="normal">h</mtext><mtext mathvariant="normal">)</mtext></mrow></msubsup><mo>‚àí</mo><mn>0.2</mn></mrow><mrow><mn>1</mn><mo>‚àí</mo><mn>0.2</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msubsup><mi>œÉ</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mn>1</mn><mo>‚àí</mo><mn>0.2</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>‚àí</mo><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msubsup><mi>Œº</mi><mi>r</mi><mrow><mtext mathvariant="normal">(</mtext><mtext mathvariant="normal">h</mtext><mtext mathvariant="normal">)</mtext></mrow></msubsup><mo>‚àí</mo><mn>0.2</mn></mrow><mrow><mn>1</mn><mo>‚àí</mo><mn>0.2</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msubsup><mi>œÉ</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mn>1</mn><mo>‚àí</mo><mn>0.2</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mi>r</mi></msub><mo>+</mo><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msubsup><mi>h</mi><mi>r</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>h</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>b</mi><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
a_{r}^{(h)} = \left( \frac{\mu_{r}^{\text{(}\text{h}\text{)}} - 0.2}{1 - 0.2} \right)\left( \frac{\sigma_{r}^{(h)}}{1 - 0.2} \right)^{2} \\
\end{matrix}
}{b_{r}^{(h)} = \left\lbrack 1 - \ \left( \frac{\mu_{r}^{\text{(}\text{h}\text{)}} - 0.2}{1 - 0.2} \right) \right\rbrack\left\lbrack \left( \frac{\sigma_{r}^{(h)}}{1 - 0.2} \right)^{2} \right\rbrack
}{P\left( h_{r} \right) = \frac{\Gamma\left( a_{r}^{(h)} \right)\Gamma\left( b_{r}^{(h)} \right)}{\Gamma\left( {a_{r}^{(h)}}_{r} + b_{r}^{(h)} \right)}h_{r}^{a - 1}\left( 1 - h_{r} \right)^{b - 1}}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">a_{r}^{(h)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">b_{r}^{(h)}</annotation></semantics></math>
are parameters of the beta distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mi>r</mi><mrow><mtext mathvariant="normal">(</mtext><mtext mathvariant="normal">h</mtext><mtext mathvariant="normal">)</mtext></mrow></msubsup><annotation encoding="application/x-tex">\mu_{r}^{\text{(}\text{h}\text{)}}</annotation></semantics></math>
is the prior mean steepness for a given region (bounded between 0.2 and
1) while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r}^{(h)}</annotation></semantics></math>
is the standard deviation for these priors.</p>
</div>
<div class="section level5">
<h5 id="recruitment-proportions">Recruitment Proportions<a class="anchor" aria-label="anchor" href="#recruitment-proportions"></a>
</h5>
<p>Regional recruitment is derived by apportioning a global recruitment
parameter using regional recruitment proportions (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Œº</mi><mtext mathvariant="normal">Rec</mtext></msup><mo>‚ãÖ</mo><msub><mi>Œ∂</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\mu^{\text{Rec}} \cdot \zeta_{r}</annotation></semantics></math>).
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∂</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\zeta_{r}</annotation></semantics></math>
is derived via a multinomial logit transformation and Dirichlet priors
can be used to help constrain estimation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùõá</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>‚àë</mo><mi>r</mi><msub><mi>n</mi><mi>r</mi></msub></munderover><msub><mi>Œ±</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>‚àè</mo><mi>r</mi><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ±</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow></mfrac><munderover><mo>‚àè</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><msubsup><mi>Œ∂</mi><mi>r</mi><mrow><msub><mi>Œ±</mi><mi>r</mi></msub><mo>‚àí</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \mathbf{\zeta} \right) = \frac{\Gamma\left( \sum_{r}^{n_{r}}\alpha_{r} \right)}{\prod_{r}^{n_{r}}{\Gamma(\alpha_{r})}}\prod_{r = 1}^{n_{r}}\zeta_{r}^{\alpha_{r} - 1} \\
\end{matrix}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõá</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Œ∂</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Œ∂</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>Œ∂</mi><msub><mi>n</mi><mi>r</mi></msub></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbf{\zeta} = \{\zeta_{1},\zeta_{2},\ldots,\zeta_{n_{r}}\}</annotation></semantics></math>
are the estimated recruitment proportions across regions, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\alpha_{r}</annotation></semantics></math>
is the concentration parameter governing the spread of the Dirichlet
distribution.</p>
</div>
<div class="section level5">
<h5 id="movement">Movement<a class="anchor" aria-label="anchor" href="#movement"></a>
</h5>
<p>Likewise, priors on movement values can be assumed to arise from a
Dirichlet process:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêå</mi><mrow><mi>.</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>‚àë</mo><mi>r</mi><msub><mi>n</mi><mi>r</mi></msub></munderover><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>‚àè</mo><mi>r</mi><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow></mfrac><munderover><mo>‚àè</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><msubsup><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mrow><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>‚àí</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \mathbf{M}_{.,k,y,a,s} \right) = \frac{\Gamma\left( \sum_{r}^{n_{r}}c_{r,k,y,a,s} \right)}{\prod_{r}^{n_{r}}{\Gamma\left( c_{r,k,y,a,s} \right)}}\prod_{r = 1}^{n_{r}}M_{r,k,y,a,s}^{c_{r,k,y,a,s} - 1} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêå</mi><mrow><mi>.</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mspace width="0.222em"></mspace><mi>œµ</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">{</mo><msub><mi>M</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>‚Ä¶</mi><mo>,</mo><mspace width="0.222em"></mspace></mrow></msub><msub><mi>M</mi><msub><mi>n</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbf{M}_{.,k,y,a,s}\ \epsilon\ \{ M_{1,k,y,a,s,\ \ldots,\ }M_{n_{r,k,y,a,s}}\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the origin region,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the destination, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">c_{r,k,y,a,s}</annotation></semantics></math>
are the concentration parameters that control the Dirichlet
distribution.</p>
</div>
<div class="section level5">
<h5 id="tag-reporting-rates">Tag Reporting Rates<a class="anchor" aria-label="anchor" href="#tag-reporting-rates"></a>
</h5>
<p>Two types of priors can be specified for tag reporting rates. In
particular, a symmetric beta distribution is applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo>+</mo><mn>1</mn><mi>e</mi><mo>‚àí</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo>+</mo><mn>1</mn><mi>e</mi><mo>‚àí</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
P\left( \beta_{r,y} \right) = \left( \beta_{r,y} + 1e - 4 \right)^{\sigma_{r,y}^{(\beta)}}\left( 1 - \beta_{r,y} + 1e - 4 \right)^{\sigma_{r,y}^{(\beta)}} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r,y}^{(\beta)}</annotation></semantics></math>
determines the scale of the tag reporting parameter and determines how
strongly to penalize estimates when they approach the bounds of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\lbrack 0,1\rbrack</annotation></semantics></math>.
Smaller values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r,y}^{(\beta)}</annotation></semantics></math>
result in larger penalties, and vice versa. Thus, estimates of tag
reporting rates are penalized if they are either close to 0 or 1.</p>
<p>Tag reporting rate priors can also be specified as a standard beta
distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mrow><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mn>1</mn><mo>‚àí</mo><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msubsup><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>Œ≤</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>b</mi><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">{\begin{matrix}
a_{r}^{(\beta)} = \frac{\mu_{r,y}^{(\beta)}}{\left( \sigma_{r,y}^{(\beta)} \right)^{2}} \\
\end{matrix}
}{b_{r}^{(\beta)} = \left\lbrack \frac{1 - \mu_{r,y}^{(\beta)}}{\left( \sigma_{r,y}^{(\beta)} \right)^{2}} \right\rbrack
}{P\left( \beta_{r,y} \right) = \frac{\Gamma\left( a_{r}^{(\beta)} \right)\Gamma\left( b_{r}^{(\beta)} \right)}{\Gamma\left( a_{r}^{(\beta)} + b_{r}^{(\beta)} \right)}\beta_{r,y}^{a - 1}\left( 1 - \beta_{r,y} \right)^{b - 1}}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">a_{r}^{(h)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>b</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">b_{r}^{(h)}</annotation></semantics></math>
are the parameters describing the beta distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mu_{r,y}^{(\beta)}</annotation></semantics></math>
denotes the prior mean for tag reporting rates and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\sigma_{r,y}^{(\beta)}</annotation></semantics></math>
is the prior standard deviation.</p>
</div>
</div>
<div class="section level4">
<h4 id="process-error-penalties">Process Error Penalties<a class="anchor" aria-label="anchor" href="#process-error-penalties"></a>
</h4>
<p>In addition to priors, penalties are also utilized to aid in the
estimation of process errors (either penalized likelihood or integrating
random effects via Laplace Approximation are possible). Currently,
process errors can be specified to arise for initial age deviations,
recruitment, fishing mortality, fishery and survey selectivity, and
movement.</p>
<div class="section level5">
<h5 id="initial-age-deviations">Initial Age Deviations<a class="anchor" aria-label="anchor" href="#initial-age-deviations"></a>
</h5>
<p>To estimate non-equilibrium initial age deviations, multiplicative
deviations can be specified:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi></mrow><mtext mathvariant="normal">Init</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Init</mtext><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi></mrow><mtext mathvariant="normal">Init</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Init</mtext><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r,i}^{\text{Init}} \right) = \frac{1}{\sqrt{2\pi\sigma_{\text{Init}}^{2}}\,}\exp\left( - \frac{\left( \epsilon_{r,i}^{\text{Init}} \right)^{2}}{2\sigma_{\text{Init}}^{2}} \right)</annotation></semantics></math></p>
<p>where deviations arise from a normal distribution with a mean of 0
and variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Init</mtext><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\text{Init}}^{2}</annotation></semantics></math>.</p>
</div>
<div class="section level5">
<h5 id="recruitment-deviations">Recruitment Deviations<a class="anchor" aria-label="anchor" href="#recruitment-deviations"></a>
</h5>
<p>Annual recruitment deviations can also be specified, where
multiplicative deviations are assumed:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mtext mathvariant="normal">Rec</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi></mrow></msqrt><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi></mrow><mtext mathvariant="normal">Rec</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r,y}^{\text{Rec}} \right) = \frac{1}{\sqrt{2\pi}\sigma_{\text{Rec}}^{2}\,}\exp\left( - \frac{\left( \epsilon_{r,y}^{\text{Rec}} \right)^{2}}{2\sigma_{\text{Rec}}^{2}} \right)</annotation></semantics></math></p>
<p>and deviations are assumed to normally distributed, with a mean of 0
and variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mtext mathvariant="normal">Rec</mtext><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\text{Rec}}^{2}</annotation></semantics></math>.</p>
</div>
<div class="section level5">
<h5 id="fishing-mortality-deviations">Fishing Mortality Deviations<a class="anchor" aria-label="anchor" href="#fishing-mortality-deviations"></a>
</h5>
<p>Fishing mortality deviations similarly assumes multiplicative
deviations:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msub><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow><mn>2</mn></msubsup><mtext mathvariant="normal">Fsh</mtext></msub></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msub><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow><mn>2</mn></msubsup><mtext mathvariant="normal">Fsh</mtext></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r,y,f}^{\text{Fsh}} \right) = \frac{1}{\sqrt{2\pi{\sigma_{r,f}^{2}}_{\text{Fsh}}}\,}\exp\left( - \frac{\left( \epsilon_{r,y,f}^{\text{Fsh}} \right)^{2}}{2{\sigma_{r,f}^{2}}_{\text{Fsh}}} \right)</annotation></semantics></math></p>
<p>Here, fishing mortality deviations are assumed to arise from a normal
distribution, with mean 0 and a variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow><mn>2</mn></msubsup><mtext mathvariant="normal">Fsh</mtext></msub><annotation encoding="application/x-tex">{\sigma_{r,f}^{2}}_{\text{Fsh}}</annotation></semantics></math>.</p>
</div>
<div class="section level5">
<h5 id="fishery-and-survey-selectivity-2">Fishery and Survey Selectivity<a class="anchor" aria-label="anchor" href="#fishery-and-survey-selectivity-2"></a>
</h5>
<p>A variety of process error parameterizations can be specified for
fishery and survey selectivity. Across all parameterizations,
multiplicative deviations are assumed. In the most basic case, iid
deviations can be assumed to vary about a parameter on a given
selectivity functional form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r,y,i,s,j}^{\text{Sel}} \right) = \frac{1}{\sqrt{2\pi\sigma_{r,i,s,j,Sel}^{2}}\,}\exp\left( - \frac{\left( \epsilon_{r,y,i,s,j}^{\text{Sel}} \right)^{2}}{2\sigma_{r,i,s,j,Sel}^{2}} \right)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><annotation encoding="application/x-tex">\epsilon_{r,y,i,s,j}^{\text{Sel}}</annotation></semantics></math>
are selectivity deviations about a given parameter for region
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
sex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
and fleet
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
Deviations are assumed to have a mean of 0 and a variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{r,i,s,j,Sel}^{2}</annotation></semantics></math>,
constrained by a normal distribution.</p>
<p>Extending the iid case, random walk selectivity deviations can also
be specified about a given parameter, assuming a normal
distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><mo>‚ãÖ</mo><msup><mn>5</mn><mn>2</mn></msup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><mrow><mi>‚ãÖ</mi><mn>5</mn></mrow><mn>2</mn></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mi>i</mi><mi>f</mi><mi>y</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo>‚àí</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>i</mi><mi>f</mi><mi>y</mi><mo>&gt;</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable></mrow><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r,y,i,s,j}^{\text{Sel}} \right) = \left\{ \begin{matrix}
\frac{1}{\sqrt{2\pi \cdot 5^{2}}\,}\exp\left( - \frac{\left( \epsilon_{r,y = 1,i,s,j}^{\text{Sel}} \right)^{2}}{2{\cdot 5}^{2}} \right),\ if y = 1) \\
\frac{1}{\sqrt{2\pi\sigma_{r,i,s,j,Sel}^{2}}\,}\exp\left( - \frac{\left( \epsilon_{r,y,i,s,j}^{\text{Sel}} - \epsilon_{r,y - 1,i,s,j}^{\text{Sel}} \right)^{2}}{2\sigma_{r,i,s,j,Sel}^{2}} \right),if y &gt; 1) \\
\end{matrix} \right.\ </annotation></semantics></math></p>
<p>where process error deviations for the first year are initialized
with a large variance. Following the first year, process error
deviations follow a random walk process with a mean conditional on the
previous year‚Äôs value
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><annotation encoding="application/x-tex">\epsilon_{r,y - 1,i,s,j}^{\text{Sel}}</annotation></semantics></math>)
and a variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{r,i,s,j,Sel}^{2}</annotation></semantics></math>.</p>
<p>In addition to being constrained by a normal distribution, both iid
and random walk cases have an optional additional smoothness penalty
applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>S</mi><mi>e</mi><mi>l</mi><mi>Y</mi><mi>r</mi><mi>S</mi><mi>m</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>j</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>y</mi><mo>=</mo><mn>2</mn></mrow><msub><mi>n</mi><mi>y</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo>‚àí</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>i</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">P_{SelYrSmooth} = \sum_{r = 1}^{n_{r}}{\sum_{j = 1}^{n_{j}}{\sum_{s = 1}^{n_{s}}{\sum_{y = 2}^{n_{y}}{\sum_{i = 1}^{n_{i}}\left( \epsilon_{r,y,i,s,j}^{\text{Sel}}- \epsilon_{r,y - 1,i,s,j}^{\text{Sel}} \right)^{2}}}}}</annotation></semantics></math></p>
<p>which serves to ensure selectivity values do not vary drastically
from year-to-year.</p>
<p>Additionally, semi-parametric deviations can also be specified. In
total, there are three options that can be utilized, two of which allow
age, year, and cohort correlations, while one allows for only age or
length and year correlations. In the case where age, year, and cohort
correlations are specified (note that this is only possible when
age-based selectivity is specified), marginal stationary variance and a
conditional non-stationary variance can be invoked. The primary
difference between the two is that the marginal variance version does
not have a closed form solution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\mathbf{\Omega}</annotation></semantics></math>
(see equations below) and needs to be iteratively solved, while the
conditional variance version has a closed form solution. The following
equations describe the conditional variance version:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ùõú</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo mathvariant="bold">=</mo><mi>v</mi><mi>e</mi><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\epsilon}_{r,s,j}^{\text{Sel}}\mathbf{=}vec\left( \epsilon_{r,y,a,s,j}^{\text{Sel}} \right)</annotation></semantics></math></p>
<p>where we vectorize the selectivity deviations across its year and age
dimensions. These deviations are then assumed to arise from a
multivariate normal distribution (or Gaussian Markov Random Field) with
a covariance matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùö∫</mi><mo>=</mo><msup><mi>ùêê</mi><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{\Sigma} = \mathbf{Q}^{- 1}</annotation></semantics></math>)
determined by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Q</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">I</mtext><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">B</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>ùõÄ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">I</mtext><mo>‚àí</mo><mtext mathvariant="normal">B</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùõÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>‚àí</mi><mn>2</mn></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Q} = \left( \text{I} - \left( \text{B} \right)^{T} \right)\mathbf{\Omega}\left( \text{I} - \text{B} \right) \\
\text{diag}\left( \mathbf{\Omega} \right) = \sigma_{r,s,j,Sel}^{- 2} \\
\end{matrix}</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">I</mtext><annotation encoding="application/x-tex">\text{I}</annotation></semantics></math>
is an identity matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÄ</mi><annotation encoding="application/x-tex">\mathbf{\Omega}</annotation></semantics></math>
is a diagonal matrix that determines the variance of the multivariate
normal process.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">B</mtext><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math>
is a square matrix representing the partial effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùõú</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><annotation encoding="application/x-tex">\mathbf{\epsilon}_{r,s,j}^{\text{Sel}}</annotation></semantics></math>
on preceding ages and/or years, governed by partial correlation
coefficients for ages, years, and cohorts. To demonstrate the
formulation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">B</mtext><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math>,
a simplified example is provided with rows representing ages
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mspace width="0.222em"></mspace><mi>œµ</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">a\ \epsilon\ \{ 1,2\}</annotation></semantics></math>
and columns representing years
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mspace width="0.222em"></mspace><mi>œµ</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">y\ \epsilon\ \{ 1,2\}</annotation></semantics></math>.
In this example,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">B</mtext><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mspace width="0.222em"></mspace><mi>x</mi><mspace width="0.222em"></mspace><mn>4</mn></mrow><annotation encoding="application/x-tex">4\ x\ 4</annotation></semantics></math>
matrix, where both the rows and columns represent combinations of age
and year. For instance,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">B_{1,2}</annotation></semantics></math>
captures the correlation within the same year between age 1 in year 1,
and age 2 in year 1, whereas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">B_{4,1}</annotation></semantics></math>
constructs the correlation within the same cohort between age 1 in year
1, and age 2 in year 2:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>ùêÅ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>y</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>a</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>c</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>a</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>œÅ</mi><mi>y</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\mathbf{B} = \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
\rho_{y} &amp; 0 &amp; 0 &amp; 0 \\
\rho_{a} &amp; 0 &amp; 0 &amp; 0 \\
\rho_{c} &amp; \rho_{a} &amp; \rho_{y} &amp; 0 \\
\end{bmatrix} \\
\end{matrix}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\rho_{y}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>a</mi></msub><annotation encoding="application/x-tex">\rho_{a}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\rho_{c}</annotation></semantics></math>
are parameters describing the partial autocorrelation among years within
a given age, among ages within a given year, and years within a cohort,
respectively. The multivariate likelihood is then defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùõú</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>ùêê</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>œÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mi>n</mi><mn>2</mn></mfrac></msup></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùõú</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mi>ùêê</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùõú</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow><mtext mathvariant="normal">Sel</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \mathbf{\epsilon}_{r,s,j}^{\text{Sel}} \right) = \frac{\left| \mathbf{Q} \right|^{1/2}}{(2\pi)^{\frac{n}{2}}}\exp\left( - \frac{1}{2}\left( \mathbf{\epsilon}_{r,s,j}^{\text{Sel}} \right)^{T}\mathbf{Q}\left( \mathbf{\epsilon}_{r,s,j}^{\text{Sel}} \right) \right)</annotation></semantics></math></p>
<p>If age or length and year correlations are specified (i.e., a
two-dimensional autoregressive structure), a multivariate normal
likelihood is similarly assumed (i.e., the equation described above),
but the covariance structured of this process is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="normal">Q</mtext><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup><mo>=</mo><mfrac><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>œÅ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>œÅ</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><msub><mtext mathvariant="normal">R</mtext><mi>y</mi></msub><mo>‚äó</mo><msub><mtext mathvariant="normal">R</mtext><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">\text{Q}^{- 1} = \frac{\sigma_{r,s,j,Sel}^{2}}{\left( 1 - \rho_{y} \right)^{2}\left( 1 - \rho_{b} \right)^{2}}\text{R}_{y} \otimes \text{R}_{b}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\rho_{y}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>b</mi></msub><annotation encoding="application/x-tex">\rho_{b}</annotation></semantics></math>
are correlation coefficients across years and bins, respectively.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">R</mtext><mi>y</mi></msub><annotation encoding="application/x-tex">\text{R}_{y}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>y</mi></msub><mo>√ó</mo><msub><mi>n</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">n_{y} \times n_{y}</annotation></semantics></math>
matrix representing a first-order autoregressive process across years
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">R</mtext><mi>b</mi></msub><annotation encoding="application/x-tex">\text{R}_{b}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>b</mi></msub><mo>√ó</mo><msub><mi>n</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">n_{b} \times n_{b}</annotation></semantics></math>
matrix representing a first-order autoregressive process across
bins.</p>
<p>Moreover, when semi-parametric deviations are specified, additional
optional penalties can be applied across bins and years to enforce
curvature control:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>S</mi><mi>e</mi><mi>l</mi><mi>B</mi><mi>i</mi><mi>n</mi><mi>C</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>j</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>y</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>b</mi><mo>=</mo><mn>2</mn></mrow><mrow><msub><mi>n</mi><mi>b</mi></msub><mo>‚àí</mo><mn>1</mn></mrow></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">P_{SelBinCurve} = \sum_{r = 1}^{n_{r}}{\sum_{j = 1}^{n_{j}}{\sum_{s = 1}^{n_{s}}{\sum_{y = 1}^{n_{y}}{\sum_{b = 2}^{n_{b} - 1}\left( \log\left( {Sel}_{r,y,b + 1,s,j} \right) - 2\log\left( {Sel}_{r,y,b,s,j} \right)\log\left( {Sel}_{r,y,b - 1,s,j} \right) \right)^{2}}}}}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>S</mi><mi>e</mi><mi>l</mi><mi>Y</mi><mi>r</mi><mi>C</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>r</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>j</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>y</mi><mo>=</mo><mn>2</mn></mrow><mrow><msub><mi>n</mi><mi>y</mi></msub><mo>‚àí</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo>‚àë</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>b</mi></msub></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>S</mi><mi>e</mi><mi>l</mi></mrow><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">P_{SelYrCurve} = \sum_{r = 1}^{n_{r}}{\sum_{j = 1}^{n_{j}}{\sum_{s = 1}^{n_{s}}{\sum_{y = 2}^{n_{y} - 1}{\sum_{b = 1}^{n_{b}}\left( \log\left( {Sel}_{r,y + 1,b,s,j} \right) - 2\log\left( {Sel}_{r,y,b,s,j} \right)\log\left( {Sel}_{r,y - 1,b,s,j} \right) \right)^{2}}}}}</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="movement-1">Movement<a class="anchor" aria-label="anchor" href="#movement-1"></a>
</h5>
<p>Process error deviations can also be specified for movement
parameters. Currently, only iid deviations are allowed, where deviations
are placed upon fixed-effects movement parameters in logit space:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>œâ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>+</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Move</mtext></msubsup></mrow><annotation encoding="application/x-tex">\omega_{r,k,y,a,s} = \omega_{r,k,s} + \epsilon_{r,k,y,a,s}^{\text{Move}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œâ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\omega_{r,k,y,a,s}</annotation></semantics></math>
are movement parameters in logit space for origin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
destination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
and sex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œâ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\omega_{r,k,s}</annotation></semantics></math>
are the corresponding fixed effects (the mean logits). Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Move</mtext></msubsup><annotation encoding="application/x-tex">\epsilon_{r,k,y,a,s}^{\text{Move}}</annotation></semantics></math>
are movement deviations specified in logit space. Deviations then arise
from a normal distribution with process variation constrained by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>M</mi><mi>o</mi><mi>v</mi><mi>e</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{r,a,s,Move}^{2}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>‚àí</mi><mn>1</mn><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Move</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>œÄ</mi><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>M</mi><mi>o</mi><mi>v</mi><mi>e</mi></mrow><mn>2</mn></msubsup></mrow></msqrt><mspace width="0.167em"></mspace></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œµ</mi><mrow><mi>r</mi><mo>,</mo><mi>‚àí</mi><mn>1</mn><mo>,</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow><mtext mathvariant="normal">Move</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>M</mi><mi>o</mi><mi>v</mi><mi>e</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L\left( \epsilon_{r, - 1,y,a,s}^{\text{Move}} \right) = \frac{1}{\sqrt{2\pi\sigma_{r,a,s,Move}^{2}}\,}\exp\left( - \frac{\left( \epsilon_{r, - 1,y,a,s}^{\text{Move}} \right)^{2}}{2\sigma_{r,a,s,Move}^{2}} \right)</annotation></semantics></math></p>
<p>Thus, process variation can be distinct for a given origin region,
age, and sex. Because logits are parameterized with a reference
category, only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>r</mi></msub><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_{r} - 1</annotation></semantics></math>
logits (and their deviations) are estimated per origin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
ensuring the sum-to-one constraint on destination probabilities.</p>
</div>
</div>
<div class="section level4">
<h4 id="joint-likelihood">Joint Likelihood<a class="anchor" aria-label="anchor" href="#joint-likelihood"></a>
</h4>
<p>Lastly, the joint likelihood to be minimized represents the sum of
all observational likelihood components, priors, and penalties defined
above:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Joint Likelihood</mtext><mo>=</mo><mo>‚àë</mo><mtext mathvariant="normal">Observation Likelihoods</mtext><mo>+</mo><mo>‚àë</mo><mtext mathvariant="normal">Priors</mtext><mo>+</mo><mo>‚àë</mo><mtext mathvariant="normal">Penalties</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\text{Joint Likelihood} = \sum\text{Observation\ Likelihoods} + \sum\text{Priors} + \sum\text{Penalties} \\
\end{matrix}</annotation></semantics></math></p>
<p>Note that some of these components may be zero (i.e., if no priors
are used) depending on the configuration of the model.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Kristensen, K., Nielsen, A., Berg, C.W., Skaug, H., Bell, B., 2016.
TMB: Automatic Differentiation and Laplace Approximation. J. Stat. Soft.
70. <a href="https://doi.org/10.18637/jss.v070.i05" class="external-link uri">https://doi.org/10.18637/jss.v070.i05</a></p>
<p>Mace, P.M., Doonan, I.J., 1988. A Generalised Bioeconomic Simulation
Model for Fish Population Dynamics. MAFFish, N.Z. Ministry of
Agriculture and Fisheries.</p>
<p>McGarvey, R., Feenstra, J.E., 2002. Estimating rates of fish movement
from tag recoveries: conditioning by recapture. Can. J. Fish. Aquat.
Sci. 59, 1054‚Äì1064. <a href="https://doi.org/10.1139/f02-080" class="external-link uri">https://doi.org/10.1139/f02-080</a></p>
<p>Methot, R.D., Taylor, I.G., 2011. Adjusting for bias due to
variability of estimated recruitments in fishery assessment models. Can.
J. Fish. Aquat. Sci. 68, 1744‚Äì1760. <a href="https://doi.org/10.1139/f2011-092" class="external-link uri">https://doi.org/10.1139/f2011-092</a></p>
<p>Monnahan, C.C., 2024. Toward good practices for Bayesian data-rich
fisheries stock assessments using a modern statistical workflow.
Fisheries Research 275, 107024. <a href="https://doi.org/10.1016/j.fishres.2024.107024" class="external-link uri">https://doi.org/10.1016/j.fishres.2024.107024</a></p>
<p>Thorson, J.T., Johnson, K.F., Methot, R.D., Taylor, I.G., 2017.
Model-based estimates of effective sample size in stock assessment
models using the Dirichlet-multinomial distribution. Fisheries Research
192, 84‚Äì93. <a href="https://doi.org/10.1016/j.fishres.2016.06.005" class="external-link uri">https://doi.org/10.1016/j.fishres.2016.06.005</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
