[{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"population-initialization","dir":"Articles","previous_headings":"Process Equations","what":"Population Initialization","title":"Description of Model Equations","text":"SPoRC, three primary methods exist initialize equilibrium population model. first method derives equilibrium population using following process: Nr,,sâ€²=Î¼Recexp(âˆ’(âˆ’1)â‹…(Zr,,sâ€²))Ïˆr,y=1,sÎ¶r,2â‰¤<+\\begin{matrix} N_{r,,s}^{'} = \\mu^{\\text{Rec}}\\exp\\left( - (- 1) \\cdot \\left( Z_{r,,s}^{'} \\right) \\right)\\psi_{r,y = 1,s}\\zeta_{r},\\quad\\text{}2 \\leq < a_{+} \\\\ \\end{matrix} Zr,,sâ€²=Natmortr,y=1,,s+Î¼r,f=1FshFmortInitPropSelr,y=1,,s,f=1FshZ_{r,,s}^{'} = \\text{Natmort}_{r,y = 1,,s} + \\mu_{r,f = 1}^{\\text{Fsh}}\\text{Fmort}^{\\text{InitProp}}\\text{Sel}_{r,y = 1,,s,f = 1}^{\\text{Fsh}} : Nr,,sâ€²N_{r,,s}^{'} equilibrium numbers--age, Î¼Rec\\mu^{\\text{Rec}} global recruitment parameter (either virgin mean recruitment depending parameterization stock recruitment dynamics), Zr,,sâ€²Z_{r,,s}^{'} initial instantaneous total mortality rate, Natmortr,y=1,,s\\text{Natmort}_{r,y = 1,,s} instantaneous natural mortality rate, Î¼r,f=1Fsh\\mu_{r,f = 1}^{\\text{Fsh}} mean fishing mortality rate first fleet (ff denotes fishery fleet), FmortInitProp\\text{Fmort}^{\\text{InitProp}} user-defined value describing proportion mean fishing mortality first fleet applied initialization stage, Selr,y=1,,s,f=1Fsh\\text{Sel}_{r,y = 1,,s,f = 1}^{\\text{Fsh}} fishery selectivity--age first fleet, Ïˆr,y,s\\psi_{r,y,s} describes recruitment sex-ratio, Î¶r\\zeta_{r} apportions global recruitment parameter across regions (estimated using multinomial logit transform ensure proportions sum one). plus group (+a_{+}) initial population computed : Nr,+,sâ€²=Nr,+âˆ’1,sâ€²exp(âˆ’Zr,=+âˆ’1,sâ€²)1âˆ’exp(Zr,=+,sâ€²)\\begin{matrix} N_{r,a_{+},s}^{'} = N_{r,a_{+} - 1,s}^{'}\\dfrac{\\exp\\left( - Z_{r,= a_{+} - 1,s}^{'} \\right)}{1 - \\exp\\left( Z_{r,= a_{+},s}^{'} \\right)} \\\\ \\end{matrix} However, scalar geometric series solution assumes plus group accumulates closed system. Therefore, movement dynamics present, solution correctly accumulate individuals plus group. address , additional methods provided explicitly incorporate movement dynamics plus group calculation. particular, initial population can derived iterating population equilibrium. , total instantaneous mortality region defined similarly first method. exponential decay model used first initialize age structure first iteration: Nr,,sâ€²={Î¼RecÏˆr,y=1,sÎ¶r,=1Î¼RecÏˆr,y=1,sÎ¶rexp(âˆ’âˆ‘=1naZr,,sâ€²),>1\\begin{matrix} N_{r,,s}^{'} = \\left\\{ \\begin{matrix} \\mu^{\\text{Rec}}\\,\\psi_{r,y = 1,s}\\,\\zeta_{r}, & \\text{}= 1 \\\\ \\mu^{\\text{Rec}}\\,\\psi_{r,y = 1,s}\\,\\zeta_{r}\\,\\exp\\left( - \\sum_{= 1}^{n_{}}Z_{r,,s}^{'} \\right), & \\text{}> 1 \\\\ \\end{matrix} \\right.\\  \\\\ \\end{matrix} initialized age structure iterated forward equilibrium applying recruitment, movement, mortality ageing processes order (see Population Projection section equations). iterative method correctly accumulates plus group movement present, can computationally inefficient due potentially large number iterations required propagate initial population. Therefore, SPoRC enables users compute plus group using matrix formulation geometric series, correctly accounts movement processes. Individuals first initialized recruitment processes, movement, mortality, ageing processes applied sequentially. population (cohort) projected forward penultimate age (Nr,+âˆ’1,sâ€²N_{r,a_{+} - 1,s}^{'}), used derive plus group. Specifically, penultimate age projected forward : ğ—s=((ğa+âˆ’1,sâ€²)TğŒy=1,+âˆ’1,s)âŠ™exp(âˆ’ğ™a=+âˆ’1,sâ€²)\\mathbf{X}_{s}\\mathbf{=}\\left( \\left( \\mathbf{N}_{a_{+} - 1,s}^{'} \\right)^{T}\\mathbf{M}_{y = 1,a_{+} - 1,s} \\right) \\odot \\exp\\left( - \\mathbf{Z}_{= a_{+} - 1,s}^{'} \\right) ğŒ\\mathbf{M} first-order Markov matrix representing movement, âŠ™\\odot Hadamard product (elementwise multiplication), ğ—s\\mathbf{X}_{s} represents culmination processes applied penultimate age. transition matrix (ğ†s\\mathbf{(G}_{s}) constructed represent combined effects survival movement plus group: ğ†s=diag(exp(âˆ’ğ™a=+,sâ€²))(ğŒy=1,+,s)T\\mathbf{G}_{s} = \\text{diag}\\left( \\exp\\left( - \\mathbf{Z}_{= a_{+},s}^{'} \\right) \\right)\\left( \\mathbf{M}_{y = 1,a_{+},s} \\right)^{T} plus group solution incorporating movement given : ğa+,sâ€²=(ğˆâˆ’ğ†s)âˆ’1ğ—s\\mathbf{N}_{a_{+},s}^{'} = \\left( \\mathbf{-}\\mathbf{G}_{s} \\right)^{- 1}\\mathbf{X}_{s} single region modeled movement occurs (.e., identity matrix), matrix formulation simplifies standard scalar geometric series solution. Following definition equilibrium age structure, initial age deviations can applied: Nr,y=1,â‰ 1,s=Nâ€²r,â‰ 1,sexp(Ïµr,iInit)\\begin{matrix} N_{r,y = 1,\\neq 1,s} = N'_{r,\\neq 1,s}\\text{exp}\\left( \\epsilon_{r,}^{\\text{Init}} \\right) \\\\ \\end{matrix} Nr,y=1,â‰ 1,sN_{r,y = 1,\\neq 1,s} represents numbers--age first model year except recruits (â‰ 1a \\neq 1). values can treated stochastic process applying multiplicative lognormal deviations Ïµr,iInit\\epsilon_{r,}^{\\text{Init}} initial equilibrium age structure. Note index ii introduced users can determine whether initial age deviations estimated penultimate age class, across classes including plus group.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"recruitment-processes","dir":"Articles","previous_headings":"Process Equations","what":"Recruitment Processes","title":"Description of Model Equations","text":"current iteration SPoRC, two stock recruitment parameterizations can specified. Recruitment can specified arise mean parameter (Î¼Rec\\mu^{\\text{Rec}}): Nr,y,=1,s=Î¼Recexp(Ïµr,yRecâˆ’ÏƒRec22by)Ïˆr,y,sÎ¶r\\begin{matrix} N_{r,y,= 1,s} = \\mu^{\\text{Rec}}\\exp\\left( \\epsilon_{r,y}^{\\text{Rec}} - \\frac{\\sigma_{\\text{Rec}}^{2}}{2}b_{y} \\right)\\psi_{r,y,s}\\zeta_{r} \\\\ \\end{matrix} Ïµr,y\\epsilon_{r,y} annual, lognormally distributed recruitment deviations lognormal bias correction term (ÏƒRec22by\\frac{\\sigma_{\\text{Rec}}^{2}}{2}b_{y}), byb_{y} representing bias correction ramp Methot Taylor (2011). Recruitment can also specified arise Beverton-Holt stock recruitment function invoke density-dependent population dynamics, follows steepness parameterization (Mace Doonan, 1988). Localized density-dependent recruitment defined : Nr,y,=1,s=4Î¼RecÎ¶rhrSSBr,yâˆ’RecLag(1âˆ’hr)SSB0r+5(hrâˆ’1)SSBr,yâˆ’RecLagexp(Ïµr,yRecâˆ’ÏƒRec22by)Ïˆr,y,s\\begin{matrix} N_{r,y,= 1,s} = \\dfrac{4\\mu^{\\text{Rec}}\\zeta_{r}h_{r}{SSB}_{r,y - RecLag}}{\\left( 1 - h_{r} \\right)SSB0_{r} + 5\\left( h_{r} - 1 \\right){SSB}_{r,y - RecLag}}\\exp\\left( \\epsilon_{r,y}^{\\text{Rec}} - \\frac{\\sigma_{\\text{Rec}}^{2}}{2}b_{y} \\right)\\psi_{r,y,s} \\\\ \\end{matrix} global density-dependent recruitment can defined : Nr,y,=1,s=4Î¼RecÎ¶rhâˆ‘rSSBr,yâˆ’RecLag(1âˆ’h)âˆ‘rSSB0r+5(hâˆ’1)âˆ‘rSSBr,yâˆ’RecLagexp(Ïµr,yRecâˆ’ÏƒRec22by)Ïˆr,y,s\\begin{matrix} N_{r,y,= 1,s} = \\dfrac{4\\mu^{\\text{Rec}}\\zeta_{r}h\\sum_{r}^{}{SSB}_{r,y - RecLag}}{(1 - h)\\sum_{r}^{}{SSB0_{r}} + 5(h - 1)\\sum_{r}^{}{SSB}_{r,y - RecLag}}\\exp\\left( \\epsilon_{r,y}^{\\text{Rec}} - \\frac{\\sigma_{\\text{Rec}}^{2}}{2}b_{y} \\right)\\psi_{r,y,s} \\\\ \\end{matrix} Î¼Rec\\mu^{\\text{Rec}} parameterization virgin unfished recruitment, hrh_{r} (hh) steepness parameter representing fraction Î¼RecÎ¶r\\mu^{\\text{Rec}}\\zeta_{r} produced 20% SSB0rSSB0_{r} (âˆ‘rSSB0r\\sum_{r}^{}{SSB0_{r}}). steepness parameter constrained values 0.2 1 estimated bounded logit space. SSB0rSSB0_{r} derived variable represents unfished spawning stock biomass (.e., derived multiplying unfished SSB per recruit Î¼RecÎ¶r\\mu^{\\text{Rec}}\\zeta_{r}). SSBr,yâˆ’RecLag{SSB}_{r,y - RecLag} spawning stock biomass, product numbers--age, spawning weight--age, maturity--age females: SSBr,y=âˆ‘=1a+Nr,y,,s=1Wr,y,,s=1spawnMatr,y,,s=1\\begin{matrix} SSB_{r,y} = \\sum_{= 1}^{a_{+}}{N_{r,y,,s = 1}W_{r,y,,s = 1}^{spawn}{Mat}_{r,y,,s = 1}} \\\\ \\end{matrix} Note RecLagRecLag denotes delay spawning recruits enter population. Thus, RecLag>yRecLag > y, SPoRC utilizes SSB0rSSB0_{r} instead SSBr,yâˆ’RecLag{SSB}_{r,y - RecLag} compute deterministic recruitment.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"population-projection","dir":"Articles","previous_headings":"Process Equations","what":"Population Projection","title":"Description of Model Equations","text":"Following recruitment processes, population can projected forward. context spatial model, Markovian movement dynamics first applied: ğy,,s=(ğy,,s)TğŒy,,s\\begin{matrix} \\mathbf{N}_{y,,s} = \\left( \\mathbf{N}_{y,,s} \\right)^{T}\\mathbf{M}_{y,,s} \\\\ \\end{matrix} , ğŒy,,s\\mathbf{M}_{y,,s} first-order Markov matrix representing movement. single-region case, movement applied (.e., ğŒy,,s\\mathbf{M}_{y,,s} implied identity matrix). year, age, sex combination, movement matrix specifies bulk-transfer coefficients, parameters transformed multinomial logit ensure proportions within origin region sum one. Following movement processes, population undergoes mortality ageing: Nr,y+1,+1,s=Nr,y,,sexp(âˆ’Zr,y,,s),1â‰¤<+\\begin{matrix} N_{r,y + 1,+ 1,s} = N_{r,y,,s}\\exp\\left( - Z_{r,y,,s} \\right),\\quad\\text{}1 \\leq < a_{+} \\\\ \\end{matrix} Nr,y+1,,s=Nr,y,âˆ’1,sexp(âˆ’Zr,y,âˆ’1,s)+Nr,y,,sexp(âˆ’Zr,y,,s),=+N_{r,y + 1,,s} = N_{r,y,- 1,s}\\exp\\left( - Z_{r,y,- 1,s} \\right) + N_{r,y,,s}\\exp\\left( - Z_{r,y,,s} \\right),\\quad\\text{}= a_{+} Zr,y,,sZ_{r,y,,s} denotes annual total instantaneous mortality rate defined combination natural mortality (Natmortr,y,,s\\text{Natmort}_{r,y,,s}) fishing mortality (Fmortr,y,f\\text{Fmort}_{r,y,f}): Zr,y,,s=Natmortr,y,,s+âˆ‘fSelr,y,,s,fFshFmortr,y,f\\begin{matrix} Z_{r,y,,s} = \\text{Natmort}_{r,y,,s} + \\sum_{f}^{}\\text{Sel}_{r,y,,s,f}^{\\text{Fsh}}\\text{Fmort}_{r,y,f} \\\\ \\end{matrix} annual instantaneous fishing mortality rate defined : Fmortr,y,f=Î¼r,fFshexp(Ïµr,y,fFsh)\\begin{matrix} \\text{Fmort}_{r,y,f} = \\mu_{r,f}^{\\text{Fsh}}\\text{exp}\\left( \\epsilon_{r,y,f}^{\\text{Fsh}} \\right) \\\\ \\end{matrix} Fmortr,y,f\\text{Fmort}_{r,y,f} parameterized based lognormal deviations (Ïµr,y,fFsh)\\epsilon_{r,y,f}^{\\text{Fsh}}) mean fishing mortality parameter given fishery fleet (Î¼r,fFsh\\mu_{r,f}^{\\text{Fsh}}).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-observation-model","dir":"Articles","previous_headings":"Observation Equations","what":"Fishery Observation Model","title":"Description of Model Equations","text":"fishery observation model describes expected catch--age, catch--length, catch (units biomass), fishery indices. Expected catch--age (Cr,y,,s,faC_{r,y,,s,f}^{}) given fishery fleet calculated using Baranovâ€™s catch equation: Cr,y,,s,fa=Fmortr,y,fSelr,y,,s,fFshZr,y,,sNr,y,,s[1âˆ’exp(âˆ’Zr,y,,s)]\\begin{matrix} C_{r,y,,s,f}^{} = \\dfrac{\\text{Fmort}_{r,y,f}\\text{Sel}_{r,y,,s,f}^{\\text{Fsh}}}{Z_{r,y,,s}}N_{r,y,,s}\\left\\lbrack 1 - \\exp\\left( - Z_{r,y,,s} \\right) \\right\\rbrack \\\\ \\end{matrix} track length-based dynamics, catch--length (Cr,y,l,s,flC_{r,y,l,s,f}^{l}) can derived using following equation: Cr,y,l,s,fl=ğ€r,y,slğ‚ğšr,y,s,f\\begin{matrix} C_{r,y,l,s,f}^{l} = \\mathbf{}_{r,y,s}^{l}{\\mathbf{C}^{\\mathbf{}}}_{r,y,s,f} \\\\ \\end{matrix} ğ€r,y,sl\\mathbf{}_{r,y,s}^{l} user-defined size-age transition matrix convert ages lengths. Expected catch (Catchr,y,f\\text{Catch}_{r,y,f}) computed summation expected catch--age across ages sexes, multiplied respective fishery weights--age (Wr,y,,s,ffishW_{r,y,,s,f}^{fish}): Catchr,y,f=âˆ‘aa+âˆ‘snsCr,y,,s,faWr,y,,s,ffish\\begin{matrix} \\text{Catch}_{r,y,f} = \\sum_{}^{a_{+}}{\\sum_{s}^{n_{s}}C_{r,y,,s,f}^{}}W_{r,y,,s,f}^{fish} \\\\ \\end{matrix} expected fishery index (FshIdxr,y,f\\text{FshIdx}_{r,y,f}) computed : FshIdxr,y,f=qr,y,fFshâˆ‘aa+âˆ‘snsNr,y,,sexp(âˆ’Zr,y,,s)Selr,y,,s,fFshWr,y,,s,ffish\\begin{matrix} \\begin{matrix} \\text{FshIdx}_{r,y,f} = q_{r,y,f}^{\\text{Fsh}}\\sum_{}^{a_{+}}{\\sum_{s}^{n_{s}}N_{r,y,,s}}\\exp\\left( - Z_{r,y,,s} \\right)\\text{Sel}_{r,y,,s,f}^{\\text{Fsh}}W_{r,y,,s,f}^{fish} \\\\ \\end{matrix} \\\\ \\end{matrix} qr,y,fFshq_{r,y,f}^{\\text{Fsh}} catchability coefficient given fishery fleet.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"survey-observation-model","dir":"Articles","previous_headings":"Observation Equations","what":"Survey Observation Model","title":"Description of Model Equations","text":"Likewise, survey observation model describes expected survey catch--age, survey catch--length, survey indices. Expected survey catch--age (Ir,y,,s,sfaI_{r,y,,s,sf}^{}) calculated follows: Ir,y,,s,sfa=Nr,y,,sexp(âˆ’Zr,y,,stsrv)Selr,y,,s,sfSrv\\begin{matrix} I_{r,y,,s,sf}^{} = N_{r,y,,s}\\exp\\left( - Z_{r,y,,s}t^{srv} \\right)\\text{Sel}_{r,y,,s,sf}^{\\text{Srv}} \\\\ \\end{matrix} subscript sfsf denotes given survey fleet Selr,y,,s,sfSrv\\text{Sel}_{r,y,,s,sf}^{\\text{Srv}} survey selectivity--age pattern. Expected survey catch--length (Ir,y,l,s,sflI_{r,y,l,s,sf}^{l}) given : Ir,y,l,s,sfl=ğ€r,y,slğˆğšr,y,s,f\\begin{matrix} I_{r,y,l,s,sf}^{l} = \\mathbf{}_{r,y,s}^{l}{\\mathbf{}^{\\mathbf{}}}_{r,y,s,f} \\\\ \\end{matrix} Survey indices (SrvIdxr,y,sf\\text{SrvIdx}_{r,y,sf}) can computed either abundance-based biomass-based. Abundance-based survey indices calculated : SrvIdxr,y,sf=qr,y,sfSrvâˆ‘aa+âˆ‘snsIr,y,,s,sfa\\begin{matrix} \\text{SrvIdx}_{r,y,sf} = q_{r,y,sf}^{\\text{Srv}}\\sum_{}^{a_{+}}{\\sum_{s}^{n_{s}}I_{r,y,,s,sf}^{}} \\\\ \\end{matrix} biomass-based indices computed : SrvIdxr,y,sf=qr,y,sfSrvâˆ‘aa+âˆ‘snsIr,y,,s,sfaWr,y,,s,sfsrv\\begin{matrix} \\text{SrvIdx}_{r,y,sf} = q_{r,y,sf}^{\\text{Srv}}\\sum_{}^{a_{+}}{\\sum_{s}^{n_{s}}I_{r,y,,s,sf}^{}}W_{r,y,,s,sf}^{srv} \\\\ \\end{matrix} , Wr,y,,s,sfsrvW_{r,y,,s,sf}^{srv} weight--age given survey, qr,y,sfSrvq_{r,y,sf}^{\\text{Srv}} represents survey catchability coefficient aforementioned equations. survey catchability, environmental linkage can specified: qr,y,sfSrv=qr,sfSrvexp(ğ±Tğ›ƒ+âˆ‘mÎ¹mpm(zr,y,sf))q_{r,y,sf}^{\\text{Srv}} = q_{r,sf}^{\\text{Srv}}\\exp\\left( \\mathbf{x}^{T}\\mathbf{\\beta +}\\sum_{m}^{}{\\iota_{m}p_{m}\\left( z_{r,y,sf} \\right)} \\right) qr,sfSrvq_{r,sf}^{\\text{Srv}} base survey catchability (.e., intercept), ğ±\\mathbf{x} matrix covariates, ğ›ƒ\\mathbf{\\beta} vector regression coefficients, Î¹mpm\\iota_{m}p_{m} orthogonal polynomial coefficients along basis functions, zr,y,sfz_{r,y,sf} covariates polynomial term assumed .","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"tagging-observation-model","dir":"Articles","previous_headings":"","what":"Tagging Observation Model","title":"Description of Model Equations","text":"tagging observation model tracks tag cohorts (Tr,y,,skT_{r,y,,s}^{k}) combination release region release year (kk) follows Brownie tag attrition framework. Tag cohorts tracked pre-defined maximum duration (maximum tag liberty; nLn_{L}), calculations tag cohort longer computed. done aid computation time. Additionally, tag cohorts also option undergo fraction mortality year release, given cohort released middle year, mortality processes discounted. mortality discounting specified, movement occur year release. general, process dynamics tagged cohort mimics specified overall population. Immediately following release, tag cohorts decremented initial tag-induced mortality rate: Tr,y,,sk=Tr,y,,skexp(âˆ’Ï„)\\begin{matrix} T_{r,y,,s}^{k} = T_{r,y,,s}^{k}\\exp( - \\tau) \\\\ \\end{matrix} Ï„\\tau initial tag-induced mortality rate. tagged cohorts released beginning calendar year, Markovian movement occurs (movement occur otherwise): ğ“y,,sk=(ğ“y,,sk)TğŒy,,s\\begin{matrix} \\mathbf{T}_{y,,s}^{k} = \\left( \\mathbf{T}_{y,,s}^{k} \\right)^{\\text{T}}\\mathbf{M}_{y,,s} \\\\ \\end{matrix} Mortality ageing tagged cohort occurs: Tr,y+1,+1,sk=Tr,y,,skexp(âˆ’Zr,y,,sTag),2â‰¤<+Tr,y+1,,sk=Tr,y,âˆ’1,skexp(âˆ’Zr,y,âˆ’1,sTag)+Tr,y,,skexp(âˆ’Zr,y,,sTag),=+\\begin{matrix} \\begin{matrix} T_{r,y + 1,+ 1,s}^{k} = T_{r,y,,s}^{k}\\exp\\left( - Z_{r,y,,s}^{\\text{Tag}} \\right),\\quad\\text{}2 \\leq < a_{+} \\\\ T_{r,y + 1,,s}^{k} = T_{r,y,- 1,s}^{k}\\exp\\left( - Z_{r,y,- 1,s}^{\\text{Tag}} \\right) + T_{r,y,,s}^{k}\\exp\\left( - Z_{r,y,,s}^{\\text{Tag}} \\right),\\quad\\text{}= a_{+} \\\\ \\end{matrix} \\\\ \\end{matrix} tagged cohorts follow exponential mortality model, accumulation individuals plus-group. Total mortality tagged cohort (Zr,y,,sTagZ_{r,y,,s}^{\\text{Tag}}) specified : Zr,y,,sTag=(Îº+NatMortr,y,,s+âˆ‘fSelr,y,,s,fFshFmortr,y,f)\\begin{matrix} Z_{r,y,,s}^{\\text{Tag}} = \\left( \\kappa + \\text{NatMort}_{r,y,,s} + \\sum_{f}^{}\\text{Sel}_{r,y,,s,f}^{\\text{Fsh}}\\text{Fmort}_{r,y,f} \\right) \\\\ \\end{matrix} Îº\\kappa parameter describing chronic tag loss (.e., annual tag shedding). Similar computations catch--age, tag recaptures calculated using modified version Baranovâ€™s catch equation: Recapr,y,,sk=Î²r,yâˆ‘fSelr,y,,s,fFshZr,y,,sTagTr,y,,sk[1âˆ’exp(âˆ’Zr,y,,sTag)]\\begin{matrix} \\text{Recap}_{r,y,,s}^{k} = \\beta_{r,y}\\dfrac{\\sum_{f}^{}\\text{Sel}_{r,y,,s,f}^{\\text{Fsh}}}{Z_{r,y,,s}^{\\text{Tag}}}T_{r,y,,s}^{k}\\left\\lbrack 1 - \\exp\\left( - Z_{r,y,,s}^{\\text{Tag}} \\right) \\right\\rbrack \\\\ \\end{matrix} Î²r,y\\beta_{r,y} represents tag reporting rate parameter can vary across space time, estimated logit space constrained [0,1]\\lbrack 0,1\\rbrack.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-selectivity","dir":"Articles","previous_headings":"","what":"Fishery and Survey Selectivity","title":"Description of Model Equations","text":"following descriptions selectivity, omit subscripts sexes fleets brevity, although note equations remain specific model partitions. Several approaches available parameterizing fishery survey selectivity. Selectivity can defined either age- length-based. age-based selectivity, age vector applied directly chosen functional form. length-based selectivity, length vector used compute selectivity, combined sizeâ€“age transition matrix dot product obtain selectivity--age. ğ’ğğ¥a=(ğ€r,y,sl)Tğ’ğğ¥l\\begin{matrix} \\mathbf{Se}\\mathbf{l}^{}\\mathbf{=}\\left( \\mathbf{}_{r,y,s}^{l} \\right)^{\\text{T}}\\mathbf{Se}\\mathbf{l}^{l} \\\\ \\end{matrix} Given age-based nature model, selectivity--age utilized subsequent calculations. Various functional forms can also specified selectivity processes. following use subscript bb denote generalized bin number. Two forms logistic selectivity can specified. first form defined : Selb=11+exp[âˆ’k(bâˆ’b50)]\\begin{matrix} {Sel}_{b} = \\frac{1}{1 + \\exp\\left\\lbrack - k\\left( b - b^{50} \\right) \\right\\rbrack} \\\\ \\end{matrix} kk determines slope/steepness logistic curve b50b^{50} bin--50% selection. second form can expressed : Selb=11+19(b50âˆ’bb95)\\begin{matrix} {Sel}_{b} = \\frac{1}{1 + 19^{\\left( \\frac{b^{50} - b}{b^{95}} \\right)}} \\\\ \\end{matrix} , b50b^{50} also bin--50% selection b95b^{95} bin--95% selection. Beyond specification flat-topped selectivity, SPoRC also allows dome-shaped selectivity. particular, reparametrized gamma function can specified: p=0.5[bmax+4Î³2âˆ’bmax]\\begin{matrix} p = 0.5\\left\\lbrack \\sqrt{b^{\\max} + 4\\gamma^{2}} - b^{\\max} \\right\\rbrack \\\\ \\end{matrix} Selb=(bbmax)bmaxpexp(bmaxâˆ’bp){Sel}_{b} = \\left( \\frac{b}{b^{\\max}} \\right)^{\\frac{b^{\\max}}{p}}\\exp\\left( \\frac{b^{\\max} - b}{p} \\right) parameterization, pp derived power parameter, Î³\\gamma shape parameter describes steepness descending limb, bmaxb^{\\max} describes bin--maximum selection. Dome-shaped selectivity can also expressed power function: Selb=1bÏ•\\begin{matrix} {Sel}_{b} = \\frac{1}{b^{\\phi}} \\\\ \\end{matrix} Ï•\\phi power parameter determines descending limb curve (larger values steeper). last dome-shaped selectivity form can specified includes 6 parameter (denoted pÌ‚1{\\widehat{p}}_{1} pÌ‚6{\\widehat{p}}_{6}) double normal functional form following transformations applied: p1=min(b)+[max(b)âˆ’min(b)]â‹…11+exp(pÌ‚1)\\begin{matrix} p_{1} = \\ \\min(b) + \\left\\lbrack \\max(b) - min(b) \\right\\rbrack \\cdot \\frac{1}{1 + \\exp\\left( {\\widehat{p}}_{1} \\right)} \\\\ \\end{matrix} p2=p1+1+0.99+max(b)âˆ’p1âˆ’11+exp(pÌ‚2)p_{2} = \\ p_{1} + 1 + \\frac{0.99 + max(b) - p_{1} - 1}{1 + exp({\\widehat{p}}_{2})} p3=exp(pÌ‚3),p4=exp(pÌ‚4)p_{3} = \\exp\\left( {\\widehat{p}}_{3} \\right),\\ \\ p_{4} = \\exp\\left( {\\widehat{p}}_{4} \\right) p5=11+exp(pÌ‚5),p6=11+exp(pÌ‚6)p_{5} = \\frac{1}{1 + \\exp\\left( {\\widehat{p}}_{5} \\right)},\\ \\ p_{6} = \\frac{1}{1 + \\exp\\left( {\\widehat{p}}_{6} \\right)} p1p_{1} represents beginning plateau, p2p_{2} describes width plateau, p3p_{3} p4p_{4} parameters controlling ascending descending widths, p5p_{5} p6p_{6} control selectivity first last bins. double normal function defined series functions: ascb=exp(âˆ’(bâˆ’p1)2p3)ascscaledb=p5+(1âˆ’p5)â‹…ascbdescb=exp(âˆ’(bâˆ’p2)2p4)stj=exp(âˆ’(40âˆ’p2)2p4)descscaledb=1+(p6âˆ’1)â‹…descbâˆ’1stjâˆ’1join1b=11+exp(âˆ’20â‹…bâˆ’p11+|bâˆ’p1|)join2b=11+exp(âˆ’20â‹…bâˆ’p21+|bâˆ’p2|)\\begin{matrix} {asc}_{b} = \\exp\\left( - \\frac{\\left( b - p_{1} \\right)^{2}}{p_{3}} \\right) \\\\ {ascscaled}_{b} = p_{5} + \\left( 1 - p_{5} \\right) \\cdot {asc}_{b} \\\\ {desc}_{b} = \\exp\\left( - \\frac{\\left( b - p_{2} \\right)^{2}}{p_{4}} \\right) \\\\ stj = exp\\left( - \\frac{\\left( 40 - p_{2} \\right)^{2}}{p_{4}} \\right) \\\\ {descscaled}_{b} = 1 + \\left( p_{6} - 1 \\right) \\cdot \\frac{{desc}_{b} - 1}{stj - 1} \\\\ join1_{b} = \\frac{1}{1 + \\exp\\left( - 20 \\cdot \\frac{b - p_{1}}{1 + \\left| b - p_{1} \\right|} \\right)} \\\\ join2_{b} = \\frac{1}{1 + \\exp\\left( - 20 \\cdot \\frac{b - p_{2}}{1 + \\left| b - p_{2} \\right|} \\right)} \\\\ \\end{matrix} joined together : Selb=ascbâ‹…(1âˆ’join1b)+join1bâ‹…[(1âˆ’join2b)+descscaledbâ‹…join2b]\\begin{matrix} {Sel}_{b} = {asc}_{b} \\cdot \\left( 1 - join1_{b} \\right) + join1_{b} \\cdot \\left\\lbrack \\left( 1 - join2_{b} \\right) + {descscaled}_{b} \\cdot join2_{b} \\right\\rbrack \\\\ \\end{matrix} double normal functional form incredibly flexible able reduce flat-topped dome-shaped selectivity forms, depending values parameters. addition functional forms can specified describe selectivity processes, several options exist specify continuous time-varying processes. particular, options specify time-varying parametric selectivity time-varying semi-parametric selectivity available. illustrate, logistic selectivity specified parametric deviations invoked, following expression used: Sely,b=11+exp[âˆ’ky(bâˆ’by50)]ky=kâ‹…exp(Ïµy,1Sel)by50=b50â‹…exp(Ïµy,2Sel){\\begin{matrix} {Sel}_{y,b} = \\frac{1}{1 + \\exp\\left\\lbrack - k_{y}\\left( b - b_{y}^{50} \\right) \\right\\rbrack} \\\\ \\end{matrix} }{k_{y} = k \\cdot \\exp\\left( \\epsilon_{y,1}^{Sel} \\right) }{b_{y}^{50} = b^{50} \\cdot exp(\\epsilon_{y,2}^{Sel})} parameters logistic form allowed vary time. context semi-parametric selectivity, following equation used: Sely,bâ€²=11+exp(âˆ’k[bâˆ’b50])exp(Ïµy,bSel)Sely,b=Sely,bâ€²mean(ğ’ğğ¥â€²){\\begin{matrix} {Sel}_{y,b}^{'} = \\frac{1}{1 + \\exp\\left( - k\\left\\lbrack b - b^{50} \\right\\rbrack \\right)}\\exp\\left( {\\epsilon_{y,b}}^{Sel} \\right) \\\\ \\end{matrix} }{{Sel}_{y,b} = \\frac{{Sel}_{y,b}^{'}}{mean(\\mathbf{Se}\\mathbf{l}^{\\mathbf{'}})}} deviations placed parametric form selectivity values mean standardized aid interpretability. Importantly, note age-based selectivity specified continuous deviations estimated, deviations placed ages . case length-based selectivity specified, deviations placed length bins. details selectivity deviations arise can found â€œSelectivity Process Errorâ€ section document.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"likelihoods","dir":"Articles","previous_headings":"","what":"Likelihoods","title":"Description of Model Equations","text":"Currently, SPoRC incorporates data likelihood components following data sources: fishery catches, fishery indices, fishery age compositions, fishery length compositions, survey indices, survey age compositions, survey length compositions, tagging data. total likelihood (objective function) sum individual likelihood contributions data sources along priors penalties, objective function minimized using non-linear optimization algorithm estimate model parameters.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-catches","dir":"Articles","previous_headings":"Likelihoods > Observation Likelihoods","what":"Fishery Catches","title":"Description of Model Equations","text":"Fishery catches can fit using lognormal likelihood. log-likelihood observed catch, L(log(ObsCatchr,y,f))L\\left( \\log\\left( \\text{ObsCatch}_{r,y,f} \\right) \\right) defined : L(log(ObsCatchr,y,f))=\\begin{matrix} L\\left( \\log\\left( \\text{ObsCatch}_{r,y,f} \\right) \\right) = \\\\ \\end{matrix} Î»ObsCatchr,y,fâ‹…12Ï€ÏƒObsCatchr,,f2exp(âˆ’[log(ObsCatchr,y,f)âˆ’log(Catchr,y,f)]22ÏƒObsCatchr,y,f2)\\lambda_{\\text{ObsCatch}_{r,y,f}} \\cdot \\frac{1}{\\sqrt{2\\pi\\sigma_{\\text{ObsCatch}_{r,,f}}^{2}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\log\\left( \\text{ObsCatch}_{r,y,f} \\right) - log\\left( \\text{Catch}_{r,y,f} \\right) \\right\\rbrack^{2}}{2\\sigma_{\\text{ObsCatch}_{r,y,f}}^{2}} \\right) , Î»ObsCatchr,y,f\\lambda_{\\text{ObsCatch}_{r,y,f}} likelihood weight, ObsCatchr,y,f\\text{ObsCatch}_{r,y,f} observed catch, Catchr,y,f\\text{Catch}_{r,y,f} predicted catch, ÏƒObsCatchr,y,f2\\sigma_{\\text{ObsCatch}_{r,y,f}}^{2} variance catch log scale.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-indices","dir":"Articles","previous_headings":"Likelihoods > Observation Likelihoods","what":"Fishery and Survey Indices","title":"Description of Model Equations","text":"Fishery indices can also fit assuming lognormal likelihood. log-likelihood observed fishery indices : L(log(ObsFshIdxr,y,f))=\\begin{matrix} L\\left( \\log\\left( \\text{ObsFshIdx}_{r,y,f} \\right) \\right) = \\\\ \\end{matrix} Î»ObsFshIdxr,y,fâ‹…12Ï€ÏƒObsFshIdxr,y,f2exp(âˆ’[log(ObsFshIdxr,y,f)âˆ’log(FshIdxr,y,f)]22ÏƒObsFshIdxr,y,f2)\\lambda_{\\text{ObsFshIdx}_{r,y,f}} \\cdot \\frac{1}{\\sqrt{2\\pi\\sigma_{\\text{ObsFshIdx}_{r,y,f}}^{2}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\log\\left( \\text{ObsFshIdx}_{r,y,f} \\right) - log\\left( \\text{FshIdx}_{r,y,f} \\right) \\right\\rbrack^{2}}{2\\sigma_{\\text{ObsFshIdx}_{r,y,f}}^{2}} \\right) Î»ObsFshIdxr,y,f\\lambda_{\\text{ObsFshIdx}_{r,y,f}} controls weight fishery indices objective function, ObsFshIdxr,y,f\\text{ObsFshIdx}_{r,y,f} represents observed fishery indices, ÏƒObsFshIdxr,y,f2\\sigma_{\\text{ObsFshIdx}_{r,y,f}}^{2} denotes variance fishery index. Likewise, survey indices can fit assuming lognormal likelihood given : L(log(ObsSrvIdxr,y,sf))=\\begin{matrix} L\\left( \\log\\left( \\text{ObsSrvIdx}_{r,y,sf} \\right) \\right) = \\\\ \\end{matrix} Î»ObsSrvIdxr,y,sfâ‹…12Ï€ÏƒObsSrvIdxr,y,sf2exp(âˆ’[log(ObsSrvIdxr,y,sf)âˆ’log(SrvIdxr,y,sf)]22ÏƒObsSrvIdxr,y,sf2)\\lambda_{\\text{ObsSrvIdx}_{r,y,sf}} \\cdot \\frac{1}{\\sqrt{2\\pi\\sigma_{\\text{ObsSrvIdx}_{r,y,sf}}^{2}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\log\\left( \\text{ObsSrvIdx}_{r,y,sf} \\right) - log\\left( \\text{SrvIdx}_{r,y,sf} \\right) \\right\\rbrack^{2}}{2\\sigma_{\\text{ObsSrvIdx}_{r,y,sf}}^{2}} \\right) Î»ObsSrvIdxr,y,sf\\lambda_{\\text{ObsSrvIdx}_{r,y,sf}} likelihood weight applied survey indices, ObsSrvIdxr,y,sf\\text{ObsSrvIdx}_{r,y,sf} observed survey indices, ÏƒObsSrvIdxr,y,sf2\\sigma_{\\text{ObsSrvIdx}_{r,y,sf}}^{2} indicates variance survey index.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-compositions","dir":"Articles","previous_headings":"Likelihoods > Observation Likelihoods","what":"Fishery and Survey Compositions","title":"Description of Model Equations","text":"Several options fitting composition data available SPoRC. include multinomial, Dirichlet-multinomial, logistic-normal likelihoods. case multinomial likelihood, following expression used: L(ObsCompositionDatar,y,j)=Î»ObsCompositionDatar,y,jâ‹…ISSr,y,jâ‹…âˆb=1nbEr,y,b,jOr,y,b,j{\\begin{matrix} L\\left( \\text{ObsCompositionData}_{r,y,j} \\right) = \\\\ \\end{matrix} }{\\lambda_{\\text{ObsCompositionData}_{r,y,j}} \\cdot \\text{ISS}_{r,y,j} \\cdot \\prod_{b = 1}^{n_{b}}E_{r,y,b,j}^{O_{r,y,b,j}}} subscript jj used indicate fishery survey fleet bb subscript generically indicates bin number. Î»ObsCompositionDatar,y,j\\lambda_{\\text{ObsCompositionData}_{r,y,j}} likelihood weights applied composition data (can derived using iterative weighting methods), ISSr,y,jISS_{r,y,j} input sample size, Er,y,b,jE_{r,y,b,j} denotes expected composition proportions, ,y,b,jO_{r,y,b,j} observed composition proportions. Dirichlet-multinomial likelihood assumed, following parameterization (linear) used: L(ObsCompositionDatar,y,j)=Î»ObsCompositionDatar,y,jâ‹…Î“(ISSr,y,j+1)ISSr,y,jâ‹…,y,b,j+1â‹…Î“(ISSr,y,jÎ¸r,j)Î“(ISSr,y,j+ISSr,y,jÎ¸r,j)â‹…âˆb=1nbÎ“(ISSr,y,jOr,y,b,j+ISSr,y,jÎ¸r,jEr,y,b,j)ISSr,y,jÎ¸r,jEr,y,b,j\\begin{matrix} L\\left( \\text{ObsCompositionData}_{r,y,j} \\right) = \\\\ \\lambda_{\\text{ObsCompositionData}_{r,y,j}} \\cdot \\frac{\\Gamma\\left( \\text{ISS}_{r,y,j} + 1 \\right)}{\\text{ISS}_{r,y,j} \\cdot O_{r,y,b,j} + 1} \\cdot \\frac{\\Gamma\\left( \\text{ISS}_{r,y,j}\\theta_{r,j} \\right)}{\\text{Î“(}\\text{ISS}_{r,y,j}\\text{+}\\text{ISS}_{r,y,j}\\theta_{r,j}\\text{)}} \\cdot \\\\ \\prod_{b = 1}^{n_{b}}\\frac{\\Gamma(\\text{ISS}_{r,y,j}O_{r,y,b,j} + \\text{ISS}_{r,y,j}\\theta_{r,j}E_{r,y,b,j})}{\\text{ISS}_{r,y,j}\\theta_{r,j}E_{r,y,b,j}} \\\\ \\end{matrix} , Î¸r,j\\theta_{r,j} overdispersion parameter Dirichlet-multinomial adjusts input sample size. effective sample size (ESSr,y,j)\\text{ESS}_{r,y,j}) can derived : ESSr,y,j=11+Î¸r,j+ISSr,y,jÎ¸r,j1+Î¸r,j\\begin{matrix} \\text{ESS}_{r,y,j} = \\frac{1}{1 + \\theta_{r,j}\\ } + \\text{ISS}_{r,y,j}\\frac{\\theta_{r,j}}{1 + \\theta_{r,j}\\ } \\\\ \\end{matrix} Therefore, Î¸r,j\\theta_{r,j} large Î¸r,jâ‰«ISSr,y,j\\theta_{r,j} \\gg \\text{ISS}_{r,y,j}, ESSr,y,jâ†’ISSr,y,j\\text{ESS}_{r,y,j} \\rightarrow \\text{ISS}_{r,y,j}. contrast, Î¸r,j\\theta_{r,j} estimated small value Î¸r,jâ‰ªISSr,y,j\\theta_{r,j} \\ll \\text{ISS}_{r,y,j}, Î¸r,j\\theta_{r,j} approximates ratio ESSr,y,j\\text{ESS}_{r,y,j} ISSr,y,j\\text{ISS}_{r,y,j} (Thorson et al., 2017). multivariate logistic-normal likelihood can also assumed, given : L(ObsCompositionDatar,y,j)=1(2Ï€)Bâˆ’12|ğšº|12exp(âˆ’12{ğr,y,jâ€²âˆ’ğ„r,y,jâ€²}Tğšºâˆ’1{ğr,y,jâ€²âˆ’ğ„r,y,jâ€²}){\\begin{matrix} L\\left( \\text{ObsCompositionData}_{r,y,j} \\right) = \\\\ \\end{matrix} }{\\frac{1}{(2\\pi)^{\\frac{B - 1}{2}}\\left| \\mathbf{\\Sigma} \\right|^{\\frac{1}{2}}}\\exp\\left( - \\frac{1}{2}\\left\\{ \\mathbf{O}_{r,y,j}^{\\mathbf{'}} - \\mathbf{E}_{r,y,j}^{\\mathbf{'}} \\right\\}^{T}\\mathbf{\\Sigma}^{- 1}\\left\\{ \\mathbf{O}_{r,y,j}^{\\mathbf{'}} - \\mathbf{E}_{r,y,j}^{\\mathbf{'}} \\right\\} \\right)} ğr,y,jâ€²\\mathbf{O}_{r,y,j}^{\\mathbf{'}} ğ„r,y,jâ€²\\mathbf{E}_{r,y,j}^{\\mathbf{'}} (Bâˆ’1)(B - 1) dimensional vectors, ğšº\\mathbf{\\Sigma} (Bâˆ’1)Ã—(Bâˆ’1)(B - 1) \\times (B - 1) covariance matrix (see details). ğr,y,jâ€²\\mathbf{O}_{r,y,j}^{\\mathbf{'}} ğ„r,y,jâ€²\\mathbf{E}_{r,y,j}^{\\mathbf{'}} derived via additive logistic function: ,y,b,jâ€²=log(,y,âˆ’B,j)âˆ’log(,y,B,j)Er,y,b,jâ€²=log(Er,y,âˆ’B,j)âˆ’log(Er,y,B,j)\\begin{matrix} O_{r,y,b,j}^{'} = \\log\\left( O_{r,y, - B,j} \\right) - log(O_{r,y,B,j}) \\\\ E_{r,y,b,j}^{'} = \\log\\left( E_{r,y, - B,j} \\right) - log(E_{r,y,B,j}) \\\\ \\end{matrix} ,y,b,jâ€²O_{r,y,b,j}^{'} Er,y,b,jâ€²E_{r,y,b,j}^{'} transformed proportions using last bin BB reference category. logarithm zero undefined, untransformed proportions must strictly positive. observed proportion zero, observed corresponding expected values removed, remaining proportions renormalized ensure sum one applying transformation. covariance matrix logistic-normal likelihood can specified various ways. simplest case, covariance matrix can assumed independent identically distributed (iid): ğšº=(ğˆBâ‹…Î¸2)âˆ’B\\begin{matrix} \\mathbf{\\Sigma =}\\left( \\mathbf{}_{B} \\cdot \\theta^{2} \\right)_{\\mathbf{-}B} \\\\ \\end{matrix} ğˆB\\mathbf{}_{B} BÃ—BB \\times B identity matrix Î¸2\\theta^{2} estimated overdispersion parameter representing variance. simple iid case can extended incorporate one-dimensional lag-1 autoregressive structure: ğšº=(ğ‘Bâ‹…Î¸2)âˆ’B(ğ‘B),j=ÏB|âˆ’j|,,j=1,â‹¯,B\\begin{matrix} \\mathbf{\\Sigma =}\\left( \\mathbf{R}_{B} \\cdot \\theta^{2} \\right)_{- B} \\\\ \\left( \\mathbf{R}_{B} \\right)_{,j}\\mathbf{=}\\rho_{B}^{|- j|},\\ \\ ,j = \\ 1,\\ \\cdots,\\ B \\\\ \\end{matrix} , ğ‘B\\mathbf{R}_{B} BÃ—BB \\times B correlation matrix lag-1 autoregressive structure, ÏB|âˆ’j|\\rho_{B}^{|- j|} defines correlation across bins. Lastly, model specified sex-structured sex-composition data utilized, two-dimensional autoregressive structure can specified: ğšº=(ğ‘Sâ¨‚ğ‘Câ‹…Î¸2)âˆ’B\\begin{matrix} \\mathbf{\\Sigma =}\\left( {\\mathbf{R}_{S}\\mathbf{\\ \\bigotimes\\ R}}_{C} \\cdot \\theta^{2} \\right)_{- B} \\\\ \\end{matrix} (ğ‘C),j=ÏC|âˆ’j|,,j=1,â‹¯,C\\left( \\mathbf{R}_{C} \\right)_{,j}\\mathbf{=}\\rho_{C}^{|- j|},\\ \\ ,j = \\ 1,\\ \\cdots,\\ C (ğ‘S),j={1,ifi=jÏs,ifiâ‰ j,,j=1,â€¦,ns\\left( \\mathbf{R}_{S} \\right)_{,j}\\mathbf{=}\\left\\{ \\begin{matrix} 1,\\ \\ = j \\\\ \\rho_{s},\\ \\ \\neq j \\\\ \\end{matrix} \\right.\\ ,\\ \\ ,j = 1,\\ldots,n_{s} ğ‘S\\mathbf{R}_{S} constant correlation matrix dimensioned nsÃ—nsn_{s} \\times n_{s}sexes, -diagonal elements Ïs\\rho_{s} controlling correlation age/length categories across sexes, ğ‘C\\mathbf{R}_{C} ncÃ—ncn_{c} \\times n_{c} lag-1 autoregressive correlation structure, ÏC|âˆ’j|\\rho_{C}^{|- j|} defines correlation across age/length categories. â¨‚\\mathbf{\\bigotimes} denotes Kronecker product. structure implies similar age size categories across sexes correlated, ensuring different age size categories remain uncorrelated.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"structuring-compositions-and-ageing-error","dir":"Articles","previous_headings":"Likelihoods > Observation Likelihoods > Fishery and Survey Compositions","what":"Structuring Compositions and Ageing Error","title":"Description of Model Equations","text":"Related use composition data likelihoods, composition data can structured differently depending model assumptions data constraints. particular, three options available fit composition data: â€˜Aggregatedâ€™ compositions across regions sexes, â€˜Splitâ€™ compositions region sex (.e., implicit information sex-ratios), â€˜Jointâ€™ compositions across sexes (.e., implicit information provided sex-ratios). expected compositions (.e., catch--age, catch--length, survey catch--age, survey catch--length) specified â€˜aggregatedâ€™ derived following: Ey,bâ€²=âˆ‘r=1nrâˆ‘s=1nsEr,y,b,sâ€²nsâ‹…nrğ„y=ğ„yâ€²ğš¯y{\\begin{matrix} E_{y,b}^{'} = \\frac{\\sum_{r = 1}^{n_{r}}{\\sum_{s = 1}^{n_{s}}E_{r,y,b,s}^{'}}}{n_{s} \\cdot n_{r}} \\\\ \\end{matrix} }{\\mathbf{E}_{y} = \\mathbf{E}_{y}^{\\mathbf{'}}\\mathbf{\\Theta}_{y}} compositions summed across regions sexes normalized sum one. Ageing error (ğš¯y\\mathbf{\\Theta}_{y}) can applied using standard matrix multiplication. Expected compositions specified â€˜Splitâ€™ sexes regions computed : Ey,b,sâ€²=Er,y,b,sâ€²âˆ‘b=1nBEr,y,b,sâ€²\\begin{matrix} E_{y,b,s}^{'} = \\frac{E_{r,y,b,s}^{'}}{\\sum_{b = 1}^{n_{B}}E_{r,y,b,s}^{'}} \\\\ \\end{matrix} ğ„y,s=ğ„y,sâ€²ğš¯y\\mathbf{E}_{y,s} = \\mathbf{E}_{y,s}^{\\mathbf{'}}\\mathbf{\\Theta}_{y} , expected compositions sum one within given region sex combination ageing error similarly applied via matrix multiplication. case expected compositions specified â€˜Jointâ€™, calculated : Ey,b,sâ€²=Er,y,b,sâ€²âˆ‘s=1nsâˆ‘b=1nBEr,y,b,sâ€²\\begin{matrix} E_{y,b,s}^{'} = \\frac{E_{r,y,b,s}^{'}}{\\sum_{s = 1}^{n_{s}}{\\sum_{b = 1}^{n_{B}}E_{r,y,b,s}^{'}}} \\\\ \\end{matrix} ğ„y=(ğ„y)T(ğˆsâ¨‚ğš¯y)\\mathbf{E}_{y} = \\left( \\mathbf{E}_{y} \\right)^{T}(\\mathbf{}_{s}\\mathbf{\\ \\bigotimes\\ \\Theta}_{y}) expected compositions sum one jointly across bins sexes, thus preserving implicit sex-ratio information. Ageing error applied taking Kronecker product nsxnsn_{s}\\ x\\ n_{s} identity matrix ageing error matrix, followed matrix multiplication.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"tagging","dir":"Articles","previous_headings":"Likelihoods > Observation Likelihoods","what":"Tagging","title":"Description of Model Equations","text":"SPoRC currently allows various tagging likelihoods, ranging Poisson, Negative Binomial, multinomial, Dirichlet-multinomial likelihood. Additionally, SPoRC also allows release- recapture-conditioned dynamics (McGarvey Feenstra, 2002). Poisson tag likelihood given : L(ObsRecapr,y,,sk)=Î»Taggingexp(âˆ’Recapr,y,,sk)(Recapr,y,,sk)ObsRecapr,y,,skObsRecapr,y,,sk!\\begin{matrix} L\\left( {ObsRecap}_{r,y,,s}^{k} \\right) = \\lambda_{\\text{Tagging}}\\frac{\\exp\\left( - {Recap}_{r,y,,s}^{k} \\right)\\left( {Recap}_{r,y,,s}^{k} \\right)^{{ObsRecap}_{r,y,,s}^{k}}}{{ObsRecap}_{r,y,,s}^{k}!} \\\\ \\end{matrix} ObsRecapr,y,,sk{ObsRecap}_{r,y,,s}^{k} observed tag recaptures Î»Tagging\\lambda_{\\text{Tagging}} likelihood weight applied tagging data. case Negative Binomial invoked, following expression used: L(ObsRecapr,y,,sk)=Î»TaggingÎ“(ObsRecapr,y,,sk+Î·)Î“(Î·)Î“(ObsRecapr,y,,sk+1)(Î·Recapr,y,,sk+Î·)Î·(Recapr,y,,skRecapr,y,,sk+Î·)ObsRecapr,y,,sk\\begin{matrix} L\\left( {ObsRecap}_{r,y,,s}^{k} \\right) = \\\\ \\lambda_{\\text{Tagging}}\\frac{\\Gamma\\left( {ObsRecap}_{r,y,,s}^{k} + \\eta \\right)}{\\Gamma(\\eta)\\Gamma\\left( {ObsRecap}_{r,y,,s}^{k} + 1 \\right)}\\left( \\frac{\\eta}{{Recap}_{r,y,,s}^{k} + \\eta} \\right)^{\\eta}\\left( \\frac{{Recap}_{r,y,,s}^{k}}{{Recap}_{r,y,,s}^{k} + \\eta} \\right)^{{ObsRecap}_{r,y,,s}^{k}} \\\\ \\end{matrix} , Î·\\eta represents estimated overdispersion parameter tagging data. release conditioned dynamics, recaptured non-recaptured states fit . Proportions observed (PObsRecapr,y,,sk{PObsRecap}_{r,y,,s}^{k}) expected recaptured (PRecapr,y,,sk){PRecap}_{r,y,,s}^{k})individuals given : PObsRecapr,y,,sk=ObsRecapr,y,,skInitTagk\\begin{matrix} {PObsRecap}_{r,y,,s}^{k} = \\frac{{ObsRecap}_{r,y,,s}^{k}}{{InitTag}^{k}} \\\\ \\end{matrix} PRecapr,y,,sk=Recapr,y,,skInitTagk{PRecap}_{r,y,,s}^{k} = \\frac{{Recap}_{r,y,,s}^{k}}{{InitTag}^{k}} InitTagk{InitTag}^{k} denotes total tags released given tag cohort (combination release region year). Non-recaptured states can written : PObsNonRecapr,y,,sk=1âˆ’âˆ‘râˆ‘yâˆ‘âˆ‘sPObsRecapr,y,,sk\\begin{matrix} {PObsNonRecap}_{r,y,,s}^{k} = 1 - \\sum_{r}^{}{\\sum_{y}^{}{\\sum_{}^{}{\\sum_{s}^{}{PObsRecap}_{r,y,,s}^{k}}}} \\\\ \\end{matrix} PNonRecapr,y,,sk=1âˆ’âˆ‘râˆ‘yâˆ‘âˆ‘sPRecapr,y,,sk{PNonRecap}_{r,y,,s}^{k} = 1 - \\sum_{r}^{}{\\sum_{y}^{}{\\sum_{}^{}{\\sum_{s}^{}{PRecap}_{r,y,,s}^{k}}}} PObsNonRecapr,y,,sk{PObsNonRecap}_{r,y,,s}^{k} PNonRecapr,y,,sk{PNonRecap}_{r,y,,s}^{k} observed expected non-recaptured states, respectively. states combined single vector observed expected values: ğTaggingk={ğğğ›ğ¬ğ‘ğğœğšğ©k,PObsNonRecapk}\\begin{matrix} \\mathbf{O}_{Tagging}^{k} = \\left\\{ \\mathbf{PObsReca}\\mathbf{p}^{k},{PObsNonRecap}^{k} \\right\\} \\\\ \\end{matrix} ğ„Taggingk={ğğ‘ğğœğšğ©k,PNonRecapk}\\mathbf{E}_{Tagging}^{k} = \\{\\mathbf{PReca}\\mathbf{p}^{k},{PNonRecap}^{k}\\} Multinomial likelihood assumed release conditioned dynamics, given : L(ObsRecapk)=Î»TaggingInitTagkâˆ(Ei,Taggingk)Oi,Taggingk\\begin{matrix} L\\left( {ObsRecap}^{k} \\right) = {\\lambda_{\\text{Tagging}}InitTag}^{k}\\prod_{}^{}\\left( E_{,Tagging}^{k} \\right)^{O_{,Tagging}^{k}} \\\\ \\end{matrix} , subscript ii used generically denote given element. Dirichlet-multinomial released-condition dynamics assumed, tagging likelihood written : L(ObsRecapk)=Î»Taggingâ‹…Î“(InitTagk+1)InitTagkâ‹…Oi,Taggingk+1â‹…Î“(InitTagkÎ·)Î“(InitTagk+InitTagkÎ·)â‹…âˆiÎ“(InitTagkâ‹…Oi,Taggingk+InitTagkâ‹…Î·â‹…Ei,Taggingk)InitTagkâ‹…Î·â‹…Ei,Taggingk\\begin{matrix} L\\left( {ObsRecap}^{k} \\right) = \\\\ \\lambda_{\\text{Tagging}} \\cdot \\frac{\\Gamma\\left( {InitTag}^{k}\\  + 1 \\right)}{{InitTag}^{k}\\  \\cdot O_{,Tagging}^{k} + 1} \\cdot \\frac{\\Gamma\\left( {InitTag}^{k}\\ \\eta \\right)}{\\text{Î“(}{InitTag}^{k}\\text{+}{InitTag}^{k}\\eta\\text{)}} \\cdot \\\\ \\prod_{}^{}\\frac{\\Gamma({InitTag}^{k} \\cdot O_{,Tagging}^{k} + {InitTag}^{k} \\cdot \\eta \\cdot E_{,Tagging}^{k})}{{InitTag}^{k} \\cdot \\eta \\cdot E_{,Tagging}^{k}} \\\\ \\end{matrix} Î·\\eta parameter Dirichlet-multinomial likelihood represents overdispersion parameter tagging data, recapture-conditioned dynamics, tag shedding, tag induced mortality, tag reporting rates assumed spatially-invariant need estimated, given terms cancel denominator (McGarvey Feenstra, 2002). Unlike release-conditioned dynamics, assuming recaptured-conditioned processes require fitting non-recaptured states. Thus, observed expected recaptured proportions can written : PObsRecapr,y,,sk=ObsRecapr,y,,skâˆ‘râˆ‘âˆ‘sObsRecapr,y,,skPRecapr,y,,sk=Recapr,y,,skâˆ‘râˆ‘âˆ‘sRecapr,y,,skTotRecapykâˆ‘râˆ‘âˆ‘sObsRecapr,y,,sk{\\begin{matrix} {PObsRecap}_{r,y,,s}^{k} = \\frac{{ObsRecap}_{r,y,,s}^{k}}{\\sum_{r}^{}{\\sum_{}^{}{\\sum_{s}^{}{ObsRecap}_{r,y,,s}^{k}}}} \\\\ \\end{matrix} }{{PRecap}_{r,y,,s}^{k} = \\frac{{Recap}_{r,y,,s}^{k}}{\\sum_{r}^{}{\\sum_{}^{}{\\sum_{s}^{}{Recap}_{r,y,,s}^{k}}}} }{{TotRecap}_{y}^{k}\\sum_{r}^{}{\\sum_{}^{}{\\sum_{s}^{}{ObsRecap}_{r,y,,s}^{k}}}} recapture probabilities normalized total number recaptures given year (TotRecapyk{TotRecap}_{y}^{k}).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"parameter-priors","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties","what":"Parameter Priors","title":"Description of Model Equations","text":"Considering complexity integrated population models, several priors can specified help inform estimation parameters providing additional knowledge. Beyond , priors can also specified aid model stabilization (.e., regularizing priors). Priors can currently specified natural mortality, fishery survey catchability, fishery survey selectivity, steepness, recruitment proportions, movement rates, tag reporting rates.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"natural-mortality","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Natural Mortality","title":"Description of Model Equations","text":"case natural mortality, lognormal prior utilized: P(log(NatMortr,y,,s))=12Ï€Ïƒr,y,,s2(Natmort)exp(âˆ’[log(NatMortr,y,,s)âˆ’log(Î¼r,y,,s(NatMort))]22ÏƒNatMort2Ïƒr,y,,s2(Natmort))\\begin{matrix} P\\left( \\log\\left( \\text{NatMort}_{r,y,,s} \\right) \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{r,y,,s}^{2\\ (Natmort)}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\log\\left( \\text{NatMort}_{r,y,,s} \\right) - log\\left( \\mu_{r,y,,s}^{\\text{(NatMort)}} \\right) \\right\\rbrack^{2}}{2\\sigma_{\\text{NatMort}}^{2}\\sigma_{r,y,,s}^{2\\ (Natmort)}} \\right) \\\\ \\end{matrix} variance prior given Ïƒr,y,,s2(Natmort)\\sigma_{r,y,,s}^{2\\ (Natmort)}, Î¼r,y,,s(NatMort)\\mu_{r,y,,s}^{\\text{(NatMort)}} denotes prior mean.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-catchability","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Fishery and Survey Catchability","title":"Description of Model Equations","text":"fishery survey catchability, lognormal prior can also specified: P(log(qr,y,j))=12Ï€Ïƒr,y,j2(qPrior)exp(âˆ’[log(qr,y,j)âˆ’log(Î¼r,y,j(qPrior))]22ÏƒNatMort2Ïƒr,y,j2(qPrior))\\begin{matrix} P\\left( \\log\\text{(}q_{r,y,j}\\text{)} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{r,y,j}^{2\\ (qPrior)}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\log\\left( q_{r,y,j} \\right) - log\\left( \\mu_{r,y,j}^{\\text{(qPrior)}} \\right) \\right\\rbrack^{2}}{2\\sigma_{\\text{NatMort}}^{2}\\sigma_{r,y,j}^{2\\ (qPrior)}} \\right) \\\\ \\end{matrix} jj represents either fishery survey fleet, Ïƒr,y,j2(qPrior)\\sigma_{r,y,j}^{2\\ (qPrior)} variance prior, Î¼r,y,j(qPrior)\\mu_{r,y,j}^{\\text{(qPrior)}} indicates prior mean catchability.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-selectivity-1","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Fishery and Survey Selectivity","title":"Description of Model Equations","text":"general, selectivity priors can utilized serve regularizing priors facilitate stable parameter estimation (Monnahan, 2024). priors assumed lognormal applied selectivity parameters : P(log(Î¸r,p,y,s,j))=12Ï€Ïƒ2r,p,y,s,j(Sel)exp(âˆ’[ln(Î¸r,p,y,s,j)âˆ’ln(Î¼r,p,y,s,j(Sel))]22Ïƒ2r,p,y,s,j(Sel))\\begin{matrix} P\\left( \\log\\left( \\theta_{r,p,y,s,j} \\right) \\right) = \\frac{1}{\\sqrt{2\\pi{\\sigma^{2}}_{r,p,y,s,j}^{\\text{(Sel)}}}\\,}\\exp\\left( - \\frac{\\left\\lbrack \\ln\\left( \\theta_{r,p,y,s,j} \\right) - ln\\left( \\mu_{r,p,y,s,j}^{\\text{(Sel)}} \\right) \\right\\rbrack^{2}}{2{\\sigma^{2}}_{r,p,y,s,j}^{\\text{(Sel)}}} \\right) \\\\ \\end{matrix} Î¸r,p,y,s,j\\theta_{r,p,y,s,j} selectivity parameter given functional form specified, Ïƒ2r,p,y,s,j(Sel){\\sigma^{2}}_{r,p,y,s,j}^{\\text{(Sel)}} prior variance, Î¼r,p,y,s,j(Sel)\\mu_{r,p,y,s,j}^{\\text{(Sel)}} prior mean specific selectivity parameter.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"steepness","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Steepness","title":"Description of Model Equations","text":"Beverton-Holt stock recruitment relationship assumed, priors steepness can specified. Currently, scaled beta prior (bounded 0.2 1) can invoked: ar(h)=(Î¼r(h)âˆ’0.21âˆ’0.2)(Ïƒr(h)1âˆ’0.2)2br(h)=[1âˆ’(Î¼r(h)âˆ’0.21âˆ’0.2)][(Ïƒr(h)1âˆ’0.2)2]P(hr)=Î“(ar(h))Î“(br(h))Î“(ar(h)r+br(h))hraâˆ’1(1âˆ’hr)bâˆ’1{\\begin{matrix} a_{r}^{(h)} = \\left( \\frac{\\mu_{r}^{\\text{(}\\text{h}\\text{)}} - 0.2}{1 - 0.2} \\right)\\left( \\frac{\\sigma_{r}^{(h)}}{1 - 0.2} \\right)^{2} \\\\ \\end{matrix} }{b_{r}^{(h)} = \\left\\lbrack 1 - \\ \\left( \\frac{\\mu_{r}^{\\text{(}\\text{h}\\text{)}} - 0.2}{1 - 0.2} \\right) \\right\\rbrack\\left\\lbrack \\left( \\frac{\\sigma_{r}^{(h)}}{1 - 0.2} \\right)^{2} \\right\\rbrack }{P\\left( h_{r} \\right) = \\frac{\\Gamma\\left( a_{r}^{(h)} \\right)\\Gamma\\left( b_{r}^{(h)} \\right)}{\\Gamma\\left( {a_{r}^{(h)}}_{r} + b_{r}^{(h)} \\right)}h_{r}^{- 1}\\left( 1 - h_{r} \\right)^{b - 1}} , ar(h)a_{r}^{(h)} br(h)b_{r}^{(h)} parameters beta distribution, Î¼r(h)\\mu_{r}^{\\text{(}\\text{h}\\text{)}} prior mean steepness given region (bounded 0.2 1) Ïƒr(h)\\sigma_{r}^{(h)} standard deviation priors.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"recruitment-proportions","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Recruitment Proportions","title":"Description of Model Equations","text":"Regional recruitment derived apportioning global recruitment parameter using regional recruitment proportions (.e., Î¼Recâ‹…Î¶r\\mu^{\\text{Rec}} \\cdot \\zeta_{r}). , Î¶r\\zeta_{r} derived via multinomial logit transformation Dirichlet priors can used help constrain estimation: P(ğ›‡)=Î“(âˆ‘rnrÎ±r)âˆrnrÎ“(Î±r)âˆr=1nrÎ¶rÎ±râˆ’1\\begin{matrix} P\\left( \\mathbf{\\zeta} \\right) = \\frac{\\Gamma\\left( \\sum_{r}^{n_{r}}\\alpha_{r} \\right)}{\\prod_{r}^{n_{r}}{\\Gamma(\\alpha_{r})}}\\prod_{r = 1}^{n_{r}}\\zeta_{r}^{\\alpha_{r} - 1} \\\\ \\end{matrix} ğ›‡={Î¶1,Î¶2,â€¦,Î¶nr}\\mathbf{\\zeta} = \\{\\zeta_{1},\\zeta_{2},\\ldots,\\zeta_{n_{r}}\\} estimated recruitment proportions across regions, Î±r\\alpha_{r} concentration parameter governing spread Dirichlet distribution.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"movement","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Movement","title":"Description of Model Equations","text":"Likewise, priors movement values can assumed arise Dirichlet process: P(ğŒ.,k,y,,s)=Î“(âˆ‘rnrcr,k,y,,s)âˆrnrÎ“(cr,k,y,,s)âˆr=1nrMr,k,y,,scr,k,y,,sâˆ’1\\begin{matrix} P\\left( \\mathbf{M}_{.,k,y,,s} \\right) = \\frac{\\Gamma\\left( \\sum_{r}^{n_{r}}c_{r,k,y,,s} \\right)}{\\prod_{r}^{n_{r}}{\\Gamma\\left( c_{r,k,y,,s} \\right)}}\\prod_{r = 1}^{n_{r}}M_{r,k,y,,s}^{c_{r,k,y,,s} - 1} \\\\ \\end{matrix} ğŒ.,k,y,,sÏµ{M1,k,y,,s,â€¦,Mnr,k,y,,s}\\mathbf{M}_{.,k,y,,s}\\ \\epsilon\\ \\{ M_{1,k,y,,s,\\ \\ldots,\\ }M_{n_{r,k,y,,s}}\\}, rr origin region, kk destination, cr,k,y,,sc_{r,k,y,,s} concentration parameters control Dirichlet distribution.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"tag-reporting-rates","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Parameter Priors","what":"Tag Reporting Rates","title":"Description of Model Equations","text":"Two types priors can specified tag reporting rates. particular, symmetric beta distribution applied: P(Î²r,y)=(Î²r,y+1eâˆ’4)Ïƒr,y(Î²)(1âˆ’Î²r,y+1eâˆ’4)Ïƒr,y(Î²)\\begin{matrix} P\\left( \\beta_{r,y} \\right) = \\left( \\beta_{r,y} + 1e - 4 \\right)^{\\sigma_{r,y}^{(\\beta)}}\\left( 1 - \\beta_{r,y} + 1e - 4 \\right)^{\\sigma_{r,y}^{(\\beta)}} \\\\ \\end{matrix} , Ïƒr,y(Î²)\\sigma_{r,y}^{(\\beta)} determines scale tag reporting parameter determines strongly penalize estimates approach bounds [0,1]\\lbrack 0,1\\rbrack. Smaller values Ïƒr,y(Î²)\\sigma_{r,y}^{(\\beta)} result larger penalties, vice versa. Thus, estimates tag reporting rates penalized either close 0 1. Tag reporting rate priors can also specified standard beta distribution: ar(Î²)=Î¼r,y(Î²)(Ïƒr,y(Î²))2br(Î²)=[1âˆ’Î¼r,y(Î²)(Ïƒr,y(Î²))2]P(Î²r,y)=Î“(ar(Î²))Î“(br(Î²))Î“(ar(Î²)+br(Î²))Î²r,yaâˆ’1(1âˆ’Î²r,y)bâˆ’1{\\begin{matrix} a_{r}^{(\\beta)} = \\frac{\\mu_{r,y}^{(\\beta)}}{\\left( \\sigma_{r,y}^{(\\beta)} \\right)^{2}} \\\\ \\end{matrix} }{b_{r}^{(\\beta)} = \\left\\lbrack \\frac{1 - \\mu_{r,y}^{(\\beta)}}{\\left( \\sigma_{r,y}^{(\\beta)} \\right)^{2}} \\right\\rbrack }{P\\left( \\beta_{r,y} \\right) = \\frac{\\Gamma\\left( a_{r}^{(\\beta)} \\right)\\Gamma\\left( b_{r}^{(\\beta)} \\right)}{\\Gamma\\left( a_{r}^{(\\beta)} + b_{r}^{(\\beta)} \\right)}\\beta_{r,y}^{- 1}\\left( 1 - \\beta_{r,y} \\right)^{b - 1}} , ar(h)a_{r}^{(h)} br(h)b_{r}^{(h)} parameters describing beta distribution, Î¼r,y(Î²)\\mu_{r,y}^{(\\beta)} denotes prior mean tag reporting rates Ïƒr,y(Î²)\\sigma_{r,y}^{(\\beta)} prior standard deviation.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"process-error-penalties","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties","what":"Process Error Penalties","title":"Description of Model Equations","text":"addition priors, penalties also utilized aid estimation process errors (either penalized likelihood integrating random effects via Laplace Approximation possible). Currently, process errors can specified arise initial age deviations, recruitment, fishing mortality, fishery survey selectivity, movement.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"initial-age-deviations","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Process Error Penalties","what":"Initial Age Deviations","title":"Description of Model Equations","text":"estimate non-equilibrium initial age deviations, multiplicative deviations can specified: L(Ïµr,iInit)=12Ï€ÏƒInit2exp(âˆ’(Ïµr,iInit)22ÏƒInit2)L\\left( \\epsilon_{r,}^{\\text{Init}} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{\\text{Init}}^{2}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,}^{\\text{Init}} \\right)^{2}}{2\\sigma_{\\text{Init}}^{2}} \\right) deviations arise normal distribution mean 0 variance ÏƒInit2\\sigma_{\\text{Init}}^{2}.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"recruitment-deviations","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Process Error Penalties","what":"Recruitment Deviations","title":"Description of Model Equations","text":"Annual recruitment deviations can also specified, multiplicative deviations assumed: L(Ïµr,yRec)=12Ï€ÏƒRec2exp(âˆ’(Ïµr,yRec)22ÏƒRec2)L\\left( \\epsilon_{r,y}^{\\text{Rec}} \\right) = \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\text{Rec}}^{2}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,y}^{\\text{Rec}} \\right)^{2}}{2\\sigma_{\\text{Rec}}^{2}} \\right) deviations assumed normally distributed, mean 0 variance ÏƒRec2\\sigma_{\\text{Rec}}^{2}.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishing-mortality-deviations","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Process Error Penalties","what":"Fishing Mortality Deviations","title":"Description of Model Equations","text":"Fishing mortality deviations similarly assumes multiplicative deviations: L(Ïµr,y,fFsh)=12Ï€Ïƒr,f2Fshexp(âˆ’(Ïµr,y,fFsh)22Ïƒr,f2Fsh)L\\left( \\epsilon_{r,y,f}^{\\text{Fsh}} \\right) = \\frac{1}{\\sqrt{2\\pi{\\sigma_{r,f}^{2}}_{\\text{Fsh}}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,y,f}^{\\text{Fsh}} \\right)^{2}}{2{\\sigma_{r,f}^{2}}_{\\text{Fsh}}} \\right) , fishing mortality deviations assumed arise normal distribution, mean 0 variance Ïƒr,f2Fsh{\\sigma_{r,f}^{2}}_{\\text{Fsh}}.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"fishery-and-survey-selectivity-2","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Process Error Penalties","what":"Fishery and Survey Selectivity","title":"Description of Model Equations","text":"variety process error parameterizations can specified fishery survey selectivity. Across parameterizations, multiplicative deviations assumed. basic case, iid deviations can assumed vary parameter given selectivity functional form: L(Ïµr,y,,s,jSel)=12Ï€Ïƒr,,s,j,Sel2exp(âˆ’(Ïµr,y,,s,jSel)22Ïƒr,,s,j,Sel2)L\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{r,,s,j,Sel}^{2}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}} \\right)^{2}}{2\\sigma_{r,,s,j,Sel}^{2}} \\right) Ïµr,y,,s,jSel\\epsilon_{r,y,,s,j}^{\\text{Sel}} selectivity deviations given parameter region rr, year yy, parameter ii, sex ss, fleet jj. Deviations assumed mean 0 variance Ïƒr,,s,j,Sel2\\sigma_{r,,s,j,Sel}^{2}, constrained normal distribution. Extending iid case, random walk selectivity deviations can also specified given parameter, assuming normal distribution: L(Ïµr,y,,s,jSel)={12Ï€â‹…52exp(âˆ’(Ïµr,y=1,,s,jSel)22â‹…52),ify=1)12Ï€Ïƒr,,s,j,Sel2exp(âˆ’(Ïµr,y,,s,jSelâˆ’Ïµr,yâˆ’1,,s,jSel)22Ïƒr,,s,j,Sel2),ify>1)L\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}} \\right) = \\left\\{ \\begin{matrix} \\frac{1}{\\sqrt{2\\pi \\cdot 5^{2}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,y = 1,,s,j}^{\\text{Sel}} \\right)^{2}}{2{\\cdot 5}^{2}} \\right),\\ y = 1) \\\\ \\frac{1}{\\sqrt{2\\pi\\sigma_{r,,s,j,Sel}^{2}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}} - \\epsilon_{r,y - 1,,s,j}^{\\text{Sel}} \\right)^{2}}{2\\sigma_{r,,s,j,Sel}^{2}} \\right),y > 1) \\\\ \\end{matrix} \\right.\\ process error deviations first year initialized large variance. Following first year, process error deviations follow random walk process mean conditional previous yearâ€™s value (Ïµr,yâˆ’1,,s,jSel\\epsilon_{r,y - 1,,s,j}^{\\text{Sel}}) variance Ïƒr,,s,j,Sel2\\sigma_{r,,s,j,Sel}^{2}. addition constrained normal distribution, iid random walk cases optional additional smoothness penalty applied: PSelYrSmooth=âˆ‘r=1nrâˆ‘j=1njâˆ‘s=1nsâˆ‘y=2nyâˆ‘=1ni(Ïµr,y,,s,jSelâˆ’Ïµr,yâˆ’1,,s,jSel)2P_{SelYrSmooth} = \\sum_{r = 1}^{n_{r}}{\\sum_{j = 1}^{n_{j}}{\\sum_{s = 1}^{n_{s}}{\\sum_{y = 2}^{n_{y}}{\\sum_{= 1}^{n_{}}\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}}- \\epsilon_{r,y - 1,,s,j}^{\\text{Sel}} \\right)^{2}}}}} serves ensure selectivity values vary drastically year--year. Additionally, semi-parametric deviations can also specified. total, three options can utilized, two allow age, year, cohort correlations, one allows age length year correlations. case age, year, cohort correlations specified (note possible age-based selectivity specified), marginal stationary variance conditional non-stationary variance can invoked. primary difference two marginal variance version closed form solution ğ›€\\mathbf{\\Omega} (see equations ) needs iteratively solved, conditional variance version closed form solution. following equations describe conditional variance version: ğ›œr,s,jSel=vec(Ïµr,y,,s,jSel)\\mathbf{\\epsilon}_{r,s,j}^{\\text{Sel}}\\mathbf{=}vec\\left( \\epsilon_{r,y,,s,j}^{\\text{Sel}} \\right) vectorize selectivity deviations across year age dimensions. deviations assumed arise multivariate normal distribution (Gaussian Markov Random Field) covariance matrix (ğšº=ğâˆ’1\\mathbf{\\Sigma} = \\mathbf{Q}^{- 1}) determined : Q=(âˆ’(B)T)ğ›€(âˆ’B)diag(ğ›€)=Ïƒr,s,j,Selâˆ’2\\begin{matrix} \\text{Q} = \\left( \\text{} - \\left( \\text{B} \\right)^{T} \\right)\\mathbf{\\Omega}\\left( \\text{} - \\text{B} \\right) \\\\ \\text{diag}\\left( \\mathbf{\\Omega} \\right) = \\sigma_{r,s,j,Sel}^{- 2} \\\\ \\end{matrix} , \\text{} identity matrix ğ›€\\mathbf{\\Omega} diagonal matrix determines variance multivariate normal process. B\\text{B} square matrix representing partial effect ğ›œr,s,jSel\\mathbf{\\epsilon}_{r,s,j}^{\\text{Sel}} preceding ages /years, governed partial correlation coefficients ages, years, cohorts. demonstrate formulation B\\text{B}, simplified example provided rows representing ages aÏµ{1,2}\\ \\epsilon\\ \\{ 1,2\\} columns representing years yÏµ{1,2}y\\ \\epsilon\\ \\{ 1,2\\}. example, B\\text{B} 4x44\\ x\\ 4 matrix, rows columns represent combinations age year. instance, B1,2B_{1,2} captures correlation within year age 1 year 1, age 2 year 1, whereas B4,1B_{4,1} constructs correlation within cohort age 1 year 1, age 2 year 2: ğ=[1000Ïy000Ïa000ÏcÏaÏy0]\\begin{matrix} \\mathbf{B} = \\begin{bmatrix} 1 & 0 & 0 & 0 \\\\ \\rho_{y} & 0 & 0 & 0 \\\\ \\rho_{} & 0 & 0 & 0 \\\\ \\rho_{c} & \\rho_{} & \\rho_{y} & 0 \\\\ \\end{bmatrix} \\\\ \\end{matrix} Ïy\\rho_{y}, Ïa\\rho_{}, Ïc\\rho_{c} parameters describing partial autocorrelation among years within given age, among ages within given year, years within cohort, respectively. multivariate likelihood defined : L(ğ›œr,s,jSel)=|ğ|1/2(2Ï€)n2exp(âˆ’12(ğ›œr,s,jSel)Tğ(ğ›œr,s,jSel))L\\left( \\mathbf{\\epsilon}_{r,s,j}^{\\text{Sel}} \\right) = \\frac{\\left| \\mathbf{Q} \\right|^{1/2}}{(2\\pi)^{\\frac{n}{2}}}\\exp\\left( - \\frac{1}{2}\\left( \\mathbf{\\epsilon}_{r,s,j}^{\\text{Sel}} \\right)^{T}\\mathbf{Q}\\left( \\mathbf{\\epsilon}_{r,s,j}^{\\text{Sel}} \\right) \\right) age length year correlations specified (.e., two-dimensional autoregressive structure), multivariate normal likelihood similarly assumed (.e., equation described ), covariance structured process defined : Qâˆ’1=Ïƒr,s,j,Sel2(1âˆ’Ïy)2(1âˆ’Ïb)2RyâŠ—Rb\\text{Q}^{- 1} = \\frac{\\sigma_{r,s,j,Sel}^{2}}{\\left( 1 - \\rho_{y} \\right)^{2}\\left( 1 - \\rho_{b} \\right)^{2}}\\text{R}_{y} \\otimes \\text{R}_{b} Ïy\\rho_{y} Ïb\\rho_{b} correlation coefficients across years bins, respectively. Ry\\text{R}_{y} nyÃ—nyn_{y} \\times n_{y} matrix representing first-order autoregressive process across years Rb\\text{R}_{b} nbÃ—nbn_{b} \\times n_{b} matrix representing first-order autoregressive process across bins. Moreover, semi-parametric deviations specified, additional optional penalties can applied across bins years enforce curvature control: PSelBinCurve=âˆ‘r=1nrâˆ‘j=1njâˆ‘s=1nsâˆ‘y=1nyâˆ‘b=2nbâˆ’1(log(Selr,y,b+1,s,j)âˆ’2log(Selr,y,b,s,j)log(Selr,y,bâˆ’1,s,j))2P_{SelBinCurve} = \\sum_{r = 1}^{n_{r}}{\\sum_{j = 1}^{n_{j}}{\\sum_{s = 1}^{n_{s}}{\\sum_{y = 1}^{n_{y}}{\\sum_{b = 2}^{n_{b} - 1}\\left( \\log\\left( {Sel}_{r,y,b + 1,s,j} \\right) - 2\\log\\left( {Sel}_{r,y,b,s,j} \\right)\\log\\left( {Sel}_{r,y,b - 1,s,j} \\right) \\right)^{2}}}}} PSelYrCurve=âˆ‘r=1nrâˆ‘j=1njâˆ‘s=1nsâˆ‘y=2nyâˆ’1âˆ‘b=1nb(log(Selr,y+1,b,s,j)âˆ’2log(Selr,y,b,s,j)log(Selr,yâˆ’1,b,s,j))2P_{SelYrCurve} = \\sum_{r = 1}^{n_{r}}{\\sum_{j = 1}^{n_{j}}{\\sum_{s = 1}^{n_{s}}{\\sum_{y = 2}^{n_{y} - 1}{\\sum_{b = 1}^{n_{b}}\\left( \\log\\left( {Sel}_{r,y + 1,b,s,j} \\right) - 2\\log\\left( {Sel}_{r,y,b,s,j} \\right)\\log\\left( {Sel}_{r,y - 1,b,s,j} \\right) \\right)^{2}}}}}","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"movement-1","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties > Process Error Penalties","what":"Movement","title":"Description of Model Equations","text":"Process error deviations can also specified movement parameters. Currently, iid deviations allowed, deviations placed upon fixed-effects movement parameters logit space: Ï‰r,k,y,,s=Ï‰r,k,s+Ïµr,k,y,,sMove\\omega_{r,k,y,,s} = \\omega_{r,k,s} + \\epsilon_{r,k,y,,s}^{\\text{Move}} Ï‰r,k,y,,s\\omega_{r,k,y,,s} movement parameters logit space origin rr, destination kk, year yy, age aa, sex ss, Ï‰r,k,s\\omega_{r,k,s} corresponding fixed effects (mean logits). , Ïµr,k,y,,sMove\\epsilon_{r,k,y,,s}^{\\text{Move}} movement deviations specified logit space. Deviations arise normal distribution process variation constrained Ïƒr,,s,Move2\\sigma_{r,,s,Move}^{2}: L(Ïµr,âˆ’1,y,,sMove)=12Ï€Ïƒr,,s,Move2exp(âˆ’(Ïµr,âˆ’1,y,,sMove)22Ïƒr,,s,Move2)L\\left( \\epsilon_{r, - 1,y,,s}^{\\text{Move}} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{r,,s,Move}^{2}}\\,}\\exp\\left( - \\frac{\\left( \\epsilon_{r, - 1,y,,s}^{\\text{Move}} \\right)^{2}}{2\\sigma_{r,,s,Move}^{2}} \\right) Thus, process variation can distinct given origin region, age, sex. logits parameterized reference category, nrâˆ’1n_{r} - 1 logits (deviations) estimated per origin rr, ensuring sum--one constraint destination probabilities.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"joint-likelihood","dir":"Articles","previous_headings":"Likelihoods > Parameter Priors and Process Error Penalties","what":"Joint Likelihood","title":"Description of Model Equations","text":"Lastly, joint likelihood minimized represents sum observational likelihood components, priors, penalties defined : Joint Likelihood=âˆ‘Observation Likelihoods+âˆ‘Priors+âˆ‘Penalties\\begin{matrix} \\text{Joint Likelihood} = \\sum\\text{Observation\\ Likelihoods} + \\sum\\text{Priors} + \\sum\\text{Penalties} \\\\ \\end{matrix} Note components may zero (.e., priors used) depending configuration model.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/c_model_equations.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Description of Model Equations","text":"Kristensen, K., Nielsen, ., Berg, C.W., Skaug, H., Bell, B., 2016. TMB: Automatic Differentiation Laplace Approximation. J. Stat. Soft. 70. https://doi.org/10.18637/jss.v070.i05 Mace, P.M., Doonan, .J., 1988. Generalised Bioeconomic Simulation Model Fish Population Dynamics. MAFFish, N.Z. Ministry Agriculture Fisheries. McGarvey, R., Feenstra, J.E., 2002. Estimating rates fish movement tag recoveries: conditioning recapture. Can. J. Fish. Aquat. Sci. 59, 1054â€“1064. https://doi.org/10.1139/f02-080 Methot, R.D., Taylor, .G., 2011. Adjusting bias due variability estimated recruitments fishery assessment models. Can. J. Fish. Aquat. Sci. 68, 1744â€“1760. https://doi.org/10.1139/f2011-092 Monnahan, C.C., 2024. Toward good practices Bayesian data-rich fisheries stock assessments using modern statistical workflow. Fisheries Research 275, 107024. https://doi.org/10.1016/j.fishres.2024.107024 Thorson, J.T., Johnson, K.F., Methot, R.D., Taylor, .G., 2017. Model-based estimates effective sample size stock assessment models using Dirichlet-multinomial distribution. Fisheries Research 192, 84â€“93. https://doi.org/10.1016/j.fishres.2016.06.005","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-model-dimensions","dir":"Articles","previous_headings":"","what":"Setup Model Dimensions","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"initially set model , input list containing data list, parameter list, mapping list needs constructed. aided function Setup_Mod_Dim, users specify vector years, ages, lengths. Additionally, users need specify number regions modelled (n_regions), number sexes modelled (n_sexes), number fishery fleets (n_fish_fleets), number survey fleets (n_srv_fleets)","code":"input_list <- Setup_Mod_Dim(years = 1:length(sgl_rg_sable_data$years), # vector of years                              # (corresponds to year 1960 - 2024)                             ages = 1:length(sgl_rg_sable_data$ages), # vector of ages                             lens = seq(41,99,2), # number of lengths                             n_regions = 1, # number of regions                             n_sexes = sgl_rg_sable_data$n_sexes, # number of sexes == 1,                             # female, == 2 male                             n_fish_fleets = sgl_rg_sable_data$n_fish_fleets, # number of fishery                             # fleet == 1, fixed gear, == 2 trawl gear                             n_srv_fleets = sgl_rg_sable_data$n_srv_fleets, # number of survey fleets                             verbose = FALSE                             )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-recruitment-dynamics","dir":"Articles","previous_headings":"","what":"Setup Recruitment Dynamics","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"Following initialization input_list, can pass created object next function (Setup_Mod_Rec) parameterize recruitment dynamics. case Alaska sablefish, recruitment parameterized : Mean Recruitment, stock recruitment relationship assumed, recruitment bias ramp used, following methods Methot Taylor 2011 (do_bias_ramp = 1), Two values sigmaR used, first value represents early period sigmaR, fixed 0.4, second value represents late period sigmaR, freely estimated (although fixed). Recruitment deviations estimated penalized likelihood framework, Recruitment deviations estimated years, except terminal year, Recruitment sex-ratios fixed 0.5 sex (default), Initial age structure derived assuming geometric series (init_age_strc = 1; alternative iterating age structure equilibrium init_age_strc = 0), 10% fraction mean fishing mortality rate assumed initalizing age structure.","code":"input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             # Model options                             do_rec_bias_ramp = 1, # do bias ramp                              # (0 == don't do bias ramp, 1 == do bias ramp)                             # breakpoints for bias ramp                              # (1 == no bias ramp - 1960 - 1980,                              # 2 == ascending limb of bias ramp - 1980 - 1990,                             # 3 == full bias correction - 1990 - 2022, == 4                              # no bias correction - terminal year of                              # recruitment estimate)                             bias_year = c(length(1960:1979),                                           length(1960:1989),                                            (length(1960:2023) - 5),                                            length(1960:2024) - 2) + 1,                             sigmaR_switch = as.integer(length(1960:1975)),                              # when to switch from early to late sigmaR                             dont_est_recdev_last = 1,                              # don't estimate last recruitment deviate                             ln_sigmaR = log(c(0.4, 1.2)),                             rec_model = \"mean_rec\", # recruitment model                             sigmaR_spec = \"fix_early_est_late\",                              # fix early sigmaR, estiamte late sigmaR                             init_age_strc = 1, # how to derive inital age strc                             init_F_prop = 0.1 # fraction of mean F from                              # dominant fleet to apply to initial age strc                             )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-biological-dynamics","dir":"Articles","previous_headings":"","what":"Setup Biological Dynamics","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"Passing input_list updated previous helper function, can parameterize biological dynamics model. Setup_Mod_Biologicals requires data inputs weight--age (WAA) maturity--age (MatAA), dimensioned n_regions, n_years, n_ages, n_sexes. Optional model inputs include single ageing-error matrix AgeingError, dimensioned n_ages, n_ages. can left NULL ageing-error matrix available, model assume identity matrix ageing-error age-composition data. Additionally, size-age transition matrix can supplied length data fit fit_lengths = 1, dimensioned n_regions, n_years, n_lens, n_ages, n_sexes. Although Alaska sablefish assessment utilizes priors natural mortality, possible get exact match 2024 assessment, given differences parameterization natural mortality. Thus, demonstration purposes, M fixed case. M_spec argument specifies natural mortality fixed array fixed values provided Fixed_natmort = fixed_natmort. Starting values fixed parameters can specified using ..., parameter name supplied, values provided parameter name represent starting value.","code":"# Specificying natural mortality fixed array fixed_natmort <- array(0, dim = c(input_list$data$n_regions, length(input_list$data$years), length(input_list$data$ages), input_list$data$n_sexes)) fixed_natmort[,,,1] <- 0.1134156 # fix female M fixed_natmort[,,,2] <- 0.1052175 # fix male M  input_list <- Setup_Mod_Biologicals(input_list = input_list,                                     # Data inputs                                     WAA = rtmb_data$WAA, # weight-at-age                                     MatAA = rtmb_data$MatAA, # maturity at age                                     AgeingError = as.matrix(ageing_dat$age_error), # ageing error                                     SizeAgeTrans = rtmb_data$SizeAgeTrans, # size age transition matrix                                     # Model options                                     Use_M_prior = 0, # use natural mortality prior                                     fit_lengths = 1, # fitting length compositions                                     M_spec = \"fix\",                                     Fixed_natmort = fixed_natmort)"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-movement-and-tagging-dynamics","dir":"Articles","previous_headings":"","what":"Setup Movement and Tagging Dynamics","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"Given Alaska sablefish assessment single region model, movement dynamics specified. However, users still need define movement dynamics parameterized. case, following code chunk specifies movement estimated (use_fixed_movement = 1), movement identity matrix (Fixed_Movement = NA), recruits move (do_recruits_move = 0). Specification tagging dynamics follow similar fashion since single-region model. necessary updating input_list setting UseTagging argument value 0.","code":"input_list <- Setup_Mod_Movement(input_list = input_list,                                  use_fixed_movement = 1, # don't est move                                  Fixed_Movement = NA, # use identity move                                  do_recruits_move = 0 # recruits don't move                                  ) input_list <- Setup_Mod_Tagging(input_list = input_list,                                 UseTagging = 0                                 )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-catch-and-fishing-mortality","dir":"Articles","previous_headings":"","what":"Setup Catch and Fishing Mortality","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"Following parameterization biological dynamics, fishery dynamics can specified set using Setup_Mod_Catch_and_F function. , input_list gets updated previous helper functions. Users need supply function array observed catches ObsCatch, dimensioned n_regions, n_years, n_fish_fleets. Similarly, users also need specify catch type observations Catch_Type argument. argument expects matrix dimensioned n_years n_fish_fleets, really applicable spatial model (values 0 indicate catch aggregated across regions periods fleets, values 1 indicate catch specific region periods fleets). Thus, single region model, values 1 always supplied. function also expects UseCatch argument specified, dimensioned n_regions, n_years, n_fish_fleets. Essentially, users need fill whether catch fit particular partitions. use cases argument scenarios catch observed value 0, helper function automatically turns estimation fishing mortality deviations partitions. Additional model options specified case study include: 1) whether fishing mortality penalties utilized help estimate deviations Use_F_pen = 1, fix standard deviation catches fishing mortality (sigmaC_spec = 'fix', sigmaF_spec = 'fix').","code":"input_list <- Setup_Mod_Catch_and_F(input_list = input_list,                                     # Data inputs                                     ObsCatch = sgl_rg_sable_data$ObsCatch,                                     Catch_Type =                                        array(1, dim = c(length(input_list$data$years),                                                         input_list$data$n_fish_fleets)),                                     UseCatch = sgl_rg_sable_data$UseCatch,                                     # Model options                                     Use_F_pen = 1,                                      # whether to use f penalty, == 0 don't use, == 1 use                                     sigmaC_spec = 'fix',                                     sigmaF_spec = \"fix\",                                      # Fixing sigma C and F                                     ln_sigmaC = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, length(input_list$data$years), input_list$data$n_fish_fleets)),                                     ln_sigmaF = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, input_list$data$n_fish_fleets))                                     )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-index-and-composition-data-fishery-and-survey","dir":"Articles","previous_headings":"","what":"Setup Index and Composition Data (Fishery and Survey)","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"involved helper functions used set single region model Setup_Mod_FishIdx_and_Comps, Setup_Mod_SrvIdx_and_Comps, Setup_Mod_Fishsel_and_Q, Setup_Mod_Srvsel_and_Q functions. helper functions essentially facilitate parameterization selectivity catchability fishery survey, compositional likelihood types, composition data structured, types indices used (biomass vs.Â abundance). fishery survey helper functions described following sections essentially equivalent respect data arguments inputs expected, specified independently fisheries surveys. set fishery indices composition data, users need supply arrays observed fishery indices associated standard errors (ObsFishIdx ObsFishIdx_SE), dimensioned n_regions, n_years, n_fish_fleets. fleets data, can input NA UseFishIdx argument (also dimensioned n_regions, n_years, n_fish_fleets) can used ensure data fit . Similarly, users need supply fishery age composition data length composition data. ObsFishAgeComps ObsFishLenComps dimensioned n_regions, n_years, n_bins (n_ages | n_lens), n_sexes, n_fish_fleets. Data inputs also required denote whether composition data used available thos regions, years, fleets. can specified using UseFishAgeComps UseFishLenComps, expects values 0 (donâ€™t fit) 1 (fit), dimensioned n_regions, n_years, n_fish_fleets. Users can optionally supply ISS_FishAgeComps ISS_FishLenComps data inputs specify input sample size composition data, dimensioned n_regions, n_years, n_sexes, n_fish_fleets. specified (.e., left NULL), helper function automatically sum ObsFishAgeComps ObsFishLenComps partitions use sums input sample size. Thus, observed composition data input proportions, model potentially incorrectly assume input sample size 1 data. Alaska sablefish, fishery indices currently utilized fixed-gear fleet (dominant fleet), biomass based, trawl fleet fit fishery indices. can specified using fish_idx_type argument, biom represents biomass indices, none indicates fishery indices available. Multinomial likelihoods also assumed fishery ages, specified FishAgeComps_LikeType. However, fixed-gear fleet fishery age compositions available. Thus, FishAgeComps_LikeType specified c(\"Multinomial\", \"none\"). Fishery length compositions FishLenComps_LikeType available fleets specified Multinomial. Currently, Alaska sablefish sex-structured model age-compositions sex-specific. specified using FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\", \"none_Year_1-terminal_Fleet_2\"), indicates model data fit aggregated across sexes years fleet 1 (fixed-gear) (.e., Multinomial expected proportions summed across sexes). none_Year_1-terminal_Fleet_2 character indicates anything age compositions trawl fishery, since availiable. fishery length compositions, specified FishLenComps_Type = c(\"spltRspltS_Year_1-terminal_Fleet_1\", \"spltRspltS_Year_1-terminal_Fleet_2\") fleets length composition data sex-specific. , spltRspltS character indicates model data sum 1 sex region, implicit sex-ratios can inferred using composition data model. arguments expected survey indices compositions. , 3 survey fleets specified, abundance based survey fleet 1 3, biomass based survey fleet 2. Age compositions aggregated sex survey fleet 1 3, available survey fleet 2, length compositions split sex survey fleets. compositions survey fleets assume Multinomial likelihood.","code":"input_list <- Setup_Mod_FishIdx_and_Comps(input_list = input_list,                                           # data inputs                                           ObsFishIdx = sgl_rg_sable_data$ObsFishIdx,                                           ObsFishIdx_SE = sgl_rg_sable_data$ObsFishIdx_SE / sgl_rg_sable_data$ObsFishIdx,                                           UseFishIdx =  sgl_rg_sable_data$UseFishIdx,                                           ObsFishAgeComps = sgl_rg_sable_data$ObsFishAgeComps,                                           UseFishAgeComps = sgl_rg_sable_data$UseFishAgeComps,                                           ISS_FishAgeComps = sgl_rg_sable_data$ISS_FishAgeComps,                                           ObsFishLenComps = sgl_rg_sable_data$ObsFishLenComps,                                           UseFishLenComps = sgl_rg_sable_data$UseFishLenComps,                                           ISS_FishLenComps = sgl_rg_sable_data$ISS_FishLenComps,                                            # Model options                                           fish_idx_type =                                              c(\"biom\", \"none\"),                                            # biomass indices for fishery fleet 1 and 2                                           FishAgeComps_LikeType =                                              c(\"Multinomial\", \"none\"),                                            # age comp likelihoods for fishery fleet 1 and 2                                           FishLenComps_LikeType =                                              c(\"Multinomial\", \"Multinomial\"),                                            # length comp likelihoods for fishery fleet 1 and 2                                           FishAgeComps_Type =                                               c(\"agg_Year_1-terminal_Fleet_1\",                                               \"none_Year_1-terminal_Fleet_2\"),                                            # age comp structure for fishery fleet 1 and 2                                           FishLenComps_Type =                                               c(\"spltRspltS_Year_1-terminal_Fleet_1\",                                               \"spltRspltS_Year_1-terminal_Fleet_2\")                                           # length comp structure for fishery fleet 1 and 2                                           ) input_list <- Setup_Mod_SrvIdx_and_Comps(input_list = input_list,                                          # data inputs                                          ObsSrvIdx = sgl_rg_sable_data$ObsSrvIdx,                                          ObsSrvIdx_SE = sgl_rg_sable_data$ObsSrvIdx_SE / sgl_rg_sable_data$ObsSrvIdx,                                          UseSrvIdx =  sgl_rg_sable_data$UseSrvIdx,                                          ObsSrvAgeComps = sgl_rg_sable_data$ObsSrvAgeComps,                                          ISS_SrvAgeComps = sgl_rg_sable_data$ISS_SrvAgeComps,                                          UseSrvAgeComps = sgl_rg_sable_data$UseSrvAgeComps,                                          ObsSrvLenComps = sgl_rg_sable_data$ObsSrvLenComps,                                          UseSrvLenComps = sgl_rg_sable_data$UseSrvLenComps,                                          ISS_SrvLenComps = sgl_rg_sable_data$ISS_SrvLenComps,                                           # Model options                                          srv_idx_type = c(\"abd\", \"biom\", \"abd\"),                                          # abundance and biomass for survey fleet 1, 2, and 3                                          SrvAgeComps_LikeType =                                             c(\"Multinomial\", \"none\", \"Multinomial\"),                                           # survey age composition likelihood for survey fleet                                           # 1, 2, and 3                                          SrvLenComps_LikeType =                                             c(\"Multinomial\", \"Multinomial\", \"Multinomial\"),                                           #  survey length composition likelihood for survey fleet                                           # 1, 2, and 3                                          SrvAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\",                                                               \"none_Year_1-terminal_Fleet_2\",                                                               \"agg_Year_1-terminal_Fleet_3\"),                                           # survey age comp type                                          SrvLenComps_Type = c(\"spltRspltS_Year_1-terminal_Fleet_1\",                                                               \"spltRspltS_Year_1-terminal_Fleet_2\",                                                               \"spltRspltS_Year_1-terminal_Fleet_3\")                                          # survey length comp type )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-selectivity-and-catchability-fishery-and-survey","dir":"Articles","previous_headings":"","what":"Setup Selectivity and Catchability (Fishery and Survey)","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"Specifying fishery/survey selectivity catchability options (function arguments fishery survey) can bit involved well. SPoRC, several selectivity options, include: Whether continuous time-varying selectivity processes (cont_tv_fish_sel cont_tv_srv_sel). sablefish, continuous time-varying selectivity used specified none_Fleet_x, Whether selectivity blocks (fish_sel_blocks srv_sel_blocks). Sablefish assumes 3 time-blocks fixed-gear fleet time-invariant selectivity trawl fishery. general, time-blocks can specified Block_v_Year_x-y_Fleet_z, Block_v represents block number, Year_x-y represents year range (x-y) block number applies , Fleet_z represents fleet time-block . time-blocks specified, can left none_Fleet_z, type parametric selectivity form specify different fleets (fish_sel_model srv_sel_model). Sablefish assumes logist1 fixed-gear fleet (logistic specified a50 k), gamma dome-shaped selectivity trawl fleet, number catchability blocks specified (fish_q_blocks srv_q_blocks). specified identical manner selectivity blocks (point 2), fishery survey selectivity parameters estimated (fish_fixed_sel_pars). case sablefish, first specifying selectivity parameters (time-blocks sexes) estimated. However, nuanced parameter sharing across sexes time-blocks used sablefish help stabilize model (last part code chunk), easily generalized. Thus, users can manually extract map list updated input_list object modify parameters fixed shared, Lastly, fishery survey catchability estimated (fish_q_spec srv_q_spec). fishery, catchability estimated regions (est_all, since single-region model) fixed-gear fleet, specified fix trawl fishery (since indices available). , arguments expected setting survey selectivity, similarly nuanced parameter fixing sharing help facilitate model stability.","code":"input_list <- Setup_Mod_Fishsel_and_Q(input_list = input_list,                                                                              # Model options                                       cont_tv_fish_sel = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       # fishery selectivity, whether continuous time-varying                                        # fishery selectivity blocks                                       fish_sel_blocks =                                          c(\"Block_1_Year_1-35_Fleet_1\",                                            # block 1, fishery ll selex                                           \"Block_2_Year_36-56_Fleet_1\",                                            # block 2 fishery ll selex                                           \"Block_3_Year_57-terminal_Fleet_1\",                                             # block 3 fishery ll selex                                           \"none_Fleet_2\"),                                            # no blocks for trawl fishery                                        # fishery selectivity form                                       fish_sel_model =                                          c(\"logist1_Fleet_1\",                                            \"gamma_Fleet_2\"),                                        # fishery catchability blocks                                       fish_q_blocks =                                          c(\"Block_1_Year_1-35_Fleet_1\",                                            # block 1, fishery ll selex                                           \"Block_2_Year_36-56_Fleet_1\",                                            # block 2 fishery ll selex                                           \"Block_3_Year_57-terminal_Fleet_1\",                                             # block 3 fishery ll selex                                           \"none_Fleet_2\"),                                           # no blocks for trawl fishery                                        # whether to estimate all fixed effects                                        # for fishery selectivity and later modify                                       # to fix and share parameters                                        fish_fixed_sel_pars_spec =                                          c(\"est_all\", \"est_all\"),                                        # whether to estimate all fixed effects                                        # for fishery catchability                                       fish_q_spec =                                          c(\"est_all\", \"fix\")                                        # estimate fishery q for fleet 1, not for fleet 2                                       )  # additional mapping for fishery selectivity # sharing delta across sexes from early domestic fishery (first time block) input_list$map$ln_fish_fixed_sel_pars <- factor(c(1:7, 2, 8:11, rep(12:13,3), rep(c(14,13),3))) input_list <- Setup_Mod_Srvsel_and_Q(input_list = input_list,                                       # Model options                                      # survey selectivity, whether continuous time-varying                                      cont_tv_srv_sel =                                        c(\"none_Fleet_1\",                                           \"none_Fleet_2\",                                           \"none_Fleet_3\"),                                       # survey selectivity blocks                                      srv_sel_blocks =                                         c(\"Block_1_Year_1-56_Fleet_1\",                                           # block 1 for domestic ll survey                                          \"Block_2_Year_57-terminal_Fleet_1\",                                           # block 2 for domestic ll survey                                          \"none_Fleet_2\",                                          \"none_Fleet_3\"                                          ), # no blocks for trawl and jp survey                                       # survey selectivity form                                      srv_sel_model =                                         c(\"logist1_Fleet_1\",                                          \"exponential_Fleet_2\",                                           \"logist1_Fleet_3\"),                                       # survey catchability blocks                                      srv_q_blocks =                                         c(\"none_Fleet_1\",                                           \"none_Fleet_2\",                                           \"none_Fleet_3\"),                                       # whether to estiamte all fixed effects                                       # for survey selectivity and later                                      # modify to fix/share parameters                                      srv_fixed_sel_pars_spec =                                         c(\"est_all\",                                           \"est_all\",                                           \"est_all\"),                                       # whether to estiamte all                                       # fixed effects for survey catchability                                      srv_q_spec =                                         c(\"est_all\",                                           \"est_all\",                                           \"est_all\")                                      )  # ll survey, share delta female (index 2) across time blocks and to the coop jp ll survey delta # ll survey, share delta male (index 5) across time blocks and to the coop jp ll survey delta # coop jp survey does not estimate parameters and shares deltas with longline survey # single time block with trawl survey and only one parameter hence,  # only one parameter estimated across blocks (indices 7 and 8) input_list$map$ln_srv_fixed_sel_pars <-    factor(c(1:3, 2, 4:6, 5,rep(7,4),             rep(8, 4), rep(c(NA,2), 2), rep(c(NA, 5), 2)))  # Coop JP Survey (Logistic) Single time block (these estimates are fixed!) input_list$par$ln_srv_fixed_sel_pars[1,,,1,3] <- c(0.980660760456, 0.9295241) input_list$par$ln_srv_fixed_sel_pars[1,,,2,3] <- c(1.22224502478, 0.8821623)"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"setup-model-weighting","dir":"Articles","previous_headings":"","what":"Setup Model Weighting","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"last helper function needs utilized setup run model Setup_Mod_Weighting function. Data sources can weighted combination Î»\\lambda (weights entire data source likelihood, e.g., Î»*CatchnLL\\lambda*Catch_{nLL}) specified â€œobservedâ€ standard errors / input sample sizes (defined previous functions). context composition data, Î»\\lambda values determined using Francis reweighting right-weight data. Francis-reweighting used, values 1 can input weights data.","code":"# set up data weighting stuff Wt_FishAgeComps <- array(NA, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                       input_list$data$n_fish_fleets))  # weights for fishery age comps Wt_FishAgeComps[1,,1,1] <- 0.826107286513784 # Weight for fixed gear age comps  # Fishery length comps Wt_FishLenComps <- array(NA, dim = c(input_list$data$n_regions,                                       length(input_list$data$years),                                       input_list$data$n_sexes,                                       input_list$data$n_fish_fleets))  Wt_FishLenComps[1,,1,1] <- 4.1837057381917  # Weight for fixed gear len comps females Wt_FishLenComps[1,,2,1] <- 4.26969350917589  # Weight for fixed gear len comps males Wt_FishLenComps[1,,1,2] <- 0.316485920691651 # Weight for trawl gear len comps females Wt_FishLenComps[1,,2,2] <- 0.229396580680981  # Weight for trawl gear len comps males  # survey age comps Wt_SrvAgeComps <- array(NA, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_srv_fleets))  # weights for survey age comps Wt_SrvAgeComps[1,,1,1] <- 3.79224544725927  # Weight for domestic survey ll gear age comps Wt_SrvAgeComps[1,,1,3] <- 1.31681114024037 # Weight for coop jp survey ll gear age comps  # Survey length comps Wt_SrvLenComps <- array(0, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets))  Wt_SrvLenComps[1,,1,1] <- 1.43792019016567  # Weight for domestic ll survey len comps females Wt_SrvLenComps[1,,2,1] <- 1.07053763450712 # Weight for domestic ll survey len comps males Wt_SrvLenComps[1,,1,2] <- 0.670883273592302  # Weight for domestic trawl survey len comps females Wt_SrvLenComps[1,,2,2] <- 0.465207132450763 # Weight for domestic trawl survey len comps males Wt_SrvLenComps[1,,1,3] <- 1.27772810174693 # Weight for coop jp ll survey len comps females Wt_SrvLenComps[1,,2,3] <- 0.857519546948587  # Weight for coop jp ll survey len comps males  input_list <- Setup_Mod_Weighting(input_list = input_list,                                   Wt_Catch = 50,                                   Wt_FishIdx = 0.448,                                   Wt_SrvIdx = 0.448,                                   Wt_Rec = 1.5,                                   Wt_F = 0.1,                                   Wt_Tagging = 0,                                   Wt_FishAgeComps = Wt_FishAgeComps,                                   Wt_FishLenComps = Wt_FishLenComps,                                   Wt_SrvAgeComps = Wt_SrvAgeComps,                                   Wt_SrvLenComps = Wt_SrvLenComps                                   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/e_single_region_sablefish_case_study.html","id":"fit-model-and-plot","dir":"Articles","previous_headings":"","what":"Fit Model and Plot","title":"Setting up a Single Region Model (Alaska Sablefish)","text":"finally done setup! Now, can run model. aided fit_model function, expects data, mapping, parameters list uses MakeADFUN function internally. lists can extracted input_list constructed. users want utilize integrate random effects using Laplace Approximation, can supply character vector random argument. instance, wanted integrate recruitment deviations , set: random = c(\"ln_RecDevs\"). newton_loops argument indicates whether user wants take additional newton steps ensure model achieved local minimum, uses Hessian gradients compute (thus, serves additional check model convergence). report file extracted internally fit_model standard errors can extracted using RTMB::sdreport function. Finally, can compare outputs ADMB RTMB. brevity, show comparisons spawning biomass recruitment two models.","code":"# extract out lists updated with helper functions data <- input_list$data parameters <- input_list$par mapping <- input_list$map  # Fit model sabie_rtmb_model <- fit_model(data,                               parameters,                               mapping,                               random = NULL,                               newton_loops = 3,                               silent = TRUE                               )  # Get standard error report sabie_rtmb_model$sd_rep <- RTMB::sdreport(sabie_rtmb_model) # Get recruitment time-series rec_series <- data.frame(Par = \"Recruitment\",                          Year = 1960:2024,                          RTMB = t(sabie_rtmb_model$rep$Rec),                          ADMB = sgl_rg_sable_data$admb_recr)  # Get SSB time-series ssb_series <- data.frame(Par = \"SSB\",                          Year = 1960:2024,                          RTMB = t(sabie_rtmb_model$rep$SSB),                          ADMB = sgl_rg_sable_data$admb_spbiom)  ts_df <- rbind(ssb_series,rec_series) # bind together ggplot() +   geom_line(ts_df, mapping = aes(x = Year, y = RTMB, color = 'RTMB'), size = 1.3, lty = 1) +   geom_line(ts_df, mapping = aes(x = Year, y = ADMB, color = 'ADMB'), size = 1.3, lty = 2) +   facet_wrap(~Par, scales = \"free_y\") +   scale_color_manual(values = c('RTMB' = 'black', 'ADMB' = 'red')) +   labs(x = \"Year\", color = 'Model', y = \"Value\") +   SPoRC::theme_sablefish()"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-model-dimensions","dir":"Articles","previous_headings":"","what":"Setup Model Dimensions","title":"Setting up a Single Region Model (BSAI Pollock)","text":"initially set model , input list containing data list, parameter list, mapping list needs constructed. aided function Setup_Mod_Dim, users specify vector years, ages, lengths. Additionally, users need specify number regions modelled (n_regions), number sexes modeled (n_sexes), number fishery fleets (n_fish_fleets), number survey fleets (n_srv_fleets)","code":"input_list <- Setup_Mod_Dim(     years = sgl_rg_ebswp_data$years,     # vector of years     ages = sgl_rg_ebswp_data$ages,     # vector of ages     lens = NA,     # number of lengths     n_regions = 1,     # number of regions     n_sexes = 1,     # number of sexes     n_fish_fleets = 1,     # number of fishery fleets     n_srv_fleets = 3 # number of survey fleets   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-recruitment-dynamics","dir":"Articles","previous_headings":"","what":"Setup Recruitment Dynamics","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Following initialization input_list, can pass created object next function (Setup_Mod_Rec) parameterize recruitment dynamics. case Bering Sea Pollock, recruitment parameterized : Beverton-Holt Recruitment, steepness fixed 2024 assessment estiamted value, Recruitment deviations estimated penalized likelihood framework, Recruitment deviations estimated years, Initial age deviations ln_sigmaR = 2, later deviations (year 1) ln_sigmaR = 1. done mimic current assessment, different mean parameter estimated early age deviations later recruitment deviations. Initial age structure derived assuming geometric series (init_age_strc = 1; alternative iterating age structure equilibrium init_age_strc = 0), Individuals assumed spawn March (t_spawn = 0.25)","code":"inv_steepness <- function(s) qlogis((s - 0.2) / 0.8)    input_list <- Setup_Mod_Rec(     input_list = input_list,      # Model options     do_rec_bias_ramp = 0,     # do bias ramp (0 == don't do bias ramp, 1 == do bias ramp)     sigmaR_switch = 1,     # when to switch from early to late sigmaR (switch in first year)     ln_sigmaR = log(c(2, 1)),     # Starting values for early and late sigmaR     rec_model = \"bh_rec\",     # recruitment model     steepness_h = inv_steepness(0.623013),     h_spec = \"fix\",     # fixing steepness     sigmaR_spec = \"fix\",     # fix early sigmaR and late sigmaR     sexratio = as.vector(c(1.0)),     # recruitment sex ratio     init_age_strc = 1,     ln_global_R0 = 10,     t_spawn = 0.25     # starting value for r0   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-biological-dynamics","dir":"Articles","previous_headings":"","what":"Setup Biological Dynamics","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Passing input_list updated previous helper function, can parameterize biological dynamics model. Setup_Mod_Biologicals requires data inputs weight--age (WAA) maturity--age (MatAA), dimensioned n_regions, n_years, n_ages, n_sexes. case Bering Sea pollock, natural mortality age-specific fixed. Thus, natural mortality array constructed passed function, also dimensioned n_regions, n_years, n_ages, n_sexes.","code":"# Setup a fixed natural mortality array for use   fix_natmort <- array(0, dim = c(input_list$data$n_regions, length(input_list$data$years), length(input_list$data$ages), 1))   fix_natmort[,,1,] <- 0.9 # age 1 M   fix_natmort[,,2,] <- 0.45 # age 2 M   fix_natmort[,,-c(1,2),] <- 0.3 # age 3+ M      input_list <- Setup_Mod_Biologicals(     input_list = input_list,      # Data inputs     WAA = sgl_rg_ebswp_data$WAA,     MatAA = sgl_rg_ebswp_data$MatAA,      # Model options     # mean and sd for M prior     fit_lengths = 0,     # don't fit length compositions     M_spec = \"fix\",     # fixing natural mortality     Fixed_natmort = fix_natmort   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-movement-and-tagging","dir":"Articles","previous_headings":"","what":"Setup Movement and Tagging","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Given vignette demonstrates single-region model, movement dynamics specified. However, users still need define movement dynamics parameterized. case, following code chunk specifies movement estimated (use_fixed_movement = 1), movement identity matrix (Fixed_Movement = NA), recruits move (do_recruits_move = 0). Specification tagging dynamics follow similar fashion since single-region model. necessary updating input_list setting UseTagging argument value 0.","code":"# setup movement   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )  # setup tagging   input_list <- Setup_Mod_Tagging(     input_list = input_list,      UseTagging = 0)"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-catch-and-fishing-mortality","dir":"Articles","previous_headings":"","what":"Setup Catch and Fishing Mortality","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Following parameterization biological dynamics, fishery dynamics can specified set using Setup_Mod_Catch_and_F function. , input_list gets updated previous helper functions. Users need supply function array observed catches ObsCatch, dimensioned n_regions, n_years, n_fish_fleets. Similarly, users also need specify catch type observations Catch_Type argument. argument expects matrix dimensioned n_years n_fish_fleets, really applicable spatial model (values 0 indicate catch aggregated across regions periods fleets, values 1 indicate catch specific region periods fleets). Thus, single region model, values 1 always supplied. function also expects UseCatch argument specified, dimensioned n_regions, n_years, n_fish_fleets. Essentially, users need fill whether catch fit particular partitions. use cases argument scenarios catch observed value 0, helper function automatically turns estimation fishing mortality deviations partitions. Additional model options specified case study include whether fishing mortality penalties utilized help estimate deviations Use_F_pen = 1, ln_sigmaC values fix .","code":"input_list <- Setup_Mod_Catch_and_F(     input_list = input_list,      # Data inputs     ObsCatch = sgl_rg_ebswp_data$ObsCatch,     Catch_Type = sgl_rg_ebswp_data$Catch_Type,     UseCatch = sgl_rg_ebswp_data$UseCatch,      # Model options     Use_F_pen = 1,     # whether to use f penalty, == 0 don't use, == 1 use     sigmaC_spec = \"fix\",     # fixing catch standard deviation     ln_sigmaC = matrix(log(0.05), 1, 1)     # starting / fixed value for catch standard deviation   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-fishery-indices-and-compositions","dir":"Articles","previous_headings":"","what":"Setup Fishery Indices and Compositions","title":"Setting up a Single Region Model (BSAI Pollock)","text":"set fishery indices composition data, supply arrays fishery indices associated standard errors (ObsFishIdx ObsFishIdx_SE), dimensioned n_regions, n_years, n_fish_fleets. Additionally, supply fishery age composition data length composition data. ObsFishAgeComps ObsFishLenComps dimensioned n_regions, n_years, n_bins (n_ages | n_lens), n_sexes, n_fish_fleets. Bering Sea pollock model fit length composition data, ObsFishLenComps specified NA UseFishLenComps specified 0s. Additionally, specify fishery index biomass-based, multinomial likelihoods utilized age composition data, fishery age compositions aggregatted across regions sexes (single-region single-sex model).","code":"input_list <- Setup_Mod_FishIdx_and_Comps(     input_list = input_list,     # data inputs     ObsFishIdx = sgl_rg_ebswp_data$ObsFishIdx,     ObsFishIdx_SE = sgl_rg_ebswp_data$ObsFishIdx_SE,     UseFishIdx = sgl_rg_ebswp_data$UseFishIdx,     ObsFishAgeComps = sgl_rg_ebswp_data$ObsFishAgeComps,     UseFishAgeComps = sgl_rg_ebswp_data$UseFishAgeComps,     ISS_FishAgeComps = sgl_rg_ebswp_data$ISS_FishAgeComps,     ObsFishLenComps = array(NA_real_, dim = c(1, length(input_list$data$years), length(input_list$data$lens), 1, 1)),     UseFishLenComps = array(0, dim = c(1, length(input_list$data$years), 1)),      # Model options     fish_idx_type = c(\"biom\"),     # indices for fishery     FishAgeComps_LikeType = c(\"Multinomial\"),     # age comp likelihoods for fishery fleet     FishLenComps_LikeType = c(\"none\"),     # length comp likelihoods for fishery     FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     # age comp structure for fishery     FishLenComps_Type = c(\"none_Year_1-terminal_Fleet_1\"),     # length comp structure for fishery     FishAge_comp_agg_type = c(1),     # ADMB aggregation quirks, ideally get rid of this     FishLen_comp_agg_type = c(0)     # ADMB aggregation quirks, ideally get rid of this   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-survey-indices-and-compositions","dir":"Articles","previous_headings":"","what":"Setup Survey Indices and Compositions","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Setting survey indices compositions follows similar fashion. , supply arrays survey indices associated standard errors (ObsSrvIdx ObsSrvIdx_SE), dimensioned n_regions, n_years, n_srv_fleets. case, modelling three survey fleets, fleet 1 bottom trawl survey, fleet 2 acoustic trawl survey, fleet 3 acoustic vessel opportunity survey. also input survey age composition data length composition data. ObsSrvAgeComps ObsSrvLenComps dimensioned n_regions, n_years, n_bins (n_ages | n_lens), n_sexes, n_srv_fleets. three survey indices biomass-based multinomial likelihoods used fit age-compositions fleets 1 2. However, acoustic vessel oppurtunity survey composition data, fit (hence specified none).","code":"# Setup survey indices and compositions   input_list <- Setup_Mod_SrvIdx_and_Comps(     input_list = input_list,      # data inputs     ObsSrvIdx = sgl_rg_ebswp_data$ObsSrvIdx,     ObsSrvIdx_SE = sgl_rg_ebswp_data$ObsSrvIdx_SE,     UseSrvIdx = sgl_rg_ebswp_data$UseSrvIdx,     ObsSrvAgeComps = sgl_rg_ebswp_data$ObsSrvAgeComps,     ISS_SrvAgeComps = sgl_rg_ebswp_data$ISS_SrvAgeComps,     UseSrvAgeComps = sgl_rg_ebswp_data$UseSrvAgeComps,     ObsSrvLenComps = array(NA_real_, dim = c(1, length(input_list$data$years), length(input_list$data$lens), 1, 3)),     UseSrvLenComps = array(0, dim = c(1, length(input_list$data$years), 3)),     ISS_SrvLenComps = NULL,      # Model options     srv_idx_type = c(\"biom\", \"biom\", \"biom\"),     # abundance and biomass for survey fleet 1, 2, and 3     SrvAgeComps_LikeType = c(\"Multinomial\", \"Multinomial\", \"none\"),     # survey age composition likelihood for survey fleet 1, 2, and 3     SrvLenComps_LikeType = c(\"none\", \"none\", \"none\"),     #  survey length composition likelihood for survey fleet 1, 2, and 3     SrvAgeComps_Type = c(       \"agg_Year_1-terminal_Fleet_1\",       \"agg_Year_1-terminal_Fleet_2\",       \"none_Year_1-terminal_Fleet_3\"     ),     # survey age comp type      SrvLenComps_Type = c(       \"none_Year_1-terminal_Fleet_1\",       \"none_Year_1-terminal_Fleet_2\",       \"none_Year_1-terminal_Fleet_3\"     ),     # survey length comp type      SrvAge_comp_agg_type = c(1, 1, 1),     # ADMB aggregation quirks, ideally get rid of this     SrvLen_comp_agg_type = c(0, 0, 0)     # ADMB aggregation quirks, ideally get rid of this   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setting-up-fishery-selectivity-and-catchability","dir":"Articles","previous_headings":"","what":"Setting up Fishery Selectivity and Catchability","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Fishery selectivity specified vary semi-parametrically pollock model, 2dar1 option specified. , estiamte selectivity deviations penalized framework fix variance values priori fishsel_pe_pars_spec = \"fix\". Moreover, estiamte fishery selectivity deviations dimensions, specify correlations set 0 (corr_opt_semipar = \"corr_zero_y_a_c\"). Thus, semi-parametric deviations collapse simple iid formulation. Additionally, specify underlying selectivity form fishery logistic function. Lastly, single catchability term estimated fit early fishery index utilized model (fish_q_spec = c(\"est_all\")). Fit Model section, demonstrate variance parameters can fixed allow estimation penalized likelihood framework.","code":"# Setup fishery selectivity and catchability   input_list <- Setup_Mod_Fishsel_and_Q(      input_list = input_list,      # Model options     # fishery selectivity, whether continuous time-varying     cont_tv_fish_sel = c(\"2dar1_Fleet_1\"),     fishsel_pe_pars_spec = \"fix\", # doing penalized likelihood for selex devs     fish_sel_devs_spec = \"est_all\", # estimating all sel devs     corr_opt_semipar = \"corr_zero_y_a_c\", # making sure 2d correaltions are 0, collapses to a simple iid case     # fishery selectivity blocks     fish_sel_blocks = c(\"none_Fleet_1\"),     # fishery selectivity form     fish_sel_model = c(\"logist1_Fleet_1\"),     # fishery catchability blocks     fish_q_blocks = c(\"none_Fleet_1\"),     # whether to estiamte all fixed effects for fishery selectivity     fish_fixed_sel_pars = c(\"est_all\"),     # whether to estiamte all fixed effects for fishery catchability     fish_q_spec = c(\"est_all\")   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setting-up-survey-selectivity-and-catchability","dir":"Articles","previous_headings":"","what":"Setting up Survey Selectivity and Catchability","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Survey selectivity setup similar way. , specify first survey fleet iid parametric deviations selectivity form, second survey fleet 2dar1 semi-parametric deviations. Selectivity survey fleet 3 estimated age composition data available. Therefore, selectivity survey fleet 2 3 shared. , specify selectivity deviations estimated penalized likelihood framework argument srvsel_pe_pars_spec = c(\"fix\", \"fix\", \"fix\") specify set 2dar1 correlations 0, semi-parametric deviations collapse iid formulation (corr_opt_semipar = c(NA, \"corr_zero_y_a_c\", \"corr_zero_y_a_c\")).","code":"# Setup survey selectivity and catchability   input_list <- Setup_Mod_Srvsel_and_Q(     input_list = input_list,      # Model options     # survey selectivity, whether continuous time-varying     cont_tv_srv_sel = c(\"iid_Fleet_1\", \"2dar1_Fleet_2\", \"2dar1_Fleet_3\"),     srvsel_pe_pars_spec = c(\"fix\", \"fix\", \"fix\"), # penalize survey selex devs     srv_sel_devs_spec = c(\"est_all\", \"est_all\", \"none\"), # estimating all srv selex devs     corr_opt_semipar = c(NA, \"corr_zero_y_a_c\", \"corr_zero_y_a_c\"), # setting corelations at 0, so 2dar1 collapses to simple iid semi-parametric devs      # survey selectivity blocks     srv_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),     # survey selectivity form     srv_sel_model = c(       \"logist1_Fleet_1\",       \"logist1_Fleet_2\",       \"logist1_Fleet_3\"     ),     # survey catchability blocks     srv_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),     # whether to estiamte all fixed effects for survey selectivity     srv_fixed_sel_pars_spec = c(\"est_all\", \"est_all\", \"est_all\"),     # whether to estiamte all fixed effects for survey catchability     srv_q_spec = c(\"est_all\", \"est_all\", \"est_all\")   )    # note that AVO (fleet 3) does not have any comp data, and needs to share selectivity with ATS (fleet 2)   input_list$map$ln_srv_fixed_sel_pars <- factor(c(1, 2, 3, 4, 3, 4))    # share ATS and AVO selex devs   map_srvsel_devs[,,,,3] <- map_srvsel_devs[,,,,2]   input_list$map$ln_srvsel_devs <- factor(map_srvsel_devs)"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"setup-model-weighting","dir":"Articles","previous_headings":"","what":"Setup Model Weighting","title":"Setting up a Single Region Model (BSAI Pollock)","text":"set data weighted Î»\\lambda model. , Î»\\lambda values set 1 TMB likelihoods utilized. Thus, data sources weighted either using specified input sample sizes (composition data) specified variances (catch abundance indices).","code":"input_list <- Setup_Mod_Weighting(   input_list = input_list,   sablefish_ADMB = 0,   likelihoods = 1, # using TMB likelihoods   Wt_Catch = 1,   Wt_FishIdx = 1,   Wt_SrvIdx = 1,   Wt_Rec = 1,   Wt_F = 1,   Wt_Tagging = 0,   Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_srv_fleets)),   Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_srv_fleets)),   Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)),   Wt_SrvLenComps = array(1, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_bsai_pollock_case_study.html","id":"fit-model-and-plot","dir":"Articles","previous_headings":"","what":"Fit Model and Plot","title":"Setting up a Single Region Model (BSAI Pollock)","text":"Next, can extract elements created input_list object. specify values fix selectivity variances . first case, fishery selectivity variance fixed value 0.075 second case, bottom trawl survey a50 k selectivity variances logistic function fixed 0.075 Lastly, acoustic trawl vessel opportunity surveys specified variance 0.15. details dimensionality fishsel_pe_pars srvsel_pe_pars, please refer Description Model Parameters page. Next, can extract parameter estimates recruitment spawning biomass compare 2024 pollock model. general, see trends recruitment spawning stock biomass align relatively well. However, slight discrepancies estimates, likely due factors discussed start vignette.  Lastly, can also inspect estimates fishery selectivity SPoRC. , show relative selectivity estimates ages 3 - 11 (panels). Note selectivity model can exceed 1, normalize values figure improve interpretability","code":"# extract out lists updated with helper functions data <- input_list$data parameters <- input_list$par mapping <- input_list$map  # selex sigma to fix at, given penalized likelihood parameters$fishsel_pe_pars[,4,,] <- log(0.075) # fishery selex variance parameters$srvsel_pe_pars[,1:2,,1] <- log(0.075) # survey BTS - a50 and delta variance parameters$srvsel_pe_pars[,4,,2] <- log(0.15) # survey ATS and ato variance  # Fit model ebswp_rtmb_model <- fit_model(data,                               parameters,                               mapping,                               random = NULL,                               newton_loops = 3,                               silent = TRUE                               )  # Get standard error report ebswp_rtmb_model$sd_rep <- RTMB::sdreport(ebswp_rtmb_model) # Get recruitment rec_series <- reshape2::melt((ebswp_rtmb_model$rep$Rec)) %>%   mutate(se = ebswp_rtmb_model$sdrep$sd[names(ebswp_rtmb_model$sdrep$value) == 'Rec']) rec_series$Par <- \"Recruitment\"  # Get SSB time-series ssb_series <- reshape2::melt((ebswp_rtmb_model$rep$SSB)) %>%   mutate(se = ebswp_rtmb_model$sdrep$sd[names(ebswp_rtmb_model$sdrep$value) == 'SSB']) ssb_series$Par <- \"Spawning Biomass\"  # bind together ts_df <- rbind(ssb_series,rec_series) %>%   dplyr::rename(Region = Var1, Year = Var2) %>%   dplyr::mutate(Year = Year + 1963, type = 'SPoRC')  # Get actual assessment results ssb_ass <- data.frame(   Region = 1,   Year = 1964:2024,   value = sgl_rg_ebswp_data$SSB[,2],   se = sgl_rg_ebswp_data$SSB[,3],   Par = 'Spawning Biomass',   type = '2024 Pollock Assessment' )  # recruitment rec_ass <- data.frame(   Region = 1,   Year = 1964:2024,   value = sgl_rg_ebswp_data$R[,2],   se = sgl_rg_ebswp_data$R[,3],   Par = 'Recruitment',   type = '2024 Pollock Assessment' )  # bind ts_df <- ts_df %>% bind_rows(ssb_ass, rec_ass) ggplot(ts_df, aes(x = Year, y = value, ymin = value - (1.96 * se),                   ymax = value + (1.96 * se), color = type, fill = type)) +   geom_point(size = 3) +   geom_line() +   facet_wrap(~Par, scales = 'free') +   geom_ribbon(alpha = 0.3, color = NA) +   ggthemes::scale_color_colorblind() +   ggthemes::scale_fill_colorblind() +   labs(y = \"Value\")  +   theme_bw(base_size = 13) +   ylim(0, NA) +   labs(x = 'Year', y = 'Value', color = 'Type', fill = 'Type') reshape2::melt(ebswp_rtmb_model$rep$fish_sel) %>%   mutate(value = value/max(value)) %>%   rename(Region = Var1, Year = Var2, Age = Var3, Sex = Var4, Fleet = Var5) %>%   filter(Age %in% 3:11) %>%   ggplot(aes(x = Year + 1963, y = value)) +   geom_point() +   geom_line() +   facet_wrap(~Age) +   theme_bw(base_size = 15) +   labs(x = 'Year', y = 'Relative Selectivity')"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-model-dimensions","dir":"Articles","previous_headings":"","what":"Setup Model Dimensions","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"initially set model , input list containing data list, parameter list, mapping list needs constructed. aided function Setup_Mod_Dim, users specify vector years, ages, lengths. Additionally, users need specify number regions modelled (n_regions), number sexes modeled (n_sexes), number fishery fleets (n_fish_fleets), number survey fleets (n_srv_fleets)","code":"input_list <- Setup_Mod_Dim(     years = sgl_rg_ebswp_data$years,     # vector of years     ages = sgl_rg_ebswp_data$ages,     # vector of ages     lens = NA,     # number of lengths     n_regions = 1,     # number of regions     n_sexes = 1,     # number of sexes     n_fish_fleets = 1,     # number of fishery fleets     n_srv_fleets = 3 # number of survey fleets   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-recruitment-dynamics","dir":"Articles","previous_headings":"","what":"Setup Recruitment Dynamics","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Following initialization input_list, can pass created object next function (Setup_Mod_Rec) parameterize recruitment dynamics. case Eastern Bering Sea Pollock, recruitment parameterized : Beverton-Holt Recruitment, steepness fixed 2024 assessment estiamted value, Recruitment deviations estimated penalized likelihood framework, Recruitment deviations estimated years, Initial age deviations estimated ages, including plus group, Initial age structure derived assuming geometric series (init_age_strc = 1; alternative iterating age structure equilibrium init_age_strc = 0), Individuals assumed spawn March (t_spawn = 0.25)","code":"inv_steepness <- function(s) qlogis((s - 0.2) / 0.8)    input_list <- Setup_Mod_Rec(     input_list = input_list,      # Model options     do_rec_bias_ramp = 0,     # do bias ramp (0 == don't do bias ramp, 1 == do bias ramp)     sigmaR_switch = 1,     # when to switch from early to late sigmaR (switch in first year)     ln_sigmaR = log(c(1, 1)),     # Starting values for early and late sigmaR     rec_model = \"bh_rec\",     # recruitment model     steepness_h = inv_steepness(0.623013),     h_spec = \"fix\",     # fixing steepness     sigmaR_spec = \"fix\",     # fix early sigmaR and late sigmaR     init_age_strc = 1,     ln_global_R0 = 10,     t_spawn = 0.25,     equil_init_age_strc = 2     # starting value for r0   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-biological-dynamics","dir":"Articles","previous_headings":"","what":"Setup Biological Dynamics","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Passing input_list updated previous helper function, can parameterize biological dynamics model. Setup_Mod_Biologicals requires data inputs weight--age (WAA) maturity--age (MatAA), dimensioned n_regions, n_years, n_ages, n_sexes. case Bering Sea pollock, natural mortality age-specific fixed. Thus, natural mortality array constructed passed function, also dimensioned n_regions, n_years, n_ages, n_sexes.","code":"# Setup a fixed natural mortality array for use   fix_natmort <- array(0, dim = c(input_list$data$n_regions, length(input_list$data$years), length(input_list$data$ages), 1))   fix_natmort[,,1,] <- 0.9 # age 1 M   fix_natmort[,,2,] <- 0.45 # age 2 M   fix_natmort[,,-c(1,2),] <- 0.3 # age 3+ M      input_list <- Setup_Mod_Biologicals(     input_list = input_list,      # Data inputs     WAA = sgl_rg_ebswp_data$WAA,     MatAA = sgl_rg_ebswp_data$MatAA,      # Model options     # mean and sd for M prior     fit_lengths = 0,     # don't fit length compositions     M_spec = \"fix\",     # fixing natural mortality     Fixed_natmort = fix_natmort   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-movement-and-tagging","dir":"Articles","previous_headings":"","what":"Setup Movement and Tagging","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Given vignette demonstrates single-region model, movement dynamics specified. However, users still need define movement dynamics parameterized. case, following code chunk specifies movement estimated (use_fixed_movement = 1), movement identity matrix (Fixed_Movement = NA), recruits move (do_recruits_move = 0). Specification tagging dynamics follow similar fashion since single-region model. necessary updating input_list setting UseTagging argument value 0.","code":"# setup movement   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )  # setup tagging   input_list <- Setup_Mod_Tagging(     input_list = input_list,      UseTagging = 0)"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-catch-and-fishing-mortality","dir":"Articles","previous_headings":"","what":"Setup Catch and Fishing Mortality","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Following parameterization biological dynamics, fishery dynamics can specified set using Setup_Mod_Catch_and_F function. , input_list gets updated previous helper functions. Users need supply function array observed catches ObsCatch, dimensioned n_regions, n_years, n_fish_fleets. Similarly, users also need specify catch type observations Catch_Type argument. argument expects matrix dimensioned n_years n_fish_fleets, really applicable spatial model (values 0 indicate catch aggregated across regions periods fleets, values 1 indicate catch specific region periods fleets). Thus, single region model, values 1 always supplied. function also expects UseCatch argument specified, dimensioned n_regions, n_years, n_fish_fleets. Essentially, users need fill whether catch fit particular partitions. use cases argument scenarios catch observed value 0, helper function automatically turns estimation fishing mortality deviations partitions. Additional model options specified case study include whether fishing mortality penalties utilized help estimate deviations Use_F_pen = 1, ln_sigmaC values fix .","code":"input_list <- Setup_Mod_Catch_and_F(     input_list = input_list,      # Data inputs     ObsCatch = sgl_rg_ebswp_data$ObsCatch,     Catch_Type = sgl_rg_ebswp_data$Catch_Type,     UseCatch = sgl_rg_ebswp_data$UseCatch,      # Model options     Use_F_pen = 1,     # whether to use f penalty, == 0 don't use, == 1 use     sigmaC_spec = \"fix\",     # fixing catch standard deviation     ln_sigmaC = array(log(0.05), dim = c(1,length(input_list$data$years),1))     # starting / fixed value for catch standard deviation   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-fishery-indices-and-compositions","dir":"Articles","previous_headings":"","what":"Setup Fishery Indices and Compositions","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"set fishery indices composition data, supply arrays fishery indices associated standard errors (ObsFishIdx ObsFishIdx_SE), dimensioned n_regions, n_years, n_fish_fleets. Additionally, supply fishery age composition data length composition data. ObsFishAgeComps ObsFishLenComps dimensioned n_regions, n_years, n_bins (n_ages | n_lens), n_sexes, n_fish_fleets. Bering Sea pollock model fit length composition data, ObsFishLenComps specified NA UseFishLenComps specified 0s. Additionally, specify fishery index biomass-based, multinomial likelihoods utilized age composition data, fishery age compositions aggregatted across regions sexes (single-region single-sex model).","code":"input_list <- Setup_Mod_FishIdx_and_Comps(     input_list = input_list,     # data inputs     ObsFishIdx = sgl_rg_ebswp_data$ObsFishIdx,     ObsFishIdx_SE = sgl_rg_ebswp_data$ObsFishIdx_SE,     UseFishIdx = sgl_rg_ebswp_data$UseFishIdx,     ObsFishAgeComps = sgl_rg_ebswp_data$ObsFishAgeComps,     UseFishAgeComps = sgl_rg_ebswp_data$UseFishAgeComps,     ISS_FishAgeComps = sgl_rg_ebswp_data$ISS_FishAgeComps,     ObsFishLenComps = array(NA_real_, dim = c(1, length(input_list$data$years), length(input_list$data$lens), 1, 1)),     UseFishLenComps = array(0, dim = c(1, length(input_list$data$years), 1)),      # Model options     fish_idx_type = c(\"biom\"),     # indices for fishery     FishAgeComps_LikeType = c(\"Multinomial\"),     # age comp likelihoods for fishery fleet     FishLenComps_LikeType = c(\"none\"),     # length comp likelihoods for fishery     FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     # age comp structure for fishery     FishLenComps_Type = c(\"none_Year_1-terminal_Fleet_1\")     # length comp structure for fishery   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-survey-indices-and-compositions","dir":"Articles","previous_headings":"","what":"Setup Survey Indices and Compositions","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Setting survey indices compositions follows similar fashion. , supply arrays survey indices associated standard errors (ObsSrvIdx ObsSrvIdx_SE), dimensioned n_regions, n_years, n_srv_fleets. case, modelling three survey fleets, fleet 1 bottom trawl survey, fleet 2 acoustic trawl survey, fleet 3 acoustic vessel opportunity survey. also input survey age composition data length composition data. ObsSrvAgeComps ObsSrvLenComps dimensioned n_regions, n_years, n_bins (n_ages | n_lens), n_sexes, n_srv_fleets. three survey indices biomass-based multinomial likelihoods used fit age-compositions fleets 1 2. However, acoustic vessel oppurtunity survey composition data, fit (hence specified none).","code":"# Setup survey indices and compositions   input_list <- Setup_Mod_SrvIdx_and_Comps(     input_list = input_list,      # data inputs     ObsSrvIdx = sgl_rg_ebswp_data$ObsSrvIdx,     ObsSrvIdx_SE = sgl_rg_ebswp_data$ObsSrvIdx_SE,     UseSrvIdx = sgl_rg_ebswp_data$UseSrvIdx,     ObsSrvAgeComps = sgl_rg_ebswp_data$ObsSrvAgeComps,     ISS_SrvAgeComps = sgl_rg_ebswp_data$ISS_SrvAgeComps,     UseSrvAgeComps = sgl_rg_ebswp_data$UseSrvAgeComps,     ObsSrvLenComps = array(NA_real_, dim = c(1, length(input_list$data$years), length(input_list$data$lens), 1, 3)),     UseSrvLenComps = array(0, dim = c(1, length(input_list$data$years), 3)),     ISS_SrvLenComps = NULL,      # Model options     srv_idx_type = c(\"biom\", \"biom\", \"biom\"),     # abundance and biomass for survey fleet 1, 2, and 3     SrvAgeComps_LikeType = c(\"Multinomial\", \"Multinomial\", \"none\"),     # survey age composition likelihood for survey fleet 1, 2, and 3     SrvLenComps_LikeType = c(\"none\", \"none\", \"none\"),     #  survey length composition likelihood for survey fleet 1, 2, and 3     SrvAgeComps_Type = c(       \"agg_Year_1-terminal_Fleet_1\",       \"agg_Year_1-terminal_Fleet_2\",       \"none_Year_1-terminal_Fleet_3\"     ),     # survey age comp type      SrvLenComps_Type = c(       \"none_Year_1-terminal_Fleet_1\",       \"none_Year_1-terminal_Fleet_2\",       \"none_Year_1-terminal_Fleet_3\"     )     # survey length comp type   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setting-up-fishery-selectivity-and-catchability","dir":"Articles","previous_headings":"","what":"Setting up Fishery Selectivity and Catchability","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Fishery selectivity specified vary semi-parametrically pollock model, 2dar1 option specified. , estiamte selectivity deviations penalized framework fix variance values priori fishsel_pe_pars_spec = \"fix\". Moreover, estiamte fishery selectivity deviations dimensions, specify correlations set 0 (corr_opt_semipar = \"corr_zero_y_a_c\"). Thus, semi-parametric deviations collapse simple iid formulation. Additionally, specify underlying selectivity form fishery logistic function. Lastly, single catchability term estimated fit early fishery index utilized model (fish_q_spec = c(\"est_all\")). Fit Model section, demonstrate variance parameters can fixed allow estimation penalized likelihood framework.","code":"# Setup fishery selectivity and catchability   input_list <- Setup_Mod_Fishsel_and_Q(      input_list = input_list,      # Model options     # fishery selectivity, whether continuous time-varying     cont_tv_fish_sel = c(\"2dar1_Fleet_1\"),     fishsel_pe_pars_spec = \"fix\", # doing penalized likelihood for selex devs     fish_sel_devs_spec = \"est_all\", # estimating all sel devs     corr_opt_semipar = \"corr_zero_y_b\", # making sure 2d correaltions are 0, collapses to a simple iid case     # fishery selectivity blocks     fish_sel_blocks = c(\"none_Fleet_1\"),     # fishery selectivity form     fish_sel_model = c(\"logist1_Fleet_1\"),     # fishery catchability blocks     fish_q_blocks = c(\"none_Fleet_1\"),     # whether to estiamte all fixed effects for fishery selectivity     fish_fixed_sel_pars_spec = c(\"est_all\"),     # whether to estiamte all fixed effects for fishery catchability     fish_q_spec = c(\"est_all\")   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setting-up-survey-selectivity-and-catchability","dir":"Articles","previous_headings":"","what":"Setting up Survey Selectivity and Catchability","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Survey selectivity setup similar way. , specify first survey fleet iid parametric deviations selectivity form, second survey fleet 2dar1 semi-parametric deviations. Selectivity survey fleet 3 estimated age composition data available. Therefore, selectivity survey fleet 2 3 shared (.e., est_shared_f_2). , specify selectivity deviations estimated penalized likelihood framework argument srvsel_pe_pars_spec = c(\"fix\", \"fix\", \"fix\") specify set 2dar1 correlations 0, semi-parametric deviations collapse iid formulation (corr_opt_semipar = c(NA, \"corr_zero_y_a_c\", \"corr_zero_y_a_c\")).","code":"# Setup survey selectivity and catchability   input_list <- Setup_Mod_Srvsel_and_Q(     input_list = input_list,      # Model options     # survey selectivity, whether continuous time-varying     cont_tv_srv_sel = c(\"iid_Fleet_1\", \"2dar1_Fleet_2\", \"2dar1_Fleet_3\"),     srvsel_pe_pars_spec = c(\"fix\", \"fix\", \"fix\"), # penalize survey selex devs     srv_sel_devs_spec = c(\"est_all\", \"est_all\", \"est_shared_f_2\"), # estimating all srv selex devs but sharing fleet 3 and 2 together     corr_opt_semipar = c(NA, \"corr_zero_y_b\", \"corr_zero_y_b\"), # setting corelations at 0, so 2dar1 collapses to simple iid semi-parametric devs      # survey selectivity blocks     srv_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),     # survey selectivity form     srv_sel_model = c(       \"logist1_Fleet_1\",       \"logist1_Fleet_2\",       \"logist1_Fleet_3\"     ),     # survey catchability blocks     srv_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),     # whether to estiamte all fixed effects for survey selectivity     srv_fixed_sel_pars_spec = c(\"est_all\", \"est_all\", \"est_shared_f_2\"), # sharing fleet 3 and 2 parameters together     # whether to estiamte all fixed effects for survey catchability     srv_q_spec = c(\"est_all\", \"est_all\", \"est_all\")   )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"setup-model-weighting","dir":"Articles","previous_headings":"","what":"Setup Model Weighting","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"set data weighted Î»\\lambda model. , Î»\\lambda values set 1. Thus, data sources weighted either using specified input sample sizes (composition data) specified variances (catch abundance indices).","code":"input_list <- Setup_Mod_Weighting(   input_list = input_list,   Wt_Catch = 1,   Wt_FishIdx = 1,   Wt_SrvIdx = 1,   Wt_Rec = 1,   Wt_F = 1,   Wt_Tagging = 0,   Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_srv_fleets)),   Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_srv_fleets)),   Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)),   Wt_SrvLenComps = array(1, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/f_single_region_ebs_pollock_case_study.html","id":"fit-model-and-plot","dir":"Articles","previous_headings":"","what":"Fit Model and Plot","title":"Setting up a Single Region Model (Eastern Bering Sea Pollock)","text":"Next, can extract elements created input_list object. specify values fix selectivity variances . first case, fishery selectivity variance fixed value 0.075 second case, bottom trawl survey a50 k selectivity variances logistic function fixed 0.075 Lastly, acoustic trawl vessel opportunity surveys specified variance 0.15. details dimensionality fishsel_pe_pars srvsel_pe_pars, please refer Description Model Parameters page. Next, can extract parameter estimates recruitment spawning biomass compare 2024 pollock model. general, see trends recruitment spawning stock biomass align relatively well. However, slight discrepancies estimates, likely due factors discussed start vignette.  Lastly, can also inspect estimates fishery selectivity SPoRC. , show relative selectivity estimates ages 3 - 11 (panels). Note selectivity model can exceed 1, normalize values figure improve interpretability","code":"# extract out lists updated with helper functions data <- input_list$data parameters <- input_list$par mapping <- input_list$map  # selex sigma to fix at, given penalized likelihood parameters$fishsel_pe_pars[,4,,] <- log(0.075) # fishery selex variance parameters$srvsel_pe_pars[,1:2,,1] <- log(0.075) # survey BTS - a50 and delta variance parameters$srvsel_pe_pars[,4,,2] <- log(0.15) # survey ATS and ato variance  # Fit model ebswp_rtmb_model <- fit_model(data,                               parameters,                               mapping,                               random = NULL,                               newton_loops = 3,                               silent = TRUE                               )  # Get standard error report ebswp_rtmb_model$sd_rep <- RTMB::sdreport(ebswp_rtmb_model) # Get recruitment rec_series <- reshape2::melt((ebswp_rtmb_model$rep$Rec)) %>%   mutate(se = ebswp_rtmb_model$sdrep$sd[names(ebswp_rtmb_model$sdrep$value) == 'log(Rec)'] * t(ebswp_rtmb_model$rep$Rec)) rec_series$Par <- \"Recruitment\"  # Get SSB time-series ssb_series <- reshape2::melt((ebswp_rtmb_model$rep$SSB)) %>%   mutate(se = ebswp_rtmb_model$sdrep$sd[names(ebswp_rtmb_model$sdrep$value) == 'log(SSB)'] * t(ebswp_rtmb_model$rep$SSB)) ssb_series$Par <- \"Spawning Biomass\"  # bind together ts_df <- rbind(ssb_series,rec_series) %>%   dplyr::rename(Region = Var1, Year = Var2) %>%   dplyr::mutate(Year = Year + 1963, type = 'SPoRC')  # Get actual assessment results ssb_ass <- data.frame(   Region = 1,   Year = 1964:2024,   value = sgl_rg_ebswp_data$SSB[,2],   se = sgl_rg_ebswp_data$SSB[,3],   Par = 'Spawning Biomass',   type = '2024 Pollock Assessment' )  # recruitment rec_ass <- data.frame(   Region = 1,   Year = 1964:2024,   value = sgl_rg_ebswp_data$R[,2],   se = sgl_rg_ebswp_data$R[,3],   Par = 'Recruitment',   type = '2024 Pollock Assessment' )  # bind ts_df <- ts_df %>% bind_rows(ssb_ass, rec_ass) ggplot(ts_df, aes(x = Year, y = value, ymin = value - (1.96 * se),                   ymax = value + (1.96 * se), color = type, fill = type)) +   geom_point(size = 3) +   geom_line() +   facet_wrap(~Par, scales = 'free') +   geom_ribbon(alpha = 0.3, color = NA) +   ggthemes::scale_color_colorblind() +   ggthemes::scale_fill_colorblind() +   labs(y = \"Value\")  +   theme_bw(base_size = 13) +   ylim(0, NA) +   labs(x = 'Year', y = 'Value', color = 'Type', fill = 'Type') reshape2::melt(ebswp_rtmb_model$rep$fish_sel) %>%   mutate(value = value/max(value)) %>%   rename(Region = Var1, Year = Var2, Age = Var3, Sex = Var4, Fleet = Var5) %>%   filter(Age %in% 3:11) %>%   ggplot(aes(x = Year + 1963, y = value)) +   geom_point() +   geom_line() +   facet_wrap(~Age) +   theme_bw(base_size = 15) +   labs(x = 'Year', y = 'Relative Selectivity')"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-model-dimensions","dir":"Articles","previous_headings":"","what":"Setup Model Dimensions","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"initially set model , input list containing data list, parameter list, mapping list needs constructed. aided function Setup_Mod_Dim, users specify vector years, ages, lengths. Additionally, users need specify number regions modeled (n_regions), number sexes modelled (n_sexes), number fishery fleets (n_fish_fleets), number survey fleets (n_srv_fleets)","code":"# Initialize model dimensions and data list input_list <- Setup_Mod_Dim(years = 1:length(mlt_rg_sable_data$years),                             # vector of years (1 - 62)                             ages = 1:length(mlt_rg_sable_data$ages),                             # vector of ages (1 - 30)                             lens = mlt_rg_sable_data$lens,                             # number of lengths (41 - 99)                             n_regions = mlt_rg_sable_data$n_regions,                             # number of regions (5)                             n_sexes = mlt_rg_sable_data$n_sexes,                             # number of sexes (2)                             n_fish_fleets = mlt_rg_sable_data$n_fish_fleets,                             # number of fishery fleet (2)                             n_srv_fleets = mlt_rg_sable_data$n_srv_fleets,                             # number of survey fleets (2)                             verbose = TRUE )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-recruitment-dynamics","dir":"Articles","previous_headings":"","what":"Setup Recruitment Dynamics","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"Following initialization input_list, can pass created object next function (Setup_Mod_Rec) parameterize recruitment dynamics. case spatial model Alaska sablefish, recruitment parameterized : Mean Recruitment, stock recruitment relationship assumed, recruitment bias ramp used (do_bias_ramp = 1), Two values sigmaR used, first value represents early period sigmaR, fixed 0.4, second value represents late period sigmaR, fixed value 1.2. Recruitment deviations estimated penalized likelihood framework, Recruitment deviations estimated years regions, except terminal year, Recruitment sex-ratios fixed 0.5 sex (default), Initial age structure derived iterating age structure equilibrium, Initial age deviations shared across regions facilitate model convergence","code":"# Setup recruitment stuff (using defaults for other stuff) input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             do_rec_bias_ramp = 0, # not using bias ramp                             sigmaR_switch = 16, # switch to using late sigma in year 16                             dont_est_recdev_last = 1, # don't estimate last rec dev                             # Model options                             rec_model = \"mean_rec\", # recruitment model                             sigmaR_spec = \"fix\", # fixing                             InitDevs_spec = \"est_shared_r\",                             # initial deviations are shared across regions,                             # but recruitment deviations are region specific                             ln_sigmaR = log(c(0.4, 1.2)),                             # values to fix sigmaR at, or starting values                             ln_global_R0 = log(20),                             # starting value for global R0                             R0_prop = array(c(0.2, 0.2, 0.2, 0.2),                                             dim = c(input_list$data$n_regions - 1))                             # starting value for R0 proportions in multinomial logit space )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-biological-dynamics","dir":"Articles","previous_headings":"","what":"Setup Biological Dynamics","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"Passing input_list updated previous helper function, can parameterize biological dynamics model. Setup_Mod_Biologicals requires data inputs weight--age (WAA) maturity--age (MatAA), dimensioned n_regions, n_years, n_ages, n_sexes. Optional model inputs include single ageing-error matrix AgeingError, dimensioned n_ages, n_ages, size-age transition matrix, whichn dimensioned n_regions, n_years, n_lens, n_ages, n_sexes. case, supplying ageing error matrix size-age transition matrix, given spatial sablefish model incorporates ageing error also fits length composition data (fit_lengths = 1). Given spatial models heavily parameterized natural mortality often poorly estimated, fixing natural mortality M_spec = \"fix\" value 0.104884, specified sex-invariant.","code":"# Setup biological stuff (using defaults for other stuff) input_list <- Setup_Mod_Biologicals(input_list = input_list,                                     WAA = mlt_rg_sable_data$WAA, # weight at age                                     MatAA = mlt_rg_sable_data$MatAA, # maturity at age                                     AgeingError = mlt_rg_sable_data$AgeingError,                                     # ageing error matrix                                     fit_lengths = 1, # fitting lengths                                     SizeAgeTrans = mlt_rg_sable_data$SizeAgeTrans,                                     # size age transition matrix                                     M_spec = \"fix\", # fix natural mortality                                     Fixed_natmort = array(0.104884, dim = c(mlt_rg_sable_data$n_regions,                                                                             length(mlt_rg_sable_data$years),                                                                             length(mlt_rg_sable_data$ages),                                                                             mlt_rg_sable_data$n_sexes))                                     # values to fix natural mortality at )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-movement-and-tagging-dynamics","dir":"Articles","previous_headings":"","what":"Setup Movement and Tagging Dynamics","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"Various options available parameterizing movement dynamics. particular, users can specify number age, year, sex blocks movement. users wish specify blocks aforementioned partitions, list needs supplied detailing blocking structure, number elements list represents number blocks estiamte, elements within list specify range block. instance, spatial model sablefish estimates 3 age blocks, (Movement_ageblk_spec = list(c(1:6), c(7:15), c(16:30))), first element specifies first age block, ranges ages 1 - 6, second element specifies second age block, ranges ages 7 - 15, third element specifies third age block, ranges ages 16 - 30. year sex blocks specified application. Thus, Movement_yearblk_spec Movement_sexblk_spec set \"constant\". Additionally, recruits allowed move, given potential severe confounding recruitment movement allowed (do_recruits_move = 0). Fixed movement used case (use_fixed_movement = 0) vague Dirichlet prior movement (Use_Movement_Prior = 1 Movement_prior = 1.5) used penalize movement away extremes (.e, away 0s 1s). Specification tagging dynamics can bit cumbersome given myriad options available. current application, tagging data longline survey utilized UseTagging = 1 maximum tag liberty 15 years specified max_tag_liberty = 15 tag cohort tracking. cut used minimize computational demands, providing reasonable level movement information. Next, need specify data inputs. primarily include: tag_release_indicator, indicates release year release region given tag cohort, Tagged_Fish, contains number tagged fish tag cohort, Obs_Tag_Recap, contains observed tag recaptures Following specification data inputs, can specify several model options. , can specify likelihood type utilized tagging data (Tag_LikeType = \"NegBin\"), specified negative binomial, overdispersion parameter estimated. can also specify tag mixing period (mixing_period = 2), indicates model fit tag recapture data release_year + 1, given tagged individuals fully mixed. Additionally, function also takes time tagging argument t_tagging, specified value 0.5 indicate tagging happens midway year, movement occur tag release year. Users can also specify tagging fishing natural mortality occurs. application, tagging fishing mortality / selectivity specified tag_selex = \"SexSp_AllFleet\", indicates selectivity curve utilized fit tag data sex-specific derived weighting fishery fleet-specific selectivity fishing mortality. option tag_natmort = \"AgeSp_SexSp\" specifies tagged individuals experience age-sex-specific natural mortality. options, users can inspect ?Setup_Mod_Tagging. Next, can specify whether tag reporting rate priors used (Use_TagRep_Prior = 1) type prior used. , tag reporting priors fact used, symmetric beta prior specified. Given , symmetric beta prior require input mean value tag reporting (mu = NA), require input standard deviation (sd = 5), larger values penalize extremes . specify move_age_tag_pool move_sex_tag_pool arguments indicate model tagging data fit. case, fitting tag data respective age sex-blocks reduce computational demand. users wish fit tag data individual ages sexes, move_age_tag_pool specified list(1,2,3,4 ..., n_ages) move_sex_tag_pool list(1,2). initial tagging mortality chronic tag shedding often confounded mortality processes difficult estiamte, fix parameters application (Init_Tag_Mort_spec = \"fix\" Tag_Shed_spec = \"fix\"). Lastly, specify estimation tag reporting rates, time-varying (estimated 2 blocks; see input supplied Tag_Reporting_blocks argument) shared across regions (TagRep_spec = \"est_shared_r\").","code":"# setting up movement parameterization input_list <- Setup_Mod_Movement(input_list = input_list,                                  # Model options                                  Movement_ageblk_spec = list(c(1:6), c(7:15), c(16:30)),                                  # estimating movement in 3 age blocks                                  # (ages 1-6, ages 7-15, ages 16-30)                                  Movement_yearblk_spec = \"constant\", # time-invariant movement                                  Movement_sexblk_spec = \"constant\", # sex-invariant movement                                  do_recruits_move = 0, # recruits do not move                                  use_fixed_movement = 0, # estimating movement                                  Use_Movement_Prior = 1, # priors used for movement                                  Movement_prior = 1.5                                  # vague prior to penalize movement away from the extremes                                  ) # setup tagging priors tag_prior <- data.frame(   region = 1,   block = c(1,2),   mu = NA, # no mean, since symmetric beta   sd = 5, # sd = 5   type = 0 # symmetric beta )  # setting up tagging parameterization input_list <- Setup_Mod_Tagging(input_list = input_list,                                 UseTagging = 1, # using tagging data                                 max_tag_liberty = 15, # maximum number of years to track a cohort                                  # Data Inputs                                 tag_release_indicator = mlt_rg_sable_data$tag_release_indicator,                                 # tag release indicator (first col = tag region,                                 # second col = tag year),                                 # total number of rows = number of tagged cohorts                                 Tagged_Fish = mlt_rg_sable_data$Tagged_Fish, # Released fish                                 # dimensioned by total number of tagged cohorts, (implicitly                                 # tracks the release year and region), age, and sex                                 Obs_Tag_Recap = mlt_rg_sable_data$Obs_Tag_Recap,                                 # dimensioned by max tag liberty, tagged cohorts, regions,                                 # ages, and sexes                                  # Model options                                 Tag_LikeType = \"NegBin\", # Negative Binomial                                 mixing_period = 2, # Don't fit tagging until release year + 1                                 t_tagging = 0.5, # tagging happens midway through the year,                                 # movement does not occur within that year                                 tag_selex = \"SexSp_AllFleet\", # tagging recapture selectivity                                 # is a weighted average of fishery selectivity of two fleets                                 tag_natmort = \"AgeSp_SexSp\", # tagging natural mortality is                                 # age and sex-specific                                 Use_TagRep_Prior = 1, # tag reporting rate priors are used                                 TagRep_Prior = tag_prior,                                 move_age_tag_pool = list(c(1:6), c(7:15), c(16:30)), # whether or                                 # not to pool tagging data when fitting (for computational cost)                                 move_sex_tag_pool = list(c(1:2)), # whether or not to pool                                 # sex-specific data when fitting                                 Init_Tag_Mort_spec = \"fix\", # fixing initial tag mortality                                 Tag_Shed_spec = \"fix\", # fixing chronic shedding                                 TagRep_spec = \"est_shared_r\", # tag reporting rates are                                 # not region specific                                 # Time blocks for tag reporting rates                                 Tag_Reporting_blocks = c(                                   paste(\"Block_1_Year_1-35_Region_\",                                         c(1:input_list$data$n_regions), sep = ''),                                   paste(\"Block_2_Year_36-terminal_Region_\",                                         c(1:input_list$data$n_regions), sep = '')                                 ),                                  # Specify starting values or fixing values                                 ln_Init_Tag_Mort = log(0.1), # fixing initial tag mortality                                 ln_Tag_Shed = log(0.02),  # fixing tag shedding                                 ln_tag_theta = log(0.5),                                 # starting value for tagging overdispersion                                 Tag_Reporting_Pars = array(log(0.2 / (1-0.2)),                                                            dim = c(input_list$data$n_regions, 2))                                 # starting values for tag reporting pars  )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-catch-and-fishing-mortality","dir":"Articles","previous_headings":"","what":"Setup Catch and Fishing Mortality","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"general, specifying catch fishing mortality relatively straightforward. Users need supply several data inputs, include array observed catches ObsCatch, catch type (Catch_Type), indicates gave region-specific region-aggregated catch, UseCatch, indicates whether fit catch data given region year. Users can inspect mlt_rg_sable_data data object understand dimensions data inputs, refer Description Model Data Dimensions vignette. Given going using TMB-style likelihoods, also specifying sigma catch fixed (sigmaC_spec = 'fix') value 0.02 fleets, years, regions (ln_sigmaC = array(log(0.02), dim = c(input_list$data$n_regions, length(input_list$data$years), input_list$data$n_fish_fleets))).","code":"input_list <- Setup_Mod_Catch_and_F(input_list = input_list,                                     # Data inputs                                     ObsCatch = mlt_rg_sable_data$ObsCatch,                                     Catch_Type = mlt_rg_sable_data$Catch_Type,                                     UseCatch = mlt_rg_sable_data$UseCatch,                                     # Model options                                     Use_F_pen = 1,                                     # whether to use f penalty, == 0 don't use, == 1 use                                     sigmaC_spec = 'fix',                                     ln_sigmaC =                                       array(log(0.02), dim = c(input_list$data$n_regions,                                                                length(input_list$data$years),                                                                input_list$data$n_fish_fleets)),                                     # fixing catch sd at small value                                     ln_F_mean = array(-2, dim = c(input_list$data$n_regions,                                                                   input_list$data$n_fish_fleets))                                     # some starting values for fishing mortality )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-index-and-composition-data-fishery-and-survey","dir":"Articles","previous_headings":"","what":"Setup Index and Composition Data (Fishery and Survey)","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"Setting fishery (survey) index composition data can similarly bit cumbersome, given number data inputs may required. Users can inspect mlt_rg_sable_data data object understand dimensions data inputs, refer Description Model Data Dimensions vignette. data inputs include following: 1. ObsFishIdx ObsSrvIdx, specifies observed indices 2. ObsFishIdx_SE ObsSrvIdx_SE, specifies standard errors observed indices 3. UseFishIdx UseSrvIdx, indicate whether indices fit 4. ObsFishAgeComps ObsSrvAgeComps contains observed age compositions 5. UseFishAgeComps UseSrvAgeComps indicates whether age compositions fit 6. ISS_FishAgeComps ISS_SrvAgeComps indicates input sample sizes used weight age compositions 7. ObsFishLenComps ObsSrvLenComps contains observed length compositions 8. UseFishLenComps UseSrvLenComps indicates whether length compositions fit 9. ISS_FishLenComps ISS_SrvLenComps indicates input sample sizes used weight length compositions Model options available similar described Setting Single Region Model (Alaska Sablefish) vignette. case fishery indices, fish_idx_type specified none given used. Age composition likelihoods specified FishAgeComps_LikeType = c(\"Multinomial\", \"none\"), indicating first fleet uses Multinomial second fleet age compositions. Fishery length compositions specified Multinomial fleets. respect FishAgeComps_Type FishLenComps_Type, specified spltRjntS availiable indicate compositions sum 1 jointly across sexes, split given region. arguments expected survey indices compositions. , 2 survey fleets specified, abundance based fleets. Age compositions fleets joint sex, split region, length compositions used. compositions survey fleets assume Mulinomial likelihood.","code":"input_list <- Setup_Mod_FishIdx_and_Comps(input_list = input_list,                                           # data inputs                                           ObsFishIdx = mlt_rg_sable_data$ObsFishIdx,                                           ObsFishIdx_SE = mlt_rg_sable_data$ObsFishIdx_SE,                                           UseFishIdx =  mlt_rg_sable_data$UseFishIdx,                                           ObsFishAgeComps = mlt_rg_sable_data$ObsFishAgeComps,                                           UseFishAgeComps = mlt_rg_sable_data$UseFishAgeComps,                                           ISS_FishAgeComps = mlt_rg_sable_data$ISS_FishAgeComps,                                           ObsFishLenComps = mlt_rg_sable_data$ObsFishLenComps,                                           UseFishLenComps = mlt_rg_sable_data$UseFishLenComps,                                           ISS_FishLenComps = mlt_rg_sable_data$ISS_FishLenComps,                                            # Model options                                           fish_idx_type = c(\"none\", \"none\"),                                           # fishery indices not used                                           FishAgeComps_LikeType =                                             c(\"Multinomial\", \"none\"),                                           # age comp likelihoods for fishery fleet 1 and 2                                           FishLenComps_LikeType =                                             c(\"Multinomial\", \"Multinomial\"),                                           # length comp likelihoods for fishery fleet 1 and 2                                           FishAgeComps_Type =                                             c(\"spltRjntS_Year_1-terminal_Fleet_1\",                                               \"none_Year_1-terminal_Fleet_2\"),                                           # age comp structure for fishery fleet 1 and 2                                           FishLenComps_Type =                                             c(\"spltRjntS_Year_1-terminal_Fleet_1\",                                               \"spltRjntS_Year_1-terminal_Fleet_2\") ) # Survey Indices and Compositions input_list <- Setup_Mod_SrvIdx_and_Comps(input_list = input_list,                                          # data inputs                                          ObsSrvIdx = mlt_rg_sable_data$ObsSrvIdx,                                          ObsSrvIdx_SE = mlt_rg_sable_data$ObsSrvIdx_SE,                                          UseSrvIdx =  mlt_rg_sable_data$UseSrvIdx,                                          ObsSrvAgeComps = mlt_rg_sable_data$ObsSrvAgeComps,                                          ISS_SrvAgeComps = mlt_rg_sable_data$ISS_SrvAgeComps,                                          UseSrvAgeComps = mlt_rg_sable_data$UseSrvAgeComps,                                          ObsSrvLenComps = mlt_rg_sable_data$ObsSrvLenComps,                                          UseSrvLenComps = mlt_rg_sable_data$UseSrvLenComps,                                          ISS_SrvLenComps = mlt_rg_sable_data$ISS_SrvLenComps,                                           # Model options                                          srv_idx_type = c(\"abd\", \"abd\"),                                          # abundance and biomass for survey fleet 1 and 2                                          SrvAgeComps_LikeType =                                            c(\"Multinomial\", \"Multinomial\"),                                          # survey age composition likelihood for survey fleet                                          # 1, and 2                                          SrvLenComps_LikeType =                                            c(\"none\", \"none\"),                                          #  no length compositions used for survey                                          SrvAgeComps_Type = c(\"spltRjntS_Year_1-terminal_Fleet_1\",                                                               \"spltRjntS_Year_1-terminal_Fleet_2\"),                                          # survey age comp type                                          SrvLenComps_Type = c(\"none_Year_1-terminal_Fleet_1\",                                                               \"none_Year_1-terminal_Fleet_2\")                                          # survey length comp type )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-selectivity-and-catchability-fishery-and-survey","dir":"Articles","previous_headings":"","what":"Setup Selectivity and Catchability (Fishery and Survey)","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"spatial sablefish application, fishery/survey selectivity catchability processes assumed spatially-invariant. Similar single region case, users need specify several selectivity options, include: Whether continuous time-varying selectivity processes (cont_tv_fish_sel cont_tv_srv_sel). case study, continuous time-varying selectivity used specified none_Fleet_x, Whether selectivity blocks (fish_sel_blocks srv_sel_blocks). application assumes 2 time-blocks fixed-gear fleet time-invariant selectivity trawl fishery, type parametric selectivity form specify different fleets (fish_sel_model srv_sel_model). , assume logist1 fixed-gear fleet (logistic specified a50 k), gamma dome-shaped selectivity trawl fleet, number catchability blocks specified (fish_q_blocks srv_q_blocks). Given fishery indices used, fishery catchability blocks estimated (fish_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\")), fishery survey selectivity parameters estimated (fish_fixed_sel_pars). case sablefish, first specifying selectivity parameters (regions, time-blocks, sexes) estimated. However, nuanced parameter sharing across regions, sexes, time-blocks used help stabilize model (last part code chunk), easily generalized. Thus, users can manually extract map list updated input_list object modify parameters fixed shared, Lastly, fishery survey catchability estimated (fish_q_spec srv_q_spec). fishery, catchability estimated fishery indices utilized (fix). , arguments expected setting survey selectivity, similarly nuanced parameter fixing sharing help facilitate model stability.","code":"# Fishery Selectivity and Catchability input_list <- Setup_Mod_Fishsel_and_Q(input_list = input_list,                                        # Model options                                       cont_tv_fish_sel = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       # fishery selectivity, whether continuous time-varying                                        # fishery selectivity blocks                                       fish_sel_blocks =                                         c(\"Block_1_Year_1-56_Fleet_1\",                                           # block 1, fishery ll selex                                           \"Block_2_Year_57-terminal_Fleet_1\",                                           # block 3 fishery ll selex                                           \"none_Fleet_2\"),                                       # no blocks for trawl fishery                                        # fishery selectivity form                                       fish_sel_model =                                         c(\"logist1_Fleet_1\",                                           \"gamma_Fleet_2\"),                                        # fishery catchability blocks                                       fish_q_blocks =                                         c(\"none_Fleet_1\",                                           \"none_Fleet_2\"),                                       # no blocks since q is not estimated                                        # whether to estimate all fixed effects                                       # for fishery selectivity and later modify                                       # to fix and share parameters                                       fish_fixed_sel_pars_spec =                                         c(\"est_all\", \"est_all\"),                                        # whether to estimate all fixed effects                                       # for fishery catchability                                       fish_q_spec =                                         c(\"fix\", \"fix\")                                       # fix fishery q since not used )   # Custom parameter sharing for fishery selectivity map_ln_fish_fixed_sel_pars <- input_list$par$ln_fish_fixed_sel_pars # mapping fishery selectivity  # Fixed gear fleet, unique parameters for each sex (time block 1) map_ln_fish_fixed_sel_pars[,1,1,1,1] <- 1 # a50, female, time block 1, fixed gear map_ln_fish_fixed_sel_pars[,2,1,1,1] <- 2 # delta, female, time block 1, fixed gear # (shared with time block 2 and sex) map_ln_fish_fixed_sel_pars[,1,1,2,1] <- 3 # a50, male, time block 1, fixed gear map_ln_fish_fixed_sel_pars[,2,1,2,1] <- 2 # delta, male, time block 1, fixed gear # (shared with time block 2 and sex)  # time block 2, fixed gear fishery map_ln_fish_fixed_sel_pars[,1,2,1,1] <- 4 # a50, female, time block 2, fixed gear map_ln_fish_fixed_sel_pars[,2,2,1,1] <- 2 # delta, female, time block 2, fixed gear # (shared with time block 1 and sex) map_ln_fish_fixed_sel_pars[,1,2,2,1] <- 5 # a50, male, time block 2, fixed gear map_ln_fish_fixed_sel_pars[,2,2,2,1] <- 2 # delta, male, time block 2, fixed gear # (shared with time block 1 and sex)  # time block 1 and 2, trawl gear fishery map_ln_fish_fixed_sel_pars[,1,1,1,2] <- 6 # amax, female, time block 1, trawl gear map_ln_fish_fixed_sel_pars[,2,1,1,2] <- 7 # delta, female, time block 1, trawl gear # (shared by sex) map_ln_fish_fixed_sel_pars[,1,1,2,2] <- 8 # amax, male, time block 1, trawl gear map_ln_fish_fixed_sel_pars[,2,1,2,2] <- 7 # delta, male, time block 1, trawl gear # (shared by sex) map_ln_fish_fixed_sel_pars[,,2,,2] <- NA # no parameters estimated for time block 2 trawl gear  input_list$map$ln_fish_fixed_sel_pars <- factor(map_ln_fish_fixed_sel_pars) # input into map list input_list$par$ln_fish_fixed_sel_pars[] <- log(5) # some more inforamtive starting values input_list <- Setup_Mod_Srvsel_and_Q(input_list = input_list,                                       # Model options                                      # survey selectivity, whether continuous time-varying                                      cont_tv_srv_sel =                                        c(\"none_Fleet_1\",                                          \"none_Fleet_2\"),                                       # survey selectivity blocks                                      srv_sel_blocks =                                        c(\"none_Fleet_1\",                                          \"none_Fleet_2\"                                        ), # no blocks for jp and domestic survey                                       # survey selectivity form                                      srv_sel_model =                                        c(\"logist1_Fleet_1\",                                          \"logist1_Fleet_2\"),                                       # survey catchability blocks                                      srv_q_blocks =                                        c(\"none_Fleet_1\",                                          \"none_Fleet_2\"),                                       # whether to estiamte all fixed effects                                      # for survey selectivity and later                                      # modify to fix/share parameters                                      srv_fixed_sel_pars_spec =                                        c(\"est_all\",                                          \"est_all\"),                                       # whether to estiamte all                                      # fixed effects for survey catchability                                      # spatially-invariant q                                      srv_q_spec =                                        c(\"est_shared_r\",                                          \"est_shared_r\"),                                       # Starting values for survey catchability                                      ln_srv_q = array(9,                                                       dim = c(input_list$data$n_regions, 1,                                                               input_list$data$n_srv_fleets)) )  # Custom mapping survey selectivity stuff map_ln_srv_fixed_sel_pars <- input_list$par$ln_srv_fixed_sel_pars # set up mapping factor stuff  # Coop survey (japanese) map_ln_srv_fixed_sel_pars[,1,1,1,1] <- 1 # a50, coop survey, time block 1, female map_ln_srv_fixed_sel_pars[,2,1,1,1] <- 2 # delta, coop survey, time block 1, female # (sharing with domestic survey) map_ln_srv_fixed_sel_pars[,1,1,2,1] <- 3 # a50, coop survey, time block 1, male map_ln_srv_fixed_sel_pars[,2,1,2,1] <- 4 # delta, coop survey, time block 1, male # (sharing with domestic survey)  # domestic survey map_ln_srv_fixed_sel_pars[,1,1,1,2] <- 5 # a50, domestic survey, time block 1, female map_ln_srv_fixed_sel_pars[,2,1,1,2] <- 2 # delta, domestic survey, time block 1, female # (sharing with coop survey) map_ln_srv_fixed_sel_pars[,1,1,2,2] <- 6 # a50, domestic survey, time block 1, male map_ln_srv_fixed_sel_pars[,2,1,2,2] <- 4 # delta, domestic survey, time block 1, male # (sharing with coop survey)  input_list$map$ln_srv_fixed_sel_pars <- factor(map_ln_srv_fixed_sel_pars)  # input into map list input_list$par$ln_srv_fixed_sel_pars[] <- log(5) # some more informative starting values"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"setup-model-weighting","dir":"Articles","previous_headings":"","what":"Setup Model Weighting","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"Finally, can specify want model weighting conducted. , weights specified 1.","code":"# set up model weighting stuff input_list <- Setup_Mod_Weighting(input_list = input_list,                                   Wt_Catch = 1,                                   Wt_FishIdx = 1,                                   Wt_SrvIdx = 1,                                   Wt_Rec = 1,                                   Wt_F = 1,                                   Wt_Tagging = 1,                                   # Composition model weighting                                   Wt_FishAgeComps =                                     array(1, dim = c(input_list$data$n_regions,                                                      length(input_list$data$years),                                                      input_list$data$n_sexes,                                                      input_list$data$n_fish_fleets)),                                   Wt_FishLenComps =                                     array(1, dim = c(input_list$data$n_regions,                                                      length(input_list$data$years),                                                      input_list$data$n_sexes,                                                      input_list$data$n_fish_fleets)),                                   Wt_SrvAgeComps =                                     array(1, dim = c(input_list$data$n_regions,                                                      length(input_list$data$years),                                                      input_list$data$n_sexes,                                                      input_list$data$n_srv_fleets)),                                   Wt_SrvLenComps =                                     array(1, dim = c(input_list$data$n_regions,                                                      length(input_list$data$years),                                                      input_list$data$n_sexes,                                                      input_list$data$n_srv_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/g_spatial_sablefish_case_study.html","id":"fit-model-and-plot","dir":"Articles","previous_headings":"","what":"Fit Model and Plot","title":"Setting up a Spatial Model (Alaska Sablefish)","text":"done setup! Now, can run model. aided fit_model function, expects data, mapping, parameters list uses MakeADFUN function internally. lists can extracted input_list constructed. report file extracted internally fit_model standard errors can extracted using RTMB::sdreport function. word caution, take run! Inspecting results spatial model, appears highest spawning biomass occurs CGOA, followed EGOA. Western regions generally demonstrate relatively comparable levels spawning biomass. Additionally, western regions (BS AI) along CGOA appear exhibit highest recruitment levels.","code":"# extract out lists updated with helper functions data <- input_list$data parameters <- input_list$par mapping <- input_list$map  # Fit model sabie_rtmb_model <- fit_model(data,                               parameters,                               mapping,                               random = NULL,                               newton_loops = 5,                               silent = F                               )  # Get standard error report sabie_rtmb_model$sd_rep <- RTMB::sdreport(sabie_rtmb_model) # Get recruitment time-series rec_series <- reshape2::melt((sabie_rtmb_model$rep$Rec)) rec_series$Par <- \"Recruitment\"  # Get SSB time-series ssb_series <- reshape2::melt((sabie_rtmb_model$rep$SSB)) ssb_series$Par <- \"Spawning Biomass\"  ts_df <- rbind(ssb_series,rec_series) # bind together  # Do some data munging here ts_df <- ts_df %>% dplyr::rename(Region = Var1, Year = Var2) %>%    dplyr::mutate(Region = dplyr::case_when(     Region == 1 ~ 'BS',     Region == 2 ~ 'AI',     Region == 3 ~ 'WGOA',     Region == 4 ~ 'CGOA',     Region == 5 ~ 'EGOA'   ),   Region = factor(Region, levels = c(\"BS\", \"AI\", \"WGOA\", \"CGOA\", \"EGOA\")),   Year = Year + 1959)  # plot! ggplot(ts_df, aes(x = Year, y = value, color = Region)) +   geom_line(size = 1.3) +   facet_grid(Par~Region, scales = \"free_y\") +   ggthemes::scale_color_colorblind() +   labs(y = \"Value\")  +   theme_bw(base_size = 13) +   theme(legend.position = 'none')"},{"path":"https://chengmatt.github.io/SPoRC/articles/h_closed_loop_simulations.html","id":"define-operating-model","dir":"Articles","previous_headings":"","what":"Define Operating Model","title":"Run Closed Loop Simulations","text":"can define operating model want condition population . , parameter estiamtes based model results Dusky rockfish. first load model list Dusky rockfish redefine variables use condition closed loop simulation. Next, condition closed-loop simulation using condition_closed_loop_simulations function. simulation run 30 additional closed-loop years, initial model years serving burn-period. total 50 simulations executed, assuming data available every fifth year. Accordingly, assessments conducted every five years, catch advice set five years advance. Future recruitment sampled burn-period, uncertainty composition data (input sample sizes) follow fishing mortality pattern.","code":"data(\"dusky_rtmb_model\") # load in dusky rtmb model for conditioning # define variables for use in setting up simulation data <- dusky_rtmb_model$data rep <- dusky_rtmb_model$rep parameters <- dusky_rtmb_model$parameters mapping <- dusky_rtmb_model$mapping sd_rep <- dusky_rtmb_model$sdrep closed_loop_yrs <- 30 # number of closed loop years to do burnin_years <- 1:length(data$years) # number of conditioning years n_sims <- 50 # number of simulations to do assess_freq <- 5 # assessments every 5 years data_yr_freq <- 5 # data year frequency  # setup simulation list to condition closed loop simulations set.seed(123) # seed for resampling sim_list <- condition_closed_loop_simulations(closed_loop_yrs = closed_loop_yrs,                                               n_sims =  n_sims,                                               data =  data,                                               parameters = parameters,                                               mapping = mapping,                                               sd_rep = sd_rep,                                               rep = rep,                                               random = NULL,                                               recruitment_opt = 'resample_from_input',                                               ISS_FishAgeComps_fill = \"F_pattern\",                                               ISS_FishLenComps_fill = \"F_pattern\",                                               )  assessment_years <- seq(sim_list$feedback_start_yr, sim_list$n_yrs, assess_freq) # assessment years years_to_use <- c(burnin_years, seq(sim_list$feedback_start_yr, sim_list$n_yrs, data_yr_freq)) # data years"},{"path":"https://chengmatt.github.io/SPoRC/articles/h_closed_loop_simulations.html","id":"define-management-options","dir":"Articles","previous_headings":"","what":"Define Management Options","title":"Run Closed Loop Simulations","text":"Following conditioning process, define reference points used set catch advice specify assumptions catch projections. Reference points based recent yearâ€™s demographic rates single-region spawning potential ratio (SPR, $F_{40%}$). Projections follow threshold harvest control rule (HCR) sets fishing mortality according stock status. Future recruitment assumed deterministic mean, projections extend assessment interval.","code":"# reference points options reference_points_opt <- list(   n_avg_yrs = 1,           # number of years over which to average demographic rates   SPR_x = 0.4,             # target spawning potential ratio   calc_rec_st_yr = 3,     # year used for recruitment in bx% calculations   rec_age = 4,             # age at recruitment   type = 'single_region',  # reference points calculated for a single region   what = \"SPR\"             # method for reference points calculation (SPR) )  # projection options proj_opt <- list(   n_proj_yrs = assess_freq + 1,  # number of years to project (assessment interval + 1)   HCR_function = function(x, frp, brp, alpha = 0.05) {     stock_status <- x / brp  # calculate stock status     # Determine fishing mortality based on stock status     if(stock_status >= 1) {       f <- frp  # full F if stock is above reference     } else if(stock_status > alpha && stock_status < 1) {       f <- frp * (stock_status - alpha) / (1 - alpha)  # scaled F if stock is between alpha and reference     } else {       f <- 0  # no fishing if stock is below threshold     }     return(f)   },   recruitment_opt = 'mean_rec',  # deterministic mean recruitment   fmort_opt = 'HCR',             # fishing mortality follows the HCR   bh_rec_opt = NULL               # no Beverton-Holt recruitment )"},{"path":"https://chengmatt.github.io/SPoRC/articles/h_closed_loop_simulations.html","id":"define-estimation-model","dir":"Articles","previous_headings":"","what":"Define Estimation Model","title":"Run Closed Loop Simulations","text":"Next, specify estimation model (EM) function uses simulated data construct SPoRC model. helper function simulation_data_to_SPoRC extracts transforms simulated data dimensions required SPoRC. Dusky rockfish, single-region model used one fishery one survey fleet. model assumes single-sex dynamics 30 ages directly fits length compositions. demographic rates fixed, consistent operational assessment, fishery survey selectivities modeled logistic. stock-recruitment relationship assumed, annual recruitment set mean value annual deviations constrained sigmaR.","code":"#' Setup Estimation Model (EM) Inputs for SPoRC #' #' Prepares the estimation model input list for a given simulation year #' and replicate within the SPoRC closed-loop simulation framework. #' #' @param sim_env Simulation environment generated by `Setup_sim_env()`. #' @param y Integer. Current simulation year index. #' @param sim Integer. Simulation replicate index. #' #' @return A fully configured EM input list suitable for fitting with `fit_model()`. setup_em <- function(sim_env, y, sim) {    # Extract simulation data for current year and replicate   sim_data <- simulation_data_to_SPoRC(sim_env, y, sim)    # Model dimensions   input_list <- Setup_Mod_Dim(years = 1:y, # vector of years                               ages = 1:sim_env$n_ages, # vector of ages                               lens = 1:sim_env$n_lens, # number of lengths                               n_regions = sim_env$n_regions, # number of regions                               n_sexes = sim_env$n_sexes, # number of sexes                               n_fish_fleets = sim_env$n_fish_fleets, # number of fishery fleet                               n_srv_fleets = sim_env$n_srv_fleets, # number of survey fleets                               verbose = F                               )    # Recruitment setup   input_list <- Setup_Mod_Rec(     input_list = input_list,     do_rec_bias_ramp = 1, # Doing bias ramp, but basically setting it so that no lognormal bias correction happens (as in the dusky model)     bias_year = rep(length(input_list$data$years), 4),     sigmaR_switch = 1, # when to switch from early to late sigmaR (switch in first year)     ln_sigmaR = rep(-0.1068576 , 2), # 2 values for early and late sigma     # Starting values for early and late sigmaR     rec_model = \"mean_rec\",     sigmaR_spec = \"fix\", # fix early sigmaR and late sigmaR     init_age_strc = 1, # geometric series to derive initial age structure     ln_global_R0 = log(2.7), # starting value for mean_rec     t_spawn = 0 # spawn timing   )    # Biological setup   input_list <- Setup_Mod_Biologicals(     input_list = input_list,     # Data inputs     WAA = sim_data$WAA,     MatAA = sim_data$MatAA,     # Model options     fit_lengths = 1,     SizeAgeTrans = sim_data$SizeAgeTrans,     AgeingError = sim_data$AgeingError,     M_spec = \"fix\",     # fixing natural mortality     Fixed_natmort = array(0.07, dim = c(input_list$data$n_regions, length(input_list$data$years),                                         length(input_list$data$ages), input_list$data$n_sexes)),     addtocomp = 0.00001   )    # Movement and tagging   input_list <- Setup_Mod_Tagging(input_list = input_list, UseTagging = 0)   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )    # Fishery catch & fishing mortality   input_list <- Setup_Mod_Catch_and_F(     input_list = input_list,     # Data inputs     ObsCatch = sim_data$ObsCatch,     Catch_Type = array(1, dim = c(length(input_list$data$years), input_list$data$n_fish_fleets)),     UseCatch = sim_data$UseCatch,     # Model options     Use_F_pen = 1,     sigmaC_spec = \"fix\",     # Fixing sigma C and F     ln_sigmaC = sim_data$ln_sigmaC,     ln_sigmaF = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, input_list$data$n_fish_fleets))   )    # Survey selectivity and catchability   input_list <- Setup_Mod_FishIdx_and_Comps(     input_list = input_list,     # Data inputs     ObsFishIdx = sim_data$ObsFishIdx,     ObsFishIdx_SE = sim_data$ObsFishIdx_SE,     UseFishIdx = sim_data$UseFishIdx,     ObsFishAgeComps = sim_data$ObsFishAgeComps,     ObsFishLenComps = sim_data$ObsFishLenComps,     UseFishAgeComps = sim_data$UseFishAgeComps,     UseFishLenComps = sim_data$UseFishLenComps,     ISS_FishAgeComps = sim_data$ISS_FishAgeComps,     ISS_FishLenComps = sim_data$ISS_FishLenComps,     # Model options     fish_idx_type = c(\"none\"),     FishAgeComps_LikeType = c(\"Multinomial\"),     FishLenComps_LikeType = c(\"Multinomial\"),     FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     FishLenComps_Type = c(\"agg_Year_1-terminal_Fleet_1\")   )    # Survey indices and compositions   input_list <- Setup_Mod_SrvIdx_and_Comps(     input_list = input_list,     # Data inputs     ObsSrvIdx = sim_data$ObsSrvIdx,     ObsSrvIdx_SE = sim_data$ObsSrvIdx_SE,     UseSrvIdx = sim_data$UseSrvIdx,     ObsSrvAgeComps = sim_data$ObsSrvAgeComps,     ObsSrvLenComps = sim_data$ObsSrvLenComps,     UseSrvAgeComps = sim_data$UseSrvAgeComps,     UseSrvLenComps = sim_data$UseSrvLenComps,     ISS_SrvAgeComps = sim_data$ISS_SrvAgeComps,     ISS_SrvLenComps = sim_data$ISS_SrvLenComps,     # Model options     srv_idx_type = c(\"biom\"),     SrvAgeComps_LikeType = c(\"Multinomial\"),     SrvLenComps_LikeType = c(\"Multinomial\"),     SrvAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     SrvLenComps_Type = c(\"agg_Year_1-terminal_Fleet_1\")   )     # Fishery selectivity and catchability   input_list <- Setup_Mod_Fishsel_and_Q(     input_list = input_list,     # Model options     fish_sel_model = c(\"logist2_Fleet_1\"), # fishery selex model     fish_fixed_sel_pars_spec = c(\"est_all\"), # whether to estiamte all fixed effects for fishery selectivity     fish_q_spec = c(\"fix\") # whether to estiamte all fixed effects for fishery catchability   )    # Survey selectivity and catchability   srv_q_prior <- data.frame(     region = 1,     block = 1,     fleet = 1,     mu = 1,     sd = 0.447213595   )    input_list <- Setup_Mod_Srvsel_and_Q(     input_list = input_list,     # Model options     srv_sel_model = c(\"logist2_Fleet_1\"), # survey selectivity form     srv_fixed_sel_pars_spec = c(\"est_all\"), # whether to estimate all fixed effects for survey selectivity     srv_q_spec = c(\"est_all\"),  # whether to estiamte all fixed effects for survey catchability     Use_srv_q_prior = 1, # Use catchability prior     srv_q_prior = srv_q_prior, # Use catchability prior     # survey timing     t_srv = array(0, dim = c(input_list$data$n_regions, input_list$data$n_srv_fleets))   )    # Data weighting   input_list <- Setup_Mod_Weighting(     input_list = input_list,     Wt_Catch = 1,     Wt_FishIdx = 1,     Wt_SrvIdx = 1,     Wt_Rec = 1,     Wt_F = 1,     Wt_Tagging = 0,     Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions,length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets)),     Wt_SrvLenComps = array(0, dim = c(input_list$data$n_regions, length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets))   )    return(input_list) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/h_closed_loop_simulations.html","id":"define-and-run-closed-loop-simulation","dir":"Articles","previous_headings":"","what":"Define and Run Closed-Loop Simulation","title":"Run Closed Loop Simulations","text":"Operating Model (OM), Estimation Model (EM), management options specified, closed-loop simulation can implemented using iterative loops. > Note: example parallelized, parallelization simulation loop (n_sims) can improve computational efficiency. simulation also wrapped single function, allows flexibility different management strategies (e.g., empirical harvest control rules, combinations empirical model-based rules, using assessment-based catch advice years empirical indicators others). simulation generally includes following components: 1. Simulation Loop Iterates simulation (sim 1:n_sims). 2. Year Loop Iterates modelled year (y 1:n_yrs). 3. Annual Dynamics Within loops, run_annual_cycle(y, sim, sim_env) updates population dynamics, natural mortality, growth, maturity, movement. 4. Management Feedback (optional) Begins specified feedback year (feedback_start_yr). years, assessments can conducted. 5. Assessment Model (optional) assessment run: - Use setup_em(sim_env, y, sim) prepare EM inputs. - Optionally exclude certain years using set_data_indicator_unused() (years still simulated run_annual_cycle). 6. Reference Points (optional) Compute reference points via get_closed_loop_reference_points(), using either EM estimates true OM values. 7. Catch Projections (optional) Project population forward determine catch advice using either true OM values EM estimates. 8. Convert Catch Advice Fishing Mortality TACs converted fishing mortality rates simulation use next year, completing feedback loop. can inspect outputs closed loop simulation. Note results now saved sim_env environment object. Plotted trajectories catch, fishing mortality, spawning stock biomass given simulation.","code":"set.seed(123) # set seed sim_env <- Setup_sim_env(sim_list) # Setup simulation environment using conditioned values  # Start Simulation for (sim in 1:sim_env$n_sims) {   for (y in 1:sim_env$n_yrs) {      # Run Annual Dynamics -----------------------------------------------------     run_annual_cycle(y, sim, sim_env)      # Start Management Feedback -----------------------------------------------     if(y >= sim_env$feedback_start_yr) {        if(y %in% assessment_years) {          dusky_input_list <- setup_em(sim_env, y, sim) # setup model EM inputs for each year          # Extract out data, parameters, and mapping         asmt_data <- dusky_input_list$data         parameters <- dusky_input_list$par         mapping <- dusky_input_list$map          # set data to 0 (assuming assessments are not conducted if no new data are availiable)         asmt_data <- set_data_indicator_unused(data = asmt_data,                                                unused_years = setdiff(1:sim_env$n_yrs, years_to_use),                                                what = c(\"FishIdx\", \"FishAgeComps\", \"SrvIdx\", \"SrvAgeComps\", \"FishLenComps\", \"SrvLenComps\"))          ### Run Assessment ----------------------------------------------------------         obj <- fit_model(asmt_data,                          parameters,                          mapping,                          random = NULL,                          newton_loops = 1,                          silent = T         )       }       if(y %in% assessment_years) {         ### Get Reference Points ----------------------------------------------------        reference_points <- get_closed_loop_reference_points(          use_true_values = FALSE,          sim_env = sim_env,          asmt_data = asmt_data,          asmt_rep = obj$rep,          y = y,          sim = sim,          reference_points_opt = reference_points_opt,          n_proj_yrs = proj_opt$n_proj_yrs        )         ### Run Projections to Determine Catch Advice ---------------------------------------------------        # Get inputs for projection        tmp_terminal_NAA <- array(obj$rep$NAA[,y,,], dim = c(asmt_data$n_regions, length(asmt_data$ages), asmt_data$n_sexes)) # terminal numbers at age        tmp_terminal_NAA0 <- array(obj$rep$NAA[,y,,], dim = c(asmt_data$n_regions, length(asmt_data$ages), asmt_data$n_sexes)) # terminal unfished numbers at age         tmp_WAA <- array(rep(asmt_data$WAA[,y,,], each = proj_opt$n_proj_yrs), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes)) # weight at age        tmp_WAA_fish <- array(rep(asmt_data$WAA_fish[,y,,,], each = proj_opt$n_proj_yrs), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes, asmt_data$n_fish_fleets)) # weight at age fishery        tmp_MatAA <- array(rep(asmt_data$MatAA[,y,,], each = proj_opt$n_proj_yrs), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes)) # maturity at age        tmp_fish_sel <- array(rep(obj$rep$fish_sel[,y,,,], each = proj_opt$n_proj_yrs), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes, asmt_data$n_fish_fleets)) # selectivity        tmp_terminal_F <- array(obj$rep$Fmort[,y,], dim = c(asmt_data$n_regions, asmt_data$n_fish_fleets)) # terminal fishing mortality        tmp_natmort <- array(rep(obj$rep$natmort[,y,,], each = proj_opt$n_proj_yrs), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes)) # natural mortality        tmp_recruitment <- array(obj$rep$Rec[,1:y], dim = c(asmt_data$n_regions, length(1:y))) # recruitment to use for projections        tmp_sexratio <- array(replicate(n = proj_opt$n_proj_yrs, obj$rep$sexratio[,y,]), dim = c(asmt_data$n_regions, proj_opt$n_proj_yrs, asmt_data$n_sexes)) # recruitment sex ratio        tmp_Movement <- array(dim = c(asmt_data$n_regions, asmt_data$n_regions, proj_opt$n_proj_yrs, length(asmt_data$ages), asmt_data$n_sexes))        for(proj_yr in 1:proj_opt$n_proj_yrs) tmp_Movement[,,proj_yr,,] <- obj$rep$Movement[,,y,,] # Movement projections         # Do projection to get TAC        proj <- Do_Population_Projection(          n_proj_yrs = proj_opt$n_proj_yrs,          n_regions = sim_env$n_regions,          n_ages = sim_env$n_ages,          n_sexes = sim_env$n_sexes,          sexratio = tmp_sexratio,          n_fish_fleets = sim_env$n_fish_fleets,          do_recruits_move = sim_env$do_recruits_move,          recruitment = tmp_recruitment,          terminal_NAA = tmp_terminal_NAA,          tmp_terminal_NAA0 = tmp_terminal_NAA0,          terminal_F = tmp_terminal_F,          natmort = tmp_natmort,          WAA = tmp_WAA,          WAA_fish = tmp_WAA_fish,          MatAA = tmp_MatAA,          fish_sel = tmp_fish_sel,          Movement = tmp_Movement,          f_ref_pt = reference_points$f_ref_pt,          b_ref_pt = reference_points$b_ref_pt,          HCR_function = proj_opt$HCR_function,          recruitment_opt = proj_opt$recruitment_opt,          fmort_opt = proj_opt$fmort_opt,          t_spawn = sim_env$t_spawn,          bh_rec_opt = proj_opt$bh_rec_opt        )         # Get TAC        tmp_TAC <- proj$proj_Catch[,-1,,drop = FALSE] # get catch advice from projected year      }        ### TAC to Fishing Mortality ------------------------------------------------       if(y < sim_env$n_yrs) {         last_assess_year <- max(assessment_years[assessment_years <= y]) # get last assessment year         tac_year_index <- y - last_assess_year + 1 # get years to index TACs         rf_grid <- expand.grid(r = seq_len(sim_env$n_regions), f = seq_len(sim_env$n_fish_fleets)) # set up region, fleet grid to bisection across         tmp_f <- mapply(function(r, f) { # do bisection to go from region and fleet specific catch to region and fleet specific F rates           bisection_F(             f_guess = 0.05, # guess for fishing mortality rate             catch = tmp_TAC[r, tac_year_index, f], # catch values to use             NAA = sim_env$NAA[r, y+1, , , sim], # numbers at age in simulation (truth)             WAA = sim_env$WAA[r, y+1, , , sim], # weight-at-age in simulation (truth)             natmort  = sim_env$natmort[r, y+1, , , sim], # natural mortality in simulation (truth)             fish_sel = sim_env$fish_sel[r, y+1, , , f, sim] # fishery selectivity in simulation (truth)           )         }, r = rf_grid$r, f = rf_grid$f)         sim_env$Fmort[,y+1,,sim] <- array(tmp_f, dim = c(sim_env$n_regions, sim_env$n_fish_fleets)) # assign bisection values back into simulation       } # end if      } # feedback year   } # end y loop } # end sim loop # Trajectories of spawning biomass reshape2::melt(sim_env$SSB) %>%   filter(value != 0) %>%   rename(Region = Var1, Year = Var2, Sim = Var3) %>%   group_by(Region, Year) %>%   summarize(median = median(value),             lwr = quantile(value, 0.025),             upr = quantile(value, 0.975)) %>%   ggplot(aes(x = Year, y = median, ymin = lwr, ymax = upr)) +   geom_line() +   geom_ribbon(alpha = 0.3) +   coord_cartesian(ylim = c(0,NA)) +   theme_bw(base_size = 15) +   labs(y = 'SSB')  # Trajectories of catches reshape2::melt(sim_env$TrueCatch) %>%   filter(value != 0) %>%   group_by(Var2, Var4, Var1) %>%   summarize(value = sum(value)) %>%   group_by(Var1, Var2) %>%   summarize(median = median(value),             lwr = quantile(value, 0.025),             upr = quantile(value, 0.975)) %>%   rename(Region = Var1, Year = Var2) %>%    ggplot(aes(x = Year, y = median, ymin = lwr, ymax = upr)) +   geom_line() +   geom_ribbon(alpha = 0.3) +   coord_cartesian(ylim = c(0,NA)) +   theme_bw(base_size = 15) +   labs(x = 'Year', y = 'Catch')  # Trajectories of fishing mortality reshape2::melt(sim_env$Fmort) %>%   filter(value != 0) %>%   group_by(Var2, Var4, Var1) %>%   summarize(value = sum(value)) %>%   group_by(Var1, Var2) %>%   summarize(median = median(value),             lwr = quantile(value, 0.025),             upr = quantile(value, 0.975)) %>%   rename(Region = Var1, Year = Var2) %>%   ggplot(aes(x = Year, y = median, ymin = lwr, ymax = upr)) +   geom_line() +   geom_ribbon(alpha = 0.3) +   coord_cartesian(ylim = c(0,NA)) +   theme_bw(base_size = 15) +   labs(y = 'Fishing Mortality', x = 'Year')"},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"reference-points","dir":"Articles","previous_headings":"","what":"Reference Points","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Deriving reference points SPoRC generally divided single-region multi-region reference points, along spawning potential ratio (SPRSPR) maximum sustainable yield (MSYMSY) reference points. following, discuss mathematical details pertaining key management quantities.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"single-region","dir":"Articles","previous_headings":"Reference Points","what":"Single Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Single-region reference points can currently derived SPRSPR reference points, estimate fishing mortality rate reduces spawning biomass per recruit (SSBPRSSBPR) x%x\\%\\ unfished level. Additionally, MSYMSY reference points based Beverton-Holt relationship, estimate fishing mortality rate maximizes long-term yield, can also derived density-dependence assumed.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"spawning-potential-ratio","dir":"Articles","previous_headings":"Reference Points > Single Region","what":"Spawning Potential Ratio","title":"Deriving Reference Points, Catch Advice, and Projections","text":"derive SPRSPR reference points, target percentage must specified, representing SSBPRSSBPR fishing relative unfished level. Following , several additional quantities needed compute reference points. include: relative fishing mortality fishery fleets (Fratf=Fmorty=ny,f/âˆ‘fFmorty=ny,fFrat_{f} = Fmort_{y = n_{y},f}/\\sum_{f}^{}{Fmort_{y = n_{y},f}}), fleet-specific fishery selectivity (Sely=y*,s,fFsh\\text{Sel}_{y = y^{*},s,f}^{\\text{Fsh}}), natural mortality females (Natmorty=y*,,s=1\\text{Natmort}_{y = y^{*},,s = 1}), spawning weight age females (Wy=y*,,s=1spawnW_{y = y^{*},,s = 1}^{spawn}), maturity age females (Maty=y*,,s=1Mat_{y = y^{*},,s = 1}), spawn timing (tspwnt^{spwn}), estimated recruitment values (Recy,s{Rec}_{y,s}), female recruitment sex ratio (Ïˆy=y*,s=1\\psi_{y = y^{*},s = 1}), recruitment age (RecAgeRecAge), first year recruitment vector (RecYearRecYear) used mean recruitment calculations. relative fishing mortality fleets, terminal year utilized calculations. contrast, estimates based user-defined period (y*y^{*}; e.g., three-year average) used natural mortality, weight age, maturity age, fleet-specific selectivity. SPRSPR\\ reference points derived initially setting numbers per-recruit female recruitment sex-ratio: Na=1fished=Ïˆy=y*,s=1N_{= 1}^{fished} = \\psi_{y = y^{*},s = 1} Na=1unfished=Ïˆy=y*,s=1N_{= 1}^{unfished} = \\psi_{y = y^{*},s = 1} Na=1fishedN_{= 1}^{fished} Na=1unfishedN_{= 1}^{unfished} fished unfished numbers age per-recruit, respectively. Subsequent numbers age per-recruit computed exponential mortality model, fished numbers age per-recruit decremented natural fishing mortality, unfished numbers age per-recruit decremented natural mortality. NafishedN_{}^{fished}, computed : Nafished={Naâˆ’1fishedâ‹…exp[âˆ’(NatMorty=y*,âˆ’1,s=1+âˆ‘fFratfâ‹…Fxâ‹…Sely=y*,âˆ’1,s=1,fFsh)]2<<+Naâˆ’1fishedâ‹…exp(âˆ’(NatMorty=y*,+âˆ’1,s=1+âˆ‘fFratfâ‹…Fxâ‹…Sely=y*,+âˆ’1,s=1,fFsh))1âˆ’exp(âˆ’(NatMorty=y*,+,s=1+âˆ‘fFratfâ‹…Fxâ‹…Sely=y*,+,s=1,fFsh))=+N_{}^{\\text{fished}} = \\left\\{ \\begin{matrix} N_{- 1}^{\\text{fished}} \\cdot \\exp\\left\\lbrack - \\left( NatMort_{y = y^{*},- 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{x} \\cdot \\text{Sel}_{y = y^{*},- 1,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack & \\text{ }2 < < a_{+} \\\\  & \\\\ N_{- 1}^{\\text{fished}} \\cdot \\frac{\\exp\\left( - \\left( NatMort_{y = y^{*},a_{+} - 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{x} \\cdot \\text{Sel}_{y = y^{*},a_{+} - 1,s = 1,f}^{\\text{Fsh}} \\right) \\right)}{1 - exp\\left( - \\left( NatMort_{y = y^{*},a_{+},s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{x} \\cdot \\text{Sel}_{y = y^{*},a_{+},s = 1,f}^{\\text{Fsh}} \\right) \\right)} & \\text{ }= a_{+} \\\\ \\end{matrix} \\right.\\ FxF_{x} represents estimated fishing mortality rate reduces SSBPRSSBPR x%x\\%, relative unfished level. Na=1unfishedN_{= 1}^{unfished}, defined : Naunfished={Naâˆ’1unfishedâ‹…exp(âˆ’NatMorty=y*,âˆ’1,s=1)2<<+Naâˆ’1unfishedâ‹…exp(âˆ’NatMorty=y*,+âˆ’1,s=1)1âˆ’exp(âˆ’NatMorty=y*,+,s=1)=+N_{}^{\\text{unfished}} = \\left\\{ \\begin{matrix} N_{- 1}^{\\text{unfished}} \\cdot exp\\left( - NatMort_{y = y^{*},- 1,s = 1} \\right) & \\text{ }2 < < a_{+} \\\\  & \\\\ N_{- 1}^{\\text{unfished}} \\cdot \\frac{\\exp\\left( - NatMort_{y = y^{*},a_{+} - 1,s = 1} \\right)}{1 - exp\\left( - NatMort_{y = y^{*},a_{+},s = 1} \\right)} & \\text{ }= a_{+} \\\\ \\end{matrix} \\right.\\ NafishedN_{}^{\\text{fished}} can converted fished SSBPRSSBPR (SSBPRfished)SS{BPR}^{\\text{fished}})\\ following equation: SSBPRfished=âˆ‘aNafishedâ‹…Wy=y*,,s=1spawnâ‹…Maty=y*,,s=1â‹…exp(âˆ’tspawnâ‹…NatMorty=y*,,s=1+âˆ‘fFratfâ‹…Fxâ‹…Sely=y*,s=1,fFsh)SS{BPR}^{\\text{fished}} = \\sum_{}^{}N_{}^{\\text{fished}} \\cdot W_{y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{y = y^{*},,s = 1} \\cdot exp\\left( - t^{spawn} \\cdot NatMort_{y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{x} \\cdot \\text{Sel}_{y = y^{*},s = 1,f}^{\\text{Fsh}} \\right) Similarly, Na=1unfishedN_{= 1}^{unfished} can converted unfished SSBPRSSBPR (SSBPRunfished)SS{BPR}^{\\text{unfished}}): SSBPRunfished=âˆ‘aNaunfishedâ‹…Wy=y*,,s=1spawnâ‹…Maty=y*,,s=1â‹…exp(âˆ’tspwnâ‹…NatMorty=y*,,s=1)SS{BPR}^{\\text{unfished}} = \\sum_{}^{}N_{}^{\\text{unfished}} \\cdot W_{y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{y = y^{*},,s = 1} \\cdot exp\\left( - t_{\\text{spwn}} \\cdot NatMort_{y = y^{*},,s = 1} \\right) SPRSPR rate can defined fraction SSBPRfishedSS{BPR}^{\\text{fished}} SSBPRunfishedSS{BPR}^{\\text{unfished}}: SPR=SSBPRfishedSSBPRunfishedSPR = \\frac{SS{BPR}^{\\text{fished}}}{SS{BPR}^{\\text{unfished}}} FxF_{x} can solved using non-linear function minimizer minimizing following criteria: Fx=argminF{100â‹…(SPR(F)âˆ’x%)2}F_{x} = arg\\min_{F}\\left\\{ 100 \\cdot \\left( \\text{SPR}(F) - \\text{x%} \\right)^{2} \\right\\} Biological SPRSPR-based reference points (BxB_{x}) can computed : Bx=SSBPRfishedâ‹…âˆ‘RecYearnyâˆ’RecAgeRecy,snyâˆ’RecAgeâˆ’RecYearB_{x} = SS{BPR}^{\\text{fished}} \\cdot \\frac{\\sum_{RecYear}^{n_{y} - RecAge}{Rec}_{y,s}}{n_{y} - RecAge - RecYear} SSBPRfishedSS{BPR}^{\\text{fished}}\\ multiplied mean recruitment user-defined period (.e., nyâˆ’RecAgeâˆ’RecYearn_{y} - RecAge - RecYear).","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"maximum-sustainable-yield-beverton-holt","dir":"Articles","previous_headings":"Reference Points > Single Region","what":"Maximum Sustainable Yield (Beverton-Holt)","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Deriving MSYMSY based reference points using Beverton-Holt stock recruitment relationship involves maximizing equilibrium yield per recruit (YPRYPR) requires several additional inputs. inputs include: relative fishing mortality fishery fleets (Fratf=Fmorty=ny,f/âˆ‘fFmorty=ny,fFrat_{f} = Fmort_{y = n_{y},f}/\\sum_{f}^{}{Fmort_{y = n_{y},f}}), fleet-specific fishery selectivity (Sely=y*,s,fFsh\\text{Sel}_{y = y^{*},s,f}^{\\text{Fsh}}), natural mortality females (Natmorty=y*,,s=1\\text{Natmort}_{y = y^{*},,s = 1}), spawning weight age females (Wy=y*,,s=1spawnW_{y = y^{*},,s = 1}^{spawn}), maturity age females (Maty=y*,,s=1Mat_{y = y^{*},,s = 1}), spawn timing (tspawn)t^{spawn}), estimated recruitment values (Recy,s{Rec}_{y,s}), female recruitment sex ratio (Ïˆy=y*,s=1\\psi_{y = y^{*},s = 1}), estimate virgin recruitment (Î¼Rec\\mu^{Rec}), estimate steepness (hh). MSYMSY reference points can derived using standard per-recruit calculations, initial number fished unfished individuals set female recruitment sex ratio: Na=1fished=Ïˆy=y*,s=1N_{= 1}^{fished} = \\psi_{y = y^{*},s = 1} Na=1unfished=Ïˆy=y*,s=1N_{= 1}^{unfished} = \\psi_{y = y^{*},s = 1} numbers--age can decremented following exponential mortality model. Na=1fishedN_{= 1}^{fished}, given : Nafished={Naâˆ’1fishedâ‹…exp[âˆ’(NatMorty=y*,âˆ’1,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,âˆ’1,s=1,fFsh)]2<<+Naâˆ’1fishedâ‹…exp(âˆ’(NatMorty=y*,+âˆ’1,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,+âˆ’1,s=1,fFsh))1âˆ’exp(âˆ’(NatMorty=y*,+,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,+,s=1,fFsh))=+N_{}^{\\text{fished}} = \\left\\{ \\begin{matrix} N_{- 1}^{\\text{fished}} \\cdot \\exp\\left\\lbrack - \\left( NatMort_{y = y^{*},- 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{msy} \\cdot \\text{Sel}_{y = y^{*},- 1,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack & \\text{ }2 < < a_{+} \\\\  & \\\\ N_{- 1}^{\\text{fished}} \\cdot \\frac{\\exp\\left( - \\left( NatMort_{y = y^{*},a_{+} - 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{msy} \\cdot \\text{Sel}_{y = y^{*},a_{+} - 1,s = 1,f}^{\\text{Fsh}} \\right) \\right)}{1 - exp\\left( - \\left( NatMort_{y = y^{*},a_{+},s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{msy} \\cdot \\text{Sel}_{y = y^{*},a_{+},s = 1,f}^{\\text{Fsh}} \\right) \\right)} & \\text{ }= a_{+} \\\\ \\end{matrix} \\right.\\ FmsyF_{msy} represents fishing mortality result equilibrium yield maximized. Na=1unfishedN_{= 1}^{unfished}, defined : Naunfished={Naâˆ’1unfishedâ‹…exp(âˆ’NatMorty=y*,âˆ’1,s=1)2<<+Naâˆ’1unfishedâ‹…exp(âˆ’NatMorty=y*,+âˆ’1,s=1)1âˆ’exp(âˆ’NatMorty=y*,+,s=1)=+N_{}^{\\text{unfished}} = \\left\\{ \\begin{matrix} N_{- 1}^{\\text{unfished}} \\cdot exp\\left( - NatMort_{y = y^{*},- 1,s = 1} \\right) & \\text{ }2 < < a_{+} \\\\  & \\\\ N_{- 1}^{\\text{unfished}} \\cdot \\frac{\\exp\\left( - NatMort_{y = y^{*},a_{+} - 1,s = 1} \\right)}{1 - exp\\left( - NatMort_{y = y^{*},a_{+},s = 1} \\right)} & \\text{ }= a_{+} \\\\ \\end{matrix} \\right.\\ YPRYPR computed using Baranovâ€™s catch equation: Ca=âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,,s=1,fFsh(NatMorty=y*,,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,,s=1,fFsh)â‹…Nafishedâ‹…(1âˆ’exp[âˆ’(NatMorty=y*,,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,,s=1,fFsh)])C_{} = \\frac{\\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{y = y^{*},,s = 1,f}^{\\text{Fsh}}}{\\left( NatMort_{y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right)} \\cdot N_{}^{\\text{fished}} \\cdot \\left( 1 - exp\\left\\lbrack - \\left( NatMort_{y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\right) CaC_{} catch--age per-recruit resulting Baranovâ€™s catch equation. Equilibrium recruitment can computed using Beverton-Holt stock recruitment relationship. Estimates equilibrium recruitment needed convert per-recruit quantities yield BmsyB_{msy} (biomass achieve MSYMSY). , first SSBPRfishedSS{BPR}^{\\text{fished}} SSBPRunfishedSS{BPR}^{\\text{unfished}}, necessary quantities Beverton-Holt stock recruitment relationship: SSBPRfished=âˆ‘aNafishedâ‹…Wy=y*,,s=1spawnâ‹…Maty=y*,,s=1â‹…exp(âˆ’tspawnâ‹…NatMorty=y*,,s=1+âˆ‘fFratfâ‹…Fmsyâ‹…Sely=y*,s=1,fFsh)SS{BPR}^{\\text{fished}} = \\sum_{}^{}N_{}^{\\text{fished}} \\cdot W_{y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{y = y^{*},,s = 1} \\cdot exp\\left( - t^{spawn} \\cdot NatMort_{y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{f} \\cdot F_{msy} \\cdot \\text{Sel}_{y = y^{*},s = 1,f}^{\\text{Fsh}} \\right) SSBPRunfished=âˆ‘aNaunfishedâ‹…Wy=y*,,s=1spawnâ‹…Maty=y*,,s=1â‹…exp(âˆ’tspwnâ‹…NatMorty=y*,,s=1)SS{BPR}^{\\text{unfished}} = \\sum_{}^{}N_{}^{\\text{unfished}} \\cdot W_{y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{y = y^{*},,s = 1} \\cdot exp\\left( - t_{\\text{spwn}} \\cdot NatMort_{y = y^{*},,s = 1} \\right) Equilibrium recruitment (EqRecEqRec) can derived following equation: EqRec=4â‹…hâ‹…Î¼Recâ‹…SSBPRfishedSSBPRunfishedâ‹…(1âˆ’h)+SSBPRfishedâ‹…(5â‹…hâˆ’1)EqRec = \\frac{4 \\cdot h \\cdot \\mu^{Rec} \\cdot SS{BPR}^{\\text{fished}}}{SS{BPR}^{\\text{unfished}} \\cdot (1 - h) + SS{BPR}^{\\text{fished}} \\cdot (5 \\cdot h - 1)} Yield BmsyB_{msy} derived multiplying YPRYPR\\ SSBPRfishedSS{BPR}^{\\text{fished}} estimate equilibrium recruitment: Yield=âˆ‘aCaâ‹…Wy=y*,,s=1spawnâ‹…EqRecYield = \\sum_{}^{}C_{} \\cdot W_{y = y^{*},,s = 1}^{spawn} \\cdot EqRec Bmsy=SSBPRfishedâ‹…EqRecB_{msy} = SS{BPR}^{\\text{fished}} \\cdot EqRec Lastly, FmsyF_{msy} solved using non-linear function minimizer minimizing following criteria (maximizing yield): Fmsy=argminFYieldF_{msy} = arg\\min_{F}\\ Yield","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"multi-region","dir":"Articles","previous_headings":"Reference Points","what":"Multi-Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"general, multi region reference points can computed similar manner single region reference points. additional complication calculating spatial reference points includes additional region subscript quantities, well potential need account movement processes.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"independent","dir":"Articles","previous_headings":"","what":"Deriving Reference Points, Catch Advice, and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"case independent spatial regions assumed (.e., movement occurs among regions), SPRSPR rates can calculated independently region, results region-specific Fr,xF_{r,x} Br,xB_{r,x} estimates. calculations derived manner computing SPRSPR rates single region case, exception additional subscript added demographic rates. Following , Fr,xF_{r,x} can solved minimizing following criteria region: Fr,x=argminFr{100â‹…(SPR(Fr)âˆ’x%)2}F_{r,x} = arg\\min_{F_{r}}\\left\\{ 100 \\cdot \\left( \\text{SPR}\\left( F_{r} \\right) - x\\%\\ \\right)^{2} \\right\\} Regional biological SPRSPR-based reference points (BxB_{x}) can derived multiplying SSBPRrfishedSS{BPR}_{r}^{\\text{fished}} regional mean recruitment user-defined period recruitment sex-ratio: Br,x=SSBPRrfishedâ‹…âˆ‘RecYearnyâˆ’RecAgeRecr,y,snyâˆ’RecAgeâˆ’RecYearB_{r,x} = SS{BPR}_{r}^{\\text{fished}} \\cdot \\frac{\\sum_{RecYear}^{n_{y} - RecAge}{Rec}_{r,y,s}}{n_{y} - RecAge - RecYear}","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"global","dir":"Articles","previous_headings":"","what":"Deriving Reference Points, Catch Advice, and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"contrast computing reference points assuming independent spatial dynamics, SPRSPR rates can also computed globally, movement occurs among regions. Given assumption global SPRSPR rates, results global FxF_{x} estimate, regional estimates Br,xB_{r,x} mean recruitment estimates defined regional scale. Thus, global SPRSPR solution results FxF_{x} reduces global SSBPRSSBPR x%x\\% unfished value, aggregate spawning biomass reaches equilibrium âˆ‘rBr,x\\sum_{r}^{}B_{r,x} applied long-term. However, solution result region equilibrating Br,xB_{r,x}. Note value FxF_{x} applied region global SPRSPR case. Deriving global SPRSPR reference points requires different set inputs. include: relative fishing mortality fishery fleets (Fratr,f=Fmortr,y=ny,f/âˆ‘fFmortr,y=ny,fFrat_{r,f} = Fmort_{r,y = n_{y},f}/\\sum_{f}^{}{Fmort_{r,y = n_{y},f}}), fleet-specific fishery selectivity (Selr,y=y*,s,fFsh\\text{Sel}_{r,y = y^{*},s,f}^{\\text{Fsh}}), natural mortality females (Natmortr,y=y*,,s=1\\text{Natmort}_{r,y = y^{*},,s = 1}), spawning weight age females (Wr,y=y*,,s=1spawnW_{r,y = y^{*},,s = 1}^{spawn}), maturity age females (Matr,y=y*,,s=1Mat_{r,y = y^{*},,s = 1}), matrix movement values (ğŒy=y*,,s=1\\mathbf{M}_{y = y^{*},\\, ,\\, s = 1}), spawn timing (tspwnt^{spwn}), estimated recruitment values (Recr,y,s{Rec}_{r,y,s}), female recruitment sex ratio (Ïˆr,y=y*,s=1\\psi_{r,y = y^{*},s = 1}), recruitment proportions (apportionment) area (Î¶r\\zeta_{r}), recruitment age (RecAgeRecAge), first year recruitment vector (RecYearRecYear) used mean recruitment calculations. Global SPRSPR reference points calculated first setting regional numbers--age per-recruit model estimated recruitment apportionment parameters (Î¶r\\zeta_{r}) multiplied recruitment sex ratio, sum 1: Nr,=1fished=Î¶râ‹…Ïˆr,y=y*,s=1N_{r,= 1}^{\\text{fished}} = \\zeta_{r} \\cdot \\psi_{r,y = y^{*},s = 1} Nr,=1unfished=Î¶râ‹…Ïˆr,y=y*,s=1N_{r,= 1}^{\\text{unfished}} = \\zeta_{r} \\cdot \\psi_{r,y = y^{*},s = 1} Nr,=1fishedN_{r,= 1}^{\\text{fished}} Nr,=1unfishedN_{r,= 1}^{\\text{unfished}} regional numbers--age per-recruit fished unfished conditions, respectively. Following initialization quantities, movement dynamics applied: ğafished=(ğafished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{}^{\\text{fished}} = \\left( \\mathbf{N}_{}^{\\text{fished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ ğaunfished=(ğaunfished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{}^{\\text{unfished}} = \\left( \\mathbf{N}_{}^{\\text{unfished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ expressions, AA denotes number modeled ages (+a_{+}) multiplied 10. example, 30 ages modeled, =300A = 300. extension enables iterative propagation plus group movement. â‰¥+\\geq a_{+}, demographic fishery quantities held constant values last modeled age (+a_{+}). Following application movement, exponential mortality model applied. Nr,afishedN_{r,}^{fished} expressed : Nr,afished=Nr,âˆ’1fishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1+âˆ‘fFratr,fâ‹…Fxâ‹…Selr,y=y*,âˆ’1,s=1,fFsh)]2<<AN_{r,}^{\\text{fished}} = {N_{r,- 1}^{fished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{x} \\cdot \\text{Sel}_{r,y = y^{*},- 1,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\\\ \\text{ }2 < < \\\\ \\end{matrix} Nr,aunfishedN_{r,}^{\\text{unfished}}, given : Nr,aunfished=Nr,âˆ’1unfishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1)],2<<AN_{r,}^{\\text{un}\\text{fished}} = {N_{r,- 1}^{unfished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} \\right) \\right\\rbrack,\\ \\ \\ \\text{ }2 < < \\\\ \\end{matrix} Regional fished unfished numbers--age per-recruit can converted SSBPR quantities. regional fished SSBPR (SSBPRrfished)SS{BPR}_{r}^{\\text{fished}}), written : SSBPRrfished=âˆ‘aNr,afishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspawnâ‹…NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fxâ‹…Selr,y=y*,s=1,fFsh)SS{BPR}_{r}^{\\text{fished}} = \\sum_{}^{}N_{r,}^{\\text{fished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t^{spawn} \\cdot NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{x} \\cdot \\text{Sel}_{r,y = y^{*},s = 1,f}^{\\text{Fsh}} \\right) Regional unfished SSBPRSSBPR (SSBPRrunfished)SS{BPR}_{r}^{\\text{unfished}}) computed similar manner: SSBPRrunfished=âˆ‘aNr,aunfishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspwnâ‹…NatMortr,y=y*,,s=1)SS{BPR}_{r}^{\\text{unfished}} = \\sum_{}^{}N_{r,}^{\\text{unfished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t_{\\text{spwn}} \\cdot NatMort_{r,y = y^{*},,s = 1} \\right) global SPRSPR rate defined : SPR=âˆ‘rSSBPRrfishedâˆ‘rSSBPRrunfishedSPR = \\frac{\\sum_{r}^{}{SS{BPR}_{r}^{\\text{fished}}}}{\\sum_{r}^{}{SS{BPR}_{r}^{\\text{unfished}}}} FxF_{x} can solved using non-linear function minimizer minimizing following criteria global SPRSPR: Fx=argminF{100â‹…(SPR(F)âˆ’x%)2}F_{x} = arg\\min_{F}\\left\\{ 100 \\cdot \\left( \\text{SPR}(F) - \\text{x%} \\right)^{2} \\right\\} Biological SPRSPR-based reference points assumed regional (Br,xB_{r,x}) derived multiplying SSBPRrfishedSS{BPR}_{r}^{\\text{fished}} regional mean recruitment user-defined period: Br,x=SSBPRrfishedâ‹…âˆ‘RecYearnyâˆ’RecAgeRecr,y,snyâˆ’RecAgeâˆ’RecYearB_{r,x} = SS{BPR}_{r}^{\\text{fished}} \\cdot \\frac{\\sum_{RecYear}^{n_{y} - RecAge}{Rec}_{r,y,s}}{n_{y} - RecAge - RecYear} Thus, global SPRSPR calculations result global FxF_{x} regional Br,xB_{r,x} estimates.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"maximum-sustainable-yield-beverton-holt-1","dir":"Articles","previous_headings":"Reference Points > Multi-Region","what":"Maximum Sustainable Yield (Beverton-Holt)","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Similar deriving spatial reference points SPRSPR rates, MSYMSY-based reference points assuming Beverton-Holt stock recruitment relationship can derived either assuming independent populations without movement global population movement processes incorporated. cases density-dependence defined locally (.e., area-specific stock-recruitment curves), local MSYMSY-based reference points can also derived (Kapur et al., 2021).","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"independent-1","dir":"Articles","previous_headings":"","what":"Deriving Reference Points, Catch Advice, and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"case independent spatial regions assumed, region-specific Fr,msyF_{r,msy} Br,msyB_{r,msy} estimates can obtained. general, calculations derived manner equations described computing MSYMSY single region case, exception demographic rates fishery selectivity additionally include region subscript. Notably, calculations, virgin recruitment considered regional compute equilibrium recruitment derived following manner: Î¼rRec=Î¼RecÎ¶r\\mu_{r}^{Rec} = \\mu^{Rec}\\zeta_{r} EqRecr=4â‹…hrâ‹…Î¼rRecâ‹…SSBPRrfishedSSBPRrunfishedâ‹…(1âˆ’hr)+SSBPRrfishedâ‹…(5â‹…hrâˆ’1){EqRec}_{r} = \\frac{4 \\cdot h_{r} \\cdot \\mu_{r}^{Rec} \\cdot SS{BPR}_{r}^{\\text{fished}}}{SS{BPR}_{r}^{\\text{unfished}} \\cdot \\left( 1 - h_{r} \\right) + SS{BPR}_{r}^{\\text{fished}} \\cdot \\left( 5 \\cdot h_{r} - 1 \\right)} Fr,msyF_{r,msy} can solved minimizing (maximizing) yield region independently: Fr,msy=argminFrYieldrF_{r,msy} = arg\\min_{F_{r}}\\ Yield_{r} Br,msyB_{r,msy} can written : Br,msy=SSBPRrfishedEqRecrB_{r,msy} = SS{BPR}_{r}^{fished}{EqRec}_{r}","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"global-1","dir":"Articles","previous_headings":"","what":"Deriving Reference Points, Catch Advice, and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"spatial context, global MSYMSY explicitly accounts movement dynamics results global FmsyF_{msy} estimate, regional estiamtes Br,msyB_{r,msy} recruitment parameters defined regionally. Thus, global MSYMSY results reference point achieves âˆ‘rBr,msy\\sum_{r}^{}B_{r,msy} entire population FmsyF_{msy} applied region, ensure region equilibrates Br,msyB_{r,msy}. following inputs required computing global MSYMSY: relative fishing mortality fishery fleets (Fratr,f=Fmortr,y=ny,f/âˆ‘fFmortr,y=ny,fFrat_{r,f} = Fmort_{r,y = n_{y},f}/\\sum_{f}^{}{Fmort_{r,y = n_{y},f}}), fleet-specific fishery selectivity (Selr,y=y*,s,fFsh\\text{Sel}_{r,y = y^{*},s,f}^{\\text{Fsh}}), natural mortality females (Natmortr,y=y*,,s=1\\text{Natmort}_{r,y = y^{*},,s = 1}), spawning weight age females (Wr,y=y*,,s=1spawnW_{r,y = y^{*},,s = 1}^{spawn}), maturity age females (Matr,y=y*,,s=1Mat_{r,y = y^{*},,s = 1}), matrix movement values (ğŒy=y*,,s=1\\mathbf{M}_{y = y^{*},\\, ,\\, s = 1}), spawn timing (tspwnt^{spwn}), female recruitment sex ratio (Ïˆr,y=y*,s=1\\psi_{r,y = y^{*},s = 1}), estimate virgin recruitment (Î¼Rec\\mu^{Rec}), global steepness value used, taken mean across regions steepness estimated regional, consistent definitions global density dependence (h=âˆ‘rhrnrh = \\frac{\\sum_{r}^{}h_{r}}{n_{r}}), recruitment proportions (apportionment) area (Î¶r\\zeta_{r}). Using standard per-recruit computations, global MSYMSY reference points calculated first setting regional numbers--age per-recruit equal estimated recruitment apportionment parameters (Î¶r\\zeta_{r}) multiplied female recruitment sex ratio, sum 1: Nr,=1fished=Î¶râ‹…Ïˆr,y=y*,s=1N_{r,= 1}^{\\text{fished}} = \\zeta_{r} \\cdot \\psi_{r,y = y^{*},s = 1} Nr,=1unfished=Î¶râ‹…Ïˆr,y=y*,s=1N_{r,= 1}^{\\text{unfished}} = \\zeta_{r} \\cdot \\psi_{r,y = y^{*},s = 1} numbers--age per-recruit quantities initialized, Markovian movement dynamics applied: ğafished=(ğafished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{}^{\\text{fished}} = \\left( \\mathbf{N}_{}^{\\text{fished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ ğaunfished=(ğaunfished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{}^{\\text{unfished}} = \\left( \\mathbf{N}_{}^{\\text{unfished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ Nr,afishedN_{r,}^{fished} can projected forward : Nr,afished=Nr,âˆ’1fishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,âˆ’1,s=1,fFsh)]2<<AN_{r,}^{\\text{fished}} = {N_{r,- 1}^{fished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{msy} \\cdot \\text{Sel}_{r,y = y^{*},- 1,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\\\ \\text{ }2 < < \\\\ \\end{matrix} Nr,aunfishedN_{r,}^{\\text{unfished}}, given : Nr,aunfished=Nr,âˆ’1unfishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1)],2<<AN_{r,}^{\\text{un}\\text{fished}} = {N_{r,- 1}^{unfished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} \\right) \\right\\rbrack,\\ \\ \\ \\text{ }2 < < \\\\ \\end{matrix} Baranovâ€™s catch equation invoked compute regional YPRYPR: Cr,=âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,,s=1,fFsh(NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,,s=1,fFsh)â‹…Nr,afishedâ‹…(1âˆ’exp[âˆ’(NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,,s=1,fFsh)])C_{r,} = \\frac{\\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}}}{\\left( NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right)} \\cdot N_{r,}^{\\text{fished}} \\cdot \\left( 1 - exp\\left\\lbrack - \\left( NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\right) Regional equilibrium recruitment computed using Beverton-Holt stock recruitment relationship. first derive quantities, regional fished unfished numbers--age per-recruit need converted SSBPR quantities. regional fished SSBPR (SSBPRrfished)SS{BPR}_{r}^{\\text{fished}}), written : SSBPRrfished=âˆ‘aNr,afishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspawnâ‹…NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,s=1,fFsh)SS{BPR}_{r}^{\\text{fished}} = \\sum_{}^{}N_{r,}^{\\text{fished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t^{spawn} \\cdot NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{msy} \\cdot \\text{Sel}_{r,y = y^{*},s = 1,f}^{\\text{Fsh}} \\right) Regional unfished SSBPRSSBPR (SSBPRrunfished)SS{BPR}_{r}^{\\text{unfished}}) computed similar manner: SSBPRrunfished=âˆ‘aNr,aunfishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspwnâ‹…NatMortr,y=y*,,s=1)SS{BPR}_{r}^{\\text{unfished}} = \\sum_{}^{}N_{r,}^{\\text{unfished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t_{\\text{spwn}} \\cdot NatMort_{r,y = y^{*},,s = 1} \\right) Calculations equilibrium recruitment follow : EqRecr=4â‹…hâ‹…Î¼RecÎ¶râ‹…âˆ‘rSSBPRrfishedâˆ‘rSSBPRrunfishedâ‹…(1âˆ’h)+âˆ‘rSSBPRrfishedâ‹…(5â‹…hâˆ’1){EqRec}_{r} = \\frac{4 \\cdot h \\cdot \\mu^{Rec}\\zeta_{r} \\cdot \\sum_{r}^{}{SS{BPR}_{r}^{\\text{fished}}}}{\\sum_{r}^{}{SS{BPR}_{r}^{\\text{un}\\text{fished}}} \\cdot (1 - h) + \\sum_{r}^{}{SS{BPR}_{r}^{\\text{fished}}} \\cdot (5 \\cdot h - 1)} Yield Br,msyB_{r,msy} calculated : Yield=âˆ‘âˆ‘rCr,â‹…Wr,y=y*,,s=1spawnâ‹…EqRecrBr,msy=SSBPRrfishedâ‹…EqRecr{Yield = \\sum_{}^{}{\\sum_{r}^{}C_{r,}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot {EqRec}_{r} }{B_{r,msy} = SS{BPR}_{r}^{\\text{fished}} \\cdot {EqRec}_{r}} FmsyF_{msy} can solved using following: Fmsy=argminFYieldF_{msy} = arg\\min_{F}\\ Yield system wide yield minimized (maximized).","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"local","dir":"Articles","previous_headings":"","what":"Deriving Reference Points, Catch Advice, and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"key challenge estimating local spatial reference points (.e., meta-population dynamics) combinations local fishing mortality rates can sometimes non-identifiable, multiple combinations local reference points can produce similar solutions. However, highlighted Kapur et al., 2021, local spatial reference points density-dependence can potentially estimated tracking area-specific yields resulting single recruit spawning area. allows yield surface defined can used compute local reference points Fr,msyF_{r,msy} Br,msyB_{r,msy}. following inputs required computing local MSYMSY: relative fishing mortality fishery fleets (Fratr,f=Fmortr,y=ny,f/âˆ‘fFmortr,y=ny,fFrat_{r,f} = Fmort_{r,y = n_{y},f}/\\sum_{f}^{}{Fmort_{r,y = n_{y},f}}), fleet-specific fishery selectivity (Selr,y=y*,s,fFsh\\text{Sel}_{r,y = y^{*},s,f}^{\\text{Fsh}}), natural mortality females (Natmortr,y=y*,,s=1\\text{Natmort}_{r,y = y^{*},,s = 1}), spawning weight age females (Wr,y=y*,,s=1spawnW_{r,y = y^{*},,s = 1}^{spawn}), maturity age females (Matr,y=y*,,s=1Mat_{r,y = y^{*},,s = 1}), matrix movement values (ğŒy=y*,,s=1\\mathbf{M}_{y = y^{*},\\, ,\\, s = 1}), spawn timing (tspwnt^{spwn}), female recruitment sex ratio (Ïˆr,y=y*,s=1\\psi_{r,y = y^{*},s = 1}), estimate global virgin recruitment (Î¼Rec\\mu^{Rec}), local steepness value used (hrh_{r}), recruitment proportions (apportionment) area (Î¶r\\zeta_{r}), partitions estimate global virgin recruitment. ensure identifiability, quantities tracked origin region (oo) destination region (rr). Using standard per-recruit calculations, region initialized one female recruit (.e., recruitment sex ratio): ,r,=1fished={Ïˆr,y=y*,s=1,ifo=r0,ifoâ‰ r,,r,=1unfished={Ïˆr,y=y*,s=1,ifo=r0,ifoâ‰ rN_{o,r,= 1}^{\\text{fished}} = \\left\\{ \\begin{matrix} \\psi_{r,y = y^{*},s = 1},\\ \\ \\  o = r \\\\ 0,\\ \\ \\  o\\  \\neq r \\\\ \\end{matrix} \\right.\\ ,\\ \\ N_{o,r,= 1}^{\\text{un}\\text{fished}} = \\left\\{ \\begin{matrix} \\psi_{r,y = y^{*},s = 1},\\ \\ \\  o = r \\\\ 0,\\ \\ \\  o\\  \\neq r \\\\ \\end{matrix} \\right.\\ Markovian movement dynamics applied: ğo,afished=(ğo,afished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{o,}^{\\text{fished}} = \\left( \\mathbf{N}_{o,}^{\\text{fished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ ğo,aunfished=(ğo,aunfished)âŠ¤ğŒy=y*,,s=1for =amin,â€¦,,amin={1if recruits move2otherwise\\mathbf{N}_{o,}^{\\text{unfished}} = \\left( \\mathbf{N}_{o,}^{\\text{unfished}} \\right)^{\\top}\\mathbf{M}_{y = y^{*},,s = 1}\\quad\\text{}= a_{\\min},\\ldots,,\\quad a_{\\min} = \\left\\{ \\begin{matrix} 1 & \\text{ recruits move} \\\\ 2 & \\text{otherwise} \\\\ \\end{matrix} \\right.\\ ,d,afishedN_{o,d,}^{fished} can projected forward : ,r,afished=,r,âˆ’1fishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1+âˆ‘fFratr,fâ‹…Fr,msyâ‹…Selr,y=y*,âˆ’1,s=1,fFsh)]2<<AN_{o,r,}^{\\text{fished}} = {N_{o,r,- 1}^{fished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{r,msy} \\cdot \\text{Sel}_{r,y = y^{*},- 1,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\\\ \\text{ }2 < < \\\\ \\end{matrix} ,r,aunfishedN_{o,r,}^{\\text{unfished}}, given : ,r,aunfished=,r,âˆ’1unfishedâ‹…exp[âˆ’(NatMortr,y=y*,âˆ’1,s=1)],2<<AN_{o,r,}^{\\text{un}\\text{fished}} = {N_{o,r,- 1}^{unfished} \\cdot exp}\\begin{matrix} \\left\\lbrack - \\left( NatMort_{r,y = y^{*},- 1,s = 1} \\right) \\right\\rbrack,\\ \\ \\ \\text{ }2 < < \\\\ \\end{matrix} Using Baranovâ€™s catch equation, area-specific YPRYPR can calculated : Co,r,=âˆ‘fFratr,fâ‹…Fr,msyâ‹…Selr,y=y*,,s=1,fFsh(NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fr,msyâ‹…Selr,y=y*,,s=1,fFsh)â‹…,r,afishedâ‹…(1âˆ’exp[âˆ’(NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,,s=1,fFsh)])C_{o,r,} = \\frac{\\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{r,msy} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}}}{\\left( NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{r,msy} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right)} \\cdot N_{o,r,}^{\\text{fished}} \\cdot \\left( 1 - exp\\left\\lbrack - \\left( NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{\\text{msy}} \\cdot \\text{Sel}_{r,y = y^{*},,s = 1,f}^{\\text{Fsh}} \\right) \\right\\rbrack \\right) Regional equilibrium recruitment destination computed solving non-linear Beverton-Holt stock-recruitment relationship ensures internal consistency. derive quantities, regional fished unfished numbers--age per-recruit converted SSBPR quantities. regional fished SSBPR (SSBPRo,rfished)SS{BPR}_{o,r}^{\\text{fished}}), written : SSBPRo,rfished=âˆ‘aNo,r,afishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspawnâ‹…NatMortr,y=y*,,s=1+âˆ‘fFratr,fâ‹…Fmsyâ‹…Selr,y=y*,s=1,fFsh)SS{BPR}_{o,r}^{\\text{fished}} = \\sum_{}^{}N_{o,r,}^{\\text{fished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t^{spawn} \\cdot NatMort_{r,y = y^{*},,s = 1} + \\sum_{f}^{}\\text{Frat}_{r,f} \\cdot F_{msy} \\cdot \\text{Sel}_{r,y = y^{*},s = 1,f}^{\\text{Fsh}} \\right) Regional unfished SSBPRSSBPR (SSBPRo,runfished)SS{BPR}_{o,r}^{\\text{unfished}}) computed similar manner: SSBPRo,runfished=âˆ‘aNo,r,aunfishedâ‹…Wr,y=y*,,s=1spawnâ‹…Matr,y=y*,,s=1â‹…exp(âˆ’tspwnâ‹…NatMortr,y=y*,,s=1)SS{BPR}_{o,r}^{\\text{unfished}} = \\sum_{}^{}N_{o,r,}^{\\text{unfished}} \\cdot W_{r,y = y^{*},,s = 1}^{spawn} \\cdot \\text{Mat}_{r,y = y^{*},,s = 1} \\cdot exp\\left( - t_{\\text{spwn}} \\cdot NatMort_{r,y = y^{*},,s = 1} \\right) Next, define components Beverton-Holt stock recruitment function: Ar=4â‹…hrâ‹…Î¶râ‹…Î¼RecA_{r} = 4 \\cdot h_{r} \\cdot \\zeta_{r} \\cdot \\mu^{Rec} Br=(1âˆ’hr)â‹…âˆ‘oSSBPRo,runfishedâ‹…Î¶râ‹…Î¼RecB_{r} = \\left( 1 - h_{r} \\right) \\cdot \\ \\sum_{o}^{}{SS{BPR}_{o,r}^{\\text{unfished}} \\cdot \\zeta_{r} \\cdot \\mu^{Rec}} Dr=5â‹…hrâˆ’1D_{r} = 5 \\cdot h_{r} - 1 Equilibrium recruitment destination region (DestEqRecr{DestEqRec}_{r}) defined function contributions origin regions (OrigEqReco{OrigEqRec}_{o}): DestEqRecr=g(OrigEqReco)=Arâ‹…EqSSBrfishedBr+Drâ‹…EqSSBrfishedEqSSBrfished=âˆ‘oSSBPRo,rfishedâ‹…OrigEqReco{{DestEqRec}_{r} = g({OrigEqRec}_{o}) = \\frac{A_{r} \\cdot EqSSB_{r}^{\\text{fished}}}{B_{r} + D_{r} \\cdot EqSSB_{r}^{\\text{fished}}} }{EqSSB_{r}^{\\text{fished}} = \\sum_{o}^{}{SS{BPR}_{o,r}^{\\text{fished}} \\cdot {OrigEqRec}_{o}}} EqSSBrfishedEqSSB_{r}^{\\text{fished}} fished equilibrium SSBSSB destination rr generated contributions origin regions. aforementioned equation non-linear system analytical solution. Thus, iterative solution obtained using Newton-Raphsonâ€™s method. Although function expressed terms destination recruitment, origin recruitment iteratively solved . Specifically, Newton-Raphsonâ€™s method adjusts OrigEqReco{OrigEqRec}_{o} contributions origins result self-consistent DestEqRecr{DestEqRec}_{r} values. Total yield (YieldYield) yield destination region (Yieldr{Yield}_{r}) defined : Yieldr=âˆ‘o(âˆ‘aCo,r,aWr,y=y*,,s=1spawn)OrigEqRecoYield=âˆ‘rYieldr{{Yield}_{r} = \\sum_{o}^{}{\\left( \\sum_{}^{}{C_{o,r,}W_{r,y = y^{*},,s = 1}^{spawn}} \\right){OrigEqRec}_{o}} }{Yield = \\sum_{r}^{}{Yield}_{r}} Br,msy=âˆ‘oSSBPRo,rfishedâ‹…OrigEqRecoB_{r,msy} = \\sum_{o}^{}{SS{BPR}_{o,r}^{\\text{fished}} \\cdot {OrigEqRec}_{o}} Lastly, regional estimates Fr,msyF_{r,msy} solved minimizing total yield: Fr,msy=argminFr,msyYieldF_{r,msy} = \\arg\\min_{F_{r,msy}}\\ Yield system wide yield minimized (maximized).","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"deriving-catch-advice-and-projections","dir":"Articles","previous_headings":"","what":"Deriving Catch Advice and Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"core part assessment process convert reference point estimates catch advice. following sections, mathematically describe catch advice derived, proceed provide code examples demonstration. conduct projection terminal year, users must define following quantities: Terminal year estimates numbers--age, user defined period recruitment values use, user defined period weight--age values use projections, user defined period natural mortality-atage values use projections, user defined period maturity--age values use projections, user defined period fishery selectivity values use projections, user defined period movement values use projections, Terminal year estimates fishing mortality, Fishing mortality rate use decrement population, Optionally, users can define: Biological reference points use project fishing mortality subsequent years, harvest control rule utilized, function describing harvest control rule. first year projection period, projected fishing mortality determined estimates fishing mortality terminal year assessment: projFr,y=âˆ‘fFmortr,y=term,f projF_{r,y} = \\sum_f Fmort_{r,y = term,f} Total mortality can computed : Fr,y,,s,f=projFr,yâ‹…Fratr,fâ‹…Selr,y,,s,fFsh F_{r,y,,s,f} = projF_{r,y} \\cdot Frat_{r,f} \\cdot Sel^{Fsh}_{r,y,,s,f} Zr,y,,s,f=âˆ‘fFr,y,,s,f+NatMortr,y,,s Z_{r,y,,s,f} = \\sum_f F_{r,y,,s,f} + NatMort_{r,y,,s} Similarly, projected numbers age first year utilizes estimates numbers age terminal year assessment, movement already applied. exponential mortality model used determine numbers age next year (y+1y+1): projNr,y,,s=Nr,y=term,,s projN_{r,y,,s} = N_{r,y = term,,s} projNr,y+1,+1,s=projNr,y,,sexp(âˆ’Zr,y,,s),1â‰¤<+projNr,y+1,,s=projNr,y,âˆ’1,sexp(âˆ’Zr,y,âˆ’1,s)+projNr,y,,sexp(âˆ’Zr,y,,s),=+ \\begin{aligned} projN_{r,y+1,+1,s} = projN_{r,y,,s}\\exp(-Z_{r,y,,s}), \\quad \\text{} 1 \\leq < a_+ \\\\ projN_{r,y+1,,s} = projN_{r,y,-1,s}\\exp(-Z_{r,y,-1,s}) + projN_{r,y,,s}\\exp(-Z_{r,y,,s}), \\quad \\text{} = a_+ \\end{aligned} Quantities spawning stock biomass can computed : projSSBr,y=âˆ‘aa+projNr,y,,s=1Wr,y,,s=1Matr,y,,s=1 projSSB_{r,y} = \\sum_a^{+} projN_{r,y,,s=1}W_{r,y,,s=1}Mat_{r,y,,s=1} Additionally, quantities projected catch can derived using Baranovâ€™s catch equation: projCr,y,,s,fa=Fmortr,y,fSelr,y,,s,fFshZr,y,,sprojNr,y,,s[1âˆ’exp(âˆ’Zr,y,,s)] projC^a_{r,y,,s,f} = \\frac{Fmort_{r,y,f}Sel^{Fsh}_{r,y,,s,f}}{Z_{r,y,,s}} projN_{r,y,,s} \\left[1-\\exp(-Z_{r,y,,s})\\right] projCatchr,y,f=âˆ‘aa+âˆ‘snsprojCr,y,,s,faWr,y,,s projCatch_{r,y,f} = \\sum_a^{a_+} \\sum_s^{n_s} projC^a_{r,y,,s,f} W_{r,y,,s} Fishing mortality next year can projected forward using either harvest control rule, projected forward using user inputs: projFr,y+1={f(SSBr,y;BRPr,y;FRPr,y)using HCRf(Finputr,y)using user defined fishing mortality rate projF_{r,y+1} =  \\begin{cases} f(SSB_{r,y}; BRP_{r,y}; FRP_{r,y}) & \\text{using HCR}  \\\\  f(Finput_{r,y}) & \\text{using user defined fishing mortality rate}  \\end{cases} f()f() harvest control function takes inputs SSBSSB, BRPBRP (biological reference points), FRPFRP (fishery reference point). Alternatively, f()f() can user defined matrix fishing mortality rates use projection period across regions. Projected fishing mortality summed natural mortaltiy compute projected total mortality given projection year. Recruitment dynamics projected year following initial projection year. particular, several recruitment projection options availiable. include deterministic predictions well ability incorporate stochasticity recruitment projections. particular, deterministic recruitment option projected forward zero: projNr,y,1,s=0,y > 1 projN_{r,y,1,s} = 0, \\text{y > 1} recruitment occurs. Deterministic recruitment can also projected forward using mean recruitment (mean_rec) matrix estimated recruitment values assessment model supplied user: projNr,y,1,s=âˆ‘yRecr,yn,y > 1 projN_{r,y,1,s} = \\frac{\\sum_y Rec_{r,y}}{n}, \\text{y > 1} Alternatively, users can also specify Beverton-Holt stock recruitment function (bh_rec) used deterministic recruitment projection, requires users supply necessary parameter inputs. case local recruitment specified, computed (.e., metapopulation dynamics): projNr,y,1,s=4â‹…hrâ‹…Rr,0â‹…projSSBrSSBrunfishedâ‹…(1âˆ’hr)+projSSBrâ‹…(5â‹…hrâˆ’1) projN_{r,y,1,s} = \\frac{4\\cdot h_r \\cdot R_{r,0} \\cdot projSSB_r}{SSB_r^{\\text{unfished}} \\cdot (1 - h_r) + projSSB_r \\cdot (5 \\cdot h_r - 1)} contrast, global recruitment specified, computed : projNr,y,1,s=(4â‹…hâ‹…R0â‹…âˆ‘rprojSSBrâˆ‘rSSBrunfishedâ‹…(1âˆ’h)+âˆ‘rprojSSBrâ‹…(5â‹…hâˆ’1))Î¶r projN_{r,y,1,s} = \\left( \\frac{4\\cdot h \\cdot R_{0} \\cdot \\sum_r projSSB_r}{\\sum_r SSB_r^{\\text{unfished}} \\cdot (1 - h) + \\sum_r projSSB_r \\cdot (5 \\cdot h - 1)} \\right) \\zeta_r density-dependence occurs globally, recruitment apportionment parameter utilized partition global recruits given year. Lastly, users can specify recruitment projections stochastic, wherein inverse Gaussian (inv_gauss) distribution parameterized based estimated recruitment values assessment model utilized project recruitment future: AMeanRecr=1Yâˆ‘y=avgYRecr,y \\text{AMeanRec}_r = \\frac{1}{Y} \\sum_{y = avg}^{Y} \\text{Rec}_{r,y} HMeanRecr=(1Yâˆ‘y=avgY1Recr,y)âˆ’1 \\text{HMeanRec}_r = \\left( \\frac{1}{Y} \\sum_{y = avg}^{Y} \\frac{1}{\\text{Rec}_{r,y}} \\right)^{-1} Î³r=AMeanRecrHMeanRecr \\gamma_r = \\frac{\\text{AMeanRec}_r}{\\text{HMeanRec}_r} Î²r=AMeanRecr \\beta_r = \\text{AMeanRec}_r Î´r=1Î³râˆ’1 \\delta_r = \\frac{1}{\\gamma_r - 1} CVRecr=1Î´r \\text{CVRec}_r = \\sqrt{ \\frac{1}{\\delta_r} } year random draw made standard normal distribution, transformed: Ïˆy=By2,âˆ¼N(0,1)     \\psi_y = B_y^2, \\quad \\text{} B_y \\sim N(0,1) Ï‰r,y=Î²r(1+Ïˆyâˆ’4Î´rÏˆy+Ïˆy22Î´r)   \\omega_{r,y} = \\beta_r \\left( 1 + \\frac{\\psi_y - \\sqrt{4 \\delta_r \\psi_y + \\psi_y^2}}{2 \\delta_r} \\right) Î¶r,y=Î²r(1+Ïˆy+4Î´rÏˆy+Ïˆy22Î´r)   \\zeta_{r,y} = \\beta_r \\left( 1 + \\frac{\\psi_y + \\sqrt{4 \\delta_r \\psi_y + \\psi_y^2}}{2 \\delta_r} \\right) Î¸r,y=Î²rÎ²r+Ï‰r,  \\theta_{r,y} = \\frac{\\beta_r}{\\beta_r + \\omega_{r,}} , draw conducted âˆ¼U(0,1)\\sim U(0,1), simulated recruitment defined : Recr,ysim={Ï‰r,y,Uyâ‰¤Î¸r,yÎ¶r,y,otherwise   \\text{Rec}_{r,y}^{\\text{sim}} =     \\begin{cases}   \\omega_{r,y}, & \\text{} U_y \\leq \\theta_{r,y} \\\\   \\zeta_{r,y}, & \\text{otherwise}   \\end{cases} Thus, inverse gaussian mixture ensures simulated values approximately correct mean variability based historical recruitment values. recruitment processes occur, usual dynamics applied project population forward. , movement individuals first occurs: ğ©ğ«ğ¨ğ£ğa=(ğ©ğ«ğ¨ğ£ğa)âŠ¤ğŒy,,sfor =amin,â€¦,,amin={1if recruits move2otherwise \\boldsymbol{projN}_a^ = (\\boldsymbol{projN}_a)^\\top \\boldsymbol{M}_{y, , s} \\quad \\text{} = a_{\\min}, \\dots, , \\quad a_{\\min} =  \\begin{cases}  1 & \\text{recruits move} \\\\ 2 & \\text{otherwise} \\end{cases} Following movement, applied projected years y>1y > 1, already accounted terminal year estimates numbers age, exponential mortality model applied. Projected spawning stock biomass catch derived. Fishing mortality subsequent years updated accordingly. sequence steps repeated specified number projection years reached. Thus, catch advice year following terminal assessment year corresponds projected catch projection year 2 (.e., projCatchr,y=2,fprojCatch_{r, y = 2, f}).","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"code-demonstration","dir":"Articles","previous_headings":"","what":"Code Demonstration","title":"Deriving Reference Points, Catch Advice, and Projections","text":"subsequent sections, demonstrate reference points, catch projections, catch advice, stochastic projections can derived conducted using SPoRC. features rely users report file SPoRC model, generally coded way flexibility users define projections done.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"single-region-1","dir":"Articles","previous_headings":"Code Demonstration > Getting Reference Points","what":"Single Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"illustrate reference points derived, begin extracting report file single-region sablefish case study (sgl_rg_sable_rep). call Get_Reference_Points function calculate reference points. example , estimate F40F_{40} B40B_{40} values single-region context. requires passing sablefish data file (sgl_reg_sable_data) data argument, report file rep argument, setting SPR rate (SPR_x) 0.4. also specify reference point SPR-based pertains single region. Additional inputs include first year recruitment used calculating B40B_{40}, recruitment age (excludes last rec_age years computing mean), timing spawning, sex ratio used B40B_{40} calculation. Note sablefish example utilize stock recruitment relationship. However, Beverton-Holt stock recruitment relationship utilized users want estimate MSY-based reference points, can derived setting = 'BH_MSY'. Note sablefish example utilize stock recruitment relationship. However, Beverton-Holt stock recruitment relationship utilized users want estimate MSY-based reference points, can derived setting = 'BH_MSY'.","code":"data(\"sgl_rg_sable_rep\") # read in single region report data(\"sgl_rg_sable_data\") # read in single region data   # single area model sgl_ref_pt <- SPoRC::Get_Reference_Points(data = sgl_rg_sable_data, # data file                                           rep = sgl_rg_sable_rep, # report file                                           SPR_x = 0.4, # spr rate                                           type = 'single_region', # single region reference point                                           what = 'SPR', # SPR reference point                                           calc_rec_st_yr = 20, # first year to calculate mean recruitment                                           rec_age = 2,  # exclues the last rec_age years when computing mean recruitment                                           t_spwn = 0,  # spawn timing                                           sex_ratio_f = 0.5 # recruitment sex-ratio for females                                           ) sgl_ref_pt$f_ref_pt # F40 #> [1] 0.0862704 sgl_ref_pt$b_ref_pt # B40 #> [1] 121.3337"},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"multi-region-1","dir":"Articles","previous_headings":"Code Demonstration > Getting Reference Points","what":"Multi Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"following, demonstrate spatial reference points can derived. general, similar single region case, except spatial model associated report files needed (report file needs spatially-explicit). , use five-region sablefish case study example, estimate independent SPR rates global SPR rates. contrast single region case, type now need specified multi_region. Additionally, independent SPR rates movement dynamics ignored, now set independent_SPR. arguments defined example . Given treated independent populations, fishery reference points biological reference points region-specific can applied accordingly. contrast, users can also specify global SPR rates. involves simply changing argument global_SPR, results single F40F_{40} estimated, region-specific Br,40B_{r,40} given regional estimates recruitment utilized. Note F40F_{40} outputs 5 values 5 regions modelled case study, values identical. Similarly, MSY-based reference points assuming Beverton-Holt stock recruitment function can specified well. can easily specified involves either assuming independent populations (= 'independent_BH_MSY') population global density dependence (= 'global_BH_MSY').","code":"data(\"mlt_rg_sable_rep\") # read in multi region report data(\"mlt_rg_sable_data\") # read in multi region data   # multi region model with independent SPR mlt_ref_pt_indp <- Get_Reference_Points(data = mlt_rg_sable_data, # data file                                           rep = mlt_rg_sable_rep, # report file                                           SPR_x = 0.4, # spr rate                                           type = 'multi_region', # multi region reference point                                           what = 'local_BH_MSY', # SPR reference point                                           calc_rec_st_yr = 20, # first year to calculate mean recruitment                                           rec_age = 2,  # exclues the last rec_age years when computing mean recruitment                                           t_spwn = 0,  # spawn timing                                           sex_ratio_f = rep(0.5, mlt_rg_sable_data$n_regions) # recruitment sex-ratio for females                                           ) mlt_ref_pt_indp$f_ref_pt # F40 #> [1] 3.130855e-11 6.458127e-11 1.995563e-10 5.331961e-02 5.084283e-01 mlt_ref_pt_indp$b_ref_pt # B40 #> [1]  7.151436 11.849269  7.196475 31.966677 14.831938 data(\"mlt_rg_sable_rep\") # read in multi region report data(\"mlt_rg_sable_data\") # read in multi region data   # multi region model with global SPR mlt_ref_pt_global <- SPoRC::Get_Reference_Points(data = mlt_rg_sable_data, # data file                                                  rep = mlt_rg_sable_rep, # report file                                                  SPR_x = 0.4, # spr rate                                                  type = 'multi_region', # multi region reference point                                                  what = 'global_SPR', # SPR reference point                                                  calc_rec_st_yr = 20, # first year to calculate mean recruitment                                                  rec_age = 2,  # exclues the last rec_age years when computing mean recruitment                                                  t_spwn = 0,  # spawn timing                                                  sex_ratio_f = rep(0.5, mlt_rg_sable_data$n_regions) # recruitment sex-ratio for females                                                  ) mlt_ref_pt_global$f_ref_pt # F40 #> [1] 0.07997828 0.07997828 0.07997828 0.07997828 0.07997828 mlt_ref_pt_global$b_ref_pt # B40 #> [1] 31.46321 24.63865 20.11382 33.32957 13.30036"},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"single-region-2","dir":"Articles","previous_headings":"Code Demonstration > Conducting Catch Projections to Derive Catch Advice (Deterministic Recruitment)","what":"Single Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Next, using reference points derived single region case study, can conduct population catch projections derive catch advice. Note require users data file extract relevant demographic rates data components, well report file extract necessary estimates conduct projections. Let us first define threshold harvest control rule utilize population projections, although note strictly necessary.  can define inputs needed run population projection: Note projections, demographic rates (e.g., weight--age, movement, maturity) use estimates terminal year assessment. However, required - users may instead define demographic rates projection period using approaches (e.g., averages last 5 years). Regardless approach, rates must provided user format dimensions described . population projection can conducted Do_Population_Projection function: outputted object function includes projected fishing mortality rates, projected catch (.e., catch advice), projected spawning stock biomass, projected numbers age, projected total mortality age. can plot quantities . example , show projected SSB:  well projected catches, can basis management advice:  Importantly, catch advice based terminal year+1 rather first projection year, since first projection year serves initialization step projection.","code":"# Define HCR to use HCR_function <- function(x, frp, brp, alpha = 0.05) {   stock_status <- x / brp # define stock status   # If stock status is > 1   if(stock_status >= 1) f <- frp   # If stock status is between brp and alpha   if(stock_status > alpha && stock_status < 1) f <- frp * (stock_status - alpha) / (1 - alpha)   # If stock status is less than alpha   if(stock_status < alpha) f <- 0   return(f) }  # Create a tibble for plotting hcr_df <- tibble(   i = 1:200,   SSB_B40 = i / sgl_ref_pt$b_ref_pt,   F = sapply(i, function(x) {     HCR_function(x = x, frp = sgl_ref_pt$f_ref_pt, brp = sgl_ref_pt$b_ref_pt)   }) )  # Plot ggplot(hcr_df, aes(x = SSB_B40, y = F)) +   geom_line(color = \"steelblue\", size = 1) +   labs(x = \"SSB / B40\", y = \"F\") +   theme_bw(base_size = 13) data(\"sgl_rg_sable_rep\") # read in single region report data(\"sgl_rg_sable_data\") # read in single region data   # Setup necessary inputs t_spawn <- 0 # spawn timing n_proj_yrs <- 15 # number of projection years n_regions <- 1 # number of regions n_ages <- length(sgl_rg_sable_data$ages) # number of ages n_sexes <- sgl_rg_sable_data$n_sexes # number of sexes n_fish_fleets <- sgl_rg_sable_data$n_fish_fleets # number of fishery fleets do_recruits_move <- 0 # recruits don't move terminal_NAA <- array(sgl_rg_sable_rep$NAA[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age terminal_NAA0 <- array(sgl_rg_sable_rep$NAA0[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age WAA <- array(rep(sgl_rg_sable_data$WAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # weight at age WAA_fish <- array(rep(sgl_rg_sable_data$WAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # weight at age for fishery MatAA <- array(rep(sgl_rg_sable_data$MatAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # maturity at age fish_sel <- array(rep(sgl_rg_sable_rep$fish_sel[,length(sgl_rg_sable_data$years),,,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # selectivity Movement <- array(rep(sgl_rg_sable_rep$Movement[,,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_regions, n_proj_yrs, n_ages, n_sexes)) # movement terminal_F <- array(sgl_rg_sable_rep$Fmort[,length(sgl_rg_sable_data$years),], dim = c(n_regions, n_fish_fleets)) # terminal F natmort <- array(sgl_rg_sable_rep$natmort[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # natural mortality recruitment <- array(sgl_rg_sable_rep$Rec[,20:(length(sgl_rg_sable_data$years) - 2)], dim = c(n_regions, length(20:length(sgl_rg_sable_data$years) - 2))) # recruitment values to use for mean recruitment calculations or inverse gaussian parameterization sexratio <- array(0.5, dim = c(n_regions, n_proj_yrs, n_sexes)) # recruitment sex ratio   # Define reference points to use in HCR f_ref_pt = array(sgl_ref_pt$f_ref_pt, dim = c(n_regions, n_proj_yrs)) b_ref_pt = array(sgl_ref_pt$b_ref_pt, dim = c(n_regions, n_proj_yrs)) # do population projection out <- Do_Population_Projection(n_proj_yrs = n_proj_yrs, # Number of projection years                                n_regions = n_regions, # number of regions                                n_ages = n_ages, # number of ages                                n_sexes = n_sexes, # number of sexes                                sexratio = sexratio, # sex ratio for recruitment                                n_fish_fleets = n_fish_fleets, # number of fishery fleets                                do_recruits_move = do_recruits_move, # whether recruits move (not used since single area)                                recruitment = recruitment, # recruitment values to use for mean recruitment                                 terminal_NAA = terminal_NAA, # terminal numbers at age                                terminal_NAA0 = terminal_NAA0,                                 terminal_F = terminal_F, # terminal F                                natmort = natmort, # natural mortality values to use in projection                                WAA = WAA, # weight at age values to use in projection spawning                                WAA_fish = WAA_fish, # weight at age values to use in projection fishery                                MatAA = MatAA, # maturity at age values to use in projection                                fish_sel = fish_sel, # fishery selectivity values to use in projection                                Movement = Movement, # movement values (not used since single area)                                f_ref_pt = f_ref_pt, # fishery reference points (f40)                                b_ref_pt = b_ref_pt, # biological reference points (b40)                                HCR_function = HCR_function, # threshold control rule defined above                                recruitment_opt = \"mean_rec\", # recruitment assumption utilizes the mean recruits for the supplied recruitment estimates                                fmort_opt = \"HCR\", # Fishing mortality in projection years are determined using a HCR                                t_spawn = t_spawn # Spawn timing                                ) combined_ssb <- c(sgl_rg_sable_rep$SSB[1, -65], out$proj_SSB[1,]) # removing terminal year becauase repeated in projection calculations years <- 1960:(2023 + n_proj_yrs)  ssb_df <- tibble(   Year = years,   SSB = combined_ssb )  # Plot ggplot(ssb_df, aes(x = Year, y = SSB)) +   geom_line(size = 1) +   geom_vline(xintercept = 2024, linetype = \"dashed\") + # projection start   scale_y_continuous(limits = c(0, 300)) +   labs(x = \"Year\", y = \"SSB (kt)\") +   theme_bw(base_size = 13) combined_catch <- c(   rowSums(sgl_rg_sable_rep$PredCatch[1, -65, ]), # removing terminal year becauase repeated in projection calculations   rowSums(out$proj_Catch[1, , ]) )  years <- 1960:(2023 + n_proj_yrs)  catch_df <- tibble(   Year = years,   Catch = combined_catch )  # Plot ggplot(catch_df, aes(x = Year, y = Catch)) +   geom_line(size = 1) +   geom_vline(xintercept = 2024, linetype = \"dashed\") +  # projection start   labs(x = \"Year\", y = \"Catch (kt)\") +   theme_bw(base_size = 13) sum(out$proj_Catch[1,2,]) # Catch advice in terminal year + 1"},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"multi-region-2","dir":"Articles","previous_headings":"Code Demonstration > Conducting Catch Projections to Derive Catch Advice (Deterministic Recruitment)","what":"Multi Region","title":"Deriving Reference Points, Catch Advice, and Projections","text":"following, demonstrate catch projections can conducted multi-region context, using independent SPR rates, region-specific estimates Fr,40F_{r,40} Br,40B_{r,40}. general, steps similar single-region case. , utilize harvest control rule function defined . Given region unique estimates, result different harvest control rules applied region:  Letâ€™s define inputs needed run population projection: global reference points (SPR MSY-based) used, fishing mortality (FF) applied across regions single global FF estimated. illustrated : contrast, independent SPR approach assigns region-specific FF value. example, first projection year: projections follow, use independent SPR rates allow region-specific reference points: , can visualize projections look like terms SSB catch advice:","code":"# Define HCR to use HCR_function <- function(x, frp, brp, alpha = 0.05) {   stock_status <- x / brp # define stock status   # If stock status is > 1   if(stock_status >= 1) f <- frp   # If stock status is between brp and alpha   if(stock_status > alpha && stock_status < 1) f <- frp * (stock_status - alpha) / (1 - alpha)   # If stock status is less than alpha   if(stock_status < alpha) f <- 0   return(f) }  # Build a dataframe by looping over j and i scalars hcr_df <- expand.grid(   j = 1:5,   i = 1:50 ) %>%   mutate(     frp = mapply(function(j) mlt_ref_pt_indp$f_ref_pt[j], j),     brp = mapply(function(j) mlt_ref_pt_indp$b_ref_pt[j], j),     F = mapply(function(i, j) {       HCR_function(x = i, frp = mlt_ref_pt_indp$f_ref_pt[j], brp = mlt_ref_pt_indp$b_ref_pt[j])     }, i, j),     SSB_B40 = i / brp   )  ggplot(hcr_df, aes(x = SSB_B40, y = F, color = factor(j))) +   geom_line(lwd = 1.3) +   facet_wrap(~j, scales = 'free') +   labs(x = \"SSB / B40\", y = \"F\",  color = 'Region') +   theme_bw(base_size = 13) +   theme(legend.position = 'none') data(\"mlt_rg_sable_rep\") # read in multi region report data(\"mlt_rg_sable_data\") # read in multi region data   # Setup necessary inputs t_spawn <- 0 # spawn timing n_proj_yrs <- 15 # number of projection years n_regions <- 5 # number of regions n_ages <- length(mlt_rg_sable_data$ages) # number of ages n_sexes <- mlt_rg_sable_data$n_sexes # number of sexes n_fish_fleets <- mlt_rg_sable_data$n_fish_fleets # number of fishery fleets do_recruits_move <- 0 # recruits don't move terminal_NAA <- array(mlt_rg_sable_rep$NAA[,length(mlt_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age terminal_NAA0 <- array(mlt_rg_sable_rep$NAA0[,length(mlt_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age WAA <- array(rep(mlt_rg_sable_data$WAA[,length(mlt_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # weight at age WAA_fish <- array(rep(mlt_rg_sable_data$WAA[,length(mlt_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # weight at age MatAA <- array(rep(mlt_rg_sable_data$MatAA[,length(mlt_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # maturity at age fish_sel <- array(rep(mlt_rg_sable_rep$fish_sel[,length(mlt_rg_sable_data$years),,,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # selectivity Movement <- aperm(abind::abind(replicate(n_proj_yrs, mlt_rg_sable_rep$Movement[,,length(mlt_rg_sable_data$years),,], simplify = FALSE), along = 5), perm = c(1,2,5,3,4)) # movement terminal_F <- array(mlt_rg_sable_rep$Fmort[,length(mlt_rg_sable_data$years),], dim = c(n_regions, n_fish_fleets)) # terminal F natmort <- array(mlt_rg_sable_rep$natmort[,length(mlt_rg_sable_data$years),,], dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # natural mortality recruitment <- array(mlt_rg_sable_rep$Rec[,20:(length(mlt_rg_sable_data$years) - 2)], dim = c(n_regions, length(20:length(mlt_rg_sable_data$years) - 2))) # recruitment values to use for mean recruitment calculations or inverse gaussian parameterization sexratio <- array(0.5, dim = c(n_regions, n_proj_yrs, n_sexes)) # recruitment sex ratio   # Define independent SPR reference points to use in HCR f_ref_pt_indp = array(mlt_ref_pt_indp$f_ref_pt, dim = c(n_regions, n_proj_yrs)) b_ref_pt_indp = array(mlt_ref_pt_indp$b_ref_pt, dim = c(n_regions, n_proj_yrs)) f_ref_pt_global = array(mlt_ref_pt_global$f_ref_pt, dim = c(n_regions, n_proj_yrs)) b_ref_pt_global = array(mlt_ref_pt_global$b_ref_pt, dim = c(n_regions, n_proj_yrs)) # F40 f_ref_pt_indp[,2] # independent SPR #> [1] 3.130855e-11 6.458127e-11 1.995563e-10 5.331961e-02 5.084283e-01 f_ref_pt_global[,2] # global SPR #> [1] 0.07997828 0.07997828 0.07997828 0.07997828 0.07997828  # b40 b_ref_pt_indp[,2] # independent SPR #> [1]  7.151436 11.849269  7.196475 31.966677 14.831938 b_ref_pt_global[,2] # global SPR #> [1] 31.46321 24.63865 20.11382 33.32957 13.30036 # do population projection out <- Do_Population_Projection(n_proj_yrs = n_proj_yrs, # Number of projection years                               n_regions = n_regions, # number of regions                               n_ages = n_ages, # number of ages                               n_sexes = n_sexes, # number of sexes                               sexratio = sexratio, # sex ratio for recruitment                               n_fish_fleets = n_fish_fleets, # number of fishery fleets                               do_recruits_move = do_recruits_move, # whether recruits move (not used since single area)                               recruitment = recruitment, # recruitment values to use for mean recruitment                                terminal_NAA = terminal_NAA, # terminal numbers at age                               terminal_NAA0 = terminal_NAA0,                               terminal_F = terminal_F, # terminal F                               natmort = natmort, # natural mortality values to use in projection                               WAA = WAA, # weight at age values to use in projection spawning                               WAA_fish = WAA_fish, # weight at age values to use in projection fishery                               MatAA = MatAA, # maturity at age values to use in projection                               fish_sel = fish_sel, # fishery selectivity values to use in projection                               Movement = Movement, # movement values (not used since single area)                               f_ref_pt = f_ref_pt_indp, # fishery reference points (f40)                               b_ref_pt = b_ref_pt_indp, # biological reference points (b40)                               HCR_function = HCR_function, # threshold control rule defined above                               recruitment_opt = \"mean_rec\", # recruitment assumption utilizes the mean recruits for the supplied recruitment estimates                               fmort_opt = \"HCR\", # Fishing mortality in projection years are determined using a HCR                               t_spawn = t_spawn # Spawn timing                               ) combined_ssb <- cbind(mlt_rg_sable_rep$SSB[,-62], out$proj_SSB[,]) # removing terminal year becauase repeated in projection calculations combined_ssb_df <- reshape2::melt(combined_ssb) %>%    rename(Region = Var1, Year = Var2, SSB = value)  # Plot ggplot(combined_ssb_df, aes(x = Year + 1959, y = SSB, color = factor(Region))) +   geom_line(size = 1) +   geom_vline(xintercept = 2021, linetype = \"dashed\") + # projection start   facet_wrap(~Region) +   scale_y_continuous(limits = c(0, NA)) +   labs(x = \"Year\", y = \"SSB (kt)\") +   theme_bw(base_size = 13) +   theme(legend.position = 'none') combined_catch <- cbind(apply(mlt_rg_sable_rep$PredCatch, c(1,2), sum), apply(out$proj_Catch, c(1,2), sum)) combined_catch_df <- reshape2::melt(combined_catch) %>%    rename(Region = Var1, Year = Var2, Catch = value)  # Plot ggplot(combined_catch_df, aes(x = Year + 1959, y = Catch, color = factor(Region))) +   geom_line(size = 1) +   geom_vline(xintercept = 2021, linetype = \"dashed\") + # projection start   facet_wrap(~Region) +   scale_y_continuous(limits = c(0, NA)) +   labs(x = \"Year\", y = \"Catch\") +   theme_bw(base_size = 13) +   theme(legend.position = 'none')  rowSums(out$proj_Catch[,2,]) # Catch advice by region in terminal year + 1"},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"conducting-stochastic-population-projections","dir":"Articles","previous_headings":"Code Demonstration","what":"Conducting Stochastic Population Projections","title":"Deriving Reference Points, Catch Advice, and Projections","text":"final section vignette, demonstrate conduct stochastic population projections. simplicity, focus single-region case, though approach extends similarly multi-region scenarios. Stochastic projections follow general structure deterministic ones, key difference recruitment_opt = 'inv_gaussâ€™ specified introduce variability recruitment. demonstration purposes, set following projection scenarios, include: Using F40F_{40} projections, HCR applied adjust F40F_{40} projection year, Using F=0F = 0 projections. Let us first redefine single region inputs use projection function, also define number simulations conduct (1000): can define two projection scenarios use example, well arrays store projection results : Next, can run projections iteration scenarios, well number simulations conduct. Note switch fmort_opt = 'HCR' fmort_opt = 'Input' going scenario 1 scenario 2, given scenario 2 use HCR (HCR used threshold control rule defined earlier). Finally, can plot stochastic simulations inspect results:","code":"data(\"sgl_rg_sable_rep\") # read in single region report data(\"sgl_rg_sable_data\") # read in single region data   # Setup necessary inputs n_sims <- 1e3 # number of simulations to conduct t_spawn <- 0 # spawn timing n_proj_yrs <- 15 # number of projection years n_regions <- 1 # number of regions n_ages <- length(sgl_rg_sable_data$ages) # number of ages n_sexes <- sgl_rg_sable_data$n_sexes # number of sexes n_fish_fleets <- sgl_rg_sable_data$n_fish_fleets # number of fishery fleets do_recruits_move <- 0 # recruits don't move terminal_NAA <- array(sgl_rg_sable_rep$NAA[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age terminal_NAA0 <- array(sgl_rg_sable_rep$NAA0[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_ages, n_sexes)) # terminal numbers at age WAA <- array(rep(sgl_rg_sable_data$WAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # weight at age WAA_fish <- array(rep(sgl_rg_sable_data$WAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # weight at age for the fishery MatAA <- array(rep(sgl_rg_sable_data$MatAA[,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # maturity at age fish_sel <- array(rep(sgl_rg_sable_rep$fish_sel[,length(sgl_rg_sable_data$years),,,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # selectivity Movement <- array(rep(sgl_rg_sable_rep$Movement[,,length(sgl_rg_sable_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_regions, n_proj_yrs, n_ages, n_sexes)) # movement terminal_F <- array(sgl_rg_sable_rep$Fmort[,length(sgl_rg_sable_data$years),], dim = c(n_regions, n_fish_fleets)) # terminal F natmort <- array(sgl_rg_sable_rep$natmort[,length(sgl_rg_sable_data$years),,], dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # natural mortality recruitment <- array(sgl_rg_sable_rep$Rec[,20:(length(sgl_rg_sable_data$years) - 2)], dim = c(n_regions, length(20:length(sgl_rg_sable_data$years) - 2))) # recruitment values to use for mean recruitment calculations or inverse gaussian parameterization sexratio <- array(0.5, dim = c(n_regions, n_proj_yrs, n_sexes)) # recruitment sex ratio # Define the F used for each scenario  proj_inputs <- list(   # Scenario 1 - Using HCR to adjust f40   list(f_ref_pt = array(sgl_ref_pt$f_ref_pt, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = array(sgl_ref_pt$b_ref_pt, dim = c(n_regions, n_proj_yrs)),        fmort_opt = 'HCR'   ),   # Scenario 2 - F is set at 0   list(f_ref_pt = array(0, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = NULL,        fmort_opt = 'Input'   ) )  # store outputs all_scenarios_f <- array(0, dim = c(n_regions, n_proj_yrs, n_sims, length(proj_inputs))) all_scenarios_ssb <- array(0, dim = c(n_regions, n_proj_yrs, n_sims, length(proj_inputs))) all_scenarios_catch <- array(0, dim = c(n_regions, n_proj_yrs, n_fish_fleets, n_sims, length(proj_inputs))) set.seed(123) for (i in seq_along(proj_inputs)) {   for (sim in 1:n_sims) {      # do population projection     out <- Do_Population_Projection(n_proj_yrs = n_proj_yrs, # number of projection years                                     n_regions = n_regions, # number of regions                                     n_ages = n_ages, # number of ages                                     n_sexes = n_sexes, # number of sexes                                     sexratio = sexratio, # sex ratio                                     n_fish_fleets = n_fish_fleets, # number of fleets                                     do_recruits_move = do_recruits_move, # whether recruits move                                     recruitment = recruitment, # recruitment values to use to parameterize inverse gaussian                                     terminal_NAA = terminal_NAA, # terminal numbers at age                                     terminal_NAA0 = terminal_NAA0, # terminal unfished numbers at age                                     terminal_F = terminal_F, # terminal fishing mortality at age                                     natmort = natmort, # natural mortality                                      WAA = WAA, # weight at age for spawning                                     WAA_fish = WAA_fish, # weight at age for fishery                                     MatAA = MatAA, # maturity at age                                     fish_sel = fish_sel, # fishery selectivity                                     Movement = Movement, # movement                                     f_ref_pt = proj_inputs[[i]]$f_ref_pt, # fishing mortality to use for projection                                     b_ref_pt = proj_inputs[[i]]$b_ref_pt, # biological reference point to use in HCR                                     HCR_function = HCR_function, # harvest control rule function                                     recruitment_opt = \"inv_gauss\", # stochastic simulation for recruitment                                     fmort_opt = proj_inputs[[i]]$fmort_opt, # fishing mortality option (either HCR or a user input)                                     t_spawn = t_spawn # spawn timing     )      # store results     all_scenarios_ssb[,,sim,i] <- out$proj_SSB     all_scenarios_catch[,,,sim,i] <- out$proj_Catch     all_scenarios_f[,,sim,i] <- out$proj_F[,-(n_proj_yrs+1)] # remove last year, since it's not used        } # end sim loop   print(i) } # end i loop # Get historical SSB historical <- reshape2::melt(array(rep(sgl_rg_sable_rep$SSB, n_sims),                                    dim = c(n_regions, length(sgl_rg_sable_data$years), n_sims))) %>%   mutate(Year = Var2 + 1959,          Scenario = \"FABC (F40)\",  # or change to match the scenarios you're plotting          Type = \"Historical\") %>%   rename(Region = Var1, Simulation = Var3, SSB = value)  # Get all scenario projections scenarios <- reshape2::melt(all_scenarios_ssb) %>%   mutate(Year = Var2 + 2023,          Scenario = case_when(            Var4 == 1 ~ \"S1: FABC (F40)\",            Var4 == 2 ~ \"S2: F = 0\"          ),          Type = \"Projection\") %>%   rename(Region = Var1, Simulation = Var3, SSB = value)  # expand historical SSB for plotting scenarios_unique <- unique(scenarios$Scenario) historical_expanded <- historical[rep(1:nrow(historical), times = length(scenarios_unique)), ] historical_expanded$Scenario <- rep(scenarios_unique, each = nrow(historical))  # combine combined_ssb <- bind_rows(historical_expanded, scenarios)  # Plot combined_ssb %>%   ggplot(aes(x = Year, y = SSB, group = interaction(Scenario, Simulation), color = Type)) +   geom_line(alpha = 0.05) +   facet_wrap(~Scenario, scales = 'free') +   geom_hline(yintercept = sgl_ref_pt$b_ref_pt, lty = 2) + # b40   geom_vline(xintercept = 2024, lty = 2) + # projection start   scale_color_manual(values = c(\"Historical\" = \"black\", \"Projection\" = \"blue\")) +   theme_bw(base_size = 15) +   theme(legend.position = 'none') # Get historical catch historical <- reshape2::melt(array(rep(sgl_rg_sable_data$ObsCatch, n_sims),                                    dim = c(n_regions, length(sgl_rg_sable_data$years), sgl_rg_sable_data$n_fish_fleets, n_sims))) %>%   mutate(Year = Var2 + 1959,          Scenario = \"FABC (F40)\",  # or change to match the scenarios you're plotting          Type = \"Historical\") %>%   rename(Region = Var1, Simulation = Var4, Fleet = Var3, Catch = value) %>%   select(-Var2)  historical$Catch[is.na(historical$Catch)] <- 0  # Get all scenario projections scenarios <- reshape2::melt(all_scenarios_catch) %>%   mutate(Year = Var2 + 2023,          Scenario = case_when(            Var5 == 1 ~ \"S1: FABC (F40)\",            Var5 == 2 ~ \"S2: F = 0\"          ),          Type = \"Projection\") %>%   rename(Region = Var1, Simulation = Var4, Catch = value, Fleet = Var3) %>%   select(-c(Var2, Var5))  # expand historical SSB for plotting scenarios_unique <- unique(scenarios$Scenario) historical_expanded <- historical[rep(1:nrow(historical), times = length(scenarios_unique)), ] historical_expanded$Scenario <- rep(scenarios_unique, each = nrow(historical))  # combine combined_cat <- bind_rows(historical_expanded, scenarios)  # Plot combined_cat %>%   group_by(Year, Scenario, Simulation, Type, Region) %>%   summarize(Catch = sum(Catch)) %>%   ggplot(aes(x = Year, y = Catch, group = interaction(Scenario, Simulation), color = Type)) +   geom_line(alpha = 0.05) +   facet_wrap(~Scenario) +   coord_cartesian(ylim = c(0, NA)) +   scale_color_manual(values = c(\"Historical\" = \"black\", \"Projection\" = \"blue\")) +   theme_bw() +   theme(legend.position = 'none')"},{"path":"https://chengmatt.github.io/SPoRC/articles/i_reference_points.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Deriving Reference Points, Catch Advice, and Projections","text":"Kapur, M.S., Siple, M.C., Olmos, M., Privitera-Johnson, K.M., Adams, G., Best, J., Castillo-JordÃ¡n, C., Cronin-Fine, L., Havron, .M., Lee, Q., Methot, R.D., Punt, .E., 2021. Equilibrium reference point calculations next generation spatial assessments. Fisheries Research 244, 106132. https://doi.org/10.1016/j.fishres.2021.106132","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/j_starting_mapping.html","id":"starting-values","dir":"Articles","previous_headings":"","what":"Starting Values","title":"Starting Values and Fixing (and Sharing) Parameters","text":"Starting values can specified two ways: Directly within SPoRC::Setup_xxx functions. setup function accepts starting values ... argument. inputs must match modelâ€™s parameter names dimensions. information parameter dimensions, see Description Model Parameters vignette. SPoRC::Setup_Mod_Recln_global_R0, Rec_prop, steepness_h, ln_InitDevs, ln_RecDevs, ln_sigmaR SPoRC::Setup_Mod_Biologicalsln_M, M_offset SPoRC::Setup_Mod_Movementmove_pars, logit_move_devs, move_pe_pars SPoRC::Setup_Mod_Taggingln_Init_Tag_Mort, ln_Tag_Shed, ln_tag_theta, Tag_Reporting_Pars SPoRC::Setup_Mod_Catch_and_Fln_sigmaC, ln_sigmaF, ln_sigmaF_agg, ln_F_mean, ln_F_devs, ln_F_mean_AggCatch, ln_F_devs_AggCatch SPoRC::Setup_Mod_FishIdx_and_Compsln_FishAge_theta, FishAge_corr_pars, ln_FishAge_theta_agg, FishAge_corr_pars_agg,ln_FishLen_theta, FishLen_corr_pars, ln_FishLen_theta_agg, FishLen_corr_pars_agg SPoRC::Setup_Mod_SrvIdx_and_Compsln_SrvAge_theta, SrvAge_corr_pars, ln_SrvAge_theta_agg, SrvAge_corr_pars_agg,ln_SrvLen_theta, SrvLen_corr_pars, ln_SrvLen_theta_agg, SrvLen_corr_pars_agg SPoRC::Setup_Mod_Fishsel_and_Qln_fish_fixed_sel_pars, ln_fish_q, fishsel_pe_pars, ln_fishsel_devs SPoRC::Setup_Mod_Srvsel_and_Qln_srv_fixed_sel_pars, ln_srv_q, srvsel_pe_pars, ln_srvsel_devs Post-hoc modification starting values. Alternatively, can first call setup functions without specifying starting values, access modify internally created parameter list (input_list$par) running model. following, illustrate methods using recruitment module (Setup_Mod_Rec) specify starting values ln_global_R0 ln_sigmaR. First let us load package define model dimensions. can specify starting values directly using Setup_Mod_Rec function. Note inputs passed via ... argument must exactly match parameter names expected dimensions model (see Description Model Parameters vignette details). example, starting value ln_global_R0 set log(30), ln_sigmaR set log(1.5) early (first element) late (second element) periods. Alternatively, starting values can assigned running setup functions without initial specifications. Users can extract internal parameter list modify starting values needed:","code":"# Load in packages library(SPoRC)  data(\"sgl_rg_sable_data\") # load in data  input_list <- Setup_Mod_Dim(years = 1:length(sgl_rg_sable_data$years), # vector of years                              # (corresponds to year 1960 - 2024)                             ages = 1:length(sgl_rg_sable_data$ages), # vector of ages                             lens = seq(41,99,2), # number of lengths                             n_regions = 1, # number of regions                             n_sexes = sgl_rg_sable_data$n_sexes, # number of sexes == 1,                             # female, == 2 male                             n_fish_fleets = sgl_rg_sable_data$n_fish_fleets, # number of fishery                             # fleet == 1, fixed gear, == 2 trawl gear                             n_srv_fleets = sgl_rg_sable_data$n_srv_fleets, # number of survey fleets                             verbose = FALSE                             ) input_list <- Setup_Mod_Rec(   input_list = input_list,        # input data list from above   # Model options   do_rec_bias_ramp = 0,       # disable bias ramp   sigmaR_switch = as.integer(length(1960:1975)),  # switch from early to late sigmaR   dont_est_recdev_last = 1,       # do not estimate last recruitment deviate   rec_model = \"mean_rec\",         # recruitment model type   init_age_strc = 1,              # geometric series for initial age structure      # Specify starting values   ln_global_R0 = log(30),         # starting value for global R0   ln_sigmaR = c(log(1.5), log(1.5))  # starting values for early and late sigmaR ) input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             # Model options                             do_rec_bias_ramp = 0, # don't do bias ramp                              sigmaR_switch = as.integer(length(1960:1975)), # when to switch from early to late sigmaR                             dont_est_recdev_last = 1, # don't estimate last recruitment deviate                             rec_model = \"mean_rec\", # recruitment model                             init_age_strc = 1 # geometric series to derive age structure                             )  # Specify starting values post-hoc # R0 input_list$par$ln_global_R0 # default starting value #> [1] 2.70805 input_list$par$ln_global_R0 <- log(30) # user specified starting value  # sigmaR input_list$par$ln_sigmaR # default starting value #> [1] 0 0 input_list$par$ln_sigmaR[] <- c(log(1.5), log(1.5)) # user specified starting value"},{"path":"https://chengmatt.github.io/SPoRC/articles/j_starting_mapping.html","id":"mapping","dir":"Articles","previous_headings":"","what":"Mapping","title":"Starting Values and Fixing (and Sharing) Parameters","text":"Mapping core feature TMB RTMB models. allows users either fix parameters known values share parameters across different parts model. sections , first demonstrate use mapping fix parameters. show mapping can used share parameters across model partitions.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/j_starting_mapping.html","id":"fixing-parameters","dir":"Articles","previous_headings":"Mapping","what":"Fixing Parameters","title":"Starting Values and Fixing (and Sharing) Parameters","text":"SPoRC::Setup_xxx functions include arguments allow certain parameters fixed, meaning estimated model fitting. arguments available parameters, note parameters can specified fixed. example, use Setup_Mod_Rec show ln_sigmaR parameter can fixed. argument sigmaR_spec = \"fix\". fix ln_sigmaR specific value, simply supply value calling function: However, parameters include convenience argument like sigmaR_spec = \"fix\". example, ln_global_R0 . cases, can fix parameter manually modifying map list directly specifying desired starting value: example, ln_global_R0 fixed log(30) setting map entry NA providing desired value parameter list.","code":"input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             # Model options                             do_rec_bias_ramp = 0, # don't do bias ramp                              sigmaR_switch = as.integer(length(1960:1975)), # when to switch from early to late sigmaR                             dont_est_recdev_last = 1, # don't estimate last recruitment deviate                             rec_model = \"mean_rec\", # recruitment model                             init_age_strc = 1, # geometric series to derive age structure                                                          # Parameter Fixing                             sigmaR_spec = 'fix'                             )  input_list$map$ln_sigmaR # both values are fixed and not estimated (specified as factor(rep(NA, 2))) #> [1] <NA> <NA> #> Levels: input_list$par$ln_sigmaR # ln_sigmaR is then fixed at the default starting value #> [1] 0 0 input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             # Model options                             do_rec_bias_ramp = , # don't do bias ramp                              sigmaR_switch = as.integer(length(1960:1975)), # when to switch from early to late sigmaR                             dont_est_recdev_last = 1, # don't estimate last recruitment deviate                             rec_model = \"mean_rec\", # recruitment model                             init_age_strc = 1, # geometric series to derive age structure                                                          # Parameter Fixing                             sigmaR_spec = 'fix',                             ln_sigmaR = c(log(1.5), log(1.5)) # user specified starting value                             )  input_list$map$ln_sigmaR # both values are fixed and not estimated (specified as factor(rep(NA, 2))) #> [1] <NA> <NA> #> Levels: input_list$par$ln_sigmaR # ln_sigmaR is then fixed at the user specified starting value #> [1] 0.4054651 0.4054651 input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             # Model options                             do_rec_bias_ramp = 0, # don't do bias ramp                              sigmaR_switch = as.integer(length(1960:1975)), # when to switch from early to late sigmaR                             dont_est_recdev_last = 1, # don't estimate last recruitment deviate                             rec_model = \"mean_rec\", # recruitment model                             init_age_strc = 1, # geometric series to derive age structure                             )  input_list$map$ln_global_R0 <- factor(NA) input_list$par$ln_global_R0 <- log(30)"},{"path":"https://chengmatt.github.io/SPoRC/articles/j_starting_mapping.html","id":"sharing-parameters","dir":"Articles","previous_headings":"Mapping","what":"Sharing Parameters","title":"Starting Values and Fixing (and Sharing) Parameters","text":"SPoRC::Setup_xxx functions also support sharing parameters across model partitions. example, selectivity parameters can shared sexes using built-convenience arguments. options simplify common sharing structures, users can also implement customized behavior needed. , demonstrate two approaches. First, show share fishery selectivity parameters sexes using convenience flag Setup_Mod_Fishsel_and_Q. , outline users can manually configure parameter sharing finer control. example , define two fishery fleets. Fleet 1 uses logistic selectivity model (2 parameters), Fleet 2 uses gamma dome-shaped model (2 parameters). first use fish_fixed_sel_pars_spec argument specify selectivity parameters fleets estimated across model partitions (est_all). Thus, inspect map, expect total 8 unique numbers, represent unique selectivity parameters estimated sex fleet (4 sex fleet combination). Next, use fish_fixed_sel_pars_spec argument indicate selectivity parameters shared across sex partitions fleets. Specifically, use \"est_shared_s\" setting link parameters sexes, even though model sex-structured. setup, still estimate separate parameters fleet, selectivity parameters used sexes within fleet. result, inspect mapping, expect four unique valuesâ€”two per fleetâ€”despite two sexes. parameter array ln_fish_fixed_sel_pars following structure: [n_regions, n_max_sel_pars, n_max_sel_blocks, n_sexes, n_fish_fleets] example, dimensions 1 x 2 x 1 x 2 x 2. means : fleet, two estimated selectivity parameters shared across two sexes flattened vector (required mapping), results four distinct values (two per fleet), even though underlying array spans two sexes minimal example replicates Setup_Mod_Fishsel_and_Q internally: can now compare custom map object constructed manually one generated Setup_Mod_Fishsel_and_Q: match, confirming parameters correctly shared across sexes fleet. Lastly, demonstrate manually specify advanced mapping parameter-sharing options fishery selectivity parameters. example, want : a50a_{50} parameter (inflection point) sex-specific slope parameter shared across sexes parameters sex-specific level control supported built-fish_fixed_sel_pars_spec convenience arguments, must construct mapping manually. begin calling Setup_Mod_Fishsel_and_Q \"est_all\" option fleets. creates parameter array correct dimensions assumes selectivity parameters uniquely estimated across model partitions. extract parameter array created internally ln_fish_fixed_sel_pars. array dimensions: [n_regions, n_max_sel_pars, n_max_sel_blocks, n_sexes, n_fish_fleets]. example, dimensions 1 x 2 x 1 x 2 x 2. can assign integer values array indicate parameters shared (value) independently estimated (different values). now assign specific values define desired sharing structure: flatten array vector factors assign map list. tells model parameters linked building model. custom mapping approach allows full control parameter sharing structures beyond available high-level setup arguments.","code":"input_list$data$Selex_Type <- 0 # specifying age-based selectivity for demonstration purposes input_list <- SPoRC::Setup_Mod_Fishsel_and_Q(input_list = input_list,                                        # Model options                                       cont_tv_fish_sel = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_sel_model = c(\"logist1_Fleet_1\", \"gamma_Fleet_2\"),                                       fish_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_q_spec = c(\"fix\", \"fix\"),                                        # Share selectivity parameters across all partitions                                       fish_fixed_sel_pars_spec = c(\"est_all\", \"est_all\"))  input_list$map$ln_fish_fixed_sel_pars # 8 unique numbers, 4 for each sex and fleet combination #> [1] <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> #> Levels: input_list$data$Selex_Type <- 0 # specifying age-based selectivity for demonstration purposes input_list <- SPoRC::Setup_Mod_Fishsel_and_Q(input_list = input_list,                                        # Model options                                       cont_tv_fish_sel = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_sel_model = c(\"logist1_Fleet_1\", \"gamma_Fleet_2\"),                                       fish_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),                                       fish_q_spec = c(\"fix\", \"fix\"),                                        # Share selectivity parameters across all partitions                                       fish_fixed_sel_pars_spec = c(\"est_shared_s\", \"est_shared_s\"))  input_list$map$ln_fish_fixed_sel_pars # 4 unique numbers, 2 for each sex and fleet combination #> [1] <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> #> Levels: # define dimensions n_regions <- 1 n_max_sel_pars <- 2 n_max_sel_blocks <- 1 n_sexes <- 2 n_fish_fleets <- 2  # define empty parameter array for demonstration ln_fish_fixed_sel_pars <- array(0, dim = c(n_regions,n_max_sel_pars,n_max_sel_blocks,n_sexes,n_fish_fleets)) ln_fish_fixed_sel_pars[1,,1,,1] <- c(1,2) # same parameters for each sex for fleet 1 ln_fish_fixed_sel_pars[1,,1,,2] <- c(3,4) # same parameters for each sex for fleet 2 ln_fish_fixed_sel_pars #> , , 1, 1, 1 #>  #>      [,1] [,2] #> [1,]    1    2 #>  #> , , 1, 2, 1 #>  #>      [,1] [,2] #> [1,]    1    2 #>  #> , , 1, 1, 2 #>  #>      [,1] [,2] #> [1,]    3    4 #>  #> , , 1, 2, 2 #>  #>      [,1] [,2] #> [1,]    3    4  # flatten array to a vector of factors for the map custom_map <- factor(as.vector(ln_fish_fixed_sel_pars)) custom_map #> [1] 1 2 1 2 3 4 3 4 #> Levels: 1 2 3 4 input_list$map$ln_fish_fixed_sel_pars #> [1] <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> #> Levels: input_list$data$Selex_Type <- 0 # specifying age-based selectivity for demonstration purposes input_list <- SPoRC::Setup_Mod_Fishsel_and_Q(   input_list = input_list,    # Model options   cont_tv_fish_sel = c(\"none_Fleet_1\", \"none_Fleet_2\"),   fish_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),   fish_sel_model = c(\"logist1_Fleet_1\", \"gamma_Fleet_2\"),   fish_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\"),   fish_q_spec = c(\"fix\", \"fix\"),    # Start with all parameters estimated independently   fish_fixed_sel_pars_spec = c(\"est_all\", \"est_all\") ) map_ln_fish_fixed_sel_pars <- input_list$par$ln_fish_fixed_sel_pars  # extract the array # Fleet 1 (logistic):  # - sel_par 1 = a50 (sex-specific) # - sel_par 2 = slope (shared across sex) map_ln_fish_fixed_sel_pars[1,1,1,,1] <- c(1,2)   # a50: unique for each sex map_ln_fish_fixed_sel_pars[1,2,1,,1] <- c(3)     # slope: same for both sexes  # Fleet 2 (gamma):  # - sel_par 1 = amax (sex-specific) # - sel_par 2 = slope (sex-specific) map_ln_fish_fixed_sel_pars[1,1,1,,2] <- c(4,5)   # amax: unique per sex map_ln_fish_fixed_sel_pars[1,2,1,,2] <- c(6,7)   # slope: unique per sex # Flatten the mapping array and assign it to the map input_list$map$ln_fish_fixed_sel_pars <- factor(as.vector(map_ln_fish_fixed_sel_pars))  # View the final map input_list$map$ln_fish_fixed_sel_pars #> [1] 1 3 2 3 4 6 5 7 #> Levels: 1 2 3 4 5 6 7"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"steepness","dir":"Articles","previous_headings":"","what":"Steepness","title":"Defining Priors","text":"specify priors steepness Beverton-Holt stock-recruitment relationship, use Setup_Mod_Rec function default settings simplicity. First, define dataframe includes region prior applies, mean (mu), standard deviation (sd) steepness prior. values specified normal space internally transformed beta distribution bounded 0.2 1. activate steepness priors, set Use_h_prior = 1 provide dataframe h_prior argument: spatial model region-specific steepness priors required, prior dataframe can include multiple entries. particular, row corresponds region-specific steepness parameter, along associated mean (mu) standard deviation (sd). instance:","code":"# set up dataframe specifying the steepness prior and the dimensions it is applied to steepness_prior <- data.frame(   region = 1, # apply steepness prior to region 1   mu = 0.6, # mean of steepness   sd = 0.2 # sd of steepness )  # setup recruitment options input_list <- Setup_Mod_Rec(   input_list = input_list,        # input data list from above   # Model options   rec_model = \"bh_rec\",          # recruitment model type   Use_h_prior = 1,               # whether steepness priors are used   h_prior = steepness_prior      # Steepness prior dataframe ) #> Recruitment is specified as: bh_rec #> Recruitment and SSB lag is specified as: 1 #> Recruitment proportion priors are: Not Used #> Steepness priors are: Used #> Sex Ratios estimated with 1 block for region 1 #> Recruitment Bias Ramp is: Off #> Initial Age Structure is: Matrix Geometric Series #> Recruitment deviations for every year are estimated #> Recruitment Variability is estimated for both early and late periods #> Initial Age Deviations is stochastic for all ages, but the plus group follows equilibrium calculations. #> Recruitment Deviations is estimated for all dimensions #> Steepness is estimated for all dimensions #> Sex ratio is specified as: fix steepness_prior <- data.frame(   region = c(1,2,3), # apply steepness prior to region 1, 2 and, 3   mu = c(0.6, 0.8, 0.3), # mean of steepness prior corresponding to the regions defined   sd = c(0.2, 0.2, 0.2) # sd of steepness corresponding to the regions defined )  steepness_prior #>   region  mu  sd #> 1      1 0.6 0.2 #> 2      2 0.8 0.2 #> 3      3 0.3 0.2"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"natural-mortality","dir":"Articles","previous_headings":"","what":"Natural Mortality","title":"Defining Priors","text":"define natural mortality priors, use Setup_Mod_Biologicals function specify natural mortality prior. , set Use_M_prior = 1 provide dataframe values corresponding region, year, age, sex blocks specified natural mortality, along associated mean standard deviation.","code":"# Define natural mortality prior M_prior <- data.frame(    regionblk = 1, # region block   yearblk = 1, # year block   ageblk = c(1), # age block   sexblk = c(1,2), # sex block   mu = 0.085, # mean   sd = 0.1 #sd )  input_list <- Setup_Mod_Biologicals(input_list = input_list,                                     # Data inputs                                     WAA = sgl_rg_sable_data$WAA, # weight-at-age                                     MatAA = sgl_rg_sable_data$MatAA, # maturity at age                                     AgeingError = as.matrix(sgl_rg_sable_data$age_error), # ageing error                                     SizeAgeTrans = sgl_rg_sable_data$SizeAgeTrans, # size age transition matrix                                     # Model options                                     Use_M_prior = 1, # use natural mortality prior                                     M_prior = M_prior, # mean and sd for M prior                                     M_spec = \"est_ln_M\", # estmating M                                     M_sexblk_spec = list(1,2) # specifying M as sex-specific ) #> Length Composition data are: Not Used #> Natural Mortality priors are: Used #> Selectivity is aged-based. #> WAA_fish was specified at NULL. Using the spawning WAA for WAA_fish #> WAA_srv was specified at NULL. Using the spawning WAA for WAA_srv #> Ageing Error is specified to be time-invariant #> Natural Mortality specified as: est_ln_M #> Natural Mortality Region Blocks is specified as: 1 #> Natural Mortality Year Blocks is specified as: 1 #> Natural Mortality Age Blocks is specified as: 1 #> Natural Mortality Sex Blocks is specified as: 2"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"catchability","dir":"Articles","previous_headings":"","what":"Catchability","title":"Defining Priors","text":"Defining catchability priors fishery survey follows process. demonstration purposes, following section illustrate catchability priors can defined survey using Setup_Mod_Srvsel_and_Q function. Similar steepness section, dataframe catchability priors first defined determines region, fleet, block catchability prior applied . dataframe also includes columns defining mean (mu), standard deviation (sd) catchability prior. , priors provided normal space, internally transformed lognormal density. Use_srv_q_prior = 1 argument utilized activate prior, dataframe provided srv_q_prior argument.","code":"# set up dataframe specifying the survey catchability prior and the dimensions it is applied to srv_q_prior <- data.frame(   region = 1, # apply catchability prior to region 1   fleet = c(1, 2, 3), # apply catchability prior to region 1, fleets 1 - 3   block = 1, # apply catchability prior to region 1, fleets 1 - 3, block 1   mu = c(6, 0.5, 4), # corresponding mean catchability prior values   sd = c(0.1, 0.35, 0.1) # corresponding standard deviation prior values )  srv_q_prior #>   region fleet block  mu   sd #> 1      1     1     1 6.0 0.10 #> 2      1     2     1 0.5 0.35 #> 3      1     3     1 4.0 0.10  # Setup survey selectivity and catchability input_list <- Setup_Mod_Srvsel_and_Q(input_list = input_list,                                       # Model options                                      # survey selectivity, whether continuous time-varying                                      cont_tv_srv_sel = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                      # survey selectivity blocks                                      srv_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                       # survey selectivity form                                      srv_sel_model = c(\"logist1_Fleet_1\", \"exponential_Fleet_2\", \"logist1_Fleet_3\"),                                      # survey catchability blocks                                      srv_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                      # whether to estiamte all fixed effects for survey selectivity                                      srv_fixed_sel_pars_spec = c(\"est_all\", \"est_all\", \"est_all\"),                                      # whether to estiamte all fixed effects for survey catchability                                      srv_q_spec = c(\"est_all\", \"est_all\", \"est_all\"),                                      # Using catchability priors                                      Use_srv_q_prior = 1,                                      # Input survey catchability prior dataframe                                      srv_q_prior = srv_q_prior ) #> Survey Catchability priors are: Used #> Survey Selectivity priors are: Not Used #> Continuous survey time-varying selectivity specified as: none for survey fleet 1 #> Continuous survey time-varying selectivity specified as: none for survey fleet 2 #> Continuous survey time-varying selectivity specified as: none for survey fleet 3 #> Survey Selectivity Time Blocks for survey 1 is specified at: 1 #> Survey Selectivity Time Blocks for survey 2 is specified at: 1 #> Survey Selectivity Time Blocks for survey 3 is specified at: 1 #> Survey selectivity functional form specified as:logist1 for srvery fleet 1 #> Survey selectivity functional form specified as:exponential for srvery fleet 2 #> Survey selectivity functional form specified as:logist1 for srvery fleet 3 #> Survey Catchability Time Blocks for survey 1 is specified at: 1 #> Survey Catchability Time Blocks for survey 2 is specified at: 1 #> Survey Catchability Time Blocks for survey 3 is specified at: 1 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 1 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 2 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 3 #> srv_q_spec is specified as: est_all for survey fleet 1 #> srv_q_spec is specified as: est_all for survey fleet 2 #> srv_q_spec is specified as: est_all for survey fleet 3"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"selectivity","dir":"Articles","previous_headings":"","what":"Selectivity","title":"Defining Priors","text":"Defining selectivity priors fishery survey follows process. , focus defining selectivity priors survey brevity, using Setup_Mod_Srvsel_and_Q function. first define dataframe following columns: region, par, block, sex, fleet, mu, sd, defines region, parameter, time block, sex, fleet combination apply prior . Given complexity number selectivity parameters can estimated across model partitions (regions, sexes, blocks, fleets), users need cautious selectivity prior dataframe defined ensure correctly applied. following, apply priors logistic selectivity parameters sexes fleet 1, priors power parameter describing exponential selectivity fleet 2. example provided , first row dataframe indicates prior pplied region 1, parameter 1, sex 1, fleet 1, block 1, corresponds b50b_50 parameter logistic selectivity specified first survey fleet. last row datframe indicates prior applied region 1, parameter 1, sex 2, fleet 2, block 1, corresponds male Ï•\\phi power paramter exponential selectivity specified second survey fleet. Next, can activate selectivity priors setting Use_srv_selex_prior = 1 providing associated selectivity prior dataframe srv_selex_prior.","code":"srv_selex_prior <- data.frame(   region = 1, # only a single region   par = c(1,2,1,2,1,1), # parameter to apply prior to   sex = c(1,1,2,2,1,2), # sexes to apply prior to   fleet = c(1,1,1,1,2,2), # fleets to apply prior to   block = 1, # only a single time block   mu = rep(0, 6), # mean specified at 0   sd = rep(5, 6) # sd specified to be wide for all parameters )  srv_selex_prior #>   region par sex fleet block mu sd #> 1      1   1   1     1     1  0  5 #> 2      1   2   1     1     1  0  5 #> 3      1   1   2     1     1  0  5 #> 4      1   2   2     1     1  0  5 #> 5      1   1   1     2     1  0  5 #> 6      1   1   2     2     1  0  5 # Setup survey selectivity and catchability input_list <- Setup_Mod_Srvsel_and_Q(input_list = input_list,                                       # Model options                                      # survey selectivity, whether continuous time-varying                                      cont_tv_srv_sel = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                      # survey selectivity blocks                                      srv_sel_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                       # survey selectivity form                                      srv_sel_model = c(\"logist1_Fleet_1\", \"exponential_Fleet_2\", \"logist1_Fleet_3\"),                                      # survey catchability blocks                                      srv_q_blocks = c(\"none_Fleet_1\", \"none_Fleet_2\", \"none_Fleet_3\"),                                      # whether to estiamte all fixed effects for survey selectivity                                      srv_fixed_sel_pars_spec = c(\"est_all\", \"est_all\", \"est_all\"),                                      # whether to estiamte all fixed effects for survey catchability                                      srv_q_spec = c(\"est_all\", \"est_all\", \"est_all\"),                                      # Using selex priors                                      Use_srv_selex_prior = 1,                                      # Input survey selex priors                                      srv_selex_prior = srv_selex_prior ) #> Survey Catchability priors are: Not Used #> Survey Selectivity priors are: Used #> Continuous survey time-varying selectivity specified as: none for survey fleet 1 #> Continuous survey time-varying selectivity specified as: none for survey fleet 2 #> Continuous survey time-varying selectivity specified as: none for survey fleet 3 #> Survey Selectivity Time Blocks for survey 1 is specified at: 1 #> Survey Selectivity Time Blocks for survey 2 is specified at: 1 #> Survey Selectivity Time Blocks for survey 3 is specified at: 1 #> Survey selectivity functional form specified as:logist1 for srvery fleet 1 #> Survey selectivity functional form specified as:exponential for srvery fleet 2 #> Survey selectivity functional form specified as:logist1 for srvery fleet 3 #> Survey Catchability Time Blocks for survey 1 is specified at: 1 #> Survey Catchability Time Blocks for survey 2 is specified at: 1 #> Survey Catchability Time Blocks for survey 3 is specified at: 1 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 1 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 2 #> srv_fixed_sel_pars_spec is specified as: est_all for survey fleet 3 #> srv_q_spec is specified as: est_all for survey fleet 1 #> srv_q_spec is specified as: est_all for survey fleet 2 #> srv_q_spec is specified as: est_all for survey fleet 3"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"movement","dir":"Articles","previous_headings":"","what":"Movement","title":"Defining Priors","text":"Defining priors movement, tag reporting rates, recruitment proportions (see section ) best illustrated setting spatial model. , load data multi-region sablefish case study demonstrate defining priors processes. movement parameters correlated must sum 1, SPoRC uses Dirichlet prior model movement probabilities. illustrate, set movement specification using Setup_Mod_Movement function. Movement priors enabled setting Use_Movement_Prior = 1. Movement_prior argument can provided scalar (example ), vector, fully specified array. scalar value, 1.5, implies vague, symmetric Dirichlet prior mildly penalizes values near extremes (.e., near 0 1). vector array supplied Movement_prior, reshaped match full set movement dimensions: important ensure shape values prior align structure movement parameters estimated. Note priors applied unique movement parameters. Thus, movement specified constant across time, age, sex, one prior applied, regardless dimensionality array provided.","code":"data(mlt_rg_sable_data) # load in data  # Initialize model dimensions and data list input_list <- Setup_Mod_Dim(years = 1:length(mlt_rg_sable_data$years),                             # vector of years (1 - 62)                             ages = 1:length(mlt_rg_sable_data$ages),                             # vector of ages (1 - 30)                             lens = mlt_rg_sable_data$lens,                             # number of lengths (41 - 99)                             n_regions = mlt_rg_sable_data$n_regions,                             # number of regions (5)                             n_sexes = mlt_rg_sable_data$n_sexes,                             # number of sexes (2)                             n_fish_fleets = mlt_rg_sable_data$n_fish_fleets,                             # number of fishery fleet (2)                             n_srv_fleets = mlt_rg_sable_data$n_srv_fleets,                             # number of survey fleets (2)                             verbose = TRUE ) #> Number of Years: 62 #> Number of Projection Years for Dev Pars: 0 #> Number of Regions: 5 #> Number of Age Bins: 30 #> Number of Length Bins: 30 #> Number of Sexes: 2 #> Number of Fishery Fleets: 2 #> Number of Survey Fleets: 2 # setting up movement parameterization input_list <- Setup_Mod_Movement(input_list = input_list,                                  # Model options                                  Movement_ageblk_spec = \"constant\",                                  # estimating movement in 3 age blocks                                  # (ages 1-6, ages 7-15, ages 16-30)                                  Movement_yearblk_spec = \"constant\", # time-invariant movement                                  Movement_sexblk_spec = \"constant\", # sex-invariant movement                                  Use_Movement_Prior = 1, # priors used for movement                                  Movement_prior = 1.5  # vague prior to penalize movement away from the extremes                                  ) #> Movement is: Estimated #> Movement priors are: Used #> Recruits are: Not Moving #> Continuous movement specification is: none #> Continuous movement process error specification is: none #> Movement fixed effect blocks are sex-invariant #> Movement fixed effect blocks are time-invariant #> Movement fixed effect blocks are age-invariant # array(Movement_prior, dim = c(input_list$data$n_regions, input_list$data$n_regions, #                               length(input_list$data$years),  #                               length(input_list$data$ages),  #                               input_list$data$n_sexes))"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"tag-reporting-rates","dir":"Articles","previous_headings":"","what":"Tag Reporting Rates","title":"Defining Priors","text":"Defining priors tag reporting rates done constructing dataframe passing Setup_Mod_Tagging function. dataframe must contain following columns: region, block, mu, sd, type. columns define region time block prior applies , mean standard deviation prior distribution, type beta prior use. Two prior types supported: symmetric beta prior (type = 0), penalizes extreme values near 0 1, standard beta prior (type = 1), allows users specify mean standard deviation directly. example , symmetric beta priors applied two time blocks region 1. symmetric form require mean, mu column set NA: example, first row dataframe indicates symmetric beta prior applied tag reporting rates region 1 block 1, standard deviation 5. second row applies prior structure block 2. type = 0, prior symmetric around 0.5 discourages extreme reporting rate estimates. type = 1 used instead, mu column need specified prior mean. Tag reporting rate priors can applied setting Use_TagRep_Prior = 1 inputting dataframe TagRep_Prior argument.","code":"# setup tagging priors tag_prior <- data.frame(   region = 1,         # apply to region 1   block  = c(1, 2),   # two time blocks   mu     = NA,        # not needed for symmetric beta   sd     = 5,         # standard deviation   type   = 0          # symmetric beta prior ) tag_prior #>   region block mu sd type #> 1      1     1 NA  5    0 #> 2      1     2 NA  5    0 # setting up tagging parameterization input_list <- Setup_Mod_Tagging(input_list = input_list,                                 UseTagging = 1, # using tagging data                                 max_tag_liberty = 15, # maximum number of years to track a cohort                                  # Data Inputs                                 tag_release_indicator = mlt_rg_sable_data$tag_release_indicator,                                 Tagged_Fish = mlt_rg_sable_data$Tagged_Fish, # Released fish                                 Obs_Tag_Recap = mlt_rg_sable_data$Obs_Tag_Recap,                                  # Model options                                 Use_TagRep_Prior = 1, # tag reporting rate priors are used                                 TagRep_Prior = tag_prior,                                 # sex-specific data when fitting                                 Init_Tag_Mort_spec = \"fix\", # fixing initial tag mortality                                 Tag_Shed_spec = \"fix\", # fixing chronic shedding                                 TagRep_spec = \"est_shared_r\", # tag reporting rates are                                 # not region specific                                 # Time blocks for tag reporting rates                                 Tag_Reporting_blocks = c(                                   paste(\"Block_1_Year_1-35_Region_\",                                         c(1:input_list$data$n_regions), sep = ''),                                   paste(\"Block_2_Year_36-terminal_Region_\",                                         c(1:input_list$data$n_regions), sep = '')                                 ),                                  # Specify starting values or fixing values                                 ln_Init_Tag_Mort = log(0.1), # fixing initial tag mortality                                 ln_Tag_Shed = log(0.02)  # fixing tag shedding ) #> Tagging priors are used #> Tagging data are fit to by pooling across 1 age groups #> Tagging data are fit to by pooling across 1 sex groups #> Tag Reporting estimated with 2 block for region 1 #> Tag Reporting estimated with 2 block for region 2 #> Tag Reporting estimated with 2 block for region 3 #> Tag Reporting estimated with 2 block for region 4 #> Tag Reporting estimated with 2 block for region 5 #> Initial Tag Mortality is specified as: fix #> Chronic Tag Shedding is specified as: fix"},{"path":"https://chengmatt.github.io/SPoRC/articles/k_defining_priors.html","id":"recruitment-proportions","dir":"Articles","previous_headings":"","what":"Recruitment Proportions","title":"Defining Priors","text":"context spatial model, Dirichlet priors can also placed recruitment proportions. process relatively straightforward uses Setup_Mod_Rec functions . particular, users need define whether prior used setting Use_Rec_prop_Prior = 1. Following , scalar vector (n_regions) can defined Rec_prop_prior. case Rec_prop_prior scalar, uniform Dirichlet prior applied. vector different values region provided, Dirichlet prior applied according concentration parameters.","code":"# Setup recruitment stuff (using defaults for other stuff) input_list <- Setup_Mod_Rec(input_list = input_list, # input data list from above                             do_rec_bias_ramp = 0,                              # Model options                             rec_model = \"mean_rec\", # recruitment model                             Use_Rec_prop_Prior = 1, # using recruitment proportion prior                             Rec_prop_prior = 5 # prior value for recruitment proportions ) #> Recruitment is specified as: mean_rec #> Recruitment proportion priors are: Used #> Sex Ratios estimated with 1 block for region 1 #> Sex Ratios estimated with 1 block for region 2 #> Sex Ratios estimated with 1 block for region 3 #> Sex Ratios estimated with 1 block for region 4 #> Sex Ratios estimated with 1 block for region 5 #> Recruitment Bias Ramp is: Off #> Initial Age Structure is: Matrix Geometric Series #> Recruitment deviations for every year are estimated #> Recruitment Variability is estimated for both early and late periods #> Initial Age Deviations is stochastic for all ages, but the plus group follows equilibrium calculations. #> Recruitment Deviations is estimated for all dimensions #> Sex ratio is specified as: fix"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"simulation-cross-testing-in-sporc","dir":"Articles","previous_headings":"","what":"Simulation Cross-Testing in SPoRC","title":"Simulation Testing (Cross and Self Tests)","text":"Simulation testing stock assessment models integral evaluating robustness understanding models perform model misspecification. SPoRC framework supports simulation testing three forms: - Self-testing: estimation model (EM) structure operating model (OM). - Cross-testing: EM differs structurally OM, allowing assessment bias sensitivity incorrect assumptions. - Closed loop simulations (see Closed Loop Simulations vignette example). first section vignette, present cross-test example. operating model (OM; simulated truth) assumes logistic selectivity curve fishery, estimation model (SPoRC; EM) incorrectly specifies dome-shaped (gamma) selectivity curve. OM defines biological processes, fishing dynamics, survey structure, recruitment assumptions. Unless otherwise noted, OM observation model uses default settings: Composition Input Sample Size = 100, Multinomial sampling (Fishery Survey) Survey index SD = 0.2, lognormal observations Catch SD = 0.02, lognormal observations","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"define-model-dimensions","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Define Model Dimensions","title":"Simulation Testing (Cross and Self Tests)","text":"start defining structural dimensions operating model.","code":"sim_list <- Setup_Sim_Dim(   n_sims        = 50,  # number of simulations   n_yrs         = 30,  # number of years   n_regions     = 1,   # single region   n_ages        = 10,  # number of ages   n_lens        = NULL,# no length structure   n_sexes       = 1,   # single sex   n_fish_fleets = 1,   # one fishery fleet   n_srv_fleets  = 1    # one survey fleet )  # Create storage containers sim_list <- Setup_Sim_Containers(sim_list)"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"fishing-processes","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Fishing Processes","title":"Simulation Testing (Cross and Self Tests)","text":"fishery selectivity OM logistic, centered around age 5.","code":"sim_list <- Setup_Sim_Fishing(sim_list = sim_list, # update simulate list                               # Logistic selectivity                               fish_sel_input = replicate(                                 n = sim_list$n_sims,                                 array(rep(1 / (1 + exp(-3 * ((1:sim_list$n_ages) - 5))), each = sim_list$n_yrs),                                       dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages,                                               sim_list$n_sexes, sim_list$n_fish_fleets))                               ) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"survey-processes","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Survey Processes","title":"Simulation Testing (Cross and Self Tests)","text":"specify survey selectivity logistic, centered around age 3.","code":"sim_list <- Setup_Sim_Survey(   sim_list = sim_list,   # Logistic selectivity   srv_sel_input = replicate(     n = sim_list$n_sims,     array(rep(1 / (1 + exp(-1 * ((1:sim_list$n_ages) - 3))), each = sim_list$n_yrs),           dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages,                   sim_list$n_sexes, sim_list$n_srv))   ) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"biological-dynamics","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Biological Dynamics","title":"Simulation Testing (Cross and Self Tests)","text":"Biological parameters set natural mortality, maturity--age, weight--age. values relatively arbitrary specified generically represent fairly short-lived species.","code":"sim_list <- Setup_Sim_Biologicals(   sim_list = sim_list, # simualtion list   natmort_input = replicate(n = sim_list$n_sims, array(0.3, dim = c(sim_list$n_regions, sim_list$n_yrs,                                                                     sim_list$n_ages, sim_list$n_sexes))), # natural mortality   WAA_input = replicate(n = sim_list$n_sims, array(rep(5 / (1 + exp(-3 * ((1:sim_list$n_ages) - 3))), each = sim_list$n_yrs),                                                    dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages, sim_list$n_sexes))), # weight at age   WAA_fish_input = replicate(n = sim_list$n_sims, array(rep(5 / (1 + exp(-3 * ((1:sim_list$n_ages) - 3))), each = sim_list$n_yrs),                                                         dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages, sim_list$n_sexes, sim_list$n_fish_fleets))), # fishery weight at age   WAA_srv_input = replicate(n = sim_list$n_sims, array(rep(5 / (1 + exp(-3 * ((1:sim_list$n_ages) - 3))), each = sim_list$n_yrs),                                                        dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages, sim_list$n_sexes, sim_list$n_srv_fleets))), # survey weight at age   MatAA_input = replicate(n = sim_list$n_sims, array(rep(1 / (1 + exp(-3 * ((1:sim_list$n_ages) - 3))), each = sim_list$n_yrs),                                                      dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages, sim_list$n_sexes))) # maturity at age )"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"tagging-and-movement","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Tagging and Movement","title":"Simulation Testing (Cross and Self Tests)","text":"example, tagging disabled movement modeled.","code":"sim_list <- Setup_Sim_Tagging(   sim_list = sim_list, # simulation list   UseTagging = 0 )  # No Movement sim_list$Movement <- array(1, dim = c(sim_list$n_regions, sim_list$n_regions, sim_list$n_yrs, sim_list$n_ages, sim_list$n_sexes, sim_list$n_sims))"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"recruitment","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Recruitment","title":"Simulation Testing (Cross and Self Tests)","text":"Recruitment modeled mean recruitment dynamics, R0_input mean recruitment parameter centered value 5.","code":"sim_list <- Setup_Sim_Rec(   sim_list = sim_list,   R0_input = replicate(n = sim_list$n_sims, expr = array(5, dim = c(sim_list$n_regions, sim_list$n_yrs))), # R0   ln_sigmaR = log(c(1, 1)),   recruitment_opt = 'mean_rec',    init_age_strc = 1 # using geometric series scalar to initialize popn )"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"run-the-operating-model","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Run the Operating Model","title":"Simulation Testing (Cross and Self Tests)","text":"object sim_obj contains simulated population, fishery, survey data ready pass EM cross-testing.","code":"set.seed(123) sim_obj <- Simulate_Pop_Static(sim_list = sim_list, output_path = NULL) # get simulated datasets"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"define-estimation-model","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Define Estimation Model","title":"Simulation Testing (Cross and Self Tests)","text":"simulating operating model (OM), can set estimation model (EM) SPoRC. cross-test, EM incorrectly assumes dome-shaped (gamma) fishery selectivity, even though OM used logistic selectivity. general, EM settings identical OM, except fishery selectivity.","code":"setup_em <- function(sim_obj, sim) {    # Extract simulation data for current year and replicate   sim_data <- simulation_data_to_SPoRC(sim_env = sim_obj, y = sim_obj$n_years, sim = sim)    # Setup model dimensions   input_list <- Setup_Mod_Dim(     years = 1:sim_obj$n_years,     ages = 1:sim_obj$n_ages,     lens = sim_obj$n_lens,     n_regions = sim_obj$n_regions,     n_sexes = sim_obj$n_sexes,     n_fish_fleets = sim_obj$n_fish_fleets,     n_srv_fleets = sim_obj$n_srv_fleets,     verbose = F   )    # Recruitment setup   input_list <- Setup_Mod_Rec(     input_list = input_list,     do_rec_bias_ramp = 0, # not doing bias ramp     sigmaR_switch = 1, # when to switch from early to late sigmaR (switch in first year)     ln_sigmaR = rep(log(1) , 2), # 2 values for early and late sigma     rec_model = \"mean_rec\",     sigmaR_spec = \"fix\", # fix early sigmaR and late sigmaR     init_age_strc = 1, # geometric series to derive initial age structure     equil_init_age_strc = 2, # estimating all intial age deviations     ln_global_R0 = log(5)   )    # Biological setup   input_list <- Setup_Mod_Biologicals(     input_list = input_list,     # Data inputs     WAA = sim_data$WAA,     MatAA = sim_data$MatAA,     WAA_fish = sim_data$WAA_fish,     WAA_srv = sim_data$WAA_srv,     fit_lengths = 0, # not fitting lengths     AgeingError = sim_data$AgeingError,     M_spec = \"fix\",     # fixing natural mortality     Fixed_natmort = array(0.3, dim = c(input_list$data$n_regions, length(input_list$data$years),  length(input_list$data$ages), input_list$data$n_sexes))   )    # Movement and tagging   input_list <- Setup_Mod_Tagging(input_list = input_list, UseTagging = 0)   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )    # Fishery catch & fishing mortality   input_list <- Setup_Mod_Catch_and_F(     input_list = input_list,     # Data inputs     ObsCatch = sim_data$ObsCatch,     Catch_Type = array(1, dim = c(length(input_list$data$years), input_list$data$n_fish_fleets)),     UseCatch = sim_data$UseCatch,     # Model options     Use_F_pen = 1,     sigmaC_spec = \"fix\",     # Fixing sigma C and F     ln_sigmaC = sim_data$ln_sigmaC,     ln_sigmaF = array(log(1), dim = c(input_list$data$n_regions, input_list$data$n_fish_fleets))     )    # Survey selectivity and catchability   input_list <- Setup_Mod_FishIdx_and_Comps(     input_list = input_list,     # Data inputs     ObsFishIdx = sim_data$ObsFishIdx,     ObsFishIdx_SE = sim_data$ObsFishIdx_SE,     UseFishIdx = sim_data$UseFishIdx,     ObsFishAgeComps = sim_data$ObsFishAgeComps,     ObsFishLenComps = sim_data$ObsFishLenComps,     UseFishAgeComps = sim_data$UseFishAgeComps,     UseFishLenComps = sim_data$UseFishLenComps,     ISS_FishAgeComps = sim_data$ISS_FishAgeComps,     ISS_FishLenComps = sim_data$ISS_FishLenComps,     # Model options     fish_idx_type = c(\"biom\"),     FishAgeComps_LikeType = c(\"Multinomial\"),     FishLenComps_LikeType = c(\"none\"),     FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     FishLenComps_Type = c(\"none_Year_1-terminal_Fleet_1\")   )    # Survey indices and compositions   input_list <- Setup_Mod_SrvIdx_and_Comps(     input_list = input_list,     # Data inputs     ObsSrvIdx = sim_data$ObsSrvIdx,     ObsSrvIdx_SE = sim_data$ObsSrvIdx_SE,     UseSrvIdx = sim_data$UseSrvIdx,     ObsSrvAgeComps = sim_data$ObsSrvAgeComps,     ObsSrvLenComps = sim_data$ObsSrvLenComps,     UseSrvAgeComps = sim_data$UseSrvAgeComps,     UseSrvLenComps = sim_data$UseSrvLenComps,     ISS_SrvAgeComps = sim_data$ISS_SrvAgeComps,     ISS_SrvLenComps = sim_data$ISS_SrvLenComps,     # Model options     srv_idx_type = c(\"biom\"),     SrvAgeComps_LikeType = c(\"Multinomial\"),     SrvLenComps_LikeType = c(\"none\"),     SrvAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     SrvLenComps_Type = c(\"none_Year_1-terminal_Fleet_1\")   )     # Fishery selectivity and catchability   input_list <- Setup_Mod_Fishsel_and_Q(     input_list = input_list,     # Model options     fish_sel_model = c(\"gamma_Fleet_1\"), # fishery selex model (NOTE: ASSUMES DOMED)     fish_fixed_sel_pars_spec = c(\"est_all\"), # whether to estiamte all fixed effects for fishery selectivity     fish_q_spec = \"est_all\" # estimate fishery q   )    # Survey selectivity and catchability   input_list <- Setup_Mod_Srvsel_and_Q(     input_list = input_list,     # Model options     srv_sel_model = c(\"logist2_Fleet_1\"), # survey selectivity form     srv_fixed_sel_pars_spec = c(\"est_all\"), # whether to estimate all fixed effects for survey selectivity     srv_q_spec = c(\"est_all\")  # whether to estiamte all fixed effects for survey catchability   )    # Data weighting   input_list <- Setup_Mod_Weighting(     input_list = input_list,     Wt_Catch = 1,     Wt_FishIdx = 1,     Wt_SrvIdx = 1,     Wt_Rec = 1,     Wt_F = 1,     Wt_Tagging = 0,     Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions,length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets)),     Wt_SrvLenComps = array(0, dim = c(input_list$data$n_regions, length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets))   )    return(input_list)  }"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"run-cross-test-analysis","dir":"Articles","previous_headings":"Simulation Cross-Testing in SPoRC","what":"Run Cross-Test Analysis","title":"Simulation Testing (Cross and Self Tests)","text":"setting EM, can run cross-test fitting model simulated dataset. store resulting spawning stock biomass (SSB) estimates comparison OM. expected, simulation cross-test demonstrates misspecification fishery selectivity leads biased estimates key population quantities. particular, spawning stock biomass (SSB) positively biased EM incorrectly assumes dome-shaped selectivity true OM selectivity logistic, treating portion population invulnerable fishery, leading overestimation stock size.","code":"ssb_results <- array(NA, dim = c(sim_list$n_yrs, sim_list$n_sims)) # storage container for(i in 1:sim_obj$n_sims) {    input_list <- setup_em(sim_obj, sim = i) # setup EM    # fit model   model <- fit_model(input_list$data,                      input_list$par,                      input_list$map,                      random = NULL,                      silent = T                      )    ssb_results[,i] <- model$rep$SSB # save results  } # end i loop # Process SSB results ssb_df_res <- reshape2::melt(ssb_results) %>%   rename(Year = Var1, Sim = Var2, Est = value) %>%   dplyr::left_join(reshape2::melt(sim_obj$SSB) %>%                      dplyr::rename(Region = Var1, Year = Var2, Sim = Var3, True = value), by = c(\"Year\", \"Sim\")) %>%   dplyr::mutate(RE = (Est - True) / True * 100) %>%   dplyr::group_by(Year) %>%   dplyr::summarise(median = median(RE),                    lwr = quantile(RE, 0.1),                    upr = quantile(RE, 0.8))  # plot! print(   ggplot(ssb_df_res, aes(x = Year, y = median, ymin = lwr, ymax = upr)) +     geom_line(lwd = 1.3) +     geom_hline(yintercept = 0, lwd = 1.3, lty = 2) +     coord_cartesian(ylim = c(-50, 50)) +     geom_ribbon(alpha = 0.3) +     theme_bw(base_size = 15) +     labs(x = 'Year', y = 'SSB Relative Error (%)') )"},{"path":"https://chengmatt.github.io/SPoRC/articles/l_simulation_testing.html","id":"self-testing","dir":"Articles","previous_headings":"","what":"Self Testing","title":"Simulation Testing (Cross and Self Tests)","text":"addition simulation cross-testing, users can also conduct self-tests. Simulation self-testing useful helps evaluate model robustness context parameter identifiability. Ideally, simulation self-test return unbiased parameter estimates average. , generally indicates lack identifiability parameters given available data. , demonstrate simulation self-testing using Dusky Rockfish example. Simulation self-testing facilitated helper function simulation_self_test, allows users conduct simulations using fitted SPoRC model (.e., providing data, parameters, mapping, rep, sd_rep). reduce computation time, parallelize simulations across 8 cores output estimates SSB recruitment. self-test indicates model generally able recover overall trends well. However, biases manifest early late periods, likely due uncertainty catch data early period lack age composition data periods.","code":"# load in dusky rockfish model data(\"dusky_rtmb_model\")  # Using Dusky Rockfish as example to conduct simulation self-testing self_test <- simulation_self_test(   data = dusky_rtmb_model$data,   parameters = dusky_rtmb_model$parameters,   mapping = dusky_rtmb_model$mapping,   random = NULL,   rep = dusky_rtmb_model$rep,   sd_rep = dusky_rtmb_model$sdrep,   n_sims = 500,    newton_loops = 3,   do_sdrep = FALSE,   do_par = TRUE,   n_cores = 8,   output_path = NULL,   what = c(\"SSB\", \"Rec\") ) # Process self test results self_test_res <- reshape2::melt(self_test$SSB) %>%   dplyr::rename(Region = Var1, Year = Var2, Sim = Var3, Est = value) %>%   dplyr::left_join(reshape2::melt(dusky_rtmb_model$rep$SSB) %>%                      dplyr::rename(Region = Var1, Year = Var2, Best = value),                    by = c(\"Region\", \"Year\")) %>%   dplyr::mutate(Type = 'SSB') %>%   dplyr::bind_rows(     reshape2::melt(self_test$Rec) %>%       dplyr::rename(Region = Var1, Year = Var2, Sim = Var3, Est = value) %>%       dplyr::left_join(reshape2::melt(dusky_rtmb_model$rep$Rec) %>%                          dplyr::rename(Region = Var1, Year = Var2, Best = value),                        by = c(\"Region\", \"Year\")) %>%       dplyr::mutate(Type = 'Rec')   )  print(   ggplot() +     geom_line(self_test_res, mapping = aes(x = Year, y = Est, group = Sim)) +     geom_line(self_test_res, mapping = aes(x = Year, y = Best), color = 'red', lty = 2, lwd = 1.3) +     coord_cartesian(ylim = c(0, NA)) +     facet_wrap(~Type, scales = 'free') +     theme_bw(base_size = 15) )"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"load-data-and-packages","dir":"Articles","previous_headings":"","what":"Load data and packages","title":"Running a Simple Assessment (The Basics)","text":"","code":"library(SPoRC) data(\"sgl_rg_dusky_data\")"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-model","dir":"Articles","previous_headings":"","what":"Setup model","title":"Running a Simple Assessment (The Basics)","text":"initially setup model, input list composed data list, parameter list, mapping list required. setup facilitated function Setup_Mod_Dim, users define vectors years, ages, lengths. Users must also specify number modeled regions (n_regions), sexes (n_sexes), fishery fleets (n_fish_fleets), survey fleets (n_srv_fleets).","code":"input_list <- Setup_Mod_Dim(   years = sgl_rg_dusky_data$years,   # vector of years   ages = sgl_rg_dusky_data$mod_ages,   # vector of ages   lens = sgl_rg_dusky_data$lens,   # number of lengths   n_regions = sgl_rg_dusky_data$n_regions,   # number of regions   n_sexes = sgl_rg_dusky_data$n_sexes,   # number of sexes   n_fish_fleets = sgl_rg_dusky_data$n_fish_fleets,   # number of fishery fleets   n_srv_fleets = sgl_rg_dusky_data$n_srv_fleets, # number of survey fleets   verbose = TRUE # whether to output messages )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-recruitment-dynamics","dir":"Articles","previous_headings":"Setup model","what":"Setup Recruitment Dynamics","title":"Running a Simple Assessment (The Basics)","text":"initializing input_list, object passed next function, Setup_Mod_Rec, define recruitment dynamics. GOA Dusky Rockfish model, recruitment specified follows: Mean recruitment estimated, lognormal bias correction applied, achieved setting bias ramp values 0 (turning bias ramp), Recruitment variability fixed, Spawning assumed occur start year.","code":"input_list <- Setup_Mod_Rec(   input_list = input_list,    # Model options   # Doing bias ramp, but basically setting it so that no lognormal bias correction happens (as in the dusky model)   do_rec_bias_ramp = 1,   bias_year = rep(length(sgl_rg_dusky_data$years), 4),   # do bias ramp (0 == don't do bias ramp, 1 == do bias ramp)   sigmaR_switch = 1,   # when to switch from early to late sigmaR (switch in first year)   ln_sigmaR = rep(-0.1068576 , 2), # 2 values for early and late sigma   # Starting values for early and late sigmaR   rec_model = \"mean_rec\",   sigmaR_spec = \"fix\",   # fix early sigmaR and late sigmaR   init_age_strc = 1, # geometric series to derive initial age structure   ln_global_R0 = log(2.7), # starting value for mean_rec   t_spawn = sgl_rg_dusky_data$spwn_month )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-biological-dynamics","dir":"Articles","previous_headings":"Setup model","what":"Setup biological dynamics","title":"Running a Simple Assessment (The Basics)","text":"updated input_list previous step, next stage parameterize modelâ€™s biological dynamics. function Setup_Mod_Biologicals requires weight--age (WAA) maturity--age (MatAA) inputs, dimensioned n_regions, n_years, n_ages, n_sexes. case, natural mortality assumed constant fixed 0.07.","code":"input_list <- Setup_Mod_Biologicals(   input_list = input_list,    # Data inputs   WAA = sgl_rg_dusky_data$waa_arr, # weight at age array   MatAA = sgl_rg_dusky_data$mataa_arr, # maturity at age array    # Model options   # fit lengths   fit_lengths = 1,   SizeAgeTrans = sgl_rg_dusky_data$sizeage, # size age transition   AgeingError = sgl_rg_dusky_data$age_error_matrix, # ageing error matrix   M_spec = \"fix\",   # fixing natural mortality   Fixed_natmort = sgl_rg_dusky_data$fix_natmort,   addtocomp = 0.00001 # adding small constant to compositions )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-movement-and-tagging","dir":"Articles","previous_headings":"Setup model","what":"Setup Movement and Tagging","title":"Running a Simple Assessment (The Basics)","text":"vignette illustrates single-region model, movement dynamics included. However, users must specify movement parameterized. example, movement estimated (use_fixed_movement = 1), movement matrix set identity (Fixed_Movement = NA), recruits assumed move (do_recruits_move = 0). Tagging dynamics defined similarly: input_list updated UseTagging argument set 0.","code":"# setup movement   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )  # setup tagging   input_list <- Setup_Mod_Tagging(     input_list = input_list,      UseTagging = 0)"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-catch-and-fishing-mortality","dir":"Articles","previous_headings":"Setup model","what":"Setup Catch and Fishing Mortality","title":"Running a Simple Assessment (The Basics)","text":"function Setup_Mod_Catch_and_F updates input_list catch data fishing mortality specifications. Three data inputs required: observed catch (ObsCatch), type catch (Catch_Type), indicator whether catch used model (UseCatch). Model options include switch applying fishing mortality penalty (Use_F_pen) whether catch error standard deviation fixed estimated (sigmaC_spec), small constant added avoid problems zero catches (Catch_Constant). Finally, fixed values observation error catch (ln_sigmaC) penalty fishing mortality (ln_sigmaF) provided. Note specified log((1/2))log(\\sqrt{(1/2)}) model originally written ADMB values computed sum squares, standard deviation terms implicitly assumed set 1.","code":"input_list <- Setup_Mod_Catch_and_F(   input_list = input_list,    # Data inputs   ObsCatch = sgl_rg_dusky_data$ObsCatch, # observed catch   Catch_Type = sgl_rg_dusky_data$Catch_Type, # catch type   UseCatch = sgl_rg_dusky_data$UseCatch, # whether catch is used    # Model options   Use_F_pen = 1,   # whether to use f penalty, == 0 don't use, == 1 use   sigmaC_spec = \"fix\",    # Fixing sigma C and F   ln_sigmaC = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, length(input_list$data$years), input_list$data$n_fish_fleets)),   ln_sigmaF = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, input_list$data$n_fish_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-fishery-indices-and-compositions","dir":"Articles","previous_headings":"Setup model","what":"Setup Fishery Indices and Compositions","title":"Running a Simple Assessment (The Basics)","text":"Next, function Setup_Mod_FishIdx_and_Comps updates input_list fishery index composition data. Inputs include observed fishery indices associated standard errors, indicators whether index used, observed age length compositions corresponding use flags input sample sizes. Model options define data treated: case, fishery index applied (fish_idx_type = \"none\"), age length compositions modeled multinomial likelihoods, composition structures specified agg_Year_1-terminal_Fleet_1 (single region, single sex model, composition structures specified , wherein data aggregated across model partitions).","code":"input_list <- Setup_Mod_FishIdx_and_Comps(   input_list = input_list,    # data inputs   ObsFishIdx = sgl_rg_dusky_data$ObsFishIdx, # fishery index   ObsFishIdx_SE = sgl_rg_dusky_data$ObsFishIdx_SE, # standard errors   UseFishIdx = sgl_rg_dusky_data$UseFishIdx, # whether fishery indices are used   ObsFishAgeComps = sgl_rg_dusky_data$ObsFishAgeComps, # observed fishery ages   UseFishAgeComps = sgl_rg_dusky_data$UseFishAgeComps, # whether fishery ages are used   ISS_FishAgeComps = sgl_rg_dusky_data$ISS_FishAgeComps, # input sample size for fishery ages   ObsFishLenComps = sgl_rg_dusky_data$ObsFishLenComps, # observed fishery lengths   UseFishLenComps = sgl_rg_dusky_data$UseFishLenComps, # whether fishery lengths are used   ISS_FishLenComps = sgl_rg_dusky_data$ISS_FishLenComps, # input sample size for fishery lengths    # Model options   fish_idx_type = c(\"none\"),   # indices for fishery   FishAgeComps_LikeType = c(\"Multinomial\"),   # age comp likelihoods for fishery fleet   FishLenComps_LikeType = c(\"Multinomial\"),   # length comp likelihoods for fishery   FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),   # age comp structure for fishery   FishLenComps_Type = c(\"agg_Year_1-terminal_Fleet_1\")   # length comp structure for fishery )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-survey-indices-and-compositions","dir":"Articles","previous_headings":"Setup model","what":"Setup Survey Indices and Compositions","title":"Running a Simple Assessment (The Basics)","text":"Setup_Mod_SrvIdx_and_Comps function defined similar previous code chunk, instead, updates input_list survey indices composition data.","code":"input_list <- Setup_Mod_SrvIdx_and_Comps(   input_list = input_list,    # data inputs   ObsSrvIdx = sgl_rg_dusky_data$ObsSrvIdx, # observed survey index   ObsSrvIdx_SE = sgl_rg_dusky_data$ObsSrvIdx_SE / sgl_rg_dusky_data$ObsSrvIdx, # lognormal SD   UseSrvIdx = sgl_rg_dusky_data$UseSrvIdx, # whether survey indices are used   ObsSrvAgeComps = sgl_rg_dusky_data$ObsSrvAgeComps, # observed survey ages   ISS_SrvAgeComps = sgl_rg_dusky_data$ISS_SrvAgeComps, # input sample size for survey ages   UseSrvAgeComps = sgl_rg_dusky_data$UseSrvAgeComps, # whether survey ages are used   ObsSrvLenComps = sgl_rg_dusky_data$ObsSrvLenComps, # observed survey lengths   UseSrvLenComps = sgl_rg_dusky_data$UseSrvLenComps, # whether survey lengths are used   ISS_SrvLenComps = sgl_rg_dusky_data$ISS_SrvLenComps, # input sample size for survey lengths    # Model options   srv_idx_type = c(\"biom\"),   # abundance and biomass for survey fleet 1   SrvAgeComps_LikeType = c(\"Multinomial\"),   # survey age composition likelihood for survey fleet 1   SrvLenComps_LikeType = c(\"Multinomial\"),   #  survey length composition likelihood for survey fleet 1   SrvAgeComps_Type = c(     \"agg_Year_1-terminal_Fleet_1\"   ),   # survey age comp type    SrvLenComps_Type = c(     \"agg_Year_1-terminal_Fleet_1\"   )   # survey length comp type )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-fishery-selectivity-and-catchability","dir":"Articles","previous_headings":"Setup model","what":"Setup Fishery Selectivity and Catchability","title":"Running a Simple Assessment (The Basics)","text":"Following defining data inputs model, can specify fishery selectivity catchability parameterizations. , time-varying selectivity specified, selectivity modelled logistic parameters b50b_{50} b95b_{95}. Catchability fixed fishery indices included model.","code":"input_list <- Setup_Mod_Fishsel_and_Q(    input_list = input_list,    # Model options   # fishery selectivity, whether continuous time-varying   cont_tv_fish_sel = c(\"none_Fleet_1\"),   # fishery selectivity blocks   fish_sel_blocks = c(\"none_Fleet_1\"),   # fishery selectivity form   fish_sel_model = c(\"logist2_Fleet_1\"),   # fishery catchability blocks   fish_q_blocks = c(\"none_Fleet_1\"),   # whether to estiamte all fixed effects for fishery selectivity   fish_fixed_sel_pars_spec = c(\"est_all\"),   # whether to estiamte all fixed effects for fishery catchability   fish_q_spec = c(\"fix\") )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-survey-selectivity-and-catchability","dir":"Articles","previous_headings":"Setup model","what":"Setup Survey Selectivity and Catchability","title":"Running a Simple Assessment (The Basics)","text":"Similar Setup_Mod_Fishsel_and_Q function, can define survey selectivity catchability parameterizations. , time-vaying selectivity specified, selectivity modelled logistic parameters b50b_{50} b95b_{95}. However, catchabiltiy estiamted estimated survey index. Note survey prior specifications must passed function dataframe column names: region, block, fleet, mu, sd.","code":"# Set up prior for survey catchability srv_q_prior <- data.frame(   region = 1,   block = 1,   fleet = 1,   mu = 1,   sd = 0.447213595 )  input_list <- Setup_Mod_Srvsel_and_Q(   input_list = input_list,    # Model options   # survey selectivity, whether continuous time-varying   cont_tv_srv_sel = c(\"none_Fleet_1\"),   # survey selectivity blocks   srv_sel_blocks = c(\"none_Fleet_1\"),   # survey selectivity form   srv_sel_model = c(\"logist2_Fleet_1\"),   # survey catchability blocks   srv_q_blocks = c(\"none_Fleet_1\"),   # whether to estiamte all fixed effects for survey selectivity   srv_fixed_sel_pars_spec = c(\"est_all\"),   # whether to estiamte all fixed effects for survey catchability   srv_q_spec = c(\"est_all\"),   Use_srv_q_prior = 1,   # Use catchability prior   srv_q_prior = srv_q_prior )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"setup-model-weighting","dir":"Articles","previous_headings":"Setup model","what":"Setup Model Weighting","title":"Running a Simple Assessment (The Basics)","text":"Finally, model weighting scheme can defined control relative influence different data sources assessment. GOA Dusky Rockfish model, weighting applied using Î»\\lambda emphasis factors, allow certain data types less influence model fitting. users prefer apply differential weighting, values can set 1. catch data, different weighting scheme applied early years model: catches 1977â€“1991 given weight 2, catches later years assigned higher weight 50. weighting setup implemented using function Setup_Mod_Weighting, accepts constructed input_list along specific weights various data components. , catch weights defined described , fishery indices given weight 1, survey indices weight 1.66, recruitment weight 1, fishing mortality weight 2. Tagging data used, weight set 0. Age length compositions fishery survey fleets assigned arrays weights, typically set 1 fishery data survey ages, survey length compositions set 0.","code":"# catch weigthing  Wt_Catch <- array(0, dim = c(sgl_rg_dusky_data$n_regions, length(sgl_rg_dusky_data$years), sgl_rg_dusky_data$n_fish_fleets)) Wt_Catch[,which(sgl_rg_dusky_data$years %in% 1977:1991),] <- 2 Wt_Catch[,-which(sgl_rg_dusky_data$years %in% 1977:1991),] <- 50  input_list <- Setup_Mod_Weighting(   input_list = input_list,   Wt_Catch = Wt_Catch,   Wt_FishIdx = 1,   Wt_SrvIdx = 1.66,   Wt_Rec = 1,   Wt_F = 2,   Wt_Tagging = 0,   Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_fish_fleets)),   Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions,                                      length(input_list$data$years),                                      input_list$data$n_sexes,                                      input_list$data$n_fish_fleets)),   Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)),   Wt_SrvLenComps = array(0, dim = c(input_list$data$n_regions,                                     length(input_list$data$years),                                     input_list$data$n_sexes,                                     input_list$data$n_srv_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fit-model","dir":"Articles","previous_headings":"","what":"Fit model","title":"Running a Simple Assessment (The Basics)","text":"model fully defined, can fitted data. example, fit two models. first model uses setup described without additional weighting adjustments. second model applies Francis re-weighting base model. approach serves illustrate compare alternative model configurations demonstrates implementation Francis re-weighting within SPoRC framework. First, let us extract data, parameters, mapping lists constructed functions defined .","code":"data <- input_list$data parameters <- input_list$par mapping <- input_list$map"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fit-model-without-francis","dir":"Articles","previous_headings":"Fit model","what":"Fit model (Without Francis)","title":"Running a Simple Assessment (The Basics)","text":"fit model without Francis reweighting, users can call fit_model helper function pass data, parameters, mapping list. random effects specified model, total 3 newton loops specified ensure model approaches minimum. Following optimization model, can extract standard error report model (.e., standard errors derived inverting Hessian matrix).","code":"# Fit model nofrancis_model <- fit_model(data,                              parameters,                              mapping,                              random = NULL,                              newton_loops = 3,                              silent = FALSE )  nofrancis_model$sdrep <- RTMB::sdreport(nofrancis_model) # get standard error report"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fit-model-with-francis","dir":"Articles","previous_headings":"Fit model","what":"Fit model (With Francis)","title":"Running a Simple Assessment (The Basics)","text":"Conducting Francis re-weighting composition data requires iterative procedure adjust effective weights age length compositions based model fit. First, separate copy data list (francis_data) created, updated revised weights iterations. number Francis iterations specified (n_francis_iter = 10), indicates number times model refit, composition weights updated model iteration. run_francis function conducts reweighting procedure weights saved inside data list object (francis_runs$obj$data)","code":"francis_data <- data # redefine data list for francis (replacing data weights)  # run francis reweighting francis_runs <- run_francis(francis_data,                              parameters,                              mapping,                              n_francis_iter = 10,                              newton_loops =  3)  # get obj francis_model <- francis_runs$obj francis_data <- francis_runs$obj$data francis_model$sdrep <- RTMB::sdreport(francis_model) # get standard error report"},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"convergence","dir":"Articles","previous_headings":"Check Model Results","what":"Convergence","title":"Running a Simple Assessment (The Basics)","text":"Following model optimization, helper functions can utilized perform post-optimization sanity checks ensure estimates reliable. function post_optim_sanity_checks evaluates fit examining standard errors, gradients, correlations parameter estimates. example, function applied model without Francis re-weighting (nofrancis_model) model Francis re-weighting (francis_model). checks required users specify tolerances gradients, standard errors, correlations among parameters. following models appear pass sanity checks.","code":"# check no francis model post_optim_sanity_checks(nofrancis_model$sdrep,                          nofrancis_model$rep,                          gradient_tol = 1e-5,                          se_tol = 5,                          corr_tol = 0.95)  # check francis model post_optim_sanity_checks(francis_model$sdrep,                          francis_model$rep,                          gradient_tol = 1e-5,                          se_tol = 5,                          corr_tol = 0.95)"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"time-series-results","dir":"Articles","previous_headings":"Check Model Results","what":"Time Series Results","title":"Running a Simple Assessment (The Basics)","text":"Next, can compare time series results two models using helper functions SPoRC. function get_ts_plot used generate comparative plots Francis re-weighted model model without Francis re-weighting. resulting list plots (ts_plot) provides visual comparison key metrics, including spawning biomass, recruitment, total biomass, fishing mortality. Accessing ts_plot[[1]] displays first plot list, presents combined time series across metrics. function can also used single model.","code":"ts_plot <- get_ts_plot(rep = list(francis_model$rep, nofrancis_model$rep),                        sd_rep = list(francis_model$sdrep, nofrancis_model$sdrep),                        model_names = c(\"With Francis\", \"No Francis\"))  ts_plot[[1]]"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"catch-and-index-fits","dir":"Articles","previous_headings":"Check Model Results","what":"Catch and Index Fits","title":"Running a Simple Assessment (The Basics)","text":"can also compare fits catch data index data. can achieved using get_catch_fits_plot get_idx_fits_plot functions. fits catch data, given following code chunk.  Fits index data can illustrated similar manner given following code chunk.","code":"get_catch_fits_plot(list(data, francis_data),                     list(nofrancis_model$rep, francis_model$rep),                     c(\"No Francis\", \"With Francis\")) get_idx_fits_plot(list(data, francis_data),                   list(nofrancis_model$rep, francis_model$rep),                   c(\"No Francis\", \"With Francis\"))"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"composition-fits","dir":"Articles","previous_headings":"Check Model Results","what":"Composition Fits","title":"Running a Simple Assessment (The Basics)","text":"GOA Dusky Rockfish model fits total 3 composition datasets, include fishery ages lengths, well survey ages. inspect model fits, users can extract observed expected composition proportions using get_comp_prop function. Next, can obtain one-step-ahead (OSA) residuals, uses afscOSA package, well plot aggregated fits. following code chunk computes OSA residuals composition data assess model fit. get_osa function computes residuals comparing observed (Obs_FishAge_mat) predicted (Pred_FishAge_mat) age compositions, accounting effective sample sizes combine input sample size Francis re-weighting factors, across years age bins interest fleet 1. can visualize residuals SPoRC::plot_resids, generates diagnostic plots bubble plots QQ plots. can also additionally plot aggregated fits composition data diagnostic tool.","code":"# Extract observed and expected compositions comp_prop <- get_comp_prop(francis_data,                            francis_model$rep,                            age_labels = 4:30,                            len_labels = 21:52,                            year_labels = 1977:2024)"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fishery-ages","dir":"Articles","previous_headings":"Check Model Results > Composition Fits","what":"Fishery Ages","title":"Running a Simple Assessment (The Basics)","text":"","code":"# get one step ahead fishery ages fishages <- get_osa(obs_mat = comp_prop$Obs_FishAge_mat, # observed fishery age compositions                     exp_mat = comp_prop$Pred_FishAge_mat, # predicted fishery age compositions                     N = francis_data$ISS_FishAgeComps[1,which(francis_data$UseFishAgeComps[,,1] == 1),1,1] * # input sample size                       unique(francis_data$Wt_FishAgeComps[1,which(francis_data$UseFishAgeComps[,,1] == 1),1,1]), # francis weight                     years = which(francis_data$UseFishAgeComps[,,1] == 1), # years with fishery ages                     fleet = 1, # fleet                     bins = 4:30, # age bins                     comp_type = 0, # composition type (age-specific)                     bin_label = \"Ages\" # bin labels                     )  # plot OSA residuals resid_plot <- SPoRC::plot_resids(osa_results = fishages)  # Get Aggregated Plot fishage_agg <- comp_prop$Fishery_Ages %>%   group_by(Age, Fleet) %>%   summarize(obs = mean(obs), pred = mean(pred)) %>%   filter(Fleet == 1) %>%   ggplot() +   geom_col(aes(x = Age, y = obs), fill = 'darkgreen', alpha = 0.8) +   geom_line(aes(x = Age, y = pred), col = 'black', lwd = 1.3) +   theme_bw(base_size = 15) +   labs(x = 'Age', y = 'Proportions')  cowplot::plot_grid(resid_plot[[2]], # Bubble                    cowplot::plot_grid(resid_plot[[1]], fishage_agg, nrow = 1), # QQ and Aggregated                    ncol = 1, rel_heights = c(0.6, 0.4))"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fishery-lengths","dir":"Articles","previous_headings":"Check Model Results > Composition Fits","what":"Fishery Lengths","title":"Running a Simple Assessment (The Basics)","text":"","code":"# get one step ahead fishery lengths fishlens <- get_osa(obs_mat = comp_prop$Obs_FishLen_mat, # observed fishery length compositions                     exp_mat = comp_prop$Pred_FishLen_mat, # predicted fishery length compositions                     N = francis_data$ISS_FishLenComps[1,which(francis_data$UseFishLenComps[,,1] == 1),1,1] * # input sample size                       unique(francis_data$Wt_FishLenComps[1,which(francis_data$UseFishLenComps[,,1] == 1),1,1]), # francis weight                     years = which(francis_data$UseFishLenComps[,,1] == 1), # years with fishery ages                     fleet = 1, # fleet                     bins = 21:52, # age bins                     comp_type = 0, # composition type (age-specific)                     bin_label = \"Lengths\" # bin labels )  # plot OSA residuals resid_plot <- SPoRC::plot_resids(osa_results = fishlens)  # Get Aggregated Plot fishlen_agg <- comp_prop$Fishery_Lens %>%   group_by(Len, Fleet) %>%   summarize(obs = mean(obs), pred = mean(pred)) %>%   filter(Fleet == 1) %>%   ggplot() +   geom_col(aes(x = Len, y = obs), fill = 'darkgreen', alpha = 0.8) +   geom_line(aes(x = Len, y = pred), col = 'black', lwd = 1.3) +   theme_bw(base_size = 15) +   labs(x = 'Lengths', y = 'Proportions')  cowplot::plot_grid(resid_plot[[2]], # Bubble                    cowplot::plot_grid(resid_plot[[1]], fishlen_agg, nrow = 1), # QQ and Aggregated                    ncol = 1, rel_heights = c(0.6, 0.4))"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"survey-ages","dir":"Articles","previous_headings":"Check Model Results > Composition Fits","what":"Survey Ages","title":"Running a Simple Assessment (The Basics)","text":"","code":"# get one step ahead survey ages srvages <- get_osa(obs_mat = comp_prop$Obs_SrvAge_mat, # observed survey age compositions                    exp_mat = comp_prop$Pred_SrvAge_mat, # predicted survey age compositions                    N = francis_data$ISS_SrvAgeComps[1,which(francis_data$UseSrvAgeComps[,,1] == 1),1,1] * # input sample size                      unique(francis_data$Wt_SrvAgeComps[1,which(francis_data$UseSrvAgeComps[,,1] == 1),1,1]), # francis weight                    years = which(francis_data$UseSrvAgeComps[,,1] == 1), # years with survey ages                    fleet = 1, # fleet                    bins = 4:30, # age bins                    comp_type = 0, # composition type (age-specific)                    bin_label = \"Ages\" # bin labels )  # plot OSA residuals resid_plot <- SPoRC::plot_resids(osa_results = srvages)  # Get Aggregated Plot srvage_agg <- comp_prop$Survey_Ages %>%   group_by(Age, Fleet) %>%   summarize(obs = mean(obs), pred = mean(pred)) %>%   filter(Fleet == 1) %>%   ggplot() +   geom_col(aes(x = Age, y = obs), fill = 'darkgreen', alpha = 0.8) +   geom_line(aes(x = Age, y = pred), col = 'black', lwd = 1.3) +   theme_bw(base_size = 15) +   labs(x = 'Age', y = 'Proportions')  cowplot::plot_grid(resid_plot[[2]], # Bubble                    cowplot::plot_grid(resid_plot[[1]], srvage_agg, nrow = 1), # QQ and Aggregated                    ncol = 1, rel_heights = c(0.6, 0.4))"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"retrospectives","dir":"Articles","previous_headings":"","what":"Retrospectives","title":"Running a Simple Assessment (The Basics)","text":"addition evaluating model fits, useful examine retrospective behavior model identify potential misspecifications assess consistency management advice time. can done using do_retrospective function, performs retrospective analysis sequentially removing data years prior terminal year. models Francis re-weighting, retrospective peel also updates composition weights, whereas models without re-weighting . get_retrospective_plot function generates visualizations retrospective results, including plots relative differences, absolute scale differences, squid plot recruitment.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"retrospectives-without-francis","dir":"Articles","previous_headings":"Retrospectives","what":"Retrospectives (Without Francis)","title":"Running a Simple Assessment (The Basics)","text":"","code":"nofrancis_retro <- do_retrospective(   n_retro = 10, # number of peels   data = data, # data list (not francis data)   parameters = parameters, # parameters list   mapping = mapping, # mapping list   random = NULL, # random effects   do_par = TRUE, # whether to parallellize   n_cores = 8,  # number of cores to use   do_francis = FALSE,  # whether to do francis within a given retrospective peel )  # get retrospective plots nofrancis_retro_plot <- get_retrospective_plot(nofrancis_retro, Rec_Age = 4) nofrancis_retro_plot[[1]] nofrancis_retro_plot[[2]] nofrancis_retro_plot[[3]]"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"retrospectives-with-francis","dir":"Articles","previous_headings":"Retrospectives","what":"Retrospectives (With Francis)","title":"Running a Simple Assessment (The Basics)","text":"","code":"# do retrospective w/ francis francis_retro <- do_retrospective(   n_retro = 10, # number of peels   data = francis_data, # data list (francis data)   parameters = parameters, # parameters list   mapping = mapping, # mapping list   random = NULL, # random effects   do_par = TRUE, # whether to parallellize   n_cores = 8,  # number of cores to use   do_francis = TRUE,  # whether to do francis within a given retrospective peel   n_francis_iter = 10 # number of francis iterations to run within a given retrospective peel )  # get retrospective plot francis_retro_plot <- get_retrospective_plot(francis_retro, Rec_Age = 4) francis_retro_plot[[1]] francis_retro_plot[[2]] francis_retro_plot[[3]]"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"likelihood-profiles","dir":"Articles","previous_headings":"","what":"Likelihood Profiles","title":"Running a Simple Assessment (The Basics)","text":"Another useful diagnostic tool can help identify data conflits potential need re-parameterize model likelihood profiles. , do_likelihood_profile function used profile parameter ln_global_R0 Francis re-weighted model. function takes data list, parameter list, mapping list, iteratively evaluates likelihood across specified range values. do_likelihood_profile outputs list profiled values data component respective dimensions (e.g., likelihood profiles fleet, region, year, etc.) well likelihood profiles data component, aggregated across respective dimensions.","code":"# do likelihood profile with francis weights francis_meanrec_prof <- do_likelihood_profile(   francis_data, # francis data list   parameters, # parameter list   mapping, # mapping list   random = NULL, # random effects   what = 'ln_global_R0', # parameter to profile   min_val = log(francis_model$rep$R0) * 0.1,  # min values to profile across   max_val = log(francis_model$rep$R0) * 2,  # max values to profile across   inc = 0.1, # increment for min and max values to profile across   do_par =  TRUE, # whether to parrallelize   n_cores = 8 # number of cores )  # summarize profile francis_mean_rec_profile <- francis_meanrec_prof$agg_nLL %>%   mutate(Summarized_Type = case_when(     str_detect(type, \"Pen|Prior\") ~ \"Other\",     str_detect(type, \"Len\") ~ \"Length Comps\",     str_detect(type, \"Age\") ~ \"Age Comps\",     str_detect(type, \"Idx\") ~ \"Indices\",     str_detect(type, \"Catch\") ~ \"Catch\",     str_detect(type, \"jnLL\") ~ \"jnLL\",   )) %>%   filter(value != 0) %>%   group_by(Summarized_Type, prof_val) %>%   summarize(value = sum(value), .groups = \"drop\") %>%   group_by(Summarized_Type) %>%   mutate(value = value - min(value))  ggplot(francis_mean_rec_profile, aes(x = prof_val, y = value, color = Summarized_Type)) +   geom_line(lwd = 1.3) +   geom_vline(xintercept = log(francis_model$rep$R0), lty = 2) +   labs(x = 'Log Mean Recruitment', y = \"Scaled nLL\", color = \"Type\") +   theme_bw(base_size = 15)"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"jitter-analysis","dir":"Articles","previous_headings":"","what":"Jitter Analysis","title":"Running a Simple Assessment (The Basics)","text":"Jitter analysis useful diagnostic assessing whether model truly converged, may stuck local minimum, understand model stability. do_jitter function perturbs initial parameter values adding random noise refits model multiple times. example, 50 jittered starts generated Francis re-weighted model, standard deviation 0.5 (additive normal) applied initial parameter values. jittered model optimized using three Newton loops, parallel processing 8 cores used enhance computational speed. can plot jitter results understand number times model converged, whether better solution achieved, trajectories spawning biomass recruitment jitter results.","code":"# get jitter results jitter_res <- do_jitter(data = francis_data, # francis data list                                parameters = parameters, # parameter list                                mapping = mapping, # mapping list                                random = NULL, # random effects                                sd = 0.5, # standard deviation for jitter                                n_jitter = 50, # number of jitters                                n_newton_loops = 3, # newton loops to od                                do_par = TRUE, # whether to parrallelize                                n_cores = 8 # number of cores to use )  # get proportion converged prop_converged <- jitter_res %>%   filter(Year == 1, Type == 'Recruitment') %>%   summarize(prop_conv = sum(Hessian) / length(Hessian))  # get jitter results final_mod <- reshape2::melt(francis_model$rep$SSB) %>% rename(Region = Var1, Year = Var2) %>%   mutate(Type = 'SSB') %>%   bind_rows(reshape2::melt(francis_model$rep$Rec) %>%               rename(Region = Var1, Year = Var2) %>% mutate(Type = 'Recruitment')) ggplot() +   geom_line(jitter_res, mapping = aes(x = Year + 1976, y = value, group = jitter, color = Hessian), lwd = 1) +   geom_line(final_mod, mapping = aes(x = Year + 1976, y = value), color = \"black\", lwd = 1.3 , lty = 2) +   facet_grid(Type~Region, scales = 'free',              labeller = labeller(Region = function(x) paste0(\"Region \", x),                                  Type = c(\"Recruitment\" = \"Age 2 Recruitment (millions)\", \"SSB\" = 'SSB (kt)'))) +   labs(x = \"Year\", y = \"Value\") +   theme_bw(base_size = 20) +   scale_color_manual(values = c(\"red\", 'grey')) +   geom_text(data = jitter_res %>% filter(Type == 'SSB', Year == 1, jitter == 1),             aes(x = Inf, y = Inf, label = paste(\"Proportion Converged: \", round(prop_converged$prop_conv, 3))),             hjust = 1.1, vjust = 1.9, size = 6, color = \"black\") ggplot(jitter_res, aes(x = jitter, y = jnLL, color = Max_Gradient, shape = Hessian)) +   geom_point(size = 5, alpha = 0.3) +   geom_hline(yintercept = min(francis_model$rep$jnLL), lty = 2, size = 2, color = \"blue\") +   facet_wrap(~Hessian, labeller = labeller(     Hessian = c(\"FALSE\" = \"non-PD Hessian\", \"TRUE\" = 'PD Hessian')   )) +   scale_color_viridis_c() +   theme_bw(base_size = 20) +   theme(legend.position = \"bottom\") +   guides(color = guide_colorbar(barwidth = 15, barheight = 0.5)) +   labs(x = 'Jitter') +   geom_text(data = jitter_res %>% filter(Hessian == TRUE, Year == 1, jitter == 1),             aes(x = Inf, y = Inf, label = paste(\"Proportion Converged: \", round(prop_converged$prop_conv, 3))),             hjust = 1.1, vjust = 1.9, size = 6, color = \"black\")"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"mcmc","dir":"Articles","previous_headings":"","what":"MCMC","title":"Running a Simple Assessment (The Basics)","text":"Lastly, SPoRC can also interact Bayesian software (.e, adnuts) conduct MCMC analysis, estimates parameter uncertainty also samples full joint posterior, revealing parameter correlations, skewed distributions, potential multimodality MLE may miss. Comparing MCMC results maximum likelihood estimates helps assess consistency point estimates standard errors. particular, can utilize native functionality built adnuts, seamlessly integrates TMB RTMB models, demonstrated following sections. First, let us install load relevant packages. sample_snuts function adnuts runs Bayesian MCMC analysis using RTMB model. example, four chains run 10,000 iterations , along 4 Markov chains. Additionally, adapt_delta set 0.99 ensure model takes smaller steps, helps improve MCMC model convergence. Default settings used throughout example sample_snuts users can refer https://cole-monnahan-noaa.github.io/adnuts/ details. running MCMC diagnostics, users can inspect summary statistics model object, includes posterior means, standard deviations, effective sample sizes (n_eff), convergence diagnostics (R_hat). can inspect various model diagnostics, ranging pairs plots, comparisons marginal distributions MLE MCMC, trace plots, comparisons uncertainty MCMC MLE.  Time series recruitment spawning stock biomass derived posterior samples can also readily plotted.","code":"# load in adnuts ans associated packages for MCMC install.packages('StanEstimators', repos = c('<https://andrjohns.r-universe.dev>', '<https://cloud.r-project.org>')) devtools::install_github('Cole-Monnahan-NOAA/adnuts') library(adnuts) # run MCMC mcmc <- sample_snuts(francis_model, num_samples = 1e4, control = list(adapt_delta = 0.99))  # Check MCMC summary diag_df <- mcmc$monitor pairs(mcmc) plot_marginals(mcmc) plot_uncertainties(mcmc) # get mcmc time series plots mcmc_ts_plot <- get_model_rep_from_mcmc(rtmb_obj = francis_model, adnuts_obj = mcmc_short, what = c(\"SSB\", \"Rec\"), n_cores = 4)  # ssb plot # summarize results ssb_summry <- mcmc_ts_plot$SSB %>%   group_by(Var1, Var2) %>%   summarize(median = median(value),             lwr = quantile(value, 0.025),             upr = quantile(value, 0.975)) ggplot() +   geom_line(ssb_summry, mapping = aes(x = Var2, y = median)) +   geom_ribbon(ssb_summry, mapping = aes(x = Var2, y = median, ymin = lwr, ymax = upr), alpha = 0.3) +   geom_line(reshape2::melt(francis_model$rep$SSB), mapping = aes(x = Var2, y = value), col = 'red', lwd = 1.3, lty = 2) +   coord_cartesian(ylim = c(0, NA)) +   labs(x = 'Year', y = 'Spawning Stock Biomass') +   theme_bw(base_size = 15)  # rec plot # summarize results rec_summry <- mcmc_ts_plot$Rec %>%   group_by(Var1, Var2) %>%   summarize(median = median(value),             lwr = quantile(value, 0.025),             upr = quantile(value, 0.975)) ggplot() +   geom_line(rec_summry, mapping = aes(x = Var2, y = median)) +   geom_ribbon(rec_summry, mapping = aes(x = Var2, y = median, ymin = lwr, ymax = upr), alpha = 0.3) +   geom_line(reshape2::melt(francis_model$rep$Rec), mapping = aes(x = Var2, y = value), col = 'red', lwd = 1.3, lty = 2) +   coord_cartesian(ylim = c(0, NA)) +   labs(x = 'Year', y = 'Recruitment') +   theme_bw(base_size = 15)"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"reference-points-and-projections","dir":"Articles","previous_headings":"","what":"Reference Points and Projections","title":"Running a Simple Assessment (The Basics)","text":"final step assessment workflow provide management advice based reference points derived model estimates. GOA Dusky Rockfish model, reference points based spawning potential ratios, aiming maintain population B40%B_{40\\%} fishing F40%F_{40\\%}. reference points projected forward generate catch advice future years. Additionally, compliance Magnuson-Stevens Reauthorization Act, range projection scenarios need conducted evaluate whether population within sustainable limits.","code":""},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"reference-points","dir":"Articles","previous_headings":"Reference Points and Projections","what":"Reference Points","title":"Running a Simple Assessment (The Basics)","text":"derive reference points catch advice population projections, Get_Reference_Points function used. Reference points corresponding SPR35%SPR_{35\\%}, SPR40%SPR_{40\\%}, SPR60%SPR_{60\\%} calculated. calc_rec_st_yr argument specifies vector estimated recruitment starting year 3 (corresponds 1979), subtracts terminal year rec_age = 4 compute mean recruitment used calculating Bx%B_{x\\%}.","code":"# get reference points spr_35 <- Get_Reference_Points(data = francis_data,                                rep = francis_model$rep,                                SPR_x = 0.35, t_spwn = 0, sex_ratio_f = 0.5,                                type = \"single_region\",                                what = 'SPR',                                calc_rec_st_yr = 3, rec_age = 4)  spr_40 <- Get_Reference_Points(data = francis_data,                                rep = francis_model$rep,                                type = \"single_region\",                                what = 'SPR',                                SPR_x = 0.4, t_spwn = 0, sex_ratio_f = 0.5,                                calc_rec_st_yr = 3, rec_age = 4)  spr_60 <- Get_Reference_Points(data = francis_data,                                rep = francis_model$rep,                                type = \"single_region\",                                what = 'SPR',                                SPR_x = 0.6, t_spwn = 0, sex_ratio_f = 0.5,                                calc_rec_st_yr = 3, rec_age = 4)  # Extract reference points b40 <- spr_40$b_ref_pt b60 <- spr_60$b_ref_pt b35 <- spr_35$b_ref_pt f40 <- spr_40$f_ref_pt f35 <- spr_35$f_ref_pt f60 <- spr_60$f_ref_pt"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"projections","dir":"Articles","previous_headings":"Reference Points and Projections","what":"Projections","title":"Running a Simple Assessment (The Basics)","text":"reference points derived can used provide catch advice population projections. First, harvest control rule (HCR) defined HCR_function, determines fishing mortality based stock status relative reference biomass Bx%B_{x\\%}. stock status reference point, fishing occurs target Fx%F_{x\\%}; stock status falls lower threshold (alpha) reference point, fishing mortality scaled linearly; stock status threshold, fishing set zero. Projection parameters specified, including number simulations (n_sims), projection years (n_proj_yrs), sex ratio, number regions, ages, fleets. Arrays initialized terminal numbers--age (terminal_NAA), weight--age (WAA WAA_fish), maturity--age (MatAA), selectivity (fish_sel), movement (used single-region model), terminal fishing mortality (terminal_F), natural mortality (natmort), recruitment, using terminal values historical recruitment fitted Francis re-weighted model. inputs form basis projecting future population dynamics deriving catch advice specified HCR. Next, can define Alaska projection scenarios understand stock within sustainable limits. scenarios vary fishing mortality applied relative biological reference points. Scenario 1 applies harvest control rule (HCR) using F40%F_{40\\%} maximum allowable fishing mortality, annual mean catch across simulations providing annual catch advice. Scenario 2 also uses HCR scales F40%F_{40\\%} based previous yearâ€™s fishing mortality. Scenario 3 applies constant fishing mortality equal average last five years. Scenario 4 applies fishing mortality using F60%F_{60\\%}, Scenario 5 assumes fishing. Scenario 6 applies HCR F35%F_{35\\%}, representing overfishing limit (FOFL). Finally, Scenario 7 applies HCR F40%F_{40\\%} first two projection years transitions F35%F_{35\\%} later years. Following setup seven projection scenarios, can simulate population dynamics forward case evaluate future spawning biomass, fishing mortality, catch. code loops projection scenarios simulation replicates, keeping record spawning stock biomass, fishing mortality, catch, Projections spawning stock biomass, catch advice, fishing mortality can visualized follows.","code":"# Define HCR to use for projections HCR_function <- function(x, frp, brp, alpha = 0.05) {   stock_status <- x / brp # define stock status   # If stock status is > 1   if(stock_status >= 1) f <- frp   # If stock status is between brp and alpha   if(stock_status > alpha && stock_status < 1) f <- frp * (stock_status - alpha) / (1 - alpha)   # If stock status is less than alpha   if(stock_status < alpha) f <- 0   return(f) }  # define projection parameters n_sims <- 1e3 t_spawn <- 0 n_proj_yrs <- 25 n_regions <- 1 n_ages <- length(francis_data$ages) n_sexes <- 1 n_fish_fleets <- 1 n_sexes <- 1 do_recruits_move <- 0 terminal_NAA <- array(francis_model$rep$NAA[,length(francis_data$years),,], dim = c(n_regions, n_ages, n_sexes)) terminal_NAA0 <- array(francis_model$rep$NAA0[,length(francis_data$years),,], dim = c(n_regions, n_ages, n_sexes)) WAA <- array(rep(francis_data$WAA[,length(francis_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # weight at age WAA_fish <- array(rep(francis_data$WAA[,length(francis_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # weight at age for fishery MatAA <- array(rep(francis_data$MatAA[,length(francis_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # maturity at age fish_sel <- array(rep(francis_model$rep$fish_sel[,length(francis_data$years),,,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets)) # selectivity Movement <- array(rep(francis_model$rep$Movement[,,length(francis_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_regions, n_proj_yrs, n_ages, n_sexes)) # movement - not used terminal_F <- array(francis_model$rep$Fmort[,length(francis_data$years),], dim = c(n_regions, n_fish_fleets)) # terminal F natmort <- array(rep(francis_model$rep$natmort[,length(francis_data$years),,], each = n_proj_yrs), dim = c(n_regions, n_proj_yrs, n_ages, n_sexes)) # natural mortaility recruitment <- array(francis_model$rep$Rec[,3:(length(francis_data$years) - 4)], dim = c(n_regions, length(3:(length(francis_data$years) - 4)))) # recruitment from years 3 - terminal (corresponds to 1979) sexratio <- array(1, dim = c(n_regions, n_proj_yrs, n_sexes)) # recruitment sex ratio # Define the F used for each scenario (Based on BSAI Intro Report - Alaska Scenarios) proj_inputs <- list(   # Scenario 1 - Using HCR to adjust maxFABC   list(f_ref_pt = array(f40, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = array(b40, dim = c(n_regions, n_proj_yrs)),        fmort_opt = 'HCR'   ),   # Scenario 2 - Using HCR to adjust maxFABC based on last year's value (constant fraction - author specified F)   list(f_ref_pt = array(f40 * (f40 / 0.091), dim = c(n_regions, n_proj_yrs)),        b_ref_pt = array(b40, dim = c(n_regions, n_proj_yrs)),        fmort_opt = 'HCR'   ),   # Scenario 3 - Using an F input of last 5 years average F, and   list(f_ref_pt = array(mean(francis_model$rep$Fmort[1, 43:47,]), dim = c(n_regions, n_proj_yrs)),        b_ref_pt = NULL,        fmort_opt = 'Input'   ),   # Scenario 4 - Using F60   list(f_ref_pt = array(f60, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = NULL,        fmort_opt = 'Input'   ),   # Scenario 5 - F is set at 0   list(f_ref_pt = array(0, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = NULL,        fmort_opt = 'Input'   ),   # Scenario 6 - Using HCR to adjust FOFL   list(f_ref_pt = array(f35, dim = c(n_regions, n_proj_yrs)),        b_ref_pt = array(b35, dim = c(n_regions, n_proj_yrs)),        fmort_opt = 'HCR'   ),   # Scenario 7 - Using HCR to adjust FABC in first 2 projection years, and then later years are adjusting FOFL   list(f_ref_pt = array(c(rep(f40, 2), rep(f35, n_proj_yrs - 2)), dim = c(n_regions, n_proj_yrs)),        b_ref_pt = array(c(rep(b40, 2), rep(b35, n_proj_yrs - 2)), dim = c(n_regions, n_proj_yrs)),        fmort_opt = 'HCR'   ) ) # store outputs all_scenarios_f <- array(0, dim = c(n_regions, n_proj_yrs, n_sims, length(proj_inputs))) all_scenarios_ssb <- array(0, dim = c(n_regions, n_proj_yrs, n_sims, length(proj_inputs))) all_scenarios_catch <- array(0, dim = c(n_regions, n_proj_yrs, n_fish_fleets, n_sims, length(proj_inputs)))  set.seed(123) for (i in seq_along(proj_inputs)) {   for (sim in 1:n_sims) {      # do population projection     out <- SPoRC::Do_Population_Projection(n_proj_yrs = n_proj_yrs,                                            n_regions = n_regions,                                            n_ages = n_ages,                                            n_sexes = n_sexes,                                            sexratio = sexratio,                                            n_fish_fleets = n_fish_fleets,                                            do_recruits_move = do_recruits_move,                                            recruitment = recruitment,                                            terminal_NAA = terminal_NAA,                                            terminal_NAA0 = terminal_NAA0,                                            terminal_F = terminal_F,                                            natmort = natmort,                                            WAA = WAA,                                            WAA_fish = WAA_fish,                                            MatAA = MatAA,                                            fish_sel = fish_sel,                                            Movement = Movement,                                            f_ref_pt = proj_inputs[[i]]$f_ref_pt,                                            b_ref_pt = proj_inputs[[i]]$b_ref_pt,                                            HCR_function = HCR_function,                                            recruitment_opt = \"inv_gauss\",                                            fmort_opt = proj_inputs[[i]]$fmort_opt,                                            t_spawn = t_spawn     )      all_scenarios_ssb[,,sim,i] <- out$proj_SSB     all_scenarios_catch[,,,sim,i] <- out$proj_Catch     all_scenarios_f[,,sim,i] <- out$proj_F[,-(n_proj_yrs+1)] # remove last year, since it's not used   } # end sim loop   print(i) } # end i loop"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"spawning-biomass-projections","dir":"Articles","previous_headings":"Reference Points and Projections > Projections","what":"Spawning Biomass Projections","title":"Running a Simple Assessment (The Basics)","text":"","code":"# Get historical SSB historical <- reshape2::melt(array(rep(francis_model$rep$SSB, n_sims),                                    dim = c(n_regions, length(francis_data$years), n_sims))) %>%   mutate(Year = Var2 + 1976,          Scenario = \"FABC (F40)\",  # or change to match the scenarios you're plotting          Type = \"Historical\") %>%   rename(Region = Var1, Simulation = Var3, SSB = value)  # Get all scenario projections scenarios <- reshape2::melt(all_scenarios_ssb) %>%   mutate(Year = Var2 + 2023,          Scenario = case_when(            Var4 == 1 ~ \"S1: FABC (F40)\",            Var4 == 2 ~ \"S2: FABC Ratio\",            Var4 == 3 ~ \"S3: F Last 5 Years\",            Var4 == 4 ~ \"S4: F60 SPR\",            Var4 == 5 ~ \"S5: No Fishing\",            Var4 == 6 ~ \"S6: FOFL\",            Var4 == 7 ~ \"S7: FABC -> FOFL\",            TRUE ~ paste(\"Scenario\", Var4)          ),          Type = \"Projection\") %>%   rename(Region = Var1, Simulation = Var3, SSB = value)  # expand historical SSB for plotting scenarios_unique <- unique(scenarios$Scenario) historical_expanded <- historical[rep(1:nrow(historical), times = length(scenarios_unique)), ] historical_expanded$Scenario <- rep(scenarios_unique, each = nrow(historical))  # combine combined_ssb <- bind_rows(historical_expanded, scenarios) combined_ssb %>%   ggplot(aes(x = Year, y = SSB, group = interaction(Scenario, Simulation), color = Type)) +   geom_line(alpha = 0.05) +   facet_wrap(~Scenario, scales = 'free') +   geom_hline(yintercept = b40, lty = 2) +   scale_color_manual(values = c(\"Historical\" = \"black\", \"Projection\" = \"blue\")) +   theme_bw(base_size = 15) +   theme(legend.position = 'none') combined_ssb %>%   filter(Year > 2024) %>%   group_by(Year, Scenario, Type) %>%   summarize(lwr = quantile(SSB, 0.025),             upr = quantile(SSB, 0.975),             SSB = mean(SSB)) %>%   ggplot(aes(x = Year, y = SSB, ymin = lwr, ymax = upr)) +   geom_line(alpha = 1, lwd = 1.3) +   geom_ribbon(color = NA, alpha = 0.3) +   facet_wrap(~Scenario) +   coord_cartesian(ylim = c(0, NA)) +   geom_hline(yintercept = b40, lty = 2) +   theme_bw(base_size = 15) +   theme(legend.position = 'none')"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"catch-projections","dir":"Articles","previous_headings":"Reference Points and Projections > Projections","what":"Catch Projections","title":"Running a Simple Assessment (The Basics)","text":"","code":"# Get historical catch historical <- reshape2::melt(array(rep(francis_data$ObsCatch, n_sims),                                    dim = c(n_regions, length(francis_data$years), francis_data$n_fish_fleets, n_sims))) %>%   mutate(Year = Var2 + 1976,          Scenario = \"FABC (F40)\",  # or change to match the scenarios you're plotting          Type = \"Historical\") %>%   rename(Region = Var1, Simulation = Var4, Fleet = Var3, Catch = value) %>%   select(-Var2)  historical$Catch[is.na(historical$Catch)] <- 0  # Get all scenario projections scenarios <- reshape2::melt(all_scenarios_catch) %>%   mutate(Year = Var2 + 2023,          Scenario = case_when(            Var5 == 1 ~ \"S1: FABC (F40)\",            Var5 == 2 ~ \"S2: FABC Ratio\",            Var5 == 3 ~ \"S3: F Last 5 Years\",            Var5 == 4 ~ \"S4: F60 SPR\",            Var5 == 5 ~ \"S5: No Fishing\",            Var5 == 6 ~ \"S6: FOFL\",            Var5 == 7 ~ \"S7: FABC -> FOFL\",            TRUE ~ paste(\"Scenario\", Var5)          ),          Type = \"Projection\") %>%   rename(Region = Var1, Simulation = Var4, Catch = value, Fleet = Var3) %>%   select(-c(Var2, Var5))  # expand historical catch for plotting scenarios_unique <- unique(scenarios$Scenario) historical_expanded <- historical[rep(1:nrow(historical), times = length(scenarios_unique)), ] historical_expanded$Scenario <- rep(scenarios_unique, each = nrow(historical))  # combine combined_cat <- bind_rows(historical_expanded, scenarios) combined_cat %>%   group_by(Year, Scenario, Simulation, Type, Region) %>%   summarize(Catch = sum(Catch)) %>%   ggplot(aes(x = Year, y = Catch, group = interaction(Scenario, Simulation), color = Type)) +   geom_line(alpha = 0.05) +   facet_wrap(~Scenario) +   coord_cartesian(ylim = c(0, NA)) +   scale_color_manual(values = c(\"Historical\" = \"black\", \"Projection\" = \"blue\")) +   theme_bw(base_size = 15) +   theme(legend.position = 'none') combined_cat %>%   filter(Year > 2024) %>%   group_by(Year, Scenario, Simulation, Type, Region) %>%   summarize(Catch = sum(Catch)) %>%   group_by(Year, Scenario, Type) %>%   summarize(lwr = quantile(Catch, 0.025),             upr = quantile(Catch, 0.975),             Catch = mean(Catch)) %>%   ggplot(aes(x = Year, y = Catch, ymin = lwr, ymax = upr)) +   geom_line(alpha = 1, lwd = 1.3) +   geom_ribbon(color = NA, alpha = 0.3) +   facet_wrap(~Scenario) +   coord_cartesian(ylim = c(0, NA)) +   theme_bw(base_size = 15) +   theme(legend.position = 'none')"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"catch-advice-under-f_40","dir":"Articles","previous_headings":"Reference Points and Projections > Projections","what":"Catch Advice under F40%F_{40\\%}","title":"Running a Simple Assessment (The Basics)","text":"Catch advice summarized projecting forward Scenario 1, applies harvest control rule F40%F_{40\\%} maximum allowable fishing mortality. plots show mean projected catch 95% uncertainty intervals across simulations, providing expected range allowable catch future years strategy.","code":"combined_cat %>%   filter(Year > 2024, Scenario == \"S1: FABC (F40)\") %>%   group_by(Year, Scenario, Simulation, Type, Region) %>%   summarize(Catch = sum(Catch)) %>%   group_by(Year, Scenario, Type) %>%   summarize(lwr = quantile(Catch, 0.025),             upr = quantile(Catch, 0.975),             Catch = mean(Catch)) combined_cat %>%   filter(Year > 2024, Scenario == \"S1: FABC (F40)\") %>%   group_by(Year, Scenario, Simulation, Type, Region) %>%   summarize(Catch = sum(Catch)) %>%   group_by(Year, Scenario, Type) %>%   summarize(lwr = quantile(Catch, 0.025),             upr = quantile(Catch, 0.975),             Catch = mean(Catch)) %>%   ggplot(aes(x = Year, y = Catch, ymin = lwr, ymax = upr)) +   geom_line(alpha = 1, lwd = 1.3) +   geom_ribbon(color = NA, alpha = 0.3) +   coord_cartesian(ylim = c(0, NA)) +   theme_bw(base_size = 15) +   theme(legend.position = 'none')"},{"path":"https://chengmatt.github.io/SPoRC/articles/o_get_started.html","id":"fishing-mortality-projections","dir":"Articles","previous_headings":"Reference Points and Projections > Projections","what":"Fishing Mortality Projections","title":"Running a Simple Assessment (The Basics)","text":"","code":"# Get historical F historical <- reshape2::melt(array(rep(as.vector(apply(francis_model$rep$Fmort, c(1,2), sum)), n_sims),                                    dim = c(n_regions, length(francis_data$years), n_sims))) %>%   mutate(Year = Var2 + 1976,          Scenario = \"FABC (F40)\",  # or change to match the scenarios you're plotting          Type = \"Historical\") %>%   rename(Region = Var1, Simulation = Var3, Fmort = value)  # Get all scenario projections scenarios <- reshape2::melt(all_scenarios_f) %>%   mutate(Year = Var2 + 2023,          Scenario = case_when(            Var4 == 1 ~ \"S1: FABC (F40)\",            Var4 == 2 ~ \"S2: FABC Ratio\",            Var4 == 3 ~ \"S3: F Last 5 Years\",            Var4 == 4 ~ \"S4: F60 SPR\",            Var4 == 5 ~ \"S5: No Fishing\",            Var4 == 6 ~ \"S6: FOFL\",            Var4 == 7 ~ \"S7: FABC -> FOFL\",            TRUE ~ paste(\"Scenario\", Var4)          ),          Type = \"Projection\") %>%   rename(Region = Var1, Simulation = Var3, Fmort = value)  # expand historical F for plotting scenarios_unique <- unique(scenarios$Scenario) historical_expanded <- historical[rep(1:nrow(historical), times = length(scenarios_unique)), ] historical_expanded$Scenario <- rep(scenarios_unique, each = nrow(historical))  # combine combined_fmort <- bind_rows(historical_expanded, scenarios) combined_fmort %>%   ggplot(aes(x = Year, y = Fmort, group = interaction(Scenario, Simulation), color = Type)) +   geom_line(alpha = 0.05) +   facet_wrap(~Scenario, scales = 'free') +   scale_color_manual(values = c(\"Historical\" = \"black\", \"Projection\" = \"blue\")) +   theme_bw(base_size = 15) +   theme(legend.position = 'none') +   labs(y = 'Fully Selected Fishing Mortality') combined_fmort %>%   filter(Year > 2024) %>%   group_by(Year, Scenario, Type) %>%   summarize(lwr = quantile(Fmort, 0.025),             upr = quantile(Fmort, 0.975),             Fmort = mean(Fmort)) %>%   ggplot(aes(x = Year, y = Fmort, ymin = lwr, ymax = upr)) +   geom_line(alpha = 1, lwd = 1.3) +   geom_ribbon(color = NA, alpha = 0.3) +   facet_wrap(~Scenario) +   coord_cartesian(ylim = c(0, NA)) +   theme_bw(base_size = 15) +   theme(legend.position = 'none') +   labs(y = 'Fully Selected Fishing Mortality')"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"demonstrated closed-loop simulations can run Run Closed Loop Simulations vignette. introductory walkthrough, please refer vignette. , demonstrate test multiple management procedures (MPs) across different demographic scenarios evaluate robustness performance alternative strategies. note one way define closed-loop simulation. Users can maintain flexibility closed-loop set , example defining MPs using empirical control rules, alternative reference points, custom projection strategies. approach allows users tailor simulation specific management questions data constraints. vignette, six MPs evaluated: f0 â€“ fishing, serving baseline comparison. f40_thresh â€“ threshold control rule using F40%F_{40\\%} B40%B_{40\\%} reference points. Fishing mortality set F40%F_{40\\%} SSBâ‰¥B40%SSB \\ge B_{40\\%} declines linearly SSBSSB falls B40%B_{40\\%}. fishing occurs SSBâ‰¤B5%SSB \\le B_{5\\%}. rule represents default strategy used Gulf Alaska Dusky Rockfish management (Omori et al., 2024). f40_const â€“ constant fishing mortality rate fixed F40%F_{40\\%}, regardless SSBSSB. f40_steep â€“ Similar f40_thresh, steeper ramp, target biomass reference point set B60%B_{60\\%}. f40_thresh_cap â€“ f40_thresh, catches capped 3,000 t, approximating mean historical catch time series. f40_hybrid â€“ hybrid rule combining elements f40_thresh, f40_steep, f40_thresh_cap. Two demographic (recruitment) scenarios evaluated: rand â€“ Recruitment randomly resampled historical time series mimic past recruitment variability. crash â€“ Recruitment follows Bevertonâ€“Holt dynamics declines sharply mimic environmentally driven recruitment collapses. first 23 years simulation period (2025â€“2046), recruitment simulated reduced values (R0=2.5,h=0.5R_0 = 2.5, h = 0.5), followed recovery phase (2047â€“2074) higher productivity (R0=12,h=0.75R_0 = 12, h = 0.75). performance metrics evaluated vignette include: Spawning stock biomass Catch Average annual variation catch Let us first set simulation loading requisite packages data files.","code":"library(parallel)       library(foreach)        library(doParallel)     library(ggplot2)        library(here)           library(SPoRC)          library(ggradar)       data(\"dusky_rtmb_model\")"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"estimation-model","dir":"Articles","previous_headings":"Overview","what":"Estimation Model","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"Next, set estimation model (EM) used within closed-loop simulation framework. helper function setup_em() prepares necessary inputs estimation model given simulation year replicate. uses SPoRC::simulation_data_to_SPoRC() convert simulation output correct input structure SPoRC model. general, EM follows structure introduced Getting Started vignette. represents **single-area, single-sex, single-fishery, single-survey model configuration. fishery survey fleets modeled logistic selectivity. Recruitment follows mean recruitment formulation, model fit : Catches Fishery age length compositions Survey age compositions Additionally, survey index fit prior catchability (q) stabilize estimation.","code":"#' Setup Estimation Model Inputs for Gulf of Alaska Dusky Rockfish #' #' Prepares the estimation model input list for a given simulation year #' and replicate within the SPoRC closed-loop simulation framework. #' #' @param sim_env Simulation environment generated by `Setup_sim_env()`. #' @param y Integer. Current simulation year index. #' @param sim Integer. Simulation replicate index. #' #' @return A fully configured EM input list suitable for fitting with `fit_model()`. setup_em <- function(sim_env, y, sim) {    # Extract simulation data for current year and replicate   sim_data <- SPoRC::simulation_data_to_SPoRC(sim_env, y, sim)    # Initialize model dimensions   input_list <- Setup_Mod_Dim(     years = 1:y,     ages = 1:sim_env$n_ages,     lens = 1:sim_env$n_lens,     n_regions = sim_env$n_regions,     n_sexes = sim_env$n_sexes,     n_fish_fleets = sim_env$n_fish_fleets,     n_srv_fleets = sim_env$n_srv_fleets,     verbose = FALSE   )    # Configure recruitment model   input_list <- Setup_Mod_Rec(     input_list = input_list,     do_rec_bias_ramp = 1,  # Enable bias ramp (no lognormal bias correction)     bias_year = rep(length(input_list$data$years), 4),     sigmaR_switch = 1,  # Switch from early to late sigmaR in first year     ln_sigmaR = rep(-0.1068576, 2),  # Early and late sigma values     rec_model = \"mean_rec\",     sigmaR_spec = \"fix\",  # Fix early and late sigmaR     init_age_strc = 1,  # Geometric series for initial age structure     ln_global_R0 = log(2.7),  # Starting value for mean recruitment     t_spawn = 0  # Spawn timing   )    # Configure biological parameters   input_list <- Setup_Mod_Biologicals(     input_list = input_list,     WAA = sim_data$WAA,     MatAA = sim_data$MatAA,     fit_lengths = 1,     SizeAgeTrans = sim_data$SizeAgeTrans,     AgeingError = sim_data$AgeingError,     M_spec = \"fix\",  # Fix natural mortality at 0.07     Fixed_natmort = array(0.07, dim = c(       input_list$data$n_regions,       length(input_list$data$years),       length(input_list$data$ages),       input_list$data$n_sexes     )),     addtocomp = 0.00001   )    # Configure movement and tagging (no tagging used)   input_list <- Setup_Mod_Tagging(input_list = input_list, UseTagging = 0)   input_list <- Setup_Mod_Movement(     input_list = input_list,     use_fixed_movement = 1,     Fixed_Movement = NA,     do_recruits_move = 0   )    # Configure fishery catch and fishing mortality   input_list <- Setup_Mod_Catch_and_F(     input_list = input_list,     ObsCatch = sim_data$ObsCatch,     Catch_Type = array(1, dim = c(length(input_list$data$years), input_list$data$n_fish_fleets)),     UseCatch = sim_data$UseCatch,     Use_F_pen = 1,     sigmaC_spec = \"fix\",     ln_sigmaC = sim_data$ln_sigmaC,     ln_sigmaF = array(log(sqrt(1/2)), dim = c(input_list$data$n_regions, input_list$data$n_fish_fleets))   )    # Configure fishery indices and compositions   input_list <- Setup_Mod_FishIdx_and_Comps(     input_list = input_list,     ObsFishIdx = sim_data$ObsFishIdx,     ObsFishIdx_SE = sim_data$ObsFishIdx_SE,     UseFishIdx = sim_data$UseFishIdx,     ObsFishAgeComps = sim_data$ObsFishAgeComps,     ObsFishLenComps = sim_data$ObsFishLenComps,     UseFishAgeComps = sim_data$UseFishAgeComps,     UseFishLenComps = sim_data$UseFishLenComps,     ISS_FishAgeComps = sim_data$ISS_FishAgeComps,     ISS_FishLenComps = sim_data$ISS_FishLenComps,     fish_idx_type = c(\"none\"),     FishAgeComps_LikeType = c(\"Multinomial\"),     FishLenComps_LikeType = c(\"Multinomial\"),     FishAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     FishLenComps_Type = c(\"agg_Year_1-terminal_Fleet_1\")   )    # Configure survey indices and compositions   input_list <- Setup_Mod_SrvIdx_and_Comps(     input_list = input_list,     ObsSrvIdx = sim_data$ObsSrvIdx,     ObsSrvIdx_SE = sim_data$ObsSrvIdx_SE,     UseSrvIdx = sim_data$UseSrvIdx,     ObsSrvAgeComps = sim_data$ObsSrvAgeComps,     ObsSrvLenComps = sim_data$ObsSrvLenComps,     UseSrvAgeComps = sim_data$UseSrvAgeComps,     UseSrvLenComps = sim_data$UseSrvLenComps,     ISS_SrvAgeComps = sim_data$ISS_SrvAgeComps,     ISS_SrvLenComps = sim_data$ISS_SrvLenComps,     srv_idx_type = c(\"biom\"),     SrvAgeComps_LikeType = c(\"Multinomial\"),     SrvLenComps_LikeType = c(\"Multinomial\"),     SrvAgeComps_Type = c(\"agg_Year_1-terminal_Fleet_1\"),     SrvLenComps_Type = c(\"agg_Year_1-terminal_Fleet_1\")   )    # Configure fishery selectivity and catchability   input_list <- Setup_Mod_Fishsel_and_Q(     input_list = input_list,     fish_sel_model = c(\"logist2_Fleet_1\"),     fish_fixed_sel_pars_spec = c(\"est_all\"),     fish_q_spec = c(\"fix\")   )    # Configure survey selectivity and catchability with prior   srv_q_prior <- data.frame(     region = 1,     block = 1,     fleet = 1,     mu = 1,     sd = 0.447213595   )    input_list <- Setup_Mod_Srvsel_and_Q(     input_list = input_list,     srv_sel_model = c(\"logist2_Fleet_1\"),     srv_fixed_sel_pars_spec = c(\"est_all\"),     srv_q_spec = c(\"est_all\"),     Use_srv_q_prior = 1,     srv_q_prior = srv_q_prior,     t_srv = array(0, dim = c(input_list$data$n_regions, input_list$data$n_srv_fleets))   )    # Configure data weighting   input_list <- Setup_Mod_Weighting(     input_list = input_list,     Wt_Catch = 1,     Wt_FishIdx = 1,     Wt_SrvIdx = 1,     Wt_Rec = 1,     Wt_F = 1,     Wt_Tagging = 0,     Wt_FishAgeComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_FishLenComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                        input_list$data$n_sexes, input_list$data$n_fish_fleets)),     Wt_SrvAgeComps = array(1, dim = c(input_list$data$n_regions, length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets)),     Wt_SrvLenComps = array(0, dim = c(input_list$data$n_regions, length(input_list$data$years),                                       input_list$data$n_sexes, input_list$data$n_srv_fleets))   )    return(input_list) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"projection-options","dir":"Articles","previous_headings":"Overview","what":"Projection Options","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"part closed-loop simulation process, estimates estimation model (EM) passed projection model, together defined management procedure (MP), derive catch advice. following helper function can embedded within closed-loop simulation generate catch advice EM outputs. details Do_Population_Projection() function operates applied provided Deriving Reference Points, Catch Advice, Projections vignette. general, following function extracts estimates terminal year condition population projections derive catch advice.","code":"#' Run Population Projection #' #' Performs forward projection of the population using assessment model outputs #' and management procedure specifications. #' #' @param sim_env Simulation environment #' @param obj Fitted assessment model object #' @param reference_points Calculated reference points #' @param asmt_data Assessment data list #' @param mp_config Management procedure configuration #' @param y Current year index #' #' @return Projection results including projected catch run_projection <- function(sim_env, obj, reference_points, asmt_data, mp_config, y) {    n_proj <- mp_config$proj_opt$n_proj_yrs    # Extract terminal year numbers-at-age   tmp_terminal_NAA <- array(     obj$rep$NAA[, y, , ],     dim = c(asmt_data$n_regions, length(asmt_data$ages), asmt_data$n_sexes)   )   tmp_terminal_NAA0 <- array(     obj$rep$NAA0[, y, , ],     dim = c(asmt_data$n_regions, length(asmt_data$ages), asmt_data$n_sexes)   )    # Replicate biological parameters for projection years   tmp_WAA <- array(     rep(asmt_data$WAA[, y, , ], each = n_proj),     dim = c(asmt_data$n_regions, n_proj, length(asmt_data$ages), asmt_data$n_sexes)   )    tmp_WAA_fish <- array(     rep(asmt_data$WAA_fish[, y, , , ], each = n_proj),     dim = c(asmt_data$n_regions, n_proj, length(asmt_data$ages),             asmt_data$n_sexes, asmt_data$n_fish_fleets)   )    tmp_MatAA <- array(     rep(asmt_data$MatAA[, y, , ], each = n_proj),     dim = c(asmt_data$n_regions, n_proj, length(asmt_data$ages), asmt_data$n_sexes)   )    tmp_fish_sel <- array(     rep(obj$rep$fish_sel[, y, , , ], each = n_proj),     dim = c(asmt_data$n_regions, n_proj, length(asmt_data$ages),             asmt_data$n_sexes, asmt_data$n_fish_fleets)   )    tmp_natmort <- array(     rep(obj$rep$natmort[, y, , ], each = n_proj),     dim = c(asmt_data$n_regions, n_proj, length(asmt_data$ages), asmt_data$n_sexes)   )    # Extract terminal fishing mortality   tmp_terminal_F <- array(     obj$rep$Fmort[, y, ],     dim = c(asmt_data$n_regions, asmt_data$n_fish_fleets)   )    # Extract recruitment history   tmp_recruitment <- array(     obj$rep$Rec[, 1:y],     dim = c(asmt_data$n_regions, length(1:y))   )    # Replicate sex ratio for projection years   tmp_sexratio <- array(     replicate(n = n_proj, obj$rep$sexratio[, y, ]),     dim = c(asmt_data$n_regions, n_proj, asmt_data$n_sexes)   )    # Replicate movement matrix for projection years   tmp_Movement <- array(     dim = c(asmt_data$n_regions, asmt_data$n_regions, n_proj,             length(asmt_data$ages), asmt_data$n_sexes)   )   for (proj_yr in 1:n_proj) {     tmp_Movement[, , proj_yr, , ] <- obj$rep$Movement[, , y, , ]   }    # Execute population projection   proj_results <- SPoRC::Do_Population_Projection(     n_proj_yrs = n_proj,     n_regions = sim_env$n_regions,     n_ages = sim_env$n_ages,     n_sexes = sim_env$n_sexes,     sexratio = tmp_sexratio,     n_fish_fleets = sim_env$n_fish_fleets,     do_recruits_move = sim_env$do_recruits_move,     recruitment = tmp_recruitment,     terminal_NAA = tmp_terminal_NAA,     terminal_NAA0 = tmp_terminal_NAA0,     terminal_F = tmp_terminal_F,     natmort = tmp_natmort,     WAA = tmp_WAA,     WAA_fish = tmp_WAA_fish,     MatAA = tmp_MatAA,     fish_sel = tmp_fish_sel,     Movement = tmp_Movement,     f_ref_pt = reference_points$f_ref_pt,     b_ref_pt = reference_points$virgin_b_ref_pt * mp_config$reference_points_opt$B_x,     HCR_function = mp_config$proj_opt$HCR_function,     recruitment_opt = mp_config$proj_opt$recruitment_opt,     fmort_opt = mp_config$proj_opt$fmort_opt,     t_spawn = sim_env$t_spawn,     bh_rec_opt = mp_config$proj_opt$bh_rec_opt   )      return(proj_results) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"functions-to-determine-catch","dir":"Articles","previous_headings":"Overview","what":"Functions to Determine Catch","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"Next, define functions determine catches constrained translate fishing mortality within closed-loop simulation. general, helper functions establish feedback catch advice operating model. first function applies management rules constraints (.e., caps) total allowable catch (TAC). constraints applied user-specified function catch_opt_func, modifies input catch advice based management procedures defined later. next function converts (possibly constrained) TAC corresponding fishing mortality rate (Fmort) used operating model. function uses bisection algorithm find value fishing mortality achieves specified TAC region fleet combination. updated Fmort values stored simulation environment use next time step closed-loop cycle.","code":"#' Apply Catch Constraints #' #' Applies management procedure catch constraints (e.g., caps) to projected catch. #' #' @param tmp_TAC Array of projected TAC values #' @param catch_opt_func Function defining catch constraints #' #' @return Modified TAC array with constraints applied apply_catch_constraints <- function(tmp_TAC, catch_opt_func) {   for (j in 1:dim(tmp_TAC)[2]) {     tmp_TAC[, j, ] <- catch_opt_func(catch = tmp_TAC[, j, ])   }   return(tmp_TAC) } #' Convert TAC to Fishing Mortality #' #' Uses bisection method to find fishing mortality rate that achieves target TAC. #' #' @param sim_env Simulation environment #' @param tmp_TAC Target total allowable catch #' @param y Current year index #' @param sim Simulation replicate index #' @param assessment_years Vector of assessment year indices #' #' @return Updated simulation environment with new fishing mortality rates tac_to_fmort <- function(sim_env, tmp_TAC, y, sim, assessment_years) {    # Find most recent assessment year   last_assess_year <- max(assessment_years[assessment_years <= y])   tac_year_index <- y - last_assess_year + 1    # Create grid of region-fleet combinations   rf_grid <- expand.grid(     r = seq_len(sim_env$n_regions),     f = seq_len(sim_env$n_fish_fleets)   )    # Solve for F that achieves target catch for each region-fleet combination   tmp_f <- mapply(     function(r, f) {       SPoRC::bisection_F(         f_guess = 0.05,         catch = tmp_TAC[r, tac_year_index, f],         NAA = sim_env$NAA[r, y + 1, , , sim],         WAA = sim_env$WAA[r, y + 1, , , sim],         natmort = sim_env$natmort[r, y + 1, , , sim],         fish_sel = sim_env$fish_sel[r, y + 1, , , f, sim]       )     },     r = rf_grid$r,     f = rf_grid$f   )    # Update fishing mortality in simulation environment   sim_env$Fmort[, y + 1, , sim] <- array(tmp_f, dim = c(sim_env$n_regions, sim_env$n_fish_fleets))    return(sim_env) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"management-procedures","dir":"Articles","previous_headings":"Overview","what":"Management Procedures","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"MPs define catch advice generated applied within closed-loop simulation. MP defined includes rules reference point calculation, control rule shape, catch implementation. helper functions specify shape control rules used across different MPs. threshold rule reduces fishing mortality spawning biomass declines biomass reference point, constant rule maintains fishing mortality fixed rate regardless biomass status. list defines specific MPs used example. configuration represents different management strategy, varying strongly responds changes biomass whether catch caps imposed. MP following components example: Reference point options (reference_points_opt) â€” specify biological reference points calculated (e.g., target spawning potential ratio, biomass thresholds). Projection options (proj_opt) â€” define harvest control rule (HCR) recruitment fishing mortality handled projections. Catch options (catch_opt) â€” optionally constrain catches according management limits (e.g., catch caps). Users flexibility modify extend structure fit specific modeling objectives.","code":"#' Threshold Harvest Control Rule #' #' Implements a threshold HCR where F is reduced linearly as biomass declines #' below the target biomass reference point. #' #' @param x Current biomass #' @param frp Fishing mortality reference point (target F) #' @param brp Biomass reference point (target biomass) #' @param alpha Minimum biomass threshold (as fraction of brp) #' #' @return Fishing mortality rate HCR_threshold <- function(x, frp, brp, alpha = 0.05) {   stock_status <- x / brp    if (stock_status >= 1) {     f <- frp   } else if (stock_status > alpha) {     f <- frp * (stock_status - alpha) / (1 - alpha)   } else {     f <- 0   }    return(f) }  #' Constant Harvest Control Rule #' #' Implements a constant catch HCR where F remains at the reference level #' regardless of stock status. #' #' @param x Current biomass (unused) #' @param frp Fishing mortality reference point (target F) #' @param brp Biomass reference point (unused) #' @param alpha Minimum biomass threshold (unused) #' #' @return Fishing mortality rate (constant at frp) HCR_constant <- function(x, frp, brp = 0, alpha = 0.05) {   return(frp) } mp_list <- list(    # 1. No fishing   # Serves as a baseline scenario. No assessment, projection, or catch is applied.   f0 = list(     skip_assessment = TRUE,     reference_points_opt = NULL,     proj_opt = NULL,     catch_opt = NULL   ),    # 2. F40% with B40% threshold   # The assessment is performed and reference points are calculated based on an SPR of 40%.   # A threshold rule (B40%) is applied, where F declines linearly as biomass drops below 40% of B_SPR.   f40_thresh = list(     skip_assessment = FALSE,     reference_points_opt = list(       n_avg_yrs = 1,       SPR_x = 0.4,       calc_rec_st_yr = 3,       rec_age = 4,       type = 'single_region',       what = \"SPR\",       B_x = 0.4     ),     proj_opt = list(       n_proj_yrs = assess_freq + 1,       HCR_function = HCR_threshold,       recruitment_opt = 'mean_rec',       fmort_opt = 'HCR',       bh_rec_opt = NULL     ),     catch_opt = function(catch, prev_catch = NULL, catch_cap = NULL) catch   ),    # 3. F40% constant   # Similar to f40_thresh, but no biomass threshold is applied.   # Fishing mortality remains constant at F40%, regardless of biomass status.   f40_const = list(     skip_assessment = FALSE,     reference_points_opt = list(       n_avg_yrs = 1,       SPR_x = 0.4,       calc_rec_st_yr = 3,       rec_age = 4,       type = 'single_region',       what = \"SPR\",       B_x = NULL     ),     proj_opt = list(       n_proj_yrs = assess_freq + 1,       HCR_function = HCR_constant,       recruitment_opt = 'mean_rec',       fmort_opt = 'HCR',       bh_rec_opt = NULL     ),     catch_opt = function(catch, prev_catch = NULL, catch_cap = NULL) catch   ),    # 4. F40% with B40% threshold and 3k ton catch cap   # Same as f40_thresh, but adds an upper limit on allowable catch (3,000 tons).   # The cap is applied after control rule-based advice is generated.   f40_thresh_cap = list(     skip_assessment = FALSE,     reference_points_opt = list(       n_avg_yrs = 1,       SPR_x = 0.4,       calc_rec_st_yr = 3,       rec_age = 4,       type = 'single_region',       what = \"SPR\",       B_x = 0.4     ),     proj_opt = list(       n_proj_yrs = assess_freq + 1,       HCR_function = HCR_threshold,       recruitment_opt = 'mean_rec',       fmort_opt = 'HCR',       bh_rec_opt = NULL     ),     catch_opt = function(catch, prev_catch = NULL, catch_cap = 3000) {       pmin(catch, catch_cap)     }   ),    # 5. F40% with B60% threshold   # A steeper control rule that initiates F reduction earlier (when biomass < 60% of B_SPR),   # providing more precautionary harvest control at moderate depletion levels.   f40_steep = list(     skip_assessment = FALSE,     reference_points_opt = list(       n_avg_yrs = 1,       SPR_x = 0.4,       calc_rec_st_yr = 3,       rec_age = 4,       type = 'single_region',       what = \"SPR\",       B_x = 0.6     ),     proj_opt = list(       n_proj_yrs = assess_freq + 1,       HCR_function = HCR_threshold,       recruitment_opt = 'mean_rec',       fmort_opt = 'HCR',       bh_rec_opt = NULL     ),     catch_opt = function(catch, prev_catch = NULL, catch_cap = NULL) catch   ),    # 6. F40% hybrid: B60% threshold with 3k ton catch cap   # Combines a precautionary threshold (B60%) with a hard catch cap (3,000 tons).   # This MP reduces F more aggressively at lower biomass and constrains annual catches   # to prevent excessive harvest in high-recruitment years.   f40_hybrid = list(     skip_assessment = FALSE,     reference_points_opt = list(       n_avg_yrs = 1,       SPR_x = 0.4,       calc_rec_st_yr = 3,       rec_age = 4,       type = 'single_region',       what = \"SPR\",       B_x = 0.6     ),     proj_opt = list(       n_proj_yrs = assess_freq + 1,       HCR_function = HCR_threshold,       recruitment_opt = 'mean_rec',       fmort_opt = 'HCR',       bh_rec_opt = NULL     ),     catch_opt = function(catch, prev_catch = NULL, catch_cap = 3000) {       pmin(catch, catch_cap)     }   ) )"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"simulation-loop-single-replicate","dir":"Articles","previous_headings":"Overview","what":"Simulation Loop (Single Replicate)","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"core closed-loop simulation involves iterating years replicates simulate population dynamics, assessments, management feedback. simulation year, population updated according biological processes, recruitment, fishing mortality. feedback period reached, management procedures applied based latest assessment results , cases, skipped MP specifies fishing (e.g., F = 0). Assessment model inputs prepared using setup_em helper, model fit available data (via fit_model). assessment complete, reference points calculated, forward projections run, catch advice determined. Catch constraints caps can applied converting advice true fishing mortality rates used operating models next year. single-replicate loop serves building block running multiple replicates parallel, allowing us evaluate robustness performance different MPs repeated simulations.","code":"#' Run Single Simulation Replicate #' #' Executes one complete closed-loop simulation replicate including population #' dynamics, assessments, and management feedback. #' #' @param sim Simulation replicate index #' @param sim_list Simulation configuration list #' @param mp_config Management procedure configuration #' @param assessment_years Vector of years when assessments occur #' @param years_to_use Vector of years with available data #' @param assess_freq Assessment frequency (years) #' #' @return List containing simulation results (SSB, catch, F, NAA) run_single_replicate <- function(sim, sim_list, mp_config, assessment_years,                                  years_to_use, assess_freq) {      # Initialize simulation environment   sim_env <- Setup_sim_env(sim_list)    # Loop through all simulation years   for (y in 1:sim_env$n_yrs) {          # Execute annual population dynamics     run_annual_cycle(y, sim, sim_env)      # Management feedback loop (after burn-in period)     if (y >= sim_env$feedback_start_yr) {       # Check if MP skips assessments (e.g., F=0)       if (!is.null(mp_config$skip_assessment) && mp_config$skip_assessment) {         if (y < sim_env$n_yrs) sim_env$Fmort[, y + 1, , sim] <- 0       } else {         # Normal assessment and management procedure         if (y %in% assessment_years) {           # Prepare estimation model inputs           dusky_input_list <- setup_em(sim_env, y, sim)           asmt_data <- dusky_input_list$data           parameters <- dusky_input_list$par           mapping <- dusky_input_list$map            # Set indicators for unused data years to 0           asmt_data <- SPoRC::set_data_indicator_unused(             data = asmt_data,             unused_years = setdiff(1:sim_env$n_yrs, years_to_use),             what = c(\"FishIdx\", \"FishAgeComps\", \"SrvIdx\", \"SrvAgeComps\", \"FishLenComps\", \"SrvLenComps\")           )            # Fit assessment model with error handling           fit_result <- tryCatch({             SPoRC::fit_model(               asmt_data, parameters, mapping,               random = NULL, newton_loops = 1, silent = TRUE             )           }, error = function(e) {             message(sprintf(\"Model fit failed for replicate %d in year %d: %s\",                             sim, y, e$message))             return(NULL)           })            # If model fitting failed, return NA results           if (is.null(fit_result)) {             return(list(               sim = sim,               rec = NA,               ssb = NA,               catch = NA,               fmort = NA,               naa = NA,               failed = TRUE,               failure_year = y             ))           }            obj <- fit_result            # Calculate biological reference points           reference_points <- SPoRC::get_closed_loop_reference_points(             use_true_values = FALSE,             sim_env = sim_env,             asmt_data = asmt_data,             asmt_rep = obj$rep,             y = y,             sim = sim,             reference_points_opt = mp_config$reference_points_opt,             n_proj_yrs = mp_config$proj_opt$n_proj_yrs           )            # Run forward projections           proj <- run_projection(sim_env, obj, reference_points, asmt_data, mp_config, y)            # Apply catch constraints (e.g., caps)           tmp_TAC <- apply_catch_constraints(             proj$proj_Catch[, -1, , drop = FALSE],             mp_config$catch_opt           )         }          # Convert TAC to fishing mortality for next year         if (y < sim_env$n_yrs) {           sim_env <- tac_to_fmort(sim_env, tmp_TAC, y, sim, assessment_years)         }       }     }   }    # Return successful replicate results   list(     sim = sim,     rec = sim_env$Rec[,,sim,drop = FALSE],     ssb = sim_env$SSB[, , sim, drop = FALSE],     catch = sim_env$TrueCatch[, , , sim, drop = FALSE],     fmort = sim_env$Fmort[, , , sim, drop = FALSE],     naa = sim_env$NAA[, , , , sim, drop = FALSE],     failed = FALSE   ) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"simulation-loop-parrallelized","dir":"Articles","previous_headings":"Overview","what":"Simulation Loop (Parrallelized)","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"efficiency, simulations can executed parallel across multiple management procedures replicates. run_parallel_simulations function sets parallel cluster, exports necessary functions objects, runs replicate simultaneously. Results replicate collected stored arrays spawning biomass, catch, fishing mortality, numbers--age. Users can modify custom manner extract additional results necessary unique applications.","code":"#' Run Parallel Simulations #' #' Executes multiple management procedures in parallel across all replicates. #' #' @param mp_list List of management procedure configurations #' @param sim_list Simulation configuration list #' @param n_cores Number of CPU cores to use  #' #' @return List of simulation results for each management procedure run_parallel_simulations <- function(mp_list, sim_list, n_cores = max(1, detectCores() - 2)) {    # Initialize parallel cluster   cl <- makeCluster(n_cores)   registerDoParallel(cl)    # load in packages   clusterEvalQ(cl, {     library(SPoRC)     library(here)   })    # export functions in env   clusterExport(     cl,     c(\"sim_list\", \"assessment_years\", \"years_to_use\", \"assess_freq\",       \"setup_em\", \"run_projection\", \"apply_catch_constraints\",       \"tac_to_fmort\", \"run_single_replicate\"),     envir = environment()   )    # init results storage   sim_res <- vector(\"list\", length(mp_list))   names(sim_res) <- names(mp_list)    # loop through each management procedure   for (i in seq_along(mp_list)) {      message(sprintf(       \"Running MP %d/%d: %s on %d cores with %d replicates\",       i, length(mp_list), names(mp_list)[i], n_cores, sim_list$n_sims     ))      # export MP to par env     current_mp_config <- mp_list[[i]]     current_mp_name <- names(mp_list)[i]     clusterExport(cl, c(\"current_mp_config\", \"current_mp_name\"), envir = environment())      # run replicates in parallel     replicate_results <- parLapply(cl, 1:sim_list$n_sims, function(sim) {        set.seed(123 + sim)         tryCatch({         run_single_replicate(           sim = sim,           sim_list = sim_list,           mp_config = current_mp_config,           assessment_years = assessment_years,           years_to_use = years_to_use,           assess_freq = assess_freq         )       }, error = function(e) {         list(error = TRUE, message = as.character(e), sim = sim)       })     })      # get dimensions from first replicate     n_regions <- dim(replicate_results[[1]]$ssb)[1]     n_years <- dim(replicate_results[[1]]$ssb)[2]     n_ages <- dim(replicate_results[[1]]$naa)[2]     n_sexes <- dim(replicate_results[[1]]$naa)[3]     n_fish_fleets <- dim(replicate_results[[1]]$fmort)[2]      # init result arrays     sim_res[[i]] <- list(       mp_name = names(mp_list)[i],       rec = array(dim = c(n_regions, n_years, sim_list$n_sims)),       ssb = array(dim = c(n_regions, n_years, sim_list$n_sims)),       catch = array(dim = c(n_regions, n_years, n_fish_fleets, sim_list$n_sims)),       fmort = array(dim = c(n_regions, n_years, n_fish_fleets, sim_list$n_sims)),       naa = array(dim = c(n_regions, n_years, n_ages, n_sexes, sim_list$n_sims))     )      # populate result arrays from replicate results     for (sim in 1:sim_list$n_sims) {       sim_res[[i]]$rec[, , sim] <- replicate_results[[sim]]$rec       sim_res[[i]]$ssb[, , sim] <- replicate_results[[sim]]$ssb       sim_res[[i]]$catch[, , , sim] <- replicate_results[[sim]]$catch       sim_res[[i]]$fmort[, , , sim] <- replicate_results[[sim]]$fmort       sim_res[[i]]$naa[, , , , sim] <- replicate_results[[sim]]$naa     }   }    # reset parallel cluster   stopCluster(cl)    return(sim_res) }"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"condition-closed-loop-simulation","dir":"Articles","previous_headings":"","what":"Condition Closed Loop Simulation","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"running full closed-loop projections, first condition simulation based historical dynamics estimated Gulf Alaska Dusky Rockfish assessment. Two demographic scenarios used condition future recruitment dynamics simulation, include rand crash scenarios. rand scenario, recruitment resampled input data reflect natural variability year--year recruitment. generates multiple stochastic replicates maintain historical patterns incorporating random variability. contrast, crash scenario simulates future recruitment mimic population crashes, followed recovery inputs R0_input h_input set produce period low recruitment (crash) subsequent rebound, providing scenario test management procedure performance extreme population dynamics. assessment conducted regular frequency (assess_freq; 2 years) burn-period, data available specified intervals (data_yr_freq; 2 years),","code":"# Extract model components from dusky model data <- dusky_rtmb_model$data rep <- dusky_rtmb_model$rep parameters <- dusky_rtmb_model$parameters mapping <- dusky_rtmb_model$mapping sd_rep <- dusky_rtmb_model$sdrep  # Define operating model parameters closed_loop_yrs <- 50      # Years to project forward burnin_years <- 1:length(data$years)  # Historical conditioning period n_sims <- 200              # Number of replicate simulations assess_freq <- 2           # Assessment frequency (every 3 years) data_yr_freq <- 2          # Data collection frequency  # Condition closed-loop simulations set.seed(123)  # random recruitment sim_list_rand <- condition_closed_loop_simulations(   closed_loop_yrs = closed_loop_yrs,   n_sims = n_sims,   data = data,   parameters = parameters,   mapping = mapping,   sd_rep = sd_rep,   rep = rep,   random = NULL,   recruitment_opt = 'resample_from_input',   ISS_FishAgeComps_fill = \"F_pattern\",   ISS_FishLenComps_fill = \"F_pattern\" )  # beverton holt crash and recover # setup R0 input to mimic crash scenario R0_input <- array(0, dim = c(n_regions, n_years + closed_loop_yrs)) R0_input[,1:47] <- exp(parameters$ln_global_R0) # mean recruitment from EM R0_input[,48:70] <- 2.5 # BH recruitment with crash R0 R0_input[,71:98] <- 12 # BH recruitment with rebound R0 R0_input <- replicate(n = n_sims, R0_input)  # setup h input to mimic crash scenario h_input <- array(0, dim = c(n_regions, n_years + closed_loop_yrs)) h_input[,1:47] <- 0.999 # mean recruitment from EM h_input[,48:70] <- 0.5 # steepness in crash h_input[,71:98] <- 0.75 # steepness in rebound h_input <- replicate(n = n_sims, h_input)  sim_list_crash <- condition_closed_loop_simulations(   closed_loop_yrs = closed_loop_yrs,   n_sims = n_sims,   data = data,   parameters = parameters,   mapping = mapping,   sd_rep = sd_rep,   rep = rep,   random = NULL,   recruitment_opt = 'bh_rec',   ISS_FishAgeComps_fill = \"F_pattern\",   ISS_FishLenComps_fill = \"F_pattern\",   R0_input = R0_input,   h_input = h_input )  # Define assessment and data years assessment_years <- seq(sim_list_rand$feedback_start_yr, sim_list_rand$n_yrs, assess_freq) years_to_use <- c(burnin_years, seq(sim_list_rand$feedback_start_yr, sim_list_rand$n_yrs, data_yr_freq))"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"run-simulations","dir":"Articles","previous_headings":"","what":"Run Simulations","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"simulation environments conditioned, can now run closed-loop projections management procedure scenario. Results scenarios combined single object (sim_all) subsequent analysis comparison MP performance.","code":"sim_res_rand <- run_parallel_simulations(mp_list, sim_list_rand, n_cores = 8) sim_res_crash <- run_parallel_simulations(mp_list, sim_list_crash, n_cores = 8) sim_all <- list(rand = sim_res_rand, crash = sim_res_crash) # combine scenarios"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"process-results","dir":"Articles","previous_headings":"","what":"Process Results","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"simulations performed, can extract results summarize visualization. , extract spawning stock biomass, recruitment, catch, fishing mortality rates. summarize quantities across time-series (within time point) median associated 95% simulation intervals.","code":"# Process results ssb_results <- data.frame() rec_results <- data.frame() catch_results <- data.frame() f_results <- data.frame()  for(i in 1:length(sim_all)) {    # extract out recruitment scenario   sim_tmp <- sim_all[[i]]    # get mp specific results   for(j in 1:length(sim_tmp)) {     # get ssb     tmp_ssb <- reshape2::melt(sim_tmp[[j]]$ssb) %>%       rename(Region = Var1, Year = Var2, Sim = Var3, SSB = value) %>%       mutate(MP = sim_tmp[[j]]$mp_name,              Scenario = names(sim_all)[i])      # get rec     tmp_rec <- reshape2::melt(sim_tmp[[j]]$rec) %>%       rename(Region = Var1, Year = Var2, Sim = Var3, Rec = value) %>%       mutate(MP = sim_tmp[[j]]$mp_name,              Scenario = names(sim_all)[i])      # get catch     tmp_catch <- reshape2::melt(sim_tmp[[j]]$catch) %>%       rename(Region = Var1, Year = Var2, Fleet = Var3, Sim = Var4, cat = value) %>%       mutate(MP = sim_tmp[[j]]$mp_name,              Scenario = names(sim_all)[i])     # get f     tmp_f <- reshape2::melt(sim_tmp[[j]]$fmort) %>%       rename(Region = Var1, Year = Var2, Fleet = Var3, Sim = Var4, f = value) %>%       mutate(MP = sim_tmp[[j]]$mp_name,              Scenario = names(sim_all)[i])      ssb_results <- rbind(ssb_results, tmp_ssb)     rec_results <- rbind(rec_results, tmp_rec)     catch_results <- rbind(catch_results, tmp_catch)     f_results <- rbind(f_results, tmp_f)   }  }  # get summary statistics for time series sumry <- ssb_results %>% # ssb   group_by(MP, Year, Scenario) %>%   summarize(median = median(SSB),             lwr = quantile(SSB, 0.025),             upr = quantile(SSB, 0.975)) %>%   mutate(Type = 'Spawning Stock Biomass') %>%   bind_rows(     catch_results %>% # catch       group_by(MP, Year, Scenario) %>%       summarize(median = median(cat),                 lwr = quantile(cat, 0.025),                 upr = quantile(cat, 0.975)) %>%       mutate(Type = 'Catch')   ) %>%   bind_rows(     f_results %>% # fishing mortality       group_by(MP, Year, Scenario) %>%       summarize(median = median(f),                 lwr = quantile(f, 0.025),                 upr = quantile(f, 0.975)) %>%       mutate(Type = 'Fishing Mortality')   ) %>%   bind_rows(     rec_results %>% # recruitment       group_by(MP, Year, Scenario) %>%       summarize(median = median(Rec),                 lwr = quantile(Rec, 0.025),                 upr = quantile(Rec, 0.975)) %>%       mutate(Type = 'Recruitment')   ) %>%   mutate(Year = Year + 1976,          Period = ifelse(Year <= 2024, \"Historical\", \"Feedback\"),          MP = factor(MP, levels = c(\"f0\", \"f40_thresh\", \"f40_const\", \"f40_steep\",                                     \"f40_thresh_cap\", \"f40_hybrid\")),          Scenario = factor(Scenario, levels = c(\"rand\", \"crash\")))  # Calculate summary statistics across entire feedback period from raw data period_summary <- ssb_results %>%   filter(Year > 2024 - 1976) %>%  # feedback period (Year is relative to 1976)   group_by(MP, Scenario) %>%   summarize(     median = median(SSB),     lwr = quantile(SSB, 0.025),     upr = quantile(SSB, 0.975),     .groups = 'drop'   ) %>%   mutate(Type = 'Spawning Stock Biomass') %>%   bind_rows(     catch_results %>%       filter(Year > 2024 - 1976) %>%       group_by(MP, Scenario, Sim) %>%       mutate(         catch_mean = mean(cat, na.rm = TRUE),         aav = if_else(catch_mean == 0, 0, abs((cat - lag(cat)) / catch_mean))       ) %>%       group_by(MP, Scenario) %>%       summarize(         median = median(aav, na.rm = TRUE),         lwr = quantile(aav, 0.025, na.rm = TRUE),         upr = quantile(aav, 0.975, na.rm = TRUE),         .groups = 'drop'       ) %>%       mutate(Type = 'AAV')   ) %>%   bind_rows(     rec_results %>%       filter(Year > 2024 - 1976) %>%       group_by(MP, Scenario) %>%       summarize(         median = median(Rec),         lwr = quantile(Rec, 0.025),         upr = quantile(Rec, 0.975),         .groups = 'drop'       ) %>%       mutate(Type = 'Recruitment')   ) %>%   bind_rows(     catch_results %>%       filter(Year > 2024 - 1976) %>%       group_by(MP, Scenario) %>%       summarize(         median = median(cat),         lwr = quantile(cat, 0.025),         upr = quantile(cat, 0.975),         .groups = 'drop'       ) %>%       mutate(Type = 'Catch')   ) %>%   mutate(MP = factor(MP, levels = c(\"f0\", \"f40_thresh\", \"f40_const\", \"f40_steep\",                                     \"f40_thresh_cap\", \"f40_hybrid\")))"},{"path":"https://chengmatt.github.io/SPoRC/articles/p_single_region_dusky_alt_mp_testing.html","id":"visualize","dir":"Articles","previous_headings":"","what":"Visualize","title":"Testing Management Procedures via Closed Loop Simulations (Dusky Rockfish)","text":"can visualize results using line radar plots. Across MPs, trade-offs apparent: rand recruitment scenario, catch remained stable, lower harvest capped MPs (f40_thresh_cap, f40_hybrid) higher harvest uncapped MPs. Spawning stock biomass higher harvest lower, catch AAV lowest capped MPs. crash scenario, differences became larger: MPs higher biomass reference points (e.g., f40_steep) reduced catch early, maintaining higher SSB (cost increased catch variability), f40_const allowed higher catch low recruitment lower catch recovery. Overall, f40_thresh_cap f40_hybrid offered balanced trade-offs, supporting intermediate catch, improved spawning stock biomass, reduced catch variability.","code":"cols <- c(\"#E69F00\", \"#56B4E9\", \"#009E73\", \"#0072B2\", \"#D55E00\", \"#CC79A7\") # colors  # plot time series lineplot_with_legend <- ggplot() +   geom_ribbon(sumry %>% filter(Year > 2024, !Type %in% c('Fishing Mortality', \"Recruitment\"), MP == 'f40_thresh'),               mapping = aes(x = Year, y = median, ymin = lwr, ymax = upr),               alpha = 0.25, color = NA) +   geom_line(sumry %>% filter(!Type %in% c('Fishing Mortality', \"Recruitment\")),             mapping = aes(x = Year, y = median, color = MP, linetype = MP), lwd = 1.1) +   geom_line(sumry %>% filter(Year < 2025, !Type %in% c('Fishing Mortality', \"Recruitment\")),             mapping = aes(x = Year, y = median), lwd = 1.1, color = 'black') +   geom_vline(xintercept = 2024.5, lty = 2, lwd = 1) +   scale_color_manual(values = cols) +   scale_fill_manual(values = cols) +   coord_cartesian(ylim = c(0, NA)) +   ggh4x::facet_grid2(Scenario ~ Type, scales = \"free\", independent = \"y\") +   theme_bw(base_size = 17) +   theme(legend.position = c(0.09, 0.875),         legend.background = element_blank()) +  # show it for extraction   labs(x = \"Year\", y = \"Median Value\", color = \"Management Procedure\", lty = \"Management Procedure\") +   theme(     plot.background = element_rect(fill = NA, color = NA),     panel.background = element_rect(fill = NA, color = NA)   )  # radar plot for crash scenario radar1 <- ggradar(   period_summary %>%     filter(Scenario == 'crash', Type != 'Recruitment') %>%     mutate(median = ifelse(Type == 'AAV', median + 1e-5, median)) %>%     select(MP,median, Type) %>%     group_by(Type) %>%     mutate(median = median / max(median)) %>%     mutate(median = ifelse(Type == 'AAV', 1 - median, median)) %>%  # Flip AAV     pivot_wider(names_from = 'Type', id_cols = 'MP', values_from = 'median'),   line.alpha = 0.85,   axis.label.size = 5,   point.alpha = 0.55,   group.point.size = 4.5,   background.circle.colour = NA,   background.circle.transparency = 0,   axis.line.colour = \"gray60\",   gridline.min.colour = \"gray60\",   gridline.mid.colour = \"gray60\",   gridline.max.colour = \"gray60\",   group.colours = cols,   legend.position = 'none' ) +   theme(     plot.background = element_rect(fill = NA, color = NA),     panel.background = element_rect(fill = NA, color = NA)   )  # radar plot for random recruitment scenario radar2 <- ggradar(   period_summary %>%     filter(Scenario == 'rand', Type != 'Recruitment') %>%     mutate(median = ifelse(Type == 'AAV', median + 1e-5, median)) %>%     select(MP, median, Type) %>%     group_by(Type) %>%     mutate(median = median / max(median)) %>%     mutate(median = ifelse(Type == 'AAV', 1 - median, median)) %>%     pivot_wider(names_from = 'Type', id_cols = 'MP', values_from = 'median'),   line.alpha = 0.85,   axis.label.size = 5,   point.alpha = 0.55,   group.point.size = 4.5,   background.circle.colour = NA,   background.circle.transparency = 0,   axis.line.colour = \"gray60\",   gridline.min.colour = \"gray60\",   gridline.mid.colour = \"gray60\",   gridline.max.colour = \"gray60\",   group.colours = cols,   legend.position = 'none' ) +   theme(     plot.background = element_rect(fill = NA, color = NA),     panel.background = element_rect(fill = NA, color = NA)   )  radar_combo <- cowplot::plot_grid(radar2, radar1, ncol = 1, labels = 'B', label_size = 30, label_x = 0.05) main_plot <- cowplot::plot_grid(lineplot_with_legend, radar_combo, rel_widths = c(0.75, 0.25), labels = 'A', label_size = 30, label_x = 0.01) main_plot"},{"path":"https://chengmatt.github.io/SPoRC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Cheng. Author, maintainer. Dan Goethel. Contributor. Pete Hulson. Contributor. Curry Cunningham. Contributor.","code":""},{"path":"https://chengmatt.github.io/SPoRC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cheng M (2025). SPoRC: Generalized Stochastic (S) Population (Po) Model Regional (R) Components (C). R package version 0.1.0, https://chengmatt.github.io/SPoRC.","code":"@Manual{,   title = {SPoRC: A Generalized Stochastic (S) Population (Po) Model Over Regional (R) Components (C)},   author = {Matthew Cheng},   year = {2025},   note = {R package version 0.1.0},   url = {https://chengmatt.github.io/SPoRC}, }"},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/index.html","id":"overview","dir":"","previous_headings":"SPoRC: Stochastic Population Model Over Regional Components","what":"Overview","title":"A Generalized Stochastic (S) Population (Po) Model Over Regional (R) Components (C)","text":"SPoRC flexible modeling framework spatially structured population dynamics. accounts stochasticity vital rates movement among geographically defined components. framework supports: Integration multiple data sources Regional structuring Age- sex-specific processes Thus, SPoRC suitable single-region spatial stock assessment applications.","code":""},{"path":"https://chengmatt.github.io/SPoRC/index.html","id":"installation","dir":"","previous_headings":"SPoRC: Stochastic Population Model Over Regional Components","what":"Installation","title":"A Generalized Stochastic (S) Population (Po) Model Over Regional (R) Components (C)","text":"SPoRC implemented RTMB optionally relies additional packages plotting diagnostics.","code":""},{"path":"https://chengmatt.github.io/SPoRC/index.html","id":"prerequisites","dir":"","previous_headings":"SPoRC: Stochastic Population Model Over Regional Components > Installation","what":"Prerequisites","title":"A Generalized Stochastic (S) Population (Po) Model Over Regional (R) Components (C)","text":"Ensure following packages installed:","code":"install.packages(\"devtools\")       # Development tools install.packages(\"TMB\")            # Template Model Builder install.packages(\"RTMB\")           # R interface to TMB TMB:::install.contrib(\"https://github.com/vtrijoulet/OSA_multivariate_dists/archive/main.zip\") # Optional: multivariate OSA distributions remotes::install_github(\"fishfollower/compResidual\") # Optional OSA residuals"},{"path":"https://chengmatt.github.io/SPoRC/index.html","id":"installing-sporc","dir":"","previous_headings":"SPoRC: Stochastic Population Model Over Regional Components > Installation","what":"Installing SPoRC","title":"A Generalized Stochastic (S) Population (Po) Model Over Regional (R) Components (C)","text":"Note: SPoRC active development. Users exercise caution features subject change without notice.","code":"devtools::install_github(\"chengmatt/SPoRC\", dependencies = c(\"Depends\", \"Imports\"))"},{"path":"https://chengmatt.github.io/SPoRC/reference/Do_Population_Projection.html","id":null,"dir":"Reference","previous_headings":"","what":"Do Population Projections â€” Do_Population_Projection","title":"Do Population Projections â€” Do_Population_Projection","text":"Population Projections","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Do_Population_Projection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do Population Projections â€” Do_Population_Projection","text":"","code":"Do_Population_Projection(   n_proj_yrs = 2,   n_regions,   n_ages,   n_sexes,   sexratio,   n_fish_fleets,   do_recruits_move = 0,   recruitment,   terminal_NAA,   terminal_NAA0,   terminal_F,   natmort,   WAA,   WAA_fish,   MatAA,   fish_sel,   Movement,   f_ref_pt = NULL,   b_ref_pt = NULL,   HCR_function = NULL,   recruitment_opt = \"inv_gauss\",   fmort_opt = \"HCR\",   t_spawn,   bh_rec_opt = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Do_Population_Projection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do Population Projections â€” Do_Population_Projection","text":"n_proj_yrs Number projection years n_regions Number regions n_ages Number ages n_sexes Number sexes sexratio Array recruitment sex ratio (n_regions, n_proj_yrs, n_sexes) n_fish_fleets Number fishery fleets do_recruits_move Whether recruits move (0 == move, 1 == move) recruitment Recruitment matrix dimensioned n_regions, n_yrs want summarize across, condition projection terminal_NAA Terminal Numbers Age dimensioned n_regions, n_ages, n_sexes terminal_NAA0 Terminal Unfished Numbers Age dimensioned n_regions, n_ages, n_sexes terminal_F Terminal fishing mortality rate, dimensioned n_regions, n_fish_fleets natmort Natural mortality, dimensioned n_regions, n_proj_yrs, n_ages, n_sexes WAA Weight age, dimensioned n_regions, n_proj_yrs, n_ages, n_sexes WAA_fish Weight age fishery, dimensioned n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets MatAA Maturity age, dimensioned n_regions, n_proj_yrs, n_ages, n_sexes fish_sel Fishery selectivity, dimensioned n_regions, n_proj_yrs, n_ages, n_sexes, n_fish_fleets Movement Movement, dimensioned n_regions, n_regions, n_proj_yrs, n_ages, n_sexes f_ref_pt Fishing mortality reference point dimensioned n_regions n_proj_yrs b_ref_pt Biological reference point dimensioned n_regions n_proj_yrs HCR_function Function describing harvest control rule. function always following arguments: x, represents SSB, frp, takes inputs fishery reference points, brp, takes inputs biological reference points. additional arguments specified defaults hard coded / fixed within function. recruitment_opt Recruitment simulation option, options \"inv_gauss\", simulates future recruitment based recruitment values supplied using inverse gaussian distribution, \"mean_rec\", takes mean recruitment values supplied given region, \"zero\", assumes future recruitment occur fmort_opt Fishing Mortality option, includes \"HCR\", modifies F reference point using user supplied HCR_function, \"Input\", uses projected F values supplied user. t_spawn Fraction time spawning used compute projected SSB bh_rec_opt list object containing following arguments: recruitment_dd value (0 1) indicating global (1) local density dependence (0). case single region model, either local global give results rec_lag value indicating number years lagged given year's SSB produces recruits R0 virgin recruitment parameter Rec_Prop Recruitment apportionment values. single region model, set value 1. Dimensioned n_regions h Steepness values stock recruitment curve. Dimensioned n_regions WAA weight--age array dimensioned n_regions, n_ages, n_sexes, reference year utilize values first year MatAA maturity age array dimensioned n_regions, n_ages, n_sexes, reference year utilize values first year natmort natural mortality age array dimensioned n_regions, n_ages, n_sexes, reference year utilize values first year SSB SSB values estimated given model, dimensioned n_regions n_yrs","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Do_Population_Projection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do Population Projections â€” Do_Population_Projection","text":"list containing projected F, catch, SSB (dynamic unfished), Numbers Age (dynamic unfished). (Objects generally dimensioned following order: n_regions, n_yrs, n_ages, n_sexes, n_fleets)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_3d_precision.html","id":null,"dir":"Reference","previous_headings":"","what":"Constructor algorithin for correlations within ages, years, and cohort (Work in Progress) â€” Get_3d_precision","title":"Constructor algorithin for correlations within ages, years, and cohort (Work in Progress) â€” Get_3d_precision","text":"Constructor algorithin correlations within ages, years, cohort (Work Progress)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_3d_precision.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constructor algorithin for correlations within ages, years, and cohort (Work in Progress) â€” Get_3d_precision","text":"","code":"Get_3d_precision(   n_ages,   n_yrs,   pcorr_age,   pcorr_year,   pcorr_cohort,   ln_var_value,   Var_Type )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_3d_precision.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constructor algorithin for correlations within ages, years, and cohort (Work in Progress) â€” Get_3d_precision","text":"n_ages Number ages n_yrs Number years pcorr_age correlations age pcorr_year correaltions year pcorr_cohort correlaitons cohort ln_var_value log space variance Var_Type variance type == 0, marginal (stationary slower run time), == 1 conditional (non-statationary, faster run time)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_3d_precision.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constructor algorithin for correlations within ages, years, and cohort (Work in Progress) â€” Get_3d_precision","text":"Sparse precision matrix dimensioned n_ages * n_years, n_ages * n_years","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Comp_Likelihoods.html","id":null,"dir":"Reference","previous_headings":"","what":"Gives negative log liklelihood values for composition data for a given year and a given fleet (fishery or survey) â€” Get_Comp_Likelihoods","title":"Gives negative log liklelihood values for composition data for a given year and a given fleet (fishery or survey) â€” Get_Comp_Likelihoods","text":"Gives negative log liklelihood values composition data given year given fleet (fishery survey)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Comp_Likelihoods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gives negative log liklelihood values for composition data for a given year and a given fleet (fishery or survey) â€” Get_Comp_Likelihoods","text":"","code":"Get_Comp_Likelihoods(   Exp,   Obs,   ISS,   Wt_Mltnml,   ln_theta_agg,   ln_theta,   LN_corr_pars = 0,   LN_corr_pars_agg = 0,   Comp_Type,   Likelihood_Type,   n_regions,   n_model_bins,   n_obs_bins,   n_sexes,   age_or_len,   AgeingError,   use,   comp_agg_type,   addtocomp,   sim = FALSE )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Comp_Likelihoods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gives negative log liklelihood values for composition data for a given year and a given fleet (fishery or survey) â€” Get_Comp_Likelihoods","text":"Exp Expected values (catch age survey index age) indexed given year fleet (structured matrix age sex) Obs Observed values (catch age survey index age) indexed given year fleet (structured matrix age sex) ISS Input sample size indexed given year fleet (structured vector w/ sexes) Wt_Mltnml Mutlinomial weight () given fleet (structured vector w/ sexes) ln_theta_agg Log overdispersion parameter comp_type == 0, want estsimate either dirichlet multinomial ln_theta Log theta overdispersion Dirichlet mutlinomial (scalar vector depending 'Split' 'Joint') LN_corr_pars Logistic normal correlation parameters (dimensioned n_regions, n_sexes, 3 parameters) LN_corr_pars_agg Logistic normal correlation parameters comps aggregated (just dimensioned length 1 value) Comp_Type Composition Parameterization Type (== 0, aggregated comps sex, == 1, split comps sex region (implicit sex region ratio information), == 2, joint comps across sexes split region (implicit sex ratio information, region information)) Likelihood_Type Composition Likelihood Type (== 0, Multinomial, == 1 Dirichlet Multinomial) n_regions number regions modeled n_model_bins Number bins used model n_obs_bins Number observed composition bins n_sexes Number sexes modeled age_or_len Age length comps (== 0, Age, == 1, Length) AgeingError Ageing Error matrix use Vector 0s 1s corresponding regions (==0, obs dont' use, ==1, obs use) comp_agg_type aggregate data (aggregating) addtocomp Small constant add composition data sim Boolean whether simualte values given specification likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Comp_Likelihoods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gives negative log liklelihood values for composition data for a given year and a given fleet (fishery or survey) â€” Get_Comp_Likelihoods","text":"Returns negative log likelihood composition data (age /length)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Det_Recruitment.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Deterministic Recruitment â€” Get_Det_Recruitment","title":"Get Deterministic Recruitment â€” Get_Det_Recruitment","text":"Computes deterministic recruitment region based either mean recruitment model Bevertonâ€“Holt stockâ€“recruitment relationship.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Det_Recruitment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Deterministic Recruitment â€” Get_Det_Recruitment","text":"","code":"Get_Det_Recruitment(   recruitment_model,   recruitment_dd,   y,   rec_lag,   R0,   Rec_Prop,   h,   n_regions,   n_ages,   WAA,   MatAA,   natmort,   SSB_vals,   Movement,   do_recruits_move,   t_spawn,   sex_ratio_f )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Det_Recruitment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Deterministic Recruitment â€” Get_Det_Recruitment","text":"recruitment_model Integer flag specifying recruitment model: `0` = mean recruitment `1` = Bevertonâ€“Holt recruitment steepness recruitment_dd Integer flag specifying scale density dependence: `0` = local (region-specific) `1` = global (shared across regions) y Current model year (used SSB lag indexing) rec_lag Recruitment lag (number years spawning recruitment) R0 Virgin mean recruitment (global scalar) Rec_Prop Vector recruitment proportions region (used allocate global `R0` local density dependence) h Vector Bevertonâ€“Holt steepness values region n_regions Number spatial regions n_ages Number modeled age classes WAA Matrix weight--age region age MatAA Matrix maturity--age region age natmort Matrix vector natural mortality region age SSB_vals Matrix spawning stock biomass (SSB) region year Movement 3D array movement probabilities regions age (`[origin, destination, age]` alternatively, `[n_regions, n_regions, age]`) do_recruits_move Logical integer flag (0/1) indicating whether recruits move first year t_spawn Fraction year spawning occurs (used survival spawning) sex_ratio_f Vector female proportions region (used scale initial recruits)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Det_Recruitment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Deterministic Recruitment â€” Get_Det_Recruitment","text":"numeric vector length `n_regions` containing deterministic recruitment values region.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Det_Recruitment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Deterministic Recruitment â€” Get_Det_Recruitment","text":"function returns region-specific deterministic recruitment estimates based chosen recruitment model density dependence structure. `recruitment_model = 0`, recruitment fixed mean values (`R0 * Rec_Prop`). `recruitment_model = 1`, Bevertonâ€“Holt recruitment applied using: $$R = \\frac{4hR_0SSB}{(1 - h)S_0 + (5h - 1)SSB}$$ `S_0` unfished spawning biomass per recruit, computed separately region (local) summed across regions (global).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Feedback_Data.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function that obtains data for a simulation with a feedback loop â€” Get_Feedback_Data","title":"Helper function that obtains data for a simulation with a feedback loop â€” Get_Feedback_Data","text":"Helper function obtains data simulation feedback loop","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Feedback_Data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function that obtains data for a simulation with a feedback loop â€” Get_Feedback_Data","text":"","code":"Get_Feedback_Data(   sim_env,   sim_list,   y,   sim,   skeleton_data,   skeleton_parameters,   skeleton_mapping )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Feedback_Data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function that obtains data for a simulation with a feedback loop â€” Get_Feedback_Data","text":"sim_env Simulation environment defined using Simulate_Pop_Feedback sim_list Simulation list defines operating model options y y index used annual cycle sim sim index used annual cycle skeleton_data Skeleton data list estimation method (SPoRC) dimensions defined using total number simulation years skeleton_parameters Skeleton parameters list estimation method (SPoRC) dimensions defined using total number simulation years skeleton_mapping Skeleton mapping list estimation method (SPoRC) dimensions defined using total number simulation years","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Feedback_Data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function that obtains data for a simulation with a feedback loop â€” Get_Feedback_Data","text":"Returns data, parameters, mapping list truncated match feedback year","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Reference_Points.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function to get reference points â€” Get_Reference_Points","title":"Wrapper function to get reference points â€” Get_Reference_Points","text":"Wrapper function compute fishing biological reference points given data report objects assessment simulation. Supports single-region multi-region calculations options SPR Bevertonâ€“Holt MSY reference points.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Reference_Points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function to get reference points â€” Get_Reference_Points","text":"","code":"Get_Reference_Points(   data,   rep,   SPR_x = NULL,   t_spwn = 0,   sex_ratio_f = rep(0.5, data$n_regions),   calc_rec_st_yr = 1,   rec_age = 1,   type,   what,   n_avg_yrs = 1,   local_bh_msy_newton_steps = 6 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Reference_Points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function to get reference points â€” Get_Reference_Points","text":"data List. Data object containing ages, years, weight--age, maturity, natural mortality, simulation/assessment info. rep List. Report object RTMB containing estimated parameters like Fmort, selectivity, recruitment, steepness. SPR_x Numeric. Target Spawning Potential Ratio fraction. Required SPR-based reference points. t_spwn Numeric. Mortality time spawning. sex_ratio_f Numeric vector. Female sex ratio region. calc_rec_st_yr Integer. First year used compute mean recruitment. rec_age Integer. Age recruitment. type Character. \"single_region\" \"multi_region\". Character. Type reference point: SPR Single-region SPR reference point independent_SPR Multi-region SPR without movement global_SPR Multi-region SPR movement BH_MSY Single-region Bevertonâ€“Holt MSY independent_BH_MSY Multi-region BH-MSY without movement global_BH_MSY Multi-region global BH-MSY movement local_BH_MSY Multi-region local BH-MSY movement n_avg_yrs Integer. Number years average demographic rates calculating reference points. local_bh_msy_newton_steps Number newton steps take solve equilibrium recruitment origin region local_BH_MSY assumed.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Reference_Points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function to get reference points â€” Get_Reference_Points","text":"list elements: f_ref_pt Vector fishing reference points region. b_ref_pt Vector biological reference points region. virgin_b_ref_pt Vector virgin biomass reference points region.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Selex.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Selectivity â€” Get_Selex","title":"Calculate Selectivity â€” Get_Selex","text":"Computes selectivity using one several parametric semi-parametric models. Supports constant time-varying selectivity, including random effects GMRF-based deviations.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Selex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Selectivity â€” Get_Selex","text":"","code":"Get_Selex(   Selex_Model,   TimeVary_Model,   ln_Pars,   ln_seldevs,   Region,   Year,   Bin,   Sex )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Selex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Selectivity â€” Get_Selex","text":"Selex_Model Integer specifying selectivity model: 0 Logistic selectivity: uses b50 slope parameters 1 Gamma-shaped (dome) selectivity: uses bin--peak delta parameters 2 Power function selectivity: decreasing selectivity bin 3 Logistic selectivity using b50 b95 4 Double-normal (dome-shaped) selectivity plateau flexible tails TimeVary_Model Integer specifying time variation structure: 0 time variation (constant blocked) 1 IID deviations 2 Random walk time 3 3D AR1-GMRF marginal 4 3D AR1-GMRF conditional 5 2D AR1-GMRF ln_Pars Vector log-transformed selectivity parameters. Interpretation depends `Selex_Model`. ln_seldevs Array selectivity deviations (may log-scale), dimensioned : [n_regions, n_years, n_bins, n_sexes, 1]. Used time-varying semi-parametric selectivity. Region Integer index region Year Integer index year Bin Numeric vector bins compute selectivity Sex Integer index sex","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Selex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Selectivity â€” Get_Selex","text":"numeric vector selectivity values corresponding bins specified model.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Selex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Selectivity â€” Get_Selex","text":"Selectivity parameters transformed internally (typically using `exp()` logistic transformations) ensure remain valid ranges. Deviations (`ln_seldevs`) apply multiplicatively transformed parameters time-varying models used. semi-parametric models (TimeVary_Model 3â€“5), deviations applied directly resulting selectivity curve.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Tagging_Mortality.html","id":null,"dir":"Reference","previous_headings":"","what":"Get values for total tag mortality and tag fishing mortality â€” Get_Tagging_Mortality","title":"Get values for total tag mortality and tag fishing mortality â€” Get_Tagging_Mortality","text":"Get values total tag mortality tag fishing mortality","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Tagging_Mortality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get values for total tag mortality and tag fishing mortality â€” Get_Tagging_Mortality","text":"","code":"Get_Tagging_Mortality(   tag_selex,   tag_natmort,   Fmort,   natmort,   Tag_Shed,   fish_sel,   n_regions,   n_ages,   n_sexes,   n_fish_fleets,   y,   what )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Tagging_Mortality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get values for total tag mortality and tag fishing mortality â€” Get_Tagging_Mortality","text":"tag_selex Tag selectivity options, == 0 (uniform, F fleet 1 (dominant fleet)), == 1 (sex-averaged selectivity, F fleet 1 (dominant fleet)), == 2 (sex-specific selectivity, F fleet 1 (dominant fleet)), 3 (uniform F summed across fleets), 4 (sex averaged F summed across fleets, weighted sum), 5 (sex-specific F summed across fleets, weighted sum) tag_natmort Tag natural mortality options == 0 (averaged across sexes ages), == 1 (averaged across sexes, unique ages), == 2 (sex-specific, averaged across ages), == 3 (sex-age-specific) Fmort Array fishing mortality, dimensioned n_region, n_years, n_fish_fleets natmort Array fishing mortality, dimensioned n_region, n_years, n_ages, n_sexes Tag_Shed Scalar chronic tag shedding rate fish_sel Array fishery selectivity, dimensioned n_region, n_years, n_ages, n_sexes, n_fish_fleetss n_regions Number regions n_ages Number ages n_sexes Number sexes n_fish_fleets Number fishery fleets y Year index Whether return Z F (total fishing mortality)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_Tagging_Mortality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get values for total tag mortality and tag fishing mortality â€” Get_Tagging_Mortality","text":"Z F values tagging specifications","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_move_PE_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get Movement Process Error Likelihoods â€” Get_move_PE_loglik","title":"Title Get Movement Process Error Likelihoods â€” Get_move_PE_loglik","text":"Title Get Movement Process Error Likelihoods","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_move_PE_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get Movement Process Error Likelihoods â€” Get_move_PE_loglik","text":"","code":"Get_move_PE_loglik(   PE_model,   PE_pars,   logit_devs,   map_move_devs,   do_recruits_move )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_move_PE_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get Movement Process Error Likelihoods â€” Get_move_PE_loglik","text":"PE_model Process error model values PE_pars Process error parameters logit_devs Deviations map_move_devs movement deviations share do_recruits_move Whether recruits move (0, move, 1 move)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_move_PE_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Get Movement Process Error Likelihoods â€” Get_move_PE_loglik","text":"numeric value log likelihood (positive space)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_sel_PE_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Get selectivity process error log likelihoods (positive) â€” Get_sel_PE_loglik","title":"Get selectivity process error log likelihoods (positive) â€” Get_sel_PE_loglik","text":"Get selectivity process error log likelihoods (positive)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_sel_PE_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get selectivity process error log likelihoods (positive) â€” Get_sel_PE_loglik","text":"","code":"Get_sel_PE_loglik(   PE_model,   PE_pars,   ln_devs,   map_sel_devs,   sel_vals,   do_sel_pen )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_sel_PE_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get selectivity process error log likelihoods (positive) â€” Get_sel_PE_loglik","text":"PE_model Process error model values (1, 2, 3, 4, 5) (iid, random walk, 3d marginal, 3d conditional, 2dar1) PE_pars Process error parameters ln_devs Deviations map_sel_devs selectivity deviations share sel_vals Selectivity values (either length age based) do_sel_pen Whether temporal bin penalties used","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Get_sel_PE_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get selectivity process error log likelihoods (positive) â€” Get_sel_PE_loglik","text":"numeric value log likelihood (positive space)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Restrc_Comps.html","id":null,"dir":"Reference","previous_headings":"","what":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","title":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","text":"Restructure composition values, used within variety functions either Francis reweighting get observed expected composition values","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Restrc_Comps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","text":"","code":"Restrc_Comps(Exp, Obs, Comp_Type, age_or_len, AgeingError, comp_agg_type)"},{"path":"https://chengmatt.github.io/SPoRC/reference/Restrc_Comps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","text":"Exp Expected values (catch age survey index age) indexed given year fleet (structured matrix age sex) Obs Observed values (catch age survey index age) indexed given year fleet (structured matrix age sex) Comp_Type Composition Parameterization Type (== 0, aggregated comps sex, == 1, split comps sex (implicit sex ratio information), == 2, joint comps across sexes (implicit sex ratio information) age_or_len Age length comps (== 0, Age, == 1, Length) AgeingError Ageing Error matrix","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Restrc_Comps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","text":"Returns list array observed expected values given year fleet","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Restrc_Comps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Restructure composition values, used within a variety of functions to either do Francis reweighting or get observed and expected composition values â€” Restrc_Comps","text":"","code":"if (FALSE) { # \\dontrun{ comps <- Restrc_Comps(Exp, Obs, Comp_Type, age_or_len, AgeingError) comps$Exp; comps$Obs } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/SPoRC_rtmb.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized RTMB model â€” SPoRC_rtmb","title":"Generalized RTMB model â€” SPoRC_rtmb","text":"Generalized RTMB model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/SPoRC_rtmb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized RTMB model â€” SPoRC_rtmb","text":"","code":"SPoRC_rtmb(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/SPoRC_rtmb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized RTMB model â€” SPoRC_rtmb","text":"pars Parameter List data Data List","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Biologicals.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup biological inputs for estimation model â€” Setup_Mod_Biologicals","title":"Setup biological inputs for estimation model â€” Setup_Mod_Biologicals","text":"Setup biological inputs estimation model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Biologicals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup biological inputs for estimation model â€” Setup_Mod_Biologicals","text":"","code":"Setup_Mod_Biologicals(   input_list,   WAA,   WAA_fish = NULL,   WAA_srv = NULL,   MatAA,   addtocomp = 0.001,   addtofishidx = 1e-04,   addtosrvidx = 1e-04,   addtotag = 1e-10,   AgeingError = NULL,   Use_M_prior = 0,   M_prior = NA,   fit_lengths = 0,   SizeAgeTrans = NA,   Selex_Type = \"age\",   M_spec = \"est_ln_M\",   M_ageblk_spec = \"constant\",   M_regionblk_spec = \"constant\",   M_yearblk_spec = \"constant\",   M_sexblk_spec = \"constant\",   Fixed_natmort = NULL,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Biologicals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup biological inputs for estimation model â€” Setup_Mod_Biologicals","text":"input_list List containing data, parameter, map lists model. WAA Numeric array weight--age (spawning), dimensioned [n_regions, n_years, n_ages, n_sexes]. WAA_fish Numeric array weight--age (fishery), dimensioned [n_regions, n_years, n_ages, n_sexes, n_fish_fleets]. WAA_srv Numeric array weight--age (survey), dimensioned [n_regions, n_years, n_ages, n_sexes, n_srv_fleets]. MatAA Numeric array maturity--age, dimensioned [n_regions, n_years, n_ages, n_sexes]. addtocomp Numeric value constant add composition data. Default 1e-3. used logistic normal likelihoods utilized. addtofishidx Numeric value constant add composition data. Default 1e-4. addtosrvidx Numeric value constant add composition data. Default 1e-4. addtotag Numeric value constant add composition data. Default 1e-10 AgeingError Numeric matrix array representing ageing error transition matrix.   matrix (2D), dimensions [number modeled ages, number observed composition ages]   ageing error assumed constant time.   array (3D), dimensions [number years, number modeled ages, number observed composition ages]   allowing ageing error vary year.   Defaults identity matrix (ageing error) specified, assuming observed age bins exactly match modeled age bins. **Note:** observed age composition bins differ modeled age bins   (e.g., observed ages 2â€“10 modeled ages 1â€“10), default identity matrix cause dimensional mismatch   misalignment. cases, users provide custom ageing error matrix mapping modeled observed ages.   example, drop first modeled age bin, supply matrix like diag(1, 10)[, 2:10].   ensures proper alignment age bins likelihood calculations. Use_M_prior Integer flag indicating whether apply natural mortality prior (0 = , 1 = yes). M_prior Numeric vector length two giving mean (normal space) standard deviation natural mortality prior. fit_lengths Integer flag indicating whether fit length data (0 = , 1 = yes). SizeAgeTrans Numeric array size--age transition probabilities, dimensioned [n_regions, n_years, n_lens, n_ages, n_sexes]. Selex_Type Character string specifying whether selectivity age length-based. Default age-based \"length\": Length-based selectivity. \"age\": Age-based selectivity M_spec Character string specifying natural mortality estimation approach. Defaults est_ln_M, estimates mortality invariant, blocks specified. Options: \"est_ln_M\": Estimates natural mortality across defined natural mortality blocks. \"fix\": Fix natural mortality parameters using provided array. M_ageblk_spec Specification age blocking natural mortality estimation. Either character string (\"constant\") list index vectors, e.g., list(1:10, 11:30), specifies 2 age blocks M. M_regionblk_spec Specification regional blocking natural mortality. Either character string (\"constant\") list index vectors, e.g., list(1:3, 4:5), specifies 2 region blocks M. M_yearblk_spec Specification year blocking natural mortality. Either character string (\"constant\") list index vectors, e.g., list(1:10, 11:30), specifies 2 year blocks M. M_sexblk_spec Specification sex blocking natural mortality. Either character string (\"constant\") list index vectors, e.g., list(1:2), specifies sex-invariant M. Fixed_natmort Numeric array fixed natural mortality values, dimensioned [n_regions, n_years, n_ages, n_sexes]. Required M_spec = \"fix\". ... Additional arguments starting values ln_M M_offset. ignored M_spec = fix.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Catch_and_F.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup fishing mortality and catch observations â€” Setup_Mod_Catch_and_F","title":"Setup fishing mortality and catch observations â€” Setup_Mod_Catch_and_F","text":"Setup fishing mortality catch observations","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Catch_and_F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup fishing mortality and catch observations â€” Setup_Mod_Catch_and_F","text":"","code":"Setup_Mod_Catch_and_F(   input_list,   ObsCatch,   Catch_Type,   UseCatch,   Use_F_pen = 1,   est_all_regional_F = 1,   sigmaC_spec = \"fix\",   sigmaC_agg_spec = \"fix\",   sigmaF_spec = \"fix\",   sigmaF_agg_spec = \"fix\",   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Catch_and_F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup fishing mortality and catch observations â€” Setup_Mod_Catch_and_F","text":"input_list list containing data, parameters, map lists used model. ObsCatch Numeric array observed catches, dimensioned [n_regions, n_years, n_fish_fleets]. Catch_Type Integer matrix dimensions [n_years, n_fish_fleets], specifying catch data types: 0: Use aggregated catch data year. 1: Use region-specific catch data year. UseCatch Indicator array [n_regions, n_years, n_fish_fleets] specifying whether include catch data fit: 0: use catch data. 1: Use catch data fit. Use_F_pen Integer flag indicating whether apply fishing mortality penalty: 0: apply penalty. 1: Apply penalty. est_all_regional_F Integer flag indicating whether regional fishing mortality deviations estimated: 0: fishing mortality deviations aggregated across regions. 1: fishing mortality deviations regional. sigmaC_spec Character string specifying observation error structure catch data. Default behavior fixes sigmaC starting value 1e-3 (log-scale ln_sigmaC = log(1e-3)) regions, years, fleets. options include: \"est_shared_f\": Estimate sigmaC shared across fishery fleets, unique region year. \"est_shared_r\": Estimate sigmaC shared across regions, unique fleet year. \"est_shared_y\": Estimate sigmaC shared across years, unique region fleet. \"est_shared_r_f\": Estimate sigmaC shared across regions fleets, unique year. \"est_shared_f_y\": Estimate sigmaC shared across fleets years, unique region. \"est_shared_r_y\": Estimate sigmaC shared across regions years, unique fleet. \"est_shared_r_y_f\": Estimate single sigmaC shared across regions, years, fleets. \"fix\": Fix sigmaC starting value. \"est_all\": Estimate separate sigmaC region, year, fleet combination. sigmaC_agg_spec Character string specifying process error structure aggregated catch observation error. Default fixes sigmaC_agg starting value (log-scale sigmaC_agg). options include: \"est_shared_f\": Estimate sigmaC_agg shared across fishery fleets, unique year. \"est_shared_y\": Estimate sigmaC_agg shared across years, unique fleet. \"est_shared_y_f\": Estimate single sigmaC_agg shared across years fleets. \"fix\": Fix starting value. \"est_all\": Estimate separate parameters year fleet combination. sigmaF_spec Character string specifying process error structure fishing mortality. Default fixes sigmaF 1 log scale (.e., ln_sigmaF = 0). options include: \"est_shared_f\": Estimate sigmaF shared across fishery fleets. \"est_shared_r\": Estimate sigmaF shared across regions unique fleet. \"est_shared_r_f\": Estimate sigmaF shared across regions fleets. \"fix\": Fix sigmaF starting value. \"est_all\": Estimate separate sigmaF region fleet. sigmaF_agg_spec Character string specifying process error structure aggregated fishing mortality. Default fixes sigmaF_agg starting value (log-scale ln_sigmaF_agg). options include: \"est_shared_f\": Estimate sigmaF_agg shared across fishery fleets. \"fix\": Fix starting value. \"est_all\": Estimate separate parameters fishery fleet. ... Additional arguments specifying starting values ln_sigmaC, ln_sigmaF, ln_sigmaF_agg.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Dim.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up model dimensions â€” Setup_Mod_Dim","title":"Set up model dimensions â€” Setup_Mod_Dim","text":"Set model dimensions","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Dim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up model dimensions â€” Setup_Mod_Dim","text":"","code":"Setup_Mod_Dim(   years,   ages,   lens,   n_regions,   n_sexes,   n_fish_fleets,   n_srv_fleets,   n_proj_yrs_devs = 0,   verbose = FALSE )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Dim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up model dimensions â€” Setup_Mod_Dim","text":"years Numeric vector years. ages Numeric vector age classes. lens Numeric vector length bins; can set 1 length data modeled. n_regions Integer specifying number spatial regions. n_sexes Integer specifying number sexes. n_fish_fleets Integer specifying number fishery fleets. n_srv_fleets Integer specifying number survey fleets. n_proj_yrs_devs Number projection years deviation parameters (ln_RecDevs, logit_move_devs, ln_fishsel_devs, ln_srvsel_devs) verbose Logical flag indicating whether print progress messages (default FALSE).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Dim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set up model dimensions â€” Setup_Mod_Dim","text":"list containing three named elements: data List data inputs dimensioned model dimensions. parameters List model parameters initialized according dimensions. map List parameter mappings model fitting.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_FishIdx_and_Comps.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup observed fishery indices and composition data (age and length comps) â€” Setup_Mod_FishIdx_and_Comps","title":"Setup observed fishery indices and composition data (age and length comps) â€” Setup_Mod_FishIdx_and_Comps","text":"Setup observed fishery indices composition data (age length comps)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_FishIdx_and_Comps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup observed fishery indices and composition data (age and length comps) â€” Setup_Mod_FishIdx_and_Comps","text":"","code":"Setup_Mod_FishIdx_and_Comps(   input_list,   ObsFishIdx,   ObsFishIdx_SE,   fish_idx_type,   UseFishIdx,   ObsFishAgeComps,   UseFishAgeComps,   ISS_FishAgeComps,   ObsFishLenComps,   UseFishLenComps,   ISS_FishLenComps,   FishAgeComps_LikeType,   FishLenComps_LikeType,   FishAgeComps_Type,   FishLenComps_Type,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_FishIdx_and_Comps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup observed fishery indices and composition data (age and length comps) â€” Setup_Mod_FishIdx_and_Comps","text":"input_list List containing data list, parameter list, map list ObsFishIdx Observed fishery index data numeric array dimensions [n_regions, n_years, n_fish_fleets]. ObsFishIdx_SE Standard errors associated ObsFishIdx, also dimensioned [n_regions, n_years, n_fish_fleets]. fish_idx_type Character vector length n_fish_fleets specifying type index data. Options \"abd\" abundance, \"biom\" biomass, \"none\" index available. UseFishIdx Logical binary indicator array ([n_regions, n_years, n_fish_fleets]) specifying whether include fishery index likelihood (1) ignore (0). ObsFishAgeComps Observed fishery age composition data numeric array dimensions [n_regions, n_years, n_ages, n_sexes, n_fish_fleets]. Values reflect counts proportions (required sum 1, comparable scale). UseFishAgeComps Indicator array ([n_regions, n_years, n_fish_fleets]) specifying whether fit fishery age composition data (1) ignore (0). ISS_FishAgeComps Input sample size age compositions, array dimensioned [n_regions, n_years, n_sexes, n_fish_fleets]. Required observed age comps normalized (.e., sum 1), correctly scale contribution likelihood. ObsFishLenComps Observed fishery length composition data numeric array dimensions [n_regions, n_years, n_lens, n_sexes, n_fish_fleets]. Values reflect counts proportions. UseFishLenComps Indicator array ([n_regions, n_years, n_fish_fleets]) specifying whether fit fishery length composition data (1) ignore (0). ISS_FishLenComps ISS_FishAgeComps, length compositions. FishAgeComps_LikeType Character vector length n_fish_fleets specifying likelihood type used fishery age composition data. Options include \"Multinomial\", \"Dirichlet-Multinomial\", \"iid-Logistic-Normal\". Use \"none\" omit likelihood. FishLenComps_LikeType FishAgeComps_LikeType, fishery length composition data. FishAgeComps_Type Character vector specifying age compositions structured fleet year range. Options include: \"agg\": Aggregated across regions sexes. \"spltRspltS\": Split region sex (compositions sum 1 within region-sex group). \"spltRjntS\": Split region summed jointly across sexes. \"none\": composition data used. Format element \"<type>_Year_<start>-<end>_Fleet_<fleet number>\" (e.g., \"agg_Year_1-10_Fleet_1\"). FishLenComps_Type FishAgeComps_Type, length compositions. ... Additional arguments specifying starting values overdispersion parameters (e.g., ln_FishAge_theta, ln_FishLen_theta, ln_FishAge_theta_agg, ln_FishLen_theta_agg).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Fishsel_and_Q.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup fishery selectivity and catchability specifications â€” Setup_Mod_Fishsel_and_Q","title":"Setup fishery selectivity and catchability specifications â€” Setup_Mod_Fishsel_and_Q","text":"Setup fishery selectivity catchability specifications","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Fishsel_and_Q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup fishery selectivity and catchability specifications â€” Setup_Mod_Fishsel_and_Q","text":"","code":"Setup_Mod_Fishsel_and_Q(   input_list,   cont_tv_fish_sel = paste(\"none_Fleet_\", 1:input_list$data$n_fish_fleets, sep = \"\"),   fish_sel_blocks = paste(\"none_Fleet_\", 1:input_list$data$n_fish_fleets, sep = \"\"),   fish_sel_model,   Use_fish_q_prior = 0,   fish_q_prior = NA,   fish_q_blocks = paste(\"none_Fleet_\", 1:input_list$data$n_fish_fleets, sep = \"\"),   fishsel_pe_pars_spec = NULL,   fish_fixed_sel_pars_spec = NULL,   fish_q_spec = NULL,   fish_sel_devs_spec = NULL,   corr_opt_semipar = NULL,   Use_fish_selex_prior = 0,   fish_selex_prior = NULL,   cont_tv_fish_sel_penalty = TRUE,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Fishsel_and_Q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup fishery selectivity and catchability specifications â€” Setup_Mod_Fishsel_and_Q","text":"input_list List containing data list, parameter list, map list cont_tv_fish_sel Character vector specifying form continuous time-varying selectivity fishery fleet. vector must length n_fish_fleets, element must follow structure: \"<time variation type>_Fleet_<fleet number>\". Valid time variation types include: \"none\": continuous time variation (default) \"iid\": Independent identically distributed deviations across years. \"rw\": Random walk time. \"3dmarg\": 3D marginal time-varying selectivity. \"3dcond\": 3D conditional time-varying selectivity. \"2dar1\": Two-dimensional AR1 process. example: \"iid_Fleet_1\" applies iid time-varying structure Fleet 1. \"none_Fleet_2\" means time variation used Fleet 2. fish_sel_blocks Character vector specifying fishery selectivity blocks region fleet. element must follow one following structures: `\"Block_<block number>_Year_<start>-<end>_Fleet_<fleet number>\"` `\"Block_<block number>_Year_<start>-terminal_Fleet_<fleet number>\"` `\"none_Fleet_<fleet number>\"` argument defines fishery selectivity varies time fleet: \"Block_...\" entries specify discrete time blocks selectivity parameters assumed constant. \"none_...\" entries indicate selectivity constant across years specified fleet. time-block-based selectivity specified fleet (via fish_sel_blocks), corresponding continuous selectivity option (cont_tv_fish_sel) must set \"none_Fleet_<fleet number>\". two approachesâ€”blocked continuous time-varying selectivityâ€”mutually exclusive. default fleet \"none_Fleet_x\" (.e., selectivity blocks). fish_sel_model Character vector specifying fishery selectivity functional form fleet, optionally time block. element must follow one following structures: \"<selectivity model>_Fleet_<fleet number>\" \"<selectivity model>_Block_<block number>_Fleet_<fleet number>\" first form applies single selectivity model across years specified fleet. second form allows user assign distinct selectivity model specific time block, defined fish_sel_blocks. Available selectivity model types include: \"logist1\" â€” Logistic function parameters a50 k. \"logist2\" â€” Logistic function parameters a50 a95. \"gamma\" â€” Dome-shaped gamma function parameters amax delta. \"exponential\" â€” Exponential function power parameter. \"dbnrml\" â€” Double-normal function six parameters. multiple selectivity time blocks specified fleet (using fish_sel_blocks), corresponding selectivity model block must explicitly defined using \"<model>_Block_<block>_Fleet_<fleet>\" format. blocks defined fleet, use \"<model>_Fleet_<fleet number>\" format . mathematical definitions implementation details selectivity form, refer model equations vignette. Use_fish_q_prior Integer (0 1). Flag enable/disable fishery catchability priors. set 1, applies log-normal priors fishery selectivity parameters specified fish_q_prior. set 0, priors applied. fish_q_prior Data frame containing prior specifications fishery catchability parameters. Must include columns: region (region index), fleet (fleet index), block (time block index), mu (prior mean natural scale), sd (prior standard deviation log scale). row specifies log-normal prior N(log(mu), sd) given catchability parameter. parameters rows data frame priors applied. fish_q_blocks Character vector specifying fishery catchability (q) blocks fleet. element must follow structure: \"Block_<block number>_Year_<start>-<end>_Fleet_<fleet number>\" \"none_Fleet_<fleet number>\". Default \"none_Fleet_x\". allows users define time-varying catchability blocks independently selectivity blocks. blocks must non-overlapping sequential time within fleet. example: \"Block_1_Year_1-35_Fleet_1\" assigns block 1 Fleet 1 years 1â€“35. \"Block_2_Year_36-56_Fleet_1\" continues block 2 years 36â€“56. \"Block_3_Year_57-terminal_Fleet_1\" assigns block 3 year 57 terminal year Fleet 1. \"none_Fleet_2\" indicates catchability blocks used Fleet 2. Internally, specifications converted [n_regions, n_years, n_fish_fleets] array, block mapped appropriate years fleets. fishsel_pe_pars_spec Character string specifying process error parameters fishery selectivity estimated across regions sexes. relevant cont_tv_fish_sel set \"none\"; otherwise, process error parameters treated fixed. Available options include: \"est_all\": Estimates separate process error parameters region sex. \"est_shared_r\": Shares process error parameters across regions (sex-specific parameters still estimated). \"est_shared_s\": Shares process error parameters across sexes (region-specific parameters still estimated). \"est_shared_r_s\": Shares process error parameters across regions sexes, estimating single set parameters. \"est_shared_f_x\": Shares process error parameters another fleet, x fleet number share .     option forces multiple fleets identical process error variance correlation structures     time-varying selectivity. example, \"est_shared_f_2\" means current fleet use     process error parameters fleet 2. reference fleet (fleet x) must use one sharing options     sharing another fleet. \"fix\" \"none\": estimate process error parameters; treated fixed. fish_fixed_sel_pars_spec Character string specifying structure estimating fixed-effect parameters fishery selectivity model (e.g., a50, k, amax). controls whether selectivity parameters estimated separately shared across regions sexes. Available options include: \"est_all\": Estimates separate fixed-effect selectivity parameters region sex. \"est_shared_r\": Shares parameters across regions (sex-specific parameters still estimated). \"est_shared_s\": Shares parameters across sexes (region-specific parameters still estimated). \"est_shared_r_s\": Shares parameters across regions sexes, estimating single set fixed-effect parameters. \"est_shared_f_x\": Shares fixed-effect selectivity parameters another fleet, x fleet number share .     option forces multiple fleets identical selectivity curves using underlying parameters     (e.g., a50, k, amax values). example, \"est_shared_f_2\" means current fleet use     fixed-effect selectivity parameters fleet 2. reference fleet (fleet x) must use one sharing options     sharing another fleet. \"fix\": Fixes selectivity parameters initial values (estimation). \"none\": selectivity parameters estimated (equivalent \"fix\"). fish_q_spec Character string specifying structure fishery catchability (q) estimation across regions. controls whether separate shared parameters used. Available options include: \"est_all\": Estimates separate catchability parameters region. \"est_shared_r\": Estimates single catchability parameter shared across regions. fish_sel_devs_spec Character string specifying structure process error deviations time-varying fishery selectivity dimensioned number fishery fleets. determines deviations estimated across regions sexes. Available options include: \"est_all\": Estimates separate deviation time series region sex. \"est_shared_r\": Shares deviations across regions (sex-specific deviations still estimated). \"est_shared_s\": Shares deviations across sexes (region-specific deviations still estimated). \"est_shared_r_s\": Shares deviations across regions sexes, estimating single deviation time series. \"est_shared_f_x\": Shares deviations another fleet, x fleet number share .     option allows multiple fleets use identical deviation parameters, reducing number parameters     estimate. example, \"est_shared_f_2\" means current fleet use deviation     parameters fleet 2. reference fleet (fleet x) must use one sharing options     (\"est_all\", \"est_shared_r\", \"est_shared_s\", \"est_shared_r_s\")     sharing another fleet. \"fix\": Fixes deviation parameters zero (time-variation). \"none\": deviation parameters estimated (equivalent \"fix\"). argument used continuous time-varying selectivity form specified (e.g., via cont_tv_fish_sel). corr_opt_semipar Character string specifying correlation structures suppress   using semi-parametric time-varying selectivity models. used cont_tv_sel   set one \"3dmarg\", \"3dcond\", \"2dar1\". option allows users turn estimation specific correlation components   time-varying selectivity model. can improve stability enforce assumptions   independence temporal age structure. Available options: \"corr_zero_y\": Sets year (temporal) correlations 0. \"corr_zero_b\": Sets age correlations 0. \"corr_zero_y_b\": Sets year bin correlations 0. \"corr_zero_c\": Sets cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_y_c\": Sets year cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_b_c\": Sets bin (age) cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_y_b_c\": Sets correlations (year, bin (age), cohort) 0.       valid cont_tv_sel = \"3dmarg\" \"3dcond\"; equivalent iid structure. correlation-suppression flags ignored cont_tv_sel set value. Use_fish_selex_prior Integer (0 1). Flag enable/disable fishery selectivity priors. set 1, applies log-normal priors fishery selectivity parameters specified fish_selex_prior. set 0, priors applied. fish_selex_prior Data frame containing prior specifications fishery selectivity parameters. Must include columns: region (region index), fleet (fleet index), block (time block index), sex (sex index), par (parameter index), mu (prior mean natural scale), sd (prior standard deviation log scale). row specifies log-normal prior N(log(mu), sd) one selectivity parameter. parameters rows data frame priors applied. cont_tv_fish_sel_penalty Whether continuous fishery time varying selectivity penalties applied (cont_tv_fish_sel > 0) ... Additional arguments specifying starting values fishery selectivity catchability parameters (fishsel_pe_pars, ln_fishsel_devs, ln_fish_fixed_sel_pars, ln_fish_q)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Movement.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup Movement Processes for SPoRC â€” Setup_Mod_Movement","title":"Setup Movement Processes for SPoRC â€” Setup_Mod_Movement","text":"Setup Movement Processes SPoRC","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Movement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup Movement Processes for SPoRC â€” Setup_Mod_Movement","text":"","code":"Setup_Mod_Movement(   input_list,   do_recruits_move = 0,   use_fixed_movement = 0,   Fixed_Movement = NA,   Use_Movement_Prior = 0,   Movement_prior = NULL,   Movement_ageblk_spec = \"constant\",   Movement_yearblk_spec = \"constant\",   Movement_sexblk_spec = \"constant\",   cont_vary_movement = \"none\",   Movement_cont_pe_pars_spec = \"none\",   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Movement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup Movement Processes for SPoRC â€” Setup_Mod_Movement","text":"input_list List containing data, parameter, map lists model. do_recruits_move Integer flag (0 1) indicating whether recruits move. Default 0 (move). use_fixed_movement Integer flag (0 1) indicating whether use fixed movement matrix (1) estimate movement parameters (0). Default 0. Fixed_Movement Numeric array fixed movement matrix dimensioned [n_regions, n_regions, n_years, n_ages, n_sexes]. Default array ones. Use_Movement_Prior Integer flag (0 1) indicating whether use movement priors. Default 0 (priors). Movement_prior Numeric vector array specifying prior values movement parameters. vector, constant prior applied across dimensions. Movement_ageblk_spec Either: Character string \"constant\" age-invariant movement (default), list numeric vectors specifying age blocks sharing parameters. example, list(c(1:6), c(7:10), c(11:n_ages)) defines three age blocks : ages 1 6 share parameters, ages 7 10 share parameters, ages 11 n_ages share parameters. specify age-invariant movement, use either \"constant\" list(c(1:n_ages)). Movement_yearblk_spec Either: Character string \"constant\" time-invariant movement (default), list numeric vectors specifying year blocks sharing movement parameters. Movement_sexblk_spec Either: Character string \"constant\" sex-invariant movement (default), list numeric vectors specifying sex blocks sharing movement parameters. cont_vary_movement Character string specifying continuous varying movement type. Available options: \"none\" \"iid_y\" (iid deviations year) \"iid_a\" (iid deviations age) \"iid_y_a\" (iid deviations year age) \"iid_y_s\" (iid deviations year sex) \"iid_a_s\" (iid deviations age sex) \"iid_y_a_s\" (iid deviations year, age, sex) Default \"none\". Movement_cont_pe_pars_spec Character string specifying process error parameter sharing. Available options: \"est_shared_r\" \"est_shared_a\" \"est_shared_s\" \"est_shared_r_a\" \"est_shared_a_s\" \"est_shared_r_s\" \"est_shared_r_a_s\" \"est_all\" \"fix\" \"none\" Default \"none\". ... Additional parameters starting values move_pars, logit_move_devs, move_pe_pars.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Rec.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup model objects for specifying recruitment module and associated processes â€” Setup_Mod_Rec","title":"Setup model objects for specifying recruitment module and associated processes â€” Setup_Mod_Rec","text":"Setup model objects specifying recruitment module associated processes","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Rec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup model objects for specifying recruitment module and associated processes â€” Setup_Mod_Rec","text":"","code":"Setup_Mod_Rec(   input_list,   rec_model,   rec_dd = NULL,   rec_lag = 1,   Use_h_prior = 0,   h_prior = NULL,   Use_Rec_prop_Prior = 0,   Rec_prop_prior = NULL,   do_rec_bias_ramp = 0,   bias_year = NA,   max_bias_ramp_fct = 1,   sigmaR_switch = 1,   dont_est_recdev_last = 0,   init_age_strc = 2,   equil_init_age_strc = 1,   init_F_prop = 0,   sigmaR_spec = NULL,   InitDevs_spec = NULL,   RecDevs_spec = NULL,   h_spec = NULL,   t_spawn = 0,   sexratio_spec = \"fix\",   sexratio_blocks = c(paste(\"none_Region_\", c(1:input_list$data$n_regions), sep = \"\")),   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Rec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup model objects for specifying recruitment module and associated processes â€” Setup_Mod_Rec","text":"input_list List containing data, parameters, map lists used model. rec_model Character string specifying recruitment model. Options : \"mean_rec\": Recruitment fixed mean value. \"bh_rec\": Beverton-Holt recruitment steepness parameter. rec_dd Character string specifying recruitment density dependence, options: \"local\", \"global\", NULL. rec_lag Integer specifying recruitment lag duration relative spawning stock biomass (SSB). Use_h_prior Integer flag (0 1) indicating whether apply prior steepness h. h_prior Data frame specifying beta prior distributions `h_trans` parameters. Must include following columns: - `region`: Integer region index corresponding element `h_trans` penalized. - `mu`: Mean prior normal space (used calculate corresponding beta distribution). - `sd`: Standard deviation prior normal space. row, beta distribution scaled interval [0.2, 1], corresponding element `h_trans` transformed scale penalized using log-density beta distribution. Use_Rec_prop_Prior Integer flag (0 1) indicating whether apply prior recruitment proportions. Rec_prop_prior Scalar array specifying prior values recruitment proportion parameters. scalar, constant uniform prior applied across dimensions. do_rec_bias_ramp Integer flag (0 1) indicating whether apply recruitment bias correction ramp. bias_year Numeric vector length 4 defining recruitment bias ramp periods: Element 1: End year bias correction period. Element 2: End year ascending bias ramp period. Element 3: End year full bias correction period. Element 4: Start year final bias correction period. example, 65 years total, c(21, 31, 60, 64) means: Years 1â€“21: bias correction. Years 22â€“31: Ascending bias correction. Years 32â€“60: Full bias correction. Years 61â€“63: Descending bias ramp. Years 64â€“65: bias correction. max_bias_ramp_fct Numeric specifying maximum bias correction apply recruitment bias ramp (0 1) sigmaR_switch Integer year indicating sigmaR switches early late values (0 disables switching). dont_est_recdev_last Integer specifying many recent recruitment deviations estimate. Default 0. init_age_strc Integer flag specifying initialization initial age structure: 0: Initialize iteration. 1: Initialize using scalar geometric series (account movement). 2: Initialize using matrix geometric series (accounts movement; default). equil_init_age_strc Integer flag specifying initial age structure deviations initialized. Default stochastic ages except recruitment age plus group. 0: Equilibrium initial age structure. 1: Stochastic initial age structure ages, except plus group, follows equilibrium calculations (geometric series) 2: Stochastic initial age structure ages init_F_prop Numeric value specifying initial fishing mortality proportion relative mean fishing mortality initializing age structure. sigmaR_spec Character string specifying estimation recruitment variability (sigmaR): NULL \"est_all\": Estimate separate sigmaR early late periods. \"est_shared\": Estimate one sigmaR shared across periods. \"fix\": Fix sigmaR values. \"fix_early_est_late\": Fix early sigmaR, estimate late sigmaR. InitDevs_spec Character string specifying estimation initial age deviations: NULL: Estimate deviations ages regions. \"est_shared_r\": Estimate deviations shared across regions. \"fix\": Fix deviations. RecDevs_spec Character string specifying recruitment deviation estimation: NULL: Estimate deviations regions years. \"est_shared_r\": Estimate deviations shared across regions (global recruitment deviations). \"fix\": Fix recruitment deviations. h_spec Character string specifying steepness estimation: NULL: Estimate steepness regions rec_model == \"bh_rec\". \"est_shared_r\": Estimate steepness shared across regions. \"fix\": Fix steepness values. rec_model == \"mean_rec\", steepness fixed. t_spawn Numeric fraction specifying spawning timing within year. sexratio_spec Character string specifying sex ratio estimation scheme: \"est_all\" estimates sex ratio blocks regions independently \"est_shared_r\" estimates sex ratio shared across regions varying block \"fix\" fixes sex ratio (estimation) sexratio_blocks Character vector specifying blocks years regions sex ratio. Format examples: \"Block_1_Year_1-15_Region_1\" \"Block_2_Year_16-terminal_Region_2\" \"none_Region_3\" (means block, constant region; default option) ... Additional arguments specifying starting values recruitment parameters ln_global_R0, Rec_prop, h, ln_InitDevs, ln_RecDevs, ln_sigmaR.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_SrvIdx_and_Comps.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup observed survey indices and composition data (age and length comps) â€” Setup_Mod_SrvIdx_and_Comps","title":"Setup observed survey indices and composition data (age and length comps) â€” Setup_Mod_SrvIdx_and_Comps","text":"Setup observed survey indices composition data (age length comps)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_SrvIdx_and_Comps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup observed survey indices and composition data (age and length comps) â€” Setup_Mod_SrvIdx_and_Comps","text":"","code":"Setup_Mod_SrvIdx_and_Comps(   input_list,   ObsSrvIdx,   ObsSrvIdx_SE,   UseSrvIdx,   srv_idx_type,   ObsSrvAgeComps,   UseSrvAgeComps,   ObsSrvLenComps,   UseSrvLenComps,   ISS_SrvAgeComps,   ISS_SrvLenComps,   SrvAgeComps_LikeType,   SrvLenComps_LikeType,   SrvAgeComps_Type,   SrvLenComps_Type,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_SrvIdx_and_Comps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup observed survey indices and composition data (age and length comps) â€” Setup_Mod_SrvIdx_and_Comps","text":"input_list List containing data list, parameter list, map list ObsSrvIdx Observed survey index data numeric array dimensions [n_regions, n_years, n_srv_fleets]. ObsSrvIdx_SE Standard errors associated ObsSrvIdx, also dimensioned [n_regions, n_years, n_srv_fleets]. UseSrvIdx Logical binary indicator array ([n_regions, n_years, n_srv_fleets]) specifying whether include survey index likelihood (1) ignore (0). srv_idx_type Character vector length n_srv_fleets specifying type index data. Options \"abd\" abundance, \"biom\" biomass, \"none\" index available. ObsSrvAgeComps Observed survey age composition data numeric array dimensions [n_regions, n_years, n_ages, n_sexes, n_srv_fleets]. Values reflect counts proportions (required sum 1, comparable scale). UseSrvAgeComps Indicator array ([n_regions, n_years, n_srv_fleets]) specifying whether fit survey age composition data (1) ignore (0). ObsSrvLenComps Observed survey length composition data numeric array dimensions [n_regions, n_years, n_lens, n_sexes, n_srv_fleets]. Values reflect counts proportions. UseSrvLenComps Indicator array ([n_regions, n_years, n_srv_fleets]) specifying whether fit survey length composition data (1) ignore (0). ISS_SrvAgeComps Input sample size age compositions, array dimensioned [n_regions, n_years, n_sexes, n_srv_fleets]. Required observed age comps normalized (.e., sum 1), correctly scale contribution likelihood. ISS_SrvLenComps ISS_SrvAgeComps, length compositions. SrvAgeComps_LikeType Character vector length n_srv_fleets specifying likelihood type used survey age composition data. Options include \"Multinomial\", \"Dirichlet-Multinomial\", \"iid-Logistic-Normal\". Use \"none\" omit likelihood. SrvLenComps_LikeType SrvAgeComps_LikeType, survey length composition data. SrvAgeComps_Type Character vector specifying age compositions structured fleet year range. Options include: \"agg\": Aggregated across regions sexes. \"spltRspltS\": Split region sex (compositions sum 1 within region-sex group). \"spltRjntS\": Split region summed jointly across sexes. \"none\": composition data used. Format element \"<type>_Year_<start>-<end>_Fleet_<fleet number>\" (e.g., \"agg_Year_1-10_Fleet_1\"). SrvLenComps_Type SrvAgeComps_Type, length compositions. ... Additional arguments specifying starting values overdispersion parameters (e.g., ln_SrvAge_theta, ln_SrvLen_theta, ln_SrvAge_theta_agg, ln_SrvLen_theta_agg).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Srvsel_and_Q.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup survey selectivity and catchability specifications â€” Setup_Mod_Srvsel_and_Q","title":"Setup survey selectivity and catchability specifications â€” Setup_Mod_Srvsel_and_Q","text":"Setup survey selectivity catchability specifications","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Srvsel_and_Q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup survey selectivity and catchability specifications â€” Setup_Mod_Srvsel_and_Q","text":"","code":"Setup_Mod_Srvsel_and_Q(   input_list,   cont_tv_srv_sel = paste(\"none_Fleet_\", 1:input_list$data$n_srv_fleets, sep = \"\"),   srv_sel_blocks = paste(\"none_Fleet_\", 1:input_list$data$n_srv_fleets, sep = \"\"),   srv_sel_model,   Use_srv_q_prior = 0,   srv_q_prior = NA,   srv_q_blocks = paste(\"none_Fleet_\", 1:input_list$data$n_srv_fleets, sep = \"\"),   srvsel_pe_pars_spec = NULL,   srv_fixed_sel_pars_spec,   srv_q_spec = NULL,   srv_sel_devs_spec = NULL,   corr_opt_semipar = NULL,   srv_q_formula = NULL,   srv_q_cov_dat = NULL,   Use_srv_selex_prior = 0,   srv_selex_prior = NULL,   t_srv = array(0.5, dim = c(input_list$data$n_regions, input_list$data$n_srv_fleets)),   cont_tv_srv_sel_penalty = TRUE,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Srvsel_and_Q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup survey selectivity and catchability specifications â€” Setup_Mod_Srvsel_and_Q","text":"input_list List containing data list, parameter list, map list cont_tv_srv_sel Character vector specifying form continuous time-varying selectivity survey fleet. vector must length n_srv_fleets, element must follow structure: \"<time variation type>_Fleet_<fleet number>\". Valid time variation types include: \"none\": continuous time variation. (default) \"iid\": Independent identically distributed deviations across years. \"rw\": Random walk time. \"3dmarg\": 3D marginal time-varying selectivity. \"3dcond\": 3D conditional time-varying selectivity. \"2dar1\": Two-dimensional AR1 process. example: \"iid_Fleet_1\" applies iid time-varying structure Fleet 1. \"none_Fleet_2\" means time variation used Fleet 2. srv_sel_blocks Character vector specifying survey selectivity blocks region fleet. element must follow one following structures: `\"Block_<block number>_Year_<start>-<end>_Fleet_<fleet number>\"` `\"Block_<block number>_Year_<start>-terminal_Fleet_<fleet number>\"` `\"none_Fleet_<fleet number>\"` argument defines survey selectivity varies time fleet: \"Block_...\" entries specify discrete time blocks selectivity parameters assumed constant. \"none_...\" entries indicate selectivity constant across years specified fleet. time-block-based selectivity specified fleet (via srv_sel_blocks), corresponding continuous selectivity option (cont_tv_srv_sel) must set \"none_Fleet_<fleet number>\". two approachesâ€”blocked continuous time-varying selectivityâ€”mutually exclusive. default fleet \"none_Fleet_x\" (.e., selectivity blocks). srv_sel_model Character vector specifying survey selectivity functional form fleet, optionally time block. element must follow one following structures: \"<selectivity model>_Fleet_<fleet number>\" \"<selectivity model>_Block_<block number>_Fleet_<fleet number>\" first form applies single selectivity model across years specified fleet. second form allows user assign distinct selectivity model specific time block, defined srv_sel_blocks. Available selectivity model types include: \"logist1\" â€” Logistic function parameters a50 k. \"logist2\" â€” Logistic function parameters a50 a95. \"gamma\" â€” Dome-shaped gamma function parameters amax delta. \"exponential\" â€” Exponential function power parameter. \"dbnrml\" â€” Double-normal function six parameters. multiple selectivity time blocks specified fleet (using srv_sel_blocks), corresponding selectivity model block must explicitly defined using \"<model>_Block_<block>_Fleet_<fleet>\" format. blocks defined fleet, use \"<model>_Fleet_<fleet number>\" format . mathematical definitions implementation details selectivity form, refer model equations vignette. Use_srv_q_prior Integer (0 1). Flag enable/disable survey catchability priors. set 1, applies log-normal priors survey selectivity parameters specified srv_q_prior. set 0, priors applied. srv_q_prior Data frame containing prior specifications survey catchability parameters. Must include columns: region (region index), fleet (fleet index), block (time block index), mu (prior mean natural scale), sd (prior standard deviation log scale). row specifies log-normal prior N(log(mu), sd) given catchability parameter. parameters rows data frame priors applied. srv_q_blocks Character vector specifying survey catchability (q) blocks fleet. element must follow structure: \"Block_<block number>_Year_<start>-<end>_Fleet_<fleet number>\" \"none_Fleet_<fleet number>\". allows users define time-varying catchability blocks independently selectivity blocks. blocks must non-overlapping sequential time within fleet. example: \"Block_1_Year_1-35_Fleet_1\" assigns block 1 Fleet 1 years 1â€“35. \"Block_2_Year_36-56_Fleet_1\" continues block 2 years 36â€“56. \"Block_3_Year_57-terminal_Fleet_1\" assigns block 3 year 57 terminal year Fleet 1. \"none_Fleet_2\" indicates catchability blocks used Fleet 2. Internally, specifications converted [n_regions, n_years, n_srv_fleets] array, block mapped appropriate years fleets. srvsel_pe_pars_spec Character string specifying process error parameters survey selectivity estimated across regions sexes. relevant cont_tv_srv_sel set \"none\"; otherwise, process error parameters treated fixed. Available options include: \"est_all\": Estimates separate process error parameters region sex. \"est_shared_r\": Shares process error parameters across regions (sex-specific parameters still estimated). \"est_shared_s\": Shares process error parameters across sexes (region-specific parameters still estimated). \"est_shared_r_s\": Shares process error parameters across regions sexes, estimating single set parameters. \"est_shared_f_x\": Shares process error parameters another fleet, x fleet number share .     option forces multiple fleets identical process error variance correlation structures     time-varying selectivity. example, \"est_shared_f_2\" means current fleet use     process error parameters fleet 2. reference fleet (fleet x) must use one sharing options     sharing another fleet. \"fix\" \"none\": estimate process error parameters; treated fixed. srv_fixed_sel_pars_spec Character string specifying structure estimating fixed-effect parameters survey selectivity model (e.g., a50, k, amax). controls whether selectivity parameters estimated separately shared across regions sexes. Available options include: \"est_all\": Estimates separate fixed-effect selectivity parameters region sex. \"est_shared_r\": Shares parameters across regions (sex-specific parameters still estimated). \"est_shared_s\": Shares parameters across sexes (region-specific parameters still estimated). \"est_shared_r_s\": Shares parameters across regions sexes, estimating single set fixed-effect parameters. \"est_shared_f_x\": Shares fixed-effect selectivity parameters another fleet, x fleet number share .     option forces multiple fleets identical selectivity curves using underlying parameters     (e.g., a50, k, amax values). example, \"est_shared_f_2\" means current fleet use     fixed-effect selectivity parameters fleet 2. reference fleet (fleet x) must use one sharing options     sharing another fleet. \"fix\": Fixes selectivity parameters initial values (estimation). \"none\": selectivity parameters estimated (equivalent \"fix\"). srv_q_spec Character string specifying structure survey catchability (q) estimation across regions. controls whether separate shared parameters used. Available options include: \"est_all\": Estimates separate catchability parameters region. \"est_shared_r\": Estimates single catchability parameter shared across regions. srv_sel_devs_spec Character string specifying structure process error deviations time-varying survey selectivity dimensioned number survey fleets. determines deviations estimated across regions sexes. Available options include: \"est_all\": Estimates separate deviation time series region sex. \"est_shared_r\": Shares deviations across regions (sex-specific deviations still estimated). \"est_shared_s\": Shares deviations across sexes (region-specific deviations still estimated). \"est_shared_r_s\": Shares deviations across regions sexes, estimating single deviation time series. \"est_shared_f_x\": Shares deviations another fleet, x fleet number share .     option allows multiple fleets use identical deviation parameters, reducing number parameters     estimate. example, \"est_shared_f_2\" means current fleet use deviation     parameters fleet 2. reference fleet (fleet x) must use one sharing options     (\"est_all\", \"est_shared_r\", \"est_shared_s\", \"est_shared_r_s\")     sharing another fleet. \"fix\": Fixes deviation parameters zero (time-variation). \"none\": deviation parameters estimated (equivalent \"fix\"). argument used continuous time-varying selectivity form specified (e.g., via cont_tv_srv_sel). corr_opt_semipar Character string specifying correlation structures suppress   using semi-parametric time-varying selectivity models. used cont_tv_sel   set one \"3dmarg\", \"3dcond\", \"2dar1\". option allows users turn estimation specific correlation components   time-varying selectivity model. can improve stability enforce assumptions   independence temporal age structure. Available options: \"corr_zero_y\": Sets year (temporal) correlations 0. \"corr_zero_b\": Sets bin correlations 0. \"corr_zero_y_b\": Sets year bin correlations 0. \"corr_zero_c\": Sets cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_y_c\": Sets year cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_b_c\": Sets bin (age) cohort correlations 0. valid cont_tv_sel = \"3dmarg\" \"3dcond\". \"corr_zero_y_b_c\": Sets correlations (year, bin (age), cohort) 0.       valid cont_tv_sel = \"3dmarg\" \"3dcond\"; equivalent iid structure. correlation-suppression flags ignored cont_tv_sel set value. srv_q_formula named list formulas specifying environmental covariate relationships region survey fleet. element named using convention `\"Region_<region>_Fleet_<fleet>\"` contain formula object using covariate names present `srv_q_cov_dat`. formula determines environmental covariates influence survey catchability. `NULL`, environmental covariate effects included. srv_q_cov_dat named list containing time series vectors (typically year) environmental covariates used `srv_q_formula`. entry numeric vector length equal number years, names must match variable names used formulas. `NULL`, survey catchability assumed time-invariant (.e., influenced environmental variables). Use_srv_selex_prior Integer (0 1). Flag enable/disable survey selectivity priors. set 1, applies log-normal priors survey selectivity parameters specified srv_selex_prior. set 0, priors applied. srv_selex_prior Data frame containing prior specifications survey selectivity parameters.   Must include columns: region (region index), fleet (fleet index),   block (time block index), sex (sex index), par (parameter index),   mu (prior mean natural scale), sd (prior standard deviation log scale).   row specifies log-normal prior N(log(mu), sd) one selectivity parameter.   parameters rows data frame priors applied. `srv_q_formula` `srv_q_cov_dat` non-`NULL`, model constructs time-varying design matrices region fleet based provided formulas environmental covariates. coefficient array (`srv_q_coeff`) mapping array (`map_srv_q_coeff`) created estimate track associated regression coefficients. design matrix stored `srv_q_env`, 4D array indexed [region, year, fleet, covariate]. either argument `NULL`, environmental covariate effects excluded survey catchability treated constant time. Important: covariate time series `srv_q_cov_dat` must: numeric vectors length equal number years model. Align years across covariates. Contain missing values; users must impute interpolate missing covariate values prior use. years index used, values can set 0. Covariates defined used formula can filled zeros (e.g., rep(0, n_yrs)). avoids issues list structure affect design matrix model results. Example formulas: \"Region_1_Fleet_1\" = ~ 0 + poly(env1_r1_f1, 3) + env2_r1_f1 uses 3rd-degree         polynomial env1_r1_f1 linear term env2_r1_f1. \"Region_2_Fleet_1\" = ~ 0 + env1_r2_f1 + env2_r2_f1 includes additive effects         two covariates. \"Region_3_Fleet_2\" = ~ NULL disables environmental covariates fleet-region. t_srv Survey timing fractions (n_regions * n_srv_fleets; default 0.5) cont_tv_srv_sel_penalty Whether apply continuous time-varying selectivity penalties (cont_tv_srv_sel > 0) ... Additional arguments specifying starting values survey selectivity catchability parameters (srvsel_pe_pars, ln_srvsel_devs, ln_srv_fixed_sel_pars, ln_srv_q, srv_q_coeff)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Tagging.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup tagging processes and parameters â€” Setup_Mod_Tagging","title":"Setup tagging processes and parameters â€” Setup_Mod_Tagging","text":"Setup tagging processes parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Tagging.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup tagging processes and parameters â€” Setup_Mod_Tagging","text":"","code":"Setup_Mod_Tagging(   input_list,   UseTagging = 0,   tag_release_indicator = NULL,   max_tag_liberty = 0,   Tagged_Fish = NA,   Obs_Tag_Recap = NA,   Tag_LikeType = NA,   mixing_period = 1,   t_tagging = 0,   tag_selex = NA,   tag_natmort = NA,   Use_TagRep_Prior = 0,   TagRep_Prior = NULL,   move_age_tag_pool = NA,   move_sex_tag_pool = NA,   Init_Tag_Mort_spec = NULL,   Tag_Shed_spec = NULL,   TagRep_spec = \"fix\",   Tag_Reporting_blocks = NULL,   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Tagging.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup tagging processes and parameters â€” Setup_Mod_Tagging","text":"input_list List containing data list, parameter list, map list UseTagging Numeric (0 1) indicating whether use tagging data (1) (0) tag_release_indicator Matrix [n_tag_cohorts x 2], columns release region release year max_tag_liberty Maximum number years track tagged cohort Tagged_Fish Array [n_tag_cohorts x n_ages x n_sexes] describing tagged fish releases Obs_Tag_Recap Array [max_tag_liberty x n_tag_cohorts x n_regions x n_ages x n_sexes] observed tag recaptures Tag_LikeType Character string specifying tag likelihood type. One : \"Poisson\" \"NegBin\" \"Multinomial_Release\" \"Multinomial_Recapture\" \"Dirichlet-Multinomial_Release\" \"Dirichlet-Multinomial_Recapture\" Example: Tag_LikeType = \"NegBin\" mixing_period Numeric indicating minimum years post-release include fitting t_tagging Fractional year tagging occurs (e.g., 0.5 mid-year) tag_selex Character string specifying tag recovery selectivity. One : \"Uniform_DomFleet\" \"SexAgg_DomFleet\" \"SexSp_DomFleet\" \"Uniform_AllFleet\" \"SexAgg_AllFleet\" \"SexSp_AllFleet\" Example: tag_selex = \"SexSp_AllFleet\" tag_natmort Character string specifying tag natural mortality parameterization. One : \"AgeAgg_SexAgg\" \"AgeSp_SexAgg\" \"AgeAgg_SexSp\" \"AgeSp_SexSp\" Example: tag_natmort = \"AgeSp_SexSp\" Use_TagRep_Prior Numeric (0 1) whether use tag reporting rate prior TagRep_Prior Data frame containing prior specifications tag reporting parameters. Must include columns: region (region index), block (time block index), mu (Numeric mean tag reporting prior (normal space); NA symmetric beta used), sd (Numeric standard deviation tag reporting prior (normal space)), type (0 == symmetric beta, 1 == regular beta). row specifies beta prior one tag reporting parameter. parameters rows data frame priors applied. move_age_tag_pool List character specifying pooling tagging data age groups. Examples: list(1:5, 6:11, 12:20) pools age groups together \"\" pools ages together (internally converted list(1:n_ages)) .list(1:n_ages) fits sex separately move_sex_tag_pool List character specifying pooling tagging data sex groups. Examples: list(1:2) pools sexes together \"\" pools sexes together (internally converted list(1:n_sexes)) list(1, 2) fits sex separately Init_Tag_Mort_spec Character string \"fix\" \"est\" specifying initial tag mortality fixed estimated Tag_Shed_spec Character string \"fix\" \"est\" specifying chronic tag shedding fixed estimated TagRep_spec Character string specifying tag reporting rate estimation scheme: \"est_all\" estimates rates blocks regions independently \"est_shared_r\" estimates rates shared across regions varying block \"fix\" fixes reporting rates (estimation) Tag_Reporting_blocks Character vector specifying blocks years regions tag reporting rates. Format examples: \"Block_1_Year_1-15_Region_1\" \"Block_2_Year_16-terminal_Region_2\" \"none_Region_3\" (means block, constant region) ... Additional starting values tagging parameters ln_Init_Tag_Mort, ln_Tag_Shed, ln_tag_theta, Tag_Reporting_Pars","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Weighting.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up SPoRC model weighting â€” Setup_Mod_Weighting","title":"Set up SPoRC model weighting â€” Setup_Mod_Weighting","text":"Set SPoRC model weighting","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Weighting.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up SPoRC model weighting â€” Setup_Mod_Weighting","text":"","code":"Setup_Mod_Weighting(   input_list,   Wt_Catch = 1,   Wt_FishIdx = 1,   Wt_SrvIdx = 1,   Wt_Rec = 1,   Wt_F = 1,   Wt_Tagging = 1,   Wt_FishAgeComps,   Wt_SrvAgeComps,   Wt_FishLenComps,   Wt_SrvLenComps )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Mod_Weighting.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up SPoRC model weighting â€” Setup_Mod_Weighting","text":"input_list List containing data, parameter, map lists. Wt_Catch Either numeric scalar (lambda) applied overall catch dataset array lambdas (.e., weights can change year fleet) dimensioned n_regions, n_years, n_fish_fleets. Wt_FishIdx Either numeric scalar (lambda) applied overall fishery index dataset  array lambdas (.e., weights can change year fleet) dimensioned n_regions, n_years, n_fish_fleets. Wt_SrvIdx Either numeric scalar (lambda) applied overall survey index dataset array lambdas (.e., weights can change year fleet) dimensioned n_regions, n_years, n_srv_fleets. Wt_Rec Numeric weight (lambda) applied recruitment penalty. Wt_F Numeric weight (lambda) applied fishing mortality penalty. Wt_Tagging Numeric weight (lambda) applied tagging data. Wt_FishAgeComps Numeric weight (lambda) applied fishery age composition data. Wt_SrvAgeComps Numeric weight (lambda) applied survey age composition data. Wt_FishLenComps Numeric weight (lambda) applied fishery length composition data. Wt_SrvLenComps Numeric weight (lambda) applied survey length composition data.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Biologicals.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up simulation containers and inputs for biological parameters â€” Setup_Sim_Biologicals","title":"Set up simulation containers and inputs for biological parameters â€” Setup_Sim_Biologicals","text":"Set simulation containers inputs biological parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Biologicals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up simulation containers and inputs for biological parameters â€” Setup_Sim_Biologicals","text":"","code":"Setup_Sim_Biologicals(   natmort_input,   WAA_input,   WAA_fish_input,   WAA_srv_input,   MatAA_input,   AgeingError_input = NULL,   SizeAgeTrans_input = NULL,   sim_list )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Biologicals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up simulation containers and inputs for biological parameters â€” Setup_Sim_Biologicals","text":"natmort_input Natural mortality array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_sims] WAA_input Spawning weight--age array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_sims] WAA_fish_input Fishery weight--age array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_sims] WAA_srv_input Survey weight--age array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_sims] MatAA_input Maturity--age array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_sims] AgeingError_input Ageing error matrix [n_regions Ã— n_model_ages Ã— n_obs_ages Ã— n_sims] SizeAgeTrans_input Size-age transition matrix [n_regions Ã— n_yrs Ã— n_lens Ã— n_ages Ã— n_sexes x n_sims] sim_list Simulation list object `Setup_Sim_Dim()`","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Containers.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup containers for simulation and output â€” Setup_Sim_Containers","title":"Setup containers for simulation and output â€” Setup_Sim_Containers","text":"Setup containers simulation output","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Containers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup containers for simulation and output â€” Setup_Sim_Containers","text":"","code":"Setup_Sim_Containers(sim_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Containers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup containers for simulation and output â€” Setup_Sim_Containers","text":"sim_list List `Setup_Sim_Dim()` containing core simulation dimensions (`n_regions`, `n_yrs`, `n_ages`, `n_sexes`, `n_sims`, `n_fish_fleets`, `n_srv_fleets`, `n_obs_ages`, `n_lens`). function appends container arrays biological, fishery, survey quantities.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Dim.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Simulation Dimension Settings â€” Setup_Sim_Dim","title":"Initialize Simulation Dimension Settings â€” Setup_Sim_Dim","text":"Creates returns list key dimension values used set simulation management strategy evaluation (MSE). list provides structural information number simulations, years, regions, ages, fleets, whether include feedback loop.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Dim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Simulation Dimension Settings â€” Setup_Sim_Dim","text":"","code":"Setup_Sim_Dim(   n_sims,   n_yrs,   n_regions,   n_ages,   n_lens,   n_obs_ages = n_ages,   n_sexes,   n_fish_fleets,   n_srv_fleets,   run_feedback = FALSE,   feedback_start_yr = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Dim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Simulation Dimension Settings â€” Setup_Sim_Dim","text":"n_sims Integer. Number simulation replicates. n_yrs Integer. Number years simulation. n_regions Integer. Number modeled regions. n_ages Integer. Number modeled age classes. n_lens Integer. Number modeled length bins. n_obs_ages Integer. Number observed age classes (can differ n_ages, default = n_ages). n_sexes Integer. Number sexes. n_fish_fleets Integer. Number fishery fleets. n_srv_fleets Integer. Number survey fleets. run_feedback Logical. Whether include feedback management loop (default = FALSE). feedback_start_yr Integer. First year feedback applied (used run_feedback = TRUE).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Dim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Simulation Dimension Settings â€” Setup_Sim_Dim","text":"list containing specified dimension values, elements: n_sims, n_yrs, n_regions, n_ages, n_lens,   n_obs_ages, n_sexes, n_fish_fleets, n_srv_fleets init_iter (set internally n_ages * 10) feedback_start_yr, run_feedback","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishMort.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup values and dimensions of fishing mortality â€” Setup_Sim_FishMort","title":"Setup values and dimensions of fishing mortality â€” Setup_Sim_FishMort","text":"Setup values dimensions fishing mortality","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishMort.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup values and dimensions of fishing mortality â€” Setup_Sim_FishMort","text":"","code":"Setup_Sim_FishMort(   sim_list,   sigmaC,   init_F_vals,   Fmort_pattern,   Fmort_start,   Fmort_fct,   proc_error,   proc_error_sd )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishMort.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup values and dimensions of fishing mortality â€” Setup_Sim_FishMort","text":"sim_list Simulation list objects sigmaC Observation error catch init_F_vals Initial F values dimensioend region fleet Fmort_pattern Fishing mortality pattern matrix dimensioned region fleet (constant, linear, one-way, two-way) Fmort_start Fishing mortality start values matrix dimensioned region fleet Fmort_fct Fishing mortality values factor increases decreases matrix dimensioned region fleet proc_error want add process error fishing mortality proc_error_sd value logrnomal sd process error fishing mortality","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishSel.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup fishery selectivity â€” Setup_Sim_FishSel","title":"Setup fishery selectivity â€” Setup_Sim_FishSel","text":"Setup fishery selectivity","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishSel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup fishery selectivity â€” Setup_Sim_FishSel","text":"","code":"Setup_Sim_FishSel(sim_list, sel_model, fixed_fish_sel_pars)"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_FishSel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup fishery selectivity â€” Setup_Sim_FishSel","text":"sim_list Simulation list sel_model Fishery selectivity model dimensioned region fleet. Options include: logistic fixed_fish_sel_pars Fixed parameters fishery selectivity, dimensioned region, sex, fishery fleet, max number parameters needed defined fishery selectivity functional form defined functional forms fishery","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Fishing.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup values and dimensions of fishing processes â€” Setup_Sim_Fishing","title":"Setup values and dimensions of fishing processes â€” Setup_Sim_Fishing","text":"Setup values dimensions fishing processes","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Fishing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup values and dimensions of fishing processes â€” Setup_Sim_Fishing","text":"","code":"Setup_Sim_Fishing(   sim_list,   ln_sigmaC = array(log(0.02), dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_fish_fleets)),   init_F_val = 0,   Fmort_input = array(0.1, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_fish_fleets, sim_list$n_sims)),   fish_sel_input,   fish_q_input = array(1, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_fish_fleets, sim_list$n_sims)),   ObsFishIdx_SE = array(0.2, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_fish_fleets)),   fish_idx_type = rep(1, sim_list$n_fish_fleets),   comp_fishage_like = rep(0, sim_list$n_fish_fleets),   ISS_FishAgeComps = array(100, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_sexes, sim_list$n_fish_fleets, sim_list$n_sims)),   ln_FishAge_theta = array(log(1), dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_fish_fleets)),   ln_FishAge_theta_agg = rep(log(1), sim_list$n_fish_fleets),   FishAge_corr_pars_agg = rep(0.01, sim_list$n_fish_fleets),   FishAge_corr_pars = array(0.01, dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_fish_fleets, 2)),   FishAgeComps_Type = array(2, dim = c(sim_list$n_yrs, sim_list$n_fish_fleets)),   comp_fishlen_like = rep(0, sim_list$n_fish_fleets),   ISS_FishLenComps = array(100, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_sexes, sim_list$n_fish_fleets, sim_list$n_sims)),   ln_FishLen_theta = array(log(1), dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_fish_fleets)),   ln_FishLen_theta_agg = rep(log(1), sim_list$n_fish_fleets),   FishLen_corr_pars_agg = rep(0.01, sim_list$n_fish_fleets),   FishLen_corr_pars = array(0.01, dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_fish_fleets, 2)),   FishLenComps_Type = array(2, dim = c(sim_list$n_yrs, sim_list$n_fish_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Fishing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup values and dimensions of fishing processes â€” Setup_Sim_Fishing","text":"sim_list Simulation list object `Setup_Sim_Dim()` ln_sigmaC Observation error catch [n_regions Ã— n_yrs Ã— n_fish_fleets] (default: `log(0.02)`) init_F_val Initial fishing mortality value (default: `0`) Fmort_input Fishing mortality input array [n_regions Ã— n_yrs Ã— n_fish_fleets Ã— n_sims] (default: `0.1`) fish_sel_input Fishery selectivity array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_fish_fleets Ã— n_sims] (default, must provided) fish_q_input Fishery catchability array [n_regions Ã— n_yrs Ã— n_fish_fleets Ã— n_sims] (default: `1`) ObsFishIdx_SE Observation error fishery index [n_regions Ã— n_yrs Ã— n_fish_fleets] (default: `0.2`) fish_idx_type Vector index types [n_fish_fleets] (default: `1` = biomass index) 0: Abundance index 1: Biomass index comp_fishage_like Vector [n_fish_fleets] specifying likelihood simulating age comps (default: `0` = multinomial) 0: Multinomial 1: Dirichlet-Multinomial 2: Logistic Normal iid 3: Logistic Normal 1dar1 4: Logistic Normal 2d correlation (constant sex, 1dar1 age) ISS_FishAgeComps Input sample sizes [n_regions Ã— n_yrs Ã— n_sexes Ã— n_fish_fleets Ã— n_sims] (default: `100`) ln_FishAge_theta Overdispersion parameters [n_regions Ã— n_sexes Ã— n_fish_fleets] (default: `log(1)`) ln_FishAge_theta_agg Overdispersion parameters aggregated comps [n_fish_fleets] (default: `log(1)`) FishAge_corr_pars_agg Correlation parameters (agg.) options 3â€“4 [n_fish_fleets] (default: `0.01`) FishAge_corr_pars Correlation parameters [n_regions Ã— n_sexes Ã— n_fish_fleets x 2] (default: `0.01`) FishAgeComps_Type Array [n_yrs Ã— n_fish_fleets] (default: `2` = joint sex, split region) 0: Aggregated 1: Split sex region 2: Joint sex, split region 999: simulated comp_fishlen_like Vector [n_fish_fleets] specifying likelihood simulating length comps (default: `0` = multinomial) 0: Multinomial 1: Dirichlet-Multinomial 2: Logistic Normal iid 3: Logistic Normal 1dar1 4: Logistic Normal 2d correlation (constant sex, 1dar1 length) ISS_FishLenComps Input sample sizes [n_regions Ã— n_yrs Ã— n_sexes Ã— n_fish_fleets Ã— n_sims] (default: `100`) ln_FishLen_theta Overdispersion parameters [n_regions Ã— n_sexes Ã— n_fish_fleets x 2] (default: `log(1)`) ln_FishLen_theta_agg Overdispersion parameters aggregated comps [n_fish_fleets] (default: `log(1)`) FishLen_corr_pars_agg Correlation parameters (agg.) options 3â€“4 [n_fish_fleets] (default: `0.01`) FishLen_corr_pars Correlation parameters [n_regions Ã— n_sexes Ã— n_fish_fleets] (default: `0.01`) FishLenComps_Type Array [n_yrs Ã— n_fish_fleets] (default: `2` = joint sex, split region) 0: Aggregated 1: Split sex region 2: Joint sex, split region 999: simulated","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Observation_Proc.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up simulation observation processes â€” Setup_Sim_Observation_Proc","title":"Set up simulation observation processes â€” Setup_Sim_Observation_Proc","text":"Set simulation observation processes","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Observation_Proc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up simulation observation processes â€” Setup_Sim_Observation_Proc","text":"","code":"Setup_Sim_Observation_Proc(   Comp_Structure,   Comp_Srv_Like,   base_ISS_SrvAge,   Srv_Like_Pars,   Comp_Fish_Like,   base_ISS_FishAge,   ISS_FishAge_Pattern,   Tag_Like,   Tag_Like_Pars,   SrvAgeTheta,   FishAgeTheta,   sim_list )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Observation_Proc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up simulation observation processes â€” Setup_Sim_Observation_Proc","text":"Comp_Structure Composition Structure (spltR_spltS, spltR_jntS) Comp_Srv_Like Survey Composition Likelihoods (Multinomial, Dirichlet-Multinomial, iid-Logistic-Normal) base_ISS_SrvAge Input sample size survey ages Srv_Like_Pars Parameters Survey Composition Likelihoods Comp_Fish_Like Fishery Composition Likelihoods (Multinomial, Dirichlet-Multinomial, iid-Logistic-Normal) base_ISS_FishAge Base Input sample size fishery ages ISS_FishAge_Pattern Input sample size pattern fishery ages. Either \"constant\" follows f pattern (\"F_pattern\") Tag_Like Tag Likelihoods (Poisson, NegBin, Multinomial_Release, Multinomial_Recapture) Tag_Like_Pars Tag Likelihood Parameters SrvAgeTheta Survey Age Composition Overdispersion Parameter FishAgeTheta Fishery Age Composition Overdispersion Parameter sim_list Simulation list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Rec.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up recruitment dynamics for simulation â€” Setup_Sim_Rec","title":"Set up recruitment dynamics for simulation â€” Setup_Sim_Rec","text":"Set recruitment dynamics simulation","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Rec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up recruitment dynamics for simulation â€” Setup_Sim_Rec","text":"","code":"Setup_Sim_Rec(   do_recruits_move = 0,   sexratio_input = array(if (sim_list$n_sexes == 1) 1 else 0.5, dim =     c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_sexes, sim_list$n_sims)),   R0_input = array(10, dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_sims)),   h_input = array(0.8, dim = c(sim_list$n_regions, sim_list$n_yrs, sim_list$n_sims)),   ln_sigmaR = log(c(1, 1)),   recruitment_opt = \"bh_rec\",   rec_dd = \"global\",   init_dd = \"global\",   sim_list,   init_age_strc = 2,   t_spawn = 0,   rec_lag = 1,   Rec_input = NULL,   ln_InitDevs_input = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Rec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up recruitment dynamics for simulation â€” Setup_Sim_Rec","text":"do_recruits_move Indicator whether recruits move (default = 0): 0: movement 1: Move sexratio_input Sex ratio array [n_regions Ã— n_yrs Ã— n_sexes Ã— n_sims] (default = 1 one sex, else 0.5 sex) R0_input Unfished recruitment (R0) array [n_regions Ã— n_yrs Ã— n_sims] (default = 10) h_input Steepness array [n_regions Ã— n_yrs Ã— n_sims] (default = 0.8) ln_sigmaR Logarithmic standard deviation recruitment [2]: 1st = sigma initial devs, 2nd = sigma latter devs (default = log(c(1, 1))) recruitment_opt Recruitment type (default = \"bh_rec\"): \"mean_rec\": Mean recruitment \"bh_rec\": Beverton-Holt recruitment \"resample_from_input\": Resampling recruitment years `Rec_input` preserves covariance recruitment among regions spatially-explicit values provided rec_dd Recruitment density dependence (default = \"global\"): \"global\": Shared across regions \"local\": Region-specific init_dd Initial age density dependence (default = \"global\"): \"global\": Shared across regions \"local\": Region-specific sim_list Simulation list object `Setup_Sim_Dim()` init_age_strc Integer flag specifying initialization initial age structure: 0: Initialize iteration. 1: Initialize using scalar geometric series (account movement). 2: Initialize using matrix geometric series (accounts movement; default). t_spawn Spawn timing fraction year (scalar, default = 0) rec_lag Recruitment lag (default = 1) Rec_input Recruitment array [n_regions Ã— n_yrs Ã— n_sims] (default = NULL) ln_InitDevs_input Initial deviations [n_regions Ã— (n_ages-1) Ã— n_sims] (default = NULL)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Survey.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup values for survey parameterization â€” Setup_Sim_Survey","title":"Setup values for survey parameterization â€” Setup_Sim_Survey","text":"Setup values survey parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Survey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup values for survey parameterization â€” Setup_Sim_Survey","text":"","code":"Setup_Sim_Survey(   ObsSrvIdx_SE = array(0.2, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_srv_fleets)),   sim_list,   srv_sel_input,   srv_q_input = array(1, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_srv_fleets, sim_list$n_sims)),   t_srv = array(0, dim = c(sim_list$n_regions, sim_list$n_srv_fleets)),   srv_idx_type = rep(1, sim_list$n_srv_fleets),   comp_srvage_like = rep(0, sim_list$n_srv_fleets),   ISS_SrvAgeComps = array(100, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_sexes, sim_list$n_srv_fleets, sim_list$n_sims)),   ln_SrvAge_theta = array(log(1), dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_srv_fleets)),   ln_SrvAge_theta_agg = rep(log(1), sim_list$n_srv_fleets),   SrvAge_corr_pars_agg = rep(0.01, sim_list$n_srv_fleets),   SrvAge_corr_pars = array(0.01, dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_srv_fleets, 2)),   SrvAgeComps_Type = array(2, dim = c(sim_list$n_yrs, sim_list$n_srv_fleets)),   comp_srvlen_like = rep(0, sim_list$n_srv_fleets),   ISS_SrvLenComps = array(100, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_sexes, sim_list$n_srv_fleets, sim_list$n_sims)),   ln_SrvLen_theta = array(log(1), dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_srv_fleets)),   ln_SrvLen_theta_agg = rep(log(1), sim_list$n_srv_fleets),   SrvLen_corr_pars_agg = rep(0.01, sim_list$n_srv_fleets),   SrvLen_corr_pars = array(0.01, dim = c(sim_list$n_regions, sim_list$n_sexes,     sim_list$n_srv_fleets, 2)),   SrvLenComps_Type = array(2, dim = c(sim_list$n_yrs, sim_list$n_srv_fleets)) )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Survey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup values for survey parameterization â€” Setup_Sim_Survey","text":"ObsSrvIdx_SE Survey index observation error [n_regions Ã— n_yrs Ã— n_srv_fleets] (default: `0.2`) sim_list Simulation list object `Setup_Sim_Dim()` srv_sel_input Survey selectivity array [n_regions Ã— n_yrs Ã— n_ages Ã— n_sexes Ã— n_srv_fleets Ã— n_sims] (default, must provided) srv_q_input Survey catchability array [n_regions Ã— n_yrs Ã— n_srv_fleets Ã— n_sims] (default: `1`) t_srv Survey timing fraction [n_regions Ã— n_srv_fleets] (default: `0`) srv_idx_type Vector index types [n_srv_fleets] (default: `1` = biomass index) 0: Abundance index 1: Biomass index comp_srvage_like Vector [n_srv_fleets] specifying likelihood simulating age comps (default: `0` = multinomial) 0: Multinomial 1: Dirichlet-Multinomial 2: Logistic Normal iid 3: Logistic Normal 1dar1 4: Logistic Normal 2d correlation (constant sex, 1dar1 age) ISS_SrvAgeComps Input sample sizes [n_regions Ã— n_yrs Ã— n_sexes Ã— n_srv_fleets Ã— n_sims] (default: `100`) ln_SrvAge_theta Overdispersion parameters [n_regions Ã— n_sexes Ã— n_srv_fleets] (default: `log(1)`) ln_SrvAge_theta_agg Overdispersion parameters aggregated comps [n_srv_fleets] (default: `log(1)`) SrvAge_corr_pars_agg Correlation parameters (agg.) options 3â€“4 [n_srv_fleets] (default: `0.01`) SrvAge_corr_pars Correlation parameters [n_regions Ã— n_sexes Ã— n_srv_fleets x 2] (default: `0.01`) SrvAgeComps_Type Array [n_yrs Ã— n_srv_fleets] (default: `2` = joint sex, split region) 0: Aggregated 1: Split sex region 2: Joint sex, split region 999: simulated comp_srvlen_like Vector [n_srv_fleets] specifying likelihood simulating length comps (default: `0` = multinomial) 0: Multinomial 1: Dirichlet-Multinomial 2: Logistic Normal iid 3: Logistic Normal 1dar1 4: Logistic Normal 2d correlation (constant sex, 1dar1 length) ISS_SrvLenComps Input sample sizes [n_regions Ã— n_yrs Ã— n_sexes Ã— n_srv_fleets Ã— n_sims] (default: `100`) ln_SrvLen_theta Overdispersion parameters [n_regions Ã— n_sexes Ã— n_srv_fleets] (default: `log(1)`) ln_SrvLen_theta_agg Overdispersion parameters aggregated comps [n_srv_fleets] (default: `log(1)`) SrvLen_corr_pars_agg Correlation parameters (agg.) options 3â€“4 [n_srv_fleets] (default: `0.01`) SrvLen_corr_pars Correlation parameters [n_regions Ã— n_sexes Ã— n_srv_fleets x 2] (default: `0.01`) SrvLenComps_Type Array [n_yrs Ã— n_srv_fleets] (default: `2` = joint sex, split region) 0: Aggregated 1: Split sex region 2: Joint sex, split region 999: simulated","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Tagging.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up simulated tagging dynamics â€” Setup_Sim_Tagging","title":"Set up simulated tagging dynamics â€” Setup_Sim_Tagging","text":"Set simulated tagging dynamics","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Tagging.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up simulated tagging dynamics â€” Setup_Sim_Tagging","text":"","code":"Setup_Sim_Tagging(   n_tags = NULL,   n_tags_rel_input = NULL,   UseTagging = 0,   max_liberty = sim_list$n_ages/2,   tag_release_indicator = expand.grid(regions = 1:sim_list$n_regions, tag_years =     1:sim_list$n_yrs),   t_tagging = 0,   ln_Init_Tag_Mort = log(1e-05),   ln_Tag_Shed = log(1e-05),   Tag_Reporting_input = array(0.5, dim = c(sim_list$n_regions, sim_list$n_yrs,     sim_list$n_sims)),   tag_selex = 5,   tag_natmort = 3,   tag_like = 0,   ln_tag_theta = log(1),   sim_list )"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_Sim_Tagging.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up simulated tagging dynamics â€” Setup_Sim_Tagging","text":"n_tags Number tags release given year (scalar, default = NULL) n_tags_rel_input Number tag releases tag cohort length (default = NULL) UseTagging Boolean use tagging (default = 0): 0: simulate tagging 1: Simulate tagging max_liberty Maximum liberty track cohorts (default = sim_list$n_ages / 2) tag_release_indicator Tag release indicator [regions Ã— tag_years] (default = combinations regions Ã— years via `expand.grid`) t_tagging Time tagging (e.g., start year == 0, mid year == 0.5; default = 0) ln_Init_Tag_Mort Log initial tag-induced mortality (default = log(1e-5)) ln_Tag_Shed Log chronic tag shedding rate (default = log(1e-5)) Tag_Reporting_input Tag reporting input [n_regions Ã— n_yrs Ã— n_sims] (default = 0.5) tag_selex Tag selectivity type (integer, default = 5): 0: Uniform_DomFleet 1: SexAgg_DomFleet 2: SexSp_DomFleet 3: Uniform_AllFleet 4: SexAgg_AllFleet 5: SexSp_AllFleet tag_natmort Tag natural mortality type (integer, default = 3): 0: AgeAgg_SexAgg 1: AgeSp_SexAgg 2: AgeAgg_SexSp 3: AgeSp_SexSp tag_like Tag likelihood type (integer, default = 0): 0: Poisson 1: NegBin 2: Multinomial_Release 3: Multinomial_Recapture 4: Dirichlet-Multinomial_Release 5: Dirichlet-Multinomial_Recapture ln_tag_theta Scalar log space describing tag likelihood overdispersion (default = log(1)) sim_list Simulation list (required)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_sim_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","title":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","text":"Constructs simulation objects new simulation environment use simulation functions","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_sim_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","text":"","code":"Setup_sim_env(sim_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_sim_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","text":"sim_list Simulation list objects","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_sim_env.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","text":"new simulation environment objects sim_list","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/Setup_sim_env.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constructs simulation objects in a new simulation environment for use in simulation functions â€” Setup_sim_env","text":"","code":"if (FALSE) { # \\dontrun{ sim_env <- Setup_sim_env(sim_list) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/Simulate_Pop_Static.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulates a static spatial, sex, and age-structured population (no feedback loop) â€” Simulate_Pop_Static","title":"Simulates a static spatial, sex, and age-structured population (no feedback loop) â€” Simulate_Pop_Static","text":"Simulates static spatial, sex, age-structured population (feedback loop)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Simulate_Pop_Static.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulates a static spatial, sex, and age-structured population (no feedback loop) â€” Simulate_Pop_Static","text":"","code":"Simulate_Pop_Static(sim_list, output_path = NULL)"},{"path":"https://chengmatt.github.io/SPoRC/reference/Simulate_Pop_Static.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulates a static spatial, sex, and age-structured population (no feedback loop) â€” Simulate_Pop_Static","text":"sim_list Simulation list objects output_path path output simulation objects","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/Simulate_Pop_Static.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulates a static spatial, sex, and age-structured population (no feedback loop) â€” Simulate_Pop_Static","text":"list object bunch simulated values outputs","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/bisection_F.html","id":null,"dir":"Reference","previous_headings":"","what":"Go from TAC to Fishing Mortality using bisection â€” bisection_F","title":"Go from TAC to Fishing Mortality using bisection â€” bisection_F","text":"Go TAC Fishing Mortality using bisection","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/bisection_F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Go from TAC to Fishing Mortality using bisection â€” bisection_F","text":"","code":"bisection_F(   f_guess,   catch,   NAA,   WAA,   natmort,   fish_sel,   n.iter = 20,   lb = 0,   ub = 2 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/bisection_F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Go from TAC to Fishing Mortality using bisection â€” bisection_F","text":"f_guess Initial guess F catch Provided catch values NAA Numbers, dimensioned ages, sexes WAA Weight, dimensioned ages sexes natmort Natural mortality dimensioned ages sex fish_sel Fishery selectivity, dimesnioned ages sex n.iter Number iterations bisection lb Lower bound F ub Upper bound F","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/bisection_F.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Go from TAC to Fishing Mortality using bisection â€” bisection_F","text":"Fishing mortality values","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/check_data_dimensions.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function used to check data dimensions to ensure they are correct â€” check_data_dimensions","title":"Helper function used to check data dimensions to ensure they are correct â€” check_data_dimensions","text":"Helper function used check data dimensions ensure correct","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/check_data_dimensions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function used to check data dimensions to ensure they are correct â€” check_data_dimensions","text":"","code":"check_data_dimensions(   x,   n_regions = NULL,   n_years = NULL,   n_ages = NULL,   n_lens = NULL,   n_sexes = NULL,   n_fish_fleets = NULL,   n_srv_fleets = NULL,   what )"},{"path":"https://chengmatt.github.io/SPoRC/reference/check_data_dimensions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function used to check data dimensions to ensure they are correct â€” check_data_dimensions","text":"x Object evaluate n_regions Number regions n_years Number years n_ages Number ages n_lens Number lengths n_sexes Number sexes n_fish_fleets Number fishery fleets n_srv_fleets Number survey fleets charcter specifying evaluated","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/check_sim_dimensions.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function used to check simulation object dimensions to ensure they are correct â€” check_sim_dimensions","title":"Helper function used to check simulation object dimensions to ensure they are correct â€” check_sim_dimensions","text":"Helper function used check simulation object dimensions ensure correct","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/check_sim_dimensions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function used to check simulation object dimensions to ensure they are correct â€” check_sim_dimensions","text":"","code":"check_sim_dimensions(   x,   n_regions = NULL,   n_years = NULL,   n_ages = NULL,   n_lens = NULL,   n_sexes = NULL,   n_fish_fleets = NULL,   n_srv_fleets = NULL,   n_sims = NULL,   what )"},{"path":"https://chengmatt.github.io/SPoRC/reference/check_sim_dimensions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function used to check simulation object dimensions to ensure they are correct â€” check_sim_dimensions","text":"x Object evaluate n_regions Number regions n_years Number years n_ages Number ages n_lens Number lengths n_sexes Number sexes n_fish_fleets Number fishery fleets n_srv_fleets Number survey fleets n_sims Number simulations character specifying evaluated","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/cmb.html","id":null,"dir":"Reference","previous_headings":"","what":"For combining a parameter and data list in RTMB so a data object can be explicitly defined â€” cmb","title":"For combining a parameter and data list in RTMB so a data object can be explicitly defined â€” cmb","text":"combining parameter data list RTMB data object can explicitly defined","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/cmb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"For combining a parameter and data list in RTMB so a data object can be explicitly defined â€” cmb","text":"","code":"cmb(f, d)"},{"path":"https://chengmatt.github.io/SPoRC/reference/cmb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"For combining a parameter and data list in RTMB so a data object can be explicitly defined â€” cmb","text":"f Parameter list d Data list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/cmb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"For combining a parameter and data list in RTMB so a data object can be explicitly defined â€” cmb","text":"","code":"if (FALSE) { # \\dontrun{   obj <- RTMB::MakeADFun(cmb(sabie_RTMB, data), parameters = parameters, map = mapping, random = random, silent = TRUE) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/collect_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to collect messages â€” collect_message","title":"Helper function to collect messages â€” collect_message","text":"Helper function collect messages","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/collect_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to collect messages â€” collect_message","text":"","code":"collect_message(...)"},{"path":"https://chengmatt.github.io/SPoRC/reference/collect_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to collect messages â€” collect_message","text":"... character vector messages","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/condition_closed_loop_simulations.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up simulation list for closed-loop projections â€” condition_closed_loop_simulations","title":"Set up simulation list for closed-loop projections â€” condition_closed_loop_simulations","text":"function creates initializes simulation list closed-loop projections population dynamics. components simulation list must match expected names used internally setup functions. Users can provide **custom definitions** component passing `...` using correct name (e.g., `WAA_input`, `fish_sel_input`).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/condition_closed_loop_simulations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up simulation list for closed-loop projections â€” condition_closed_loop_simulations","text":"","code":"condition_closed_loop_simulations(   closed_loop_yrs,   n_sims,   data,   parameters,   mapping,   sd_rep,   rep,   random = random,   FishIdx_SE_fill = \"mean\",   SrvIdx_SE_fill = \"mean\",   ISS_FishAgeComps_fill = \"mean\",   ISS_FishLenComps_fill = \"mean\",   ISS_SrvAgeComps_fill = \"mean\",   ISS_SrvLenComps_fill = \"mean\",   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/condition_closed_loop_simulations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up simulation list for closed-loop projections â€” condition_closed_loop_simulations","text":"closed_loop_yrs Integer. Number years project closed loop. n_sims Integer. Number simulation replicates. data List. Observed data configuration population. parameters List. Parameter values model. mapping List. Mapping parameters optimization. sd_rep List. Standard deviation reports fitted model. rep List. Report fitted model. random Character vector random effects estimated FishIdx_SE_fill Character numeric. Fill method fishery index standard errors extending simulation years. Options : - `\"zeros\"`: fill zeros - `\"last\"`: repeat last non-NA slice - `\"mean\"`: fill mean observed series - Numeric: constant scalar array value SrvIdx_SE_fill Character numeric. Fill method survey index standard errors. options `FishIdx_SE_fill`. ISS_FishAgeComps_fill Character numeric. Fill method fishery age composition input sample sizes. Options : - `\"zeros\"`, `\"last\"`, `\"mean\"` () - `\"F_pattern\"`: fill based fishing mortality pattern closed-loop simulation - Numeric: constant scalar array value ISS_FishLenComps_fill Character numeric. Fill method fishery length composition input sample sizes. options `ISS_FishAgeComps_fill`. ISS_SrvAgeComps_fill Character numeric. Fill method survey age composition input sample sizes. Options `\"zeros\"`, `\"last\"`, `\"mean\"`, numeric constant. ISS_SrvLenComps_fill Character numeric. Fill method survey length composition input sample sizes. options `ISS_SrvAgeComps_fill`. ... Optional named arguments custom inputs.   name must correspond component expected simulation setup functions, dimensioned appropriately:   `Setup_Sim_Fishing()`, `Setup_Sim_Survey()`, `Setup_Sim_Biologicals()`,   `Setup_Sim_Rec()`, `Setup_Sim_Tagging()`. Examples include: - **Fishing**: `fish_sel_input`, `ln_sigmaC`, `Fmort_input`, `fish_q_input`, etc.   - **Survey**: `srv_sel_input`, `srv_q_input`, `ObsSrvIdx_SE`, etc.   - **Biologicals**: `WAA_input`, `MatAA_input`, `natmort_input`, `AgeingError_input`, `SizeAgeTrans_input`   - **Recruitment inputs**:       - `R0_input`, `h_input`, `sexratio_input`, `ln_InitDevs_input`, `Rec_input`       - `Rec_input`:           - shorter number projection years, new recruitment deviates simulated             based `recruitment_opt`, `R0_input`, `h_input` (supports changing regimes across years).           - want fixed recruitment projection years, provide `Rec_input` array spans years.   - **Tagging**: `Tag_Reporting_input`, `ln_Init_Tag_Mort`, `ln_Tag_Shed`, `tag_selex`, `tag_natmort`   - **Movement**: `Movement` (must match expected dimensions named exactly `Movement`) values must correct dimensions expected component.   component provided, default behavior extend last year (zeros fishing mortality, can filled subsequently)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/dbeta_symmetric.html","id":null,"dir":"Reference","previous_headings":"","what":"Symmetric Beta Function â€” dbeta_symmetric","title":"Symmetric Beta Function â€” dbeta_symmetric","text":"Symmetric Beta Function","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dbeta_symmetric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Symmetric Beta Function â€” dbeta_symmetric","text":"","code":"dbeta_symmetric(p_val, p_ub, p_lb, p_prsd, log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/dbeta_symmetric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Symmetric Beta Function â€” dbeta_symmetric","text":"p_val Parameter value p_ub Upper Bound Parameter p_lb Lower Bound Parameter p_prsd SD parameter, higher values stronger penalty bounds, lower values difuse penalty bounds log whether return log likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dbeta_symmetric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Symmetric Beta Function â€” dbeta_symmetric","text":"Returns likelihood values symmetric beta distribution","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirichlet.html","id":null,"dir":"Reference","previous_headings":"","what":"Dirichlet Likelihood â€” ddirichlet","title":"Dirichlet Likelihood â€” ddirichlet","text":"Dirichlet Likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirichlet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dirichlet Likelihood â€” ddirichlet","text":"","code":"ddirichlet(x, alpha, log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirichlet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dirichlet Likelihood â€” ddirichlet","text":"x vector values alpha Expected values w/ concentration sum(alpha) log Whether give log ","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirichlet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dirichlet Likelihood â€” ddirichlet","text":"Returns likelihood values Dirichlet distribution","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirmult.html","id":null,"dir":"Reference","previous_headings":"","what":"Dirichlet Multinomial Likelihood â€” ddirmult","title":"Dirichlet Multinomial Likelihood â€” ddirmult","text":"https://github.com/James-Thorson/CCSRA/blob/main/inst/executables/CCSRA_v9.cpp","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirmult.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dirichlet Multinomial Likelihood â€” ddirmult","text":"","code":"ddirmult(obs, pred, Ntotal, ln_theta, give_log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirmult.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dirichlet Multinomial Likelihood â€” ddirmult","text":"obs Vector observed values proportions pred Vector predicted values proportions Ntotal Input sample size scalar ln_theta Weighting parameter log space give_log Whether likelihood log space","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/ddirmult.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dirichlet Multinomial Likelihood â€” ddirmult","text":"returns likelihood values dirihclet multinomial","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dlogistnormal.html","id":null,"dir":"Reference","previous_headings":"","what":"Logistic Normal Likelihood â€” dlogistnormal","title":"Logistic Normal Likelihood â€” dlogistnormal","text":"Logistic Normal Likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dlogistnormal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logistic Normal Likelihood â€” dlogistnormal","text":"","code":"dlogistnormal(obs, pred, Sigma, give_log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/dlogistnormal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logistic Normal Likelihood â€” dlogistnormal","text":"obs Vector observed values numbers (can integers non-integers - vector length n_bins) pred Vector predicted values proportions (vector length n_bins) Sigma Covariance matrix give_log whether use log space likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dlogistnormal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logistic Normal Likelihood â€” dlogistnormal","text":"Returns likelihood values logistic normal","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dnbinom_robust_noint.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative Binomial Likelihood â€” dnbinom_robust_noint","title":"Negative Binomial Likelihood â€” dnbinom_robust_noint","text":"Approximates negative binomial non-integer values provided","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dnbinom_robust_noint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative Binomial Likelihood â€” dnbinom_robust_noint","text":"","code":"dnbinom_robust_noint(x, log_mu, log_var_minus_mu, give_log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/dnbinom_robust_noint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative Binomial Likelihood â€” dnbinom_robust_noint","text":"x observations log_mu log mu log_var_minus_mu log var minus mu - reparameterize negbin give_log whether give log","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dnbinom_robust_noint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative Binomial Likelihood â€” dnbinom_robust_noint","text":"Returns likelihood values robust negative binomial","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_corr_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery age overdispersion correlation parameters â€” do_FishAge_corr_pars_mapping","title":"Helper function to set up fishery age overdispersion correlation parameters â€” do_FishAge_corr_pars_mapping","text":"Helper function set fishery age overdispersion correlation parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_corr_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery age overdispersion correlation parameters â€” do_FishAge_corr_pars_mapping","text":"","code":"do_FishAge_corr_pars_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_corr_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery age overdispersion correlation parameters â€” do_FishAge_corr_pars_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_theta_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery age overdispersion parameters â€” do_FishAge_theta_mapping","title":"Helper function to set up fishery age overdispersion parameters â€” do_FishAge_theta_mapping","text":"Helper function set fishery age overdispersion parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_theta_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery age overdispersion parameters â€” do_FishAge_theta_mapping","text":"","code":"do_FishAge_theta_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishAge_theta_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery age overdispersion parameters â€” do_FishAge_theta_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_corr_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery length overdispersion correlation parameters â€” do_FishLen_corr_pars_mapping","title":"Helper function to set up fishery length overdispersion correlation parameters â€” do_FishLen_corr_pars_mapping","text":"Helper function set fishery length overdispersion correlation parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_corr_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery length overdispersion correlation parameters â€” do_FishLen_corr_pars_mapping","text":"","code":"do_FishLen_corr_pars_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_corr_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery length overdispersion correlation parameters â€” do_FishLen_corr_pars_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_theta_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery length overdispersion parameters â€” do_FishLen_theta_mapping","title":"Helper function to set up fishery length overdispersion parameters â€” do_FishLen_theta_mapping","text":"Helper function set fishery length overdispersion parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_theta_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery length overdispersion parameters â€” do_FishLen_theta_mapping","text":"","code":"do_FishLen_theta_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_FishLen_theta_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery length overdispersion parameters â€” do_FishLen_theta_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Fmort_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to setup fmort mapping â€” do_Fmort_mapping","title":"Helper function to setup fmort mapping â€” do_Fmort_mapping","text":"Helper function setup fmort mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Fmort_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to setup fmort mapping â€” do_Fmort_mapping","text":"","code":"do_Fmort_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Fmort_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to setup fmort mapping â€” do_Fmort_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_InitDevs_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to handle mapping for ln_InitDevs â€” do_InitDevs_mapping","title":"Helper function to handle mapping for ln_InitDevs â€” do_InitDevs_mapping","text":"Helper function handle mapping ln_InitDevs","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_InitDevs_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to handle mapping for ln_InitDevs â€” do_InitDevs_mapping","text":"","code":"do_InitDevs_mapping(input_list, InitDevs_spec, rec_dd)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_InitDevs_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to handle mapping for ln_InitDevs â€” do_InitDevs_mapping","text":"input_list Input list InitDevs_spec Character vector specifying InitDevs mapping rec_dd Recruitment density dependence indicator (global vs. local)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Init_Tag_Mort_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to setup initial tag mortality parameters â€” do_Init_Tag_Mort_mapping","title":"Helper function to setup initial tag mortality parameters â€” do_Init_Tag_Mort_mapping","text":"Helper function setup initial tag mortality parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Init_Tag_Mort_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to setup initial tag mortality parameters â€” do_Init_Tag_Mort_mapping","text":"","code":"do_Init_Tag_Mort_mapping(input_list, Init_Tag_Mort_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Init_Tag_Mort_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to setup initial tag mortality parameters â€” do_Init_Tag_Mort_mapping","text":"input_list Input list Init_Tag_Mort_spec Character vector specifying initial tag mortality parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_M_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to map natural mortality blocks â€” do_M_mapping","title":"Helper function to map natural mortality blocks â€” do_M_mapping","text":"function maps natural mortality (ln_M) block structure across region, year, age, sex dimensions. assigns unique integer identifiers block defined user's specifications, stored M_blocks array input list.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_M_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to map natural mortality blocks â€” do_M_mapping","text":"","code":"do_M_mapping(   input_list,   M_spec,   M_regionblk_spec_vals,   M_yearblk_spec_vals,   M_ageblk_spec_vals,   M_sexblk_spec_vals )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_M_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to map natural mortality blocks â€” do_M_mapping","text":"input_list named list object containing model data, parameters, mapping structures. M_spec Character string indicating whether estimate fix natural mortality. Options : \"est_ln_M\": Estimate natural mortality parameters. \"fix\": Fix natural mortality parameters (requires passed input list). M_regionblk_spec_vals list numeric vectors specifying region indices grouped block. M_yearblk_spec_vals list numeric vectors specifying year indices grouped block. M_ageblk_spec_vals list numeric vectors specifying age indices grouped block. M_sexblk_spec_vals list numeric vectors specifying sex indices grouped block.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_M_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to map natural mortality blocks â€” do_M_mapping","text":"updated input_list mapped natural mortality blocks: input_list$map$ln_M factor indicating fixed estimated mortality parameters. input_list$data$M_blocks 4D array (region Ã— year Ã— age Ã— sex) unique block IDs.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_RecDevs_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to handle RecDevs mapping â€” do_RecDevs_mapping","title":"Helper function to handle RecDevs mapping â€” do_RecDevs_mapping","text":"Helper function handle RecDevs mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_RecDevs_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to handle RecDevs mapping â€” do_RecDevs_mapping","text":"","code":"do_RecDevs_mapping(input_list, RecDevs_spec, rec_dd)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_RecDevs_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to handle RecDevs mapping â€” do_RecDevs_mapping","text":"input_list Input list RecDevs_spec Character vector specifying RecDevs mapping rec_dd Recruitment density dependence indicator (global vs. local)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Rec_prop_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to map recruitment proportions â€” do_Rec_prop_mapping","title":"Helper function to map recruitment proportions â€” do_Rec_prop_mapping","text":"Helper function map recruitment proportions","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Rec_prop_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to map recruitment proportions â€” do_Rec_prop_mapping","text":"","code":"do_Rec_prop_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Rec_prop_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to map recruitment proportions â€” do_Rec_prop_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_corr_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey age overdispersion correlation parameters â€” do_SrvAge_corr_pars_mapping","title":"Helper function to set up survey age overdispersion correlation parameters â€” do_SrvAge_corr_pars_mapping","text":"Helper function set survey age overdispersion correlation parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_corr_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey age overdispersion correlation parameters â€” do_SrvAge_corr_pars_mapping","text":"","code":"do_SrvAge_corr_pars_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_corr_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey age overdispersion correlation parameters â€” do_SrvAge_corr_pars_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_theta_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey age overdispersion parameters â€” do_SrvAge_theta_mapping","title":"Helper function to set up survey age overdispersion parameters â€” do_SrvAge_theta_mapping","text":"Helper function set survey age overdispersion parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_theta_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey age overdispersion parameters â€” do_SrvAge_theta_mapping","text":"","code":"do_SrvAge_theta_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvAge_theta_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey age overdispersion parameters â€” do_SrvAge_theta_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_corr_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey length overdispersion correlation parameters â€” do_SrvLen_corr_pars_mapping","title":"Helper function to set up survey length overdispersion correlation parameters â€” do_SrvLen_corr_pars_mapping","text":"Helper function set survey length overdispersion correlation parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_corr_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey length overdispersion correlation parameters â€” do_SrvLen_corr_pars_mapping","text":"","code":"do_SrvLen_corr_pars_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_corr_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey length overdispersion correlation parameters â€” do_SrvLen_corr_pars_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_theta_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey length overdispersion parameters â€” do_SrvLen_theta_mapping","title":"Helper function to set up survey length overdispersion parameters â€” do_SrvLen_theta_mapping","text":"Helper function set survey length overdispersion parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_theta_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey length overdispersion parameters â€” do_SrvLen_theta_mapping","text":"","code":"do_SrvLen_theta_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_SrvLen_theta_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey length overdispersion parameters â€” do_SrvLen_theta_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Reporting_Pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up tag reporting rate parameters â€” do_Tag_Reporting_Pars_mapping","title":"Helper function to set up tag reporting rate parameters â€” do_Tag_Reporting_Pars_mapping","text":"Helper function set tag reporting rate parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Reporting_Pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up tag reporting rate parameters â€” do_Tag_Reporting_Pars_mapping","text":"","code":"do_Tag_Reporting_Pars_mapping(input_list, TagRep_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Reporting_Pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up tag reporting rate parameters â€” do_Tag_Reporting_Pars_mapping","text":"input_list Input list TagRep_spec Charcacter specifying tag reporting parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Shed_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up tag shedding parameters â€” do_Tag_Shed_mapping","title":"Helper function to set up tag shedding parameters â€” do_Tag_Shed_mapping","text":"Helper function set tag shedding parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Shed_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up tag shedding parameters â€” do_Tag_Shed_mapping","text":"","code":"do_Tag_Shed_mapping(input_list, Tag_Shed_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_Tag_Shed_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up tag shedding parameters â€” do_Tag_Shed_mapping","text":"input_list Input list Tag_Shed_spec Character specifying tag shedding parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_cont_vary_move_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up mapping for movement deviations and process error parameters â€” do_cont_vary_move_mapping","title":"Helper function to set up mapping for movement deviations and process error parameters â€” do_cont_vary_move_mapping","text":"Helper function set mapping movement deviations process error parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_cont_vary_move_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up mapping for movement deviations and process error parameters â€” do_cont_vary_move_mapping","text":"","code":"do_cont_vary_move_mapping(   input_list,   cont_vary_movement,   Movement_cont_pe_pars_spec )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_cont_vary_move_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up mapping for movement deviations and process error parameters â€” do_cont_vary_move_mapping","text":"input_list Input list cont_vary_movement Character vector specfiying continuous time-varying movmenet parameterization Movement_cont_pe_pars_spec Character vector specifying process erorr parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_fixed_sel_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery selctivity fixed effects mapping â€” do_fish_fixed_sel_pars_mapping","title":"Helper function to set up fishery selctivity fixed effects mapping â€” do_fish_fixed_sel_pars_mapping","text":"Helper function set fishery selctivity fixed effects mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_fixed_sel_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery selctivity fixed effects mapping â€” do_fish_fixed_sel_pars_mapping","text":"","code":"do_fish_fixed_sel_pars_mapping(input_list, fish_fixed_sel_pars_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_fixed_sel_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery selctivity fixed effects mapping â€” do_fish_fixed_sel_pars_mapping","text":"input_list Input list fish_fixed_sel_pars_spec Character vector specifying fishery selectivity fixed effects parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_q_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery catchability mapping â€” do_fish_q_mapping","title":"Helper function to set up fishery catchability mapping â€” do_fish_q_mapping","text":"Helper function set fishery catchability mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_q_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery catchability mapping â€” do_fish_q_mapping","text":"","code":"do_fish_q_mapping(input_list, fish_q_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fish_q_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery catchability mapping â€” do_fish_q_mapping","text":"input_list Input list fish_q_spec Character vector specifying fishery catchability parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_devs_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery selectivity deviations mapping â€” do_fishsel_devs_mapping","title":"Helper function to set up fishery selectivity deviations mapping â€” do_fishsel_devs_mapping","text":"Helper function set fishery selectivity deviations mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_devs_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery selectivity deviations mapping â€” do_fishsel_devs_mapping","text":"","code":"do_fishsel_devs_mapping(input_list, fish_sel_devs_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_devs_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery selectivity deviations mapping â€” do_fishsel_devs_mapping","text":"input_list Input list fish_sel_devs_spec Character vector specifying fishery selectivity deviations parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_pe_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up fishery process error mapping â€” do_fishsel_pe_pars_mapping","title":"Helper function to set up fishery process error mapping â€” do_fishsel_pe_pars_mapping","text":"Helper function set fishery process error mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_pe_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up fishery process error mapping â€” do_fishsel_pe_pars_mapping","text":"","code":"do_fishsel_pe_pars_mapping(input_list, fishsel_pe_pars_spec, corr_opt_semipar)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_fishsel_pe_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up fishery process error mapping â€” do_fishsel_pe_pars_mapping","text":"input_list Input list fishsel_pe_pars_spec Character vector specifying fishery process error parameterization corr_opt_semipar Character vector specifying correlation parameter options","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Francis Weights â€” do_francis_reweighting","title":"Get Francis Weights â€” do_francis_reweighting","text":"Get Francis Weights","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Francis Weights â€” do_francis_reweighting","text":"","code":"do_francis_reweighting(data, rep, age_labels, len_labels, year_labels)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Francis Weights â€” do_francis_reweighting","text":"data List data inputs rep Report file list age_labels Age labels len_labels Length labels year_labels Year labels","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Francis Weights â€” do_francis_reweighting","text":"list object francis weights (note NAs , using jnt composition approaches - .e., uses one dimension), well dataframe francis mean fits","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Francis Weights â€” do_francis_reweighting","text":"Function get francis weights. Used inside wrapper function run_francis(), can defined user loop extract Francis weights (see example).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_francis_reweighting.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Francis Weights â€” do_francis_reweighting","text":"","code":"if (FALSE) { # \\dontrun{ for(j in 1:5) {    if(j == 1) { # reset weights at 1     data$Wt_FishAgeComps[] <- 1     data$Wt_FishLenComps[] <- 1     data$Wt_SrvAgeComps[] <- 1     data$Wt_SrvLenComps[] <- 1   } else {     data$Wt_FishAgeComps[] <- wts$new_fish_age_wts     data$Wt_FishLenComps[] <- wts$new_fish_len_wts     data$Wt_SrvAgeComps[] <- wts$new_srv_age_wts     data$Wt_SrvLenComps[] <- wts$new_srv_len_wts   }    sabie_rtmb_model <- fit_model(data,                                 parameters,                                 mapping,                                 random = NULL,                                 newton_loops = 3,                                 silent = TRUE   )    rep <- sabie_rtmb_model$report(sabie_rtmb_model$env$last.par.best) # Get report   wts <- do_francis_reweighting(data = data, rep = rep, age_labels = 2:31,                                 len_labels = seq(41, 99, 2), year_labels = 1960:2024) } } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_h_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to setup steepness mapping â€” do_h_mapping","title":"Helper function to setup steepness mapping â€” do_h_mapping","text":"Helper function setup steepness mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_h_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to setup steepness mapping â€” do_h_mapping","text":"","code":"do_h_mapping(input_list, h_spec, rec_dd)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_h_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to setup steepness mapping â€” do_h_mapping","text":"input_list Input list h_spec Character vector specifying steepness mapping rec_dd Recruitment density dependence indicator (global vs. local)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_jitter.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Jitter Analysis â€” do_jitter","title":"Run Jitter Analysis â€” do_jitter","text":"Run Jitter Analysis","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_jitter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Jitter Analysis â€” do_jitter","text":"","code":"do_jitter(   data,   parameters,   mapping,   random = NULL,   sd,   n_jitter,   n_newton_loops,   do_par,   n_cores,   par_vec = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_jitter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Jitter Analysis â€” do_jitter","text":"data Data list make obj parameters Parameter list make obj mapping Mapping list make obj random Character random effects sd sd jitter (additive) n_jitter Number jitters n_newton_loops Number newton loops do_par Whether paralleizaiton (boolean) n_cores Number cores use par_vec Vector parameter starting values use jitter analysis. default NULL (jitters starting value model). vector provided, jitter initialized MLE parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_jitter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Jitter Analysis â€” do_jitter","text":"Dataframe jitter values","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_jitter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Jitter Analysis â€” do_jitter","text":"","code":"if (FALSE) { # \\dontrun{    library(ggplot2)    # get jitter values    jit <- do_jitter(data = data,                  parameters = parameters,                  mapping = mapping,                  random = NULL,                  sd = 0.1,                  n_jitter = 100,                  n_newton_loops = 3,                  do_par = TRUE,                  n_cores = 8)     # get proportion converged    prop_converged <- jit %>%    filter(Year == 1, Type == 'Recruitment') %>%      summarize(prop_conv = sum(Hessian) / length(Hessian))     # get final model results    final_mod <- reshape2::melt(sabie_rtmb_model$rep$SSB) %>% rename(Region = Var1, Year = Var2) %>%    mutate(Type = 'SSB') %>%      bind_rows(reshape2::melt(sabie_rtmb_model$rep$Rec) %>%      rename(Region = Var1, Year = Var2) %>% mutate(Type = 'Recruitment'))     # comparison of SSB and recruitment   ggplot() +     geom_line(jit, mapping = aes(x = Year + 1959, y = value, group = jitter, color = Hessian), lwd = 1) +     geom_line(final_mod, mapping = aes(x = Year + 1959, y = value), color = \"black\", lwd = 1.3 , lty = 2) +     facet_grid(Type~Region, scales = 'free',                labeller = labeller(Region = function(x) paste0(\"Region \", x),                                    Type = c(\"Recruitment\" = \"Age 2 Recruitment (millions)\", \"SSB\" = 'SSB (kt)'))) +     labs(x = \"Year\", y = \"Value\") +     theme_bw(base_size = 20) +     scale_color_manual(values = c(\"red\", 'grey')) +     geom_text(data = jit %>% filter(Type == 'SSB', Year == 1, jitter == 1),               aes(x = Inf, y = Inf, label = paste(\"Proportion Converged: \", round(prop_converged$prop_conv, 3))),               hjust = 1.1, vjust = 1.9, size = 6, color = \"black\")     # compare jitter of max gradient and hessian PD    ggplot(jit, aes(x = jitter, y = jnLL, color = Max_Gradient, shape = Hessian)) +      geom_point(size = 5, alpha = 0.3) +      geom_hline(yintercept = min(sabie_rtmb_model$rep$jnLL), lty = 2, size = 2, color = \"blue\") +      facet_wrap(~Hessian, labeller = labeller(        Hessian = c(\"FALSE\" = \"non-PD Hessian\", \"TRUE\" = 'PD Hessian')      )) +      scale_color_viridis_c() +      theme_bw(base_size = 20) +      theme(legend.position = \"bottom\") +      guides(color = guide_colorbar(barwidth = 15, barheight = 0.5)) +      labs(x = 'Jitter') +      geom_text(data = jit %>% filter(Hessian == TRUE, Year == 1, jitter == 1),                aes(x = Inf, y = Inf, label = paste(\"Proportion Converged: \", round(prop_converged$prop_conv, 3))),                hjust = 1.1, vjust = 1.9, size = 6, color = \"black\") } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_likelihood_profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Likelihood Profile â€” do_likelihood_profile","title":"Run Likelihood Profile â€” do_likelihood_profile","text":"Run Likelihood Profile","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_likelihood_profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Likelihood Profile â€” do_likelihood_profile","text":"","code":"do_likelihood_profile(   data,   parameters,   mapping,   random = NULL,   what,   idx = NULL,   min_val,   max_val,   inc = 0.05,   do_par = FALSE,   n_cores = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_likelihood_profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Likelihood Profile â€” do_likelihood_profile","text":"data data list model parameters parameter list model mapping mapping list model random character vector random effects estimate parameter name want profile idx Index parameter array, pointing value want map (index relative flattened array) min_val minimum value profile max_val maximum value profile inc increment value min max value do_par logical, whether use parallel processing (default FALSE) n_cores integer, number cores use parallel processing (default detectCores() - 1)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_likelihood_profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Likelihood Profile â€” do_likelihood_profile","text":"Returns list likelihood profiled values data component respective dimensions (e.g., likelihood profiles fleet, region, year, etc.) well likelihood profiles data component, aggregated across respective dimensions.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Run MCMC using rtmbstan â€” do_mcmc","title":"Run MCMC using rtmbstan â€” do_mcmc","text":"Run MCMC using rtmbstan","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run MCMC using rtmbstan â€” do_mcmc","text":"","code":"do_mcmc(obj, chains, cores, iter, thin, bounds = Inf, laplace = FALSE, ...)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run MCMC using rtmbstan â€” do_mcmc","text":"obj Object built ADFUN via RTMB chains Number chains run cores Number cores use iter Number MCMC iterations run thin Thinning rate bounds Uniform bounds constrain parameter bounds laplace Whether laplace approximation random effects MCMC fixed effects ... Additional arguments tmbstan (e.g., adapt_delta)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run MCMC using rtmbstan â€” do_mcmc","text":"MCMC list object rtmbstan","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_mcmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run MCMC using rtmbstan â€” do_mcmc","text":"","code":"if (FALSE) { # \\dontrun{ obj <- RTMB::MakeADFun(cmb(SPoRC_rtmb, data), parameters = parameters, map = mapping) mcmc <- do_mcmc(obj = obj,                 chains = 4,                 cores = 4,                 iter = 10000,                 thin = 10,                 bounds = 1.5,                 laplace = FALSE,                 adapt_delta = 0.99) saveRDS(mcmc, here('output', 'MCMC_Model_23.5.rds')) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_move_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up movement mapping â€” do_move_pars_mapping","title":"Helper function to set up movement mapping â€” do_move_pars_mapping","text":"Helper function set movement mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_move_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up movement mapping â€” do_move_pars_mapping","text":"","code":"do_move_pars_mapping(   input_list,   Movement_ageblk_spec,   Movement_yearblk_spec,   Movement_sexblk_spec )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_move_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up movement mapping â€” do_move_pars_mapping","text":"input_list Input list Movement_ageblk_spec Character specifying movement age block options Movement_yearblk_spec Character specifying movement year block options Movement_sexblk_spec Character specifying movement sex block options","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_retrospective.html","id":null,"dir":"Reference","previous_headings":"","what":"Run retrospective analyses for RTMB models â€” do_retrospective","title":"Run retrospective analyses for RTMB models â€” do_retrospective","text":"Performs retrospective peels truncating input data, optionally applying Francis reweighting parallelization, returns estimates spawning stock biomass (SSB) recruitment peel.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_retrospective.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run retrospective analyses for RTMB models â€” do_retrospective","text":"","code":"do_retrospective(   n_retro,   data,   parameters,   mapping,   random = NULL,   do_par,   n_cores,   newton_loops = 3,   do_francis = FALSE,   n_francis_iter = NULL,   nlminb_control = list(iter.max = 1e+05, eval.max = 1e+05, rel.tol = 1e-15),   do_sdrep = FALSE,   fishidx_datalag = array(0, dim = c(data$n_regions, data$n_fish_fleets)),   fishage_datalag = array(0, dim = c(data$n_regions, data$n_fish_fleets)),   fishlen_datalag = array(0, dim = c(data$n_regions, data$n_fish_fleets)),   srvidx_datalag = array(0, dim = c(data$n_regions, data$n_srv_fleets)),   srvage_datalag = array(0, dim = c(data$n_regions, data$n_srv_fleets)),   srvlen_datalag = array(0, dim = c(data$n_regions, data$n_srv_fleets)),   tag_datalag = 0 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_retrospective.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run retrospective analyses for RTMB models â€” do_retrospective","text":"n_retro Integer. Number retrospective peels perform. data List. Data input RTMB model. parameters List. Parameter values RTMB model. mapping List. Mapping information RTMB model. random Character vector. Names random effects model. Default NULL. do_par Logical. Whether run retrospective peels parallel. Default FALSE. n_cores Integer. Number cores use parallel execution do_par = TRUE. newton_loops Integer. Number Newton loops run model fitting. Default 3. do_francis Logical. Whether apply Francis reweighting within retrospective peel. Default FALSE. n_francis_iter Integer. Number Francis reweighting iterations. Required do_francis = TRUE. nlminb_control List. Control parameters passed nlminb model fitting. Default list(iter.max = 1e5, eval.max = 1e5, rel.tol = 1e-15). do_sdrep Logical. Whether return standard errors sdreport. Default FALSE. fishidx_datalag Integer array. Lags fishery index data [regions x fleets]. Default zeros. fishage_datalag Integer array. Lags fishery age composition data [regions x fleets]. Default zeros. fishlen_datalag Integer array. Lags fishery length composition data [regions x fleets]. Default zeros. srvidx_datalag Integer array. Lags survey index data [regions x fleets]. Default zeros. srvage_datalag Integer array. Lags survey age composition data [regions x fleets]. Default zeros. srvlen_datalag Integer array. Lags survey length composition data [regions x fleets]. Default zeros. tag_datalag Integer. Lag tagging data. Default 0.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_retrospective.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run retrospective analyses for RTMB models â€” do_retrospective","text":"data.frame containing retrospective estimates SSB recruitment.   Columns include: Region: Region index. Year: Year index. Type: \"SSB\" \"Recruitment\". peel: Peel number (0 = full data, 1 = 1-year peel, etc.). value: Estimated value SSB recruitment. pdHess max_grad (optional): Information sdreport do_sdrep = TRUE.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_retrospective.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run retrospective analyses for RTMB models â€” do_retrospective","text":"","code":"if (FALSE) { # \\dontrun{ # Run a 7-year retrospective ret <- do_retrospective(   n_retro = 7,   data = data,   parameters = parameters,   mapping = mapping,   random = NULL,   do_par = TRUE,   n_cores = 7,   do_francis = TRUE,   n_francis_iter = 5 )  # Plot retrospective SSB and Recruitment library(ggplot2) ggplot(ret, aes(x = Year + 1959, y = value, group = peel, color = 2024 - peel)) +   geom_line(lwd = 1.3) +   facet_wrap(~Type) +   guides(color = guide_colourbar(barwidth = 10, barheight = 1.3)) +   labs(x = 'Year', y = 'Value', color = 'Retrospective Year') +   scale_color_viridis_c() +   theme_bw(base_size = 15) +   theme(legend.position = 'top') } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_runs_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Runs test function taken from SS3 diags. â€” do_runs_test","title":"Runs test function taken from SS3 diags. â€” do_runs_test","text":"Runs test function taken SS3 diags.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_runs_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Runs test function taken from SS3 diags. â€” do_runs_test","text":"","code":"do_runs_test(x, type = NULL, mixing = \"two.sided\")"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_runs_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Runs test function taken from SS3 diags. â€” do_runs_test","text":"x Vector residuals type Whether use mean 0 assumption mean residuals (default = use mean 0) mixing Type test , less = left tailed test detects positive autocorrelation, two.sided = two sided test tests whether positive /negative autocorrealtion. null , rejecting null (<0.05) indictes non-randomness.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_runs_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Runs test function taken from SS3 diags. â€” do_runs_test","text":"List object p value limits three-sigma limit - (potential data outlier, residual > 3 standard deviations away mean 0)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/do_runs_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Runs test function taken from SS3 diags. â€” do_runs_test","text":"","code":"if (FALSE) { # \\dontrun{  idx_fits <- get_idx_fits(data = data, rep = rep, year_labs = seq(1960, 2024, 1))   idx_fits <- idx_fits %>%     mutate(       Idx = case_when(         Type == \"Fishery\" & Year < 1995 ~ \"Japanese Fishery CPUE Index\",         Type == \"Fishery\" & Year >= 1995 ~ \"Domestic Fishery CPUE Index\",         Type == 'Survey' & Fleet == 1 ~ \"Domestic LL Survey Relative Population Numbers\",         Type == 'Survey' & Fleet == 2 ~ \"GOA Trawl Survey Biomass (kt)\",         Type == 'Survey' & Fleet == 3 ~ 'Japanese LL Survey Relative Population Numbers'       )     )    unique_idx <- unique(idx_fits$Idx)   runs_all <- data.frame()   for(i in 1:length(unique(idx_fits$Idx))) {     tmp <- idx_fits %>% filter(Idx == unique_idx[i])     runstest <- do_runs_test(x=as.numeric(tmp$resid),type=\"resid\", mixing = \"less\")     tmp_runs <- data.frame(p = runstest$p.runs, lwr = runstest$sig3lim[1], upr = runstest$sig3lim[2], Idx = unique_idx[i])     runs_all <- rbind(runs_all, tmp_runs)   } # end i    ggplot() +     geom_point(idx_fits, mapping = aes(x = Year, y = resid)) +     geom_segment(idx_fits, mapping = aes(x = Year, xend = Year, y = 0, yend = resid)) +     geom_smooth(idx_fits, mapping = aes(x = Year, y = resid), se = F) +     geom_hline(yintercept = 0, lty = 2) +     geom_hline(runs_all, mapping = aes(yintercept = upr), lty = 2) +     geom_hline(runs_all, mapping = aes(yintercept = lwr), lty = 2) +     geom_text(data = runs_all, aes(x = -Inf, y = Inf, label = paste(\"p = \", round(p, 3))), hjust = -0.5, vjust = 8.2, size = 7)+     labs(x = \"Year\", y = 'Residuals') +     theme_bw(base_size = 20) +     facet_wrap(~Idx, scales = 'free', ncol = 2) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sexratio_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up sex ratio parameters â€” do_sexratio_pars_mapping","title":"Helper function to set up sex ratio parameters â€” do_sexratio_pars_mapping","text":"Helper function set sex ratio parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sexratio_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up sex ratio parameters â€” do_sexratio_pars_mapping","text":"","code":"do_sexratio_pars_mapping(input_list, sexratio_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sexratio_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up sex ratio parameters â€” do_sexratio_pars_mapping","text":"input_list Input list sexratio_spec Charcacter specifying sex ratio parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaC_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to setup sigma C and sigma C agg mapping â€” do_sigmaC_mapping","title":"Helper function to setup sigma C and sigma C agg mapping â€” do_sigmaC_mapping","text":"Helper function setup sigma C sigma C agg mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaC_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to setup sigma C and sigma C agg mapping â€” do_sigmaC_mapping","text":"","code":"do_sigmaC_mapping(input_list, sigmaC_spec, sigmaC_agg_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaC_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to setup sigma C and sigma C agg mapping â€” do_sigmaC_mapping","text":"input_list Input list sigmaC_spec Character vector sigmaC specification sigmaC_agg_spec Character vector sigmaC_agg specification","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaF_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to setup sigma F and sigma F agg mapping â€” do_sigmaF_mapping","title":"Helper function to setup sigma F and sigma F agg mapping â€” do_sigmaF_mapping","text":"Helper function setup sigma F sigma F agg mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaF_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to setup sigma F and sigma F agg mapping â€” do_sigmaF_mapping","text":"","code":"do_sigmaF_mapping(input_list, sigmaF_spec, sigmaF_agg_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaF_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to setup sigma F and sigma F agg mapping â€” do_sigmaF_mapping","text":"input_list Input list sigmaF_spec Character vector sigmaF specification sigmaF_agg_spec Character vector sigmaF_agg specification","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaR_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Helper function to handle sigmaR mapping â€” do_sigmaR_mapping","title":"Title Helper function to handle sigmaR mapping â€” do_sigmaR_mapping","text":"Title Helper function handle sigmaR mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaR_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Helper function to handle sigmaR mapping â€” do_sigmaR_mapping","text":"","code":"do_sigmaR_mapping(input_list, sigmaR_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaR_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Helper function to handle sigmaR mapping â€” do_sigmaR_mapping","text":"input_list Input list sigmaR_spec Character vector specifying sigmaR mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_sigmaR_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Helper function to handle sigmaR mapping â€” do_sigmaR_mapping","text":"Input list mapping modified","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_fixed_sel_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey selctivity fixed effects mapping â€” do_srv_fixed_sel_pars_mapping","title":"Helper function to set up survey selctivity fixed effects mapping â€” do_srv_fixed_sel_pars_mapping","text":"Helper function set survey selctivity fixed effects mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_fixed_sel_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey selctivity fixed effects mapping â€” do_srv_fixed_sel_pars_mapping","text":"","code":"do_srv_fixed_sel_pars_mapping(input_list, srv_fixed_sel_pars_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_fixed_sel_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey selctivity fixed effects mapping â€” do_srv_fixed_sel_pars_mapping","text":"input_list Input list srv_fixed_sel_pars_spec Character vector specifying survey selectivity fixed effects parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_q_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey catchability mapping â€” do_srv_q_mapping","title":"Helper function to set up survey catchability mapping â€” do_srv_q_mapping","text":"Helper function set survey catchability mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_q_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey catchability mapping â€” do_srv_q_mapping","text":"","code":"do_srv_q_mapping(input_list, srv_q_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srv_q_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey catchability mapping â€” do_srv_q_mapping","text":"input_list Input list srv_q_spec Character vector specifying survey catchability parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_devs_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey selectivity deviations mapping â€” do_srvsel_devs_mapping","title":"Helper function to set up survey selectivity deviations mapping â€” do_srvsel_devs_mapping","text":"Helper function set survey selectivity deviations mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_devs_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey selectivity deviations mapping â€” do_srvsel_devs_mapping","text":"","code":"do_srvsel_devs_mapping(input_list, srv_sel_devs_spec)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_devs_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey selectivity deviations mapping â€” do_srvsel_devs_mapping","text":"input_list Input list srv_sel_devs_spec Character vector specifying survey selectivity deviations parameterization","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_pe_pars_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up survey process error mapping â€” do_srvsel_pe_pars_mapping","title":"Helper function to set up survey process error mapping â€” do_srvsel_pe_pars_mapping","text":"Helper function set survey process error mapping","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_pe_pars_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up survey process error mapping â€” do_srvsel_pe_pars_mapping","text":"","code":"do_srvsel_pe_pars_mapping(input_list, srvsel_pe_pars_spec, corr_opt_semipar)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_srvsel_pe_pars_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up survey process error mapping â€” do_srvsel_pe_pars_mapping","text":"input_list Input list srvsel_pe_pars_spec Character vector specifying survey process error parameterization corr_opt_semipar Character vector specifying correlation parameter options","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_tag_theta_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to set up tag overdispersion parameters â€” do_tag_theta_mapping","title":"Helper function to set up tag overdispersion parameters â€” do_tag_theta_mapping","text":"Helper function set tag overdispersion parameters","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/do_tag_theta_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to set up tag overdispersion parameters â€” do_tag_theta_mapping","text":"","code":"do_tag_theta_mapping(input_list)"},{"path":"https://chengmatt.github.io/SPoRC/reference/do_tag_theta_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to set up tag overdispersion parameters â€” do_tag_theta_mapping","text":"input_list Input list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dpois_noint.html","id":null,"dir":"Reference","previous_headings":"","what":"Poisson Likelihood â€” dpois_noint","title":"Poisson Likelihood â€” dpois_noint","text":"Approximates Poisson non-integer values provided","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dpois_noint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Poisson Likelihood â€” dpois_noint","text":"","code":"dpois_noint(x, pred, give_log = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/dpois_noint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Poisson Likelihood â€” dpois_noint","text":"x observations pred predicted give_log giving log likelihood","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dpois_noint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Poisson Likelihood â€” dpois_noint","text":"Returns likelihood values poisson","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dusky_rtmb_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Dusky model outputs from single regino model â€” dusky_rtmb_model","title":"Dusky model outputs from single regino model â€” dusky_rtmb_model","text":"list containing inputs outputs 2024 GOA Dusky Rockfish Assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dusky_rtmb_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dusky model outputs from single regino model â€” dusky_rtmb_model","text":"","code":"dusky_rtmb_model"},{"path":"https://chengmatt.github.io/SPoRC/reference/dusky_rtmb_model.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dusky model outputs from single regino model â€” dusky_rtmb_model","text":"Data list single region dusky rockfish assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/dusky_rtmb_model.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dusky model outputs from single regino model â€” dusky_rtmb_model","text":"Omori, K. L., Williams, B. C., Hulson, P.-J., Ferriss, B. 2024. Assessment dusky rockfish stock Gulf Alaska. North Pacific Fishery Management Council, Anchorage, AK.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/extend_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Extend an array along a year dimension â€” extend_years","title":"Extend an array along a year dimension â€” extend_years","text":"function takes array extends along specified year dimension. extension can either filled zeros repeating last year slice.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/extend_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extend an array along a year dimension â€” extend_years","text":"","code":"extend_years(arr, n_years, yr_dim, fill = \"zeros\")"},{"path":"https://chengmatt.github.io/SPoRC/reference/extend_years.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extend an array along a year dimension â€” extend_years","text":"arr Array extend. Can number dimensions. n_years Integer. total number years extend array . yr_dim Integer. dimension `arr` corresponds years. fill Character Numeric (scalar array). fill extended years: - `\"zeros\"`: fill zeros - `\"last\"`: repeat last year slice NaN NA value. values NA, array gets populated NAs. - `\"mean\"`: take mean time series - `\"F_pattern\"`: Used fishery input sample sizes, dynamically fills sample sizes based fishing mortality values specified closed loop simulation -  Numeric: Constant scalar array","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/extend_years.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extend an array along a year dimension â€” extend_years","text":"array extended along `yr_dim` dimension.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/fit_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Run RTMB model â€” fit_model","title":"Run RTMB model â€” fit_model","text":"Run RTMB model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/fit_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run RTMB model â€” fit_model","text":"","code":"fit_model(   data,   parameters,   mapping,   random = NULL,   newton_loops = 3,   silent = FALSE,   do_optim = TRUE,   nlminb_control = list(iter.max = 1e+05, eval.max = 1e+05, rel.tol = 1e-15),   ... )"},{"path":"https://chengmatt.github.io/SPoRC/reference/fit_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run RTMB model â€” fit_model","text":"data Data list parameters Parameter list mapping Mapping list random Character random effects integrate newton_loops Number newton loops run get gradients silent Boolean whether model run silent do_optim Boolean whether model optimized nlminb_control List argument controls nlminb ... Additional arguments taken MakeADFun","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/fit_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run RTMB model â€” fit_model","text":"Returns list object optimized, results outputted RTMB model","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/fit_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run RTMB model â€” fit_model","text":"","code":"if (FALSE) { # \\dontrun{ model <- fit_model(data,                  parameters,                  mapping,                  random = NULL,                  newton_loops = 3) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_AR1_CorrMat.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","title":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","text":"Function fill n x n correlation AR(1) matrix","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_AR1_CorrMat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","text":"","code":"get_AR1_CorrMat(n, rho)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_AR1_CorrMat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","text":"n Number bins rho correaltion parameter","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_AR1_CorrMat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","text":"correlation matrix ar1 process","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_AR1_CorrMat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to fill in an n x n correlation AR(1) matrix â€” get_AR1_CorrMat","text":"","code":"if (FALSE) { # \\dontrun{ mat <- get_AR1_CorrMat(10, 0.5) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_Constant_CorrMat.html","id":null,"dir":"Reference","previous_headings":"","what":"Constant correlation matrix â€” get_Constant_CorrMat","title":"Constant correlation matrix â€” get_Constant_CorrMat","text":"Constant correlation matrix","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_Constant_CorrMat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constant correlation matrix â€” get_Constant_CorrMat","text":"","code":"get_Constant_CorrMat(n, rho)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_Constant_CorrMat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constant correlation matrix â€” get_Constant_CorrMat","text":"n Number bins rho correaltion parameter","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_Constant_CorrMat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constant correlation matrix â€” get_Constant_CorrMat","text":"constant correlation matrix","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_Constant_CorrMat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constant correlation matrix â€” get_Constant_CorrMat","text":"","code":"if (FALSE) { # \\dontrun{ mat <- get_Constant_CorrMat(10, 0.5) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_beta_scaled_pars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get scaled parameters for a scaled beta distribution â€” get_beta_scaled_pars","title":"Get scaled parameters for a scaled beta distribution â€” get_beta_scaled_pars","text":"https://stackoverflow.com/questions/75165770/beta-distribution--bounds--0-1-0-5","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_beta_scaled_pars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get scaled parameters for a scaled beta distribution â€” get_beta_scaled_pars","text":"","code":"get_beta_scaled_pars(low, high, mu, sigma)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_beta_scaled_pars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get scaled parameters for a scaled beta distribution â€” get_beta_scaled_pars","text":"low lower bound high upper bound mu mean normal space sigma sigma normal space","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_beta_scaled_pars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get scaled parameters for a scaled beta distribution â€” get_beta_scaled_pars","text":"Returns beta distribution parmeters bounds","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_biological_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Plots of Biological Quantities â€” get_biological_plot","title":"Get Plots of Biological Quantities â€” get_biological_plot","text":"Get Plots Biological Quantities","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_biological_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Plots of Biological Quantities â€” get_biological_plot","text":"","code":"get_biological_plot(data, rep, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_biological_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Plots of Biological Quantities â€” get_biological_plot","text":"data List n_models `SPoRC` data lists rep List n_models `SPoRC` report lists model_names Vector model names","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_biological_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Plots of Biological Quantities â€” get_biological_plot","text":"list plots terminal year movement, natural mortality, weight--age, maturity age across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_biological_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Plots of Biological Quantities â€” get_biological_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_biological_plot(list(data1, data2), list(rep1, rep2), c(\"Model1\", \"Model2\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_catch_fits_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get Catch Fits Plot â€” get_catch_fits_plot","title":"Title Get Catch Fits Plot â€” get_catch_fits_plot","text":"Title Get Catch Fits Plot","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_catch_fits_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get Catch Fits Plot â€” get_catch_fits_plot","text":"","code":"get_catch_fits_plot(data, rep, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_catch_fits_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get Catch Fits Plot â€” get_catch_fits_plot","text":"data List n_models `SPoRC` data lists rep List n_models `SPoRC` report lists model_names Vector model names","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_catch_fits_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Get Catch Fits Plot â€” get_catch_fits_plot","text":"plot fitted values various catch time series across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_catch_fits_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Title Get Catch Fits Plot â€” get_catch_fits_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_catch_fits_plot(list(data1, data2), list(rep1, rep2), c(\"Model1\", \"Model2\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_closed_loop_reference_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Closed Loop Reference Points â€” get_closed_loop_reference_points","title":"Get Closed Loop Reference Points â€” get_closed_loop_reference_points","text":"Computes fishery biological reference points either using \"true\" simulated values operating model using assessment-derived data report objects. Supports single-region multi-region reference points.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_closed_loop_reference_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Closed Loop Reference Points â€” get_closed_loop_reference_points","text":"","code":"get_closed_loop_reference_points(   use_true_values,   sim_env,   asmt_data = NULL,   asmt_rep = NULL,   y,   sim,   reference_points_opt = list(n_avg_yrs = 1, SPR_x = 0.4, calc_rec_st_yr = 1, rec_age =     1, type = \"single_region\", what = \"SPR\"),   n_proj_yrs )"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_closed_loop_reference_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Closed Loop Reference Points â€” get_closed_loop_reference_points","text":"use_true_values Logical. TRUE, uses values simulation environment (`sim_env`) calculating reference points. FALSE, uses `asmt_data` `asmt_rep`. sim_env Simulation environment asmt_data Optional list. Assessment data object (RTMB) using true values. asmt_rep Optional list. Assessment report object (RTMB) using true values. y Integer. Number years include calculations (usually last year assessment simulation). sim Integer. Index simulation replicate `sim_env`. reference_points_opt List. Options reference point calculations: n_avg_yrs Number years average demographic rates. Default 1. SPR_x Target SPR fraction reference point calculations. Default 0.4. calc_rec_st_yr Year start calculating mean recruitment. Default 1. rec_age Age recruitment. Default 1. type Reference point type: \"single_region\" \"multi_region\". Default \"single_region\". Method reference point calculation. Options include \"SPR\", \"BH_MSY\", \"independent_SPR\", \"independent_BH_MSY\", \"global_SPR\", \"global_BH_MSY\". Default \"SPR\". n_proj_yrs Number projection years","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_closed_loop_reference_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Closed Loop Reference Points â€” get_closed_loop_reference_points","text":"list elements: f_ref_pt Array fishing reference points region projection year. b_ref_pt Array biological reference points region projection year. virgin_b_ref_pt Array unfished biological reference points region projection year.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_comp_prop.html","id":null,"dir":"Reference","previous_headings":"","what":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","title":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","text":"Gets composition data proportions normalized according assessment specifications RTMB","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_comp_prop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","text":"","code":"get_comp_prop(data, rep, age_labels, len_labels, year_labels)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_comp_prop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","text":"data list data inputs rep report file RTMB age_labels vector observed age labels assessment len_labels vector length labels assessment year_labels vector years","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_comp_prop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","text":"List fishery age, lengths, survey age, lengths dataframe well matrix form (dimensioned region, year, bin, sex, fleet)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_comp_prop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gets composition data proportions normalized according to the assessment specifications from RTMB â€” get_comp_prop","text":"","code":"if (FALSE) { # \\dontrun{ comp_props <- get_comp_prop(data = data, rep = rep, age_labels = 2:31, len_labels = seq(41, 99, 2), year_labels = 1960:2024) comp_props$Fishery_Ages %>%   filter(Fleet == 1, Sex == 1) %>%   ggplot() +   geom_col(aes(x = Age, y = obs)) +   geom_line(aes(x = Age, y = pred)) +   facet_wrap(~Year, ncol = 3)    comp_props$Survey_Ages %>%     group_by(Region, Age, Sex, Fleet) %>%     summarize(lwr_obs = quantile(obs, 0.1),               upr_obs = quantile(obs, 0.9),               lwr_pred = quantile(pred, 0.1),               upr_pred = quantile(pred, 0.9),               obs = mean(obs),               pred = mean(pred)) %>%     ggplot() +     geom_line(mapping = aes(x = Age, y = obs, color = 'Obs', lty = 'Obs'), lwd = 1.3) +     geom_ribbon(mapping = aes(x = Age, y = obs, ymin = lwr_obs, ymax = upr_obs, fill = 'Obs'), alpha = 0.3) +     geom_line(mapping = aes(x = Age, y = pred, color = 'Pred', lty = 'Pred'), lwd = 1.3) +     geom_ribbon(mapping = aes(x = Age, y = pred, ymin = lwr_pred, ymax = upr_pred, fill = 'Pred'), alpha = 0.3) +     facet_grid(Region~Fleet, labeller = labeller(       Region = c('1' = \"Region 1\"),       Fleet = c('1' = 'Domestic LL Survey', '3' = 'JP LL Survey')     )) +     labs(x = 'Age', y = 'Proportion', color = '', linetype = '', fill = '') +     theme_bw(base_size = 20) +     theme(legend.position = 'top') } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_data_fitted_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Data Fitted to Plot â€” get_data_fitted_plot","title":"Get Data Fitted to Plot â€” get_data_fitted_plot","text":"Get Data Fitted Plot","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_data_fitted_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Data Fitted to Plot â€” get_data_fitted_plot","text":"","code":"get_data_fitted_plot(data, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_data_fitted_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Data Fitted to Plot â€” get_data_fitted_plot","text":"data List n_models `SPoRC` data lists model_names Character vector model names","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_data_fitted_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Data Fitted to Plot â€” get_data_fitted_plot","text":"plot data fitted across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_data_fitted_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Data Fitted to Plot â€” get_data_fitted_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_data_fitted_plot(list(data1, data2), c(\"Model1\", \"Model2\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_francis_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","title":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","text":"Computes Francis weights, used internally do_francis_reweighting","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_francis_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","text":"","code":"get_francis_weights(   n_regions,   n_sexes,   n_fleets,   Use,   ISS,   Pred_array,   Obs_array,   weights,   bins,   comp_type )"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_francis_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","text":"n_regions Number regions n_sexes Number sexes n_fleets Number fleets (fishery survey) Use Array data list specifies whether use data year ISS Input sample size array Pred_array Predicted values array dimensioned n_regions, n_years, n_ages, n_sexes, n_fleets Obs_array Observed values array dimensioned n_regions, n_years, n_ages, n_sexes, n_fleets weights Array francis weights (NAs) apply dimensioned n_regions, n_years, n_sexes, n_fleets bins Vector bins used (age length) comp_type Matrix composition structure types dimensioned year fleet","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_francis_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","text":"List values calculated francis weight, dataframe observed expected means","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_francis_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes Francis weights, which is used internally by do_francis_reweighting â€” get_francis_weights","text":"","code":"if (FALSE) { # \\dontrun{ # Function is used within do_francis_reweighting get_francis_weights(n_regions, n_sexes, n_fleets, Use, ISS, Pred_arry, Obs_array, weights, bins, comp_type) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits.html","id":null,"dir":"Reference","previous_headings":"","what":"Gets index fits results â€” get_idx_fits","title":"Gets index fits results â€” get_idx_fits","text":"Gets index fits results","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gets index fits results â€” get_idx_fits","text":"","code":"get_idx_fits(data, rep, year_labs)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gets index fits results â€” get_idx_fits","text":"data Data list fed RTMB rep Report list output RTMB year_labs Year labels use (vector)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gets index fits results â€” get_idx_fits","text":"Fits indices dataframe","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gets index fits results â€” get_idx_fits","text":"","code":"if (FALSE) { # \\dontrun{ idx_fits <- get_idx_fits(data = data, rep = rep, year_labs = seq(1960, 2024, 1))  idx_fits <- idx_fits %>%   mutate(     Idx = case_when(       Type == \"Fishery\" & Year < 1995 ~ \"Japanese Fishery CPUE Index\",       Type == \"Fishery\" & Year >= 1995 ~ \"Domestic Fishery CPUE Index\",       Type == 'Survey' & Fleet == 1 ~ \"Domestic LL Survey Relative Population Numbers\",       Type == 'Survey' & Fleet == 2 ~ \"GOA Trawl Survey Biomass (kt)\",       Type == 'Survey' & Fleet == 3 ~ 'Japanese LL Survey Relative Population Numbers'     )   ) ggplot() +   geom_line(idx_fits, mapping = aes(x = Year, y = value), lwd = 1.3, col = 'red') +   geom_pointrange(idx_fits, mapping = aes(x = Year, y = obs, ymin = lci, ymax = uci), color = 'blue', pch = 1) +   labs(x = \"Year\", y = 'Index') +   theme_bw(base_size = 20) +   facet_wrap(~Idx, scales = 'free', ncol = 2)  } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Index Fits Plot â€” get_idx_fits_plot","title":"Get Index Fits Plot â€” get_idx_fits_plot","text":"Get Index Fits Plot","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Index Fits Plot â€” get_idx_fits_plot","text":"","code":"get_idx_fits_plot(data, rep, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Index Fits Plot â€” get_idx_fits_plot","text":"data List n_models `SPoRC` data lists rep List n_models `SPoRC` report lists model_names Vector model names","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Index Fits Plot â€” get_idx_fits_plot","text":"plot fitted values various indices across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_idx_fits_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Index Fits Plot â€” get_idx_fits_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_idx_fits_plot(list(data1, data2), list(rep1, rep2), c(\"Model1\", \"Model2\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"Calculates biological fishery reference points performs population projections estimate terminal spawning biomass, catch advice, reference point values model region. Also returns formatted table plot key quantities.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"","code":"get_key_quants(data, rep, reference_points_opt, proj_model_opt, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"data list model input data objects, one model (.e., list SPoRC-formatted data lists). element contain information regions, years, ages, fleets, biological inputs (e.g., weight--age, maturity, mortality). rep list model output objects, one model (.e., list SPoRC-formatted report lists). element must include recruitment, selectivity, mortality, numbers--age. reference_points_opt named list specifying options reference point calculations. See Get_Reference_Points details. Must include: SPR_x Spawning potential ratio (e.g., 0.4) calculating F reference points. May NULL using bh_rec. t_spwn Fraction year spawning occurs (e.g., 0.5). sex_ratio_f Proportion recruits female. calc_rec_st_yr Start year averaging recruitment. rec_age Recruitment age. type Reference point calculation method (e.g., \"multi_region\"). Type output requested reference point function. proj_model_opt named list projection settings. See Do_Population_Projection details. Must include: n_proj_yrs Number years project forward. HCR_function Harvest control rule function use. recruitment_opt Recruitment assumption (e.g., \"mean_rec\", \"bh_rec\", \"inv_gauss\"). fmort_opt Fishing mortality assumption (e.g., \"input\", \"HCR\"). n_avg_yrs Number years average projection inputs. model_names character vector model identifiers (e.g., c(\"Base\", \"Alt1\", \"Alt2\")), one element data rep.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"list two elements: [[1]] data.frame key quantities model region, including terminal SSB, catch advice, reference points. [[2]] cowplot table plot (ggdraw object) key quantities.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"function checks input list completeness, calculates reference points using Get_Reference_Points(), performs population projections Do_Population_Projection(), assembles tabular visual summaries. recruitment_opt set \"inv_gauss\", warning issued since single simulation run. typically appropriate alternative assumption recommended.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_key_quants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Key Projection Quantities and Table Plot â€” get_key_quants","text":"","code":"if (FALSE) { # \\dontrun{ reference_points_opt <- list(SPR_x = 0.4,                              t_spwn = 0,                              sex_ratio_f = 0.5,                              calc_rec_st_yr = 20,                              rec_age = 2,                              type = \"multi_region\",                              what = \"global_SPR\")  proj_model_opt <- list(   n_proj_yrs = 2,   n_avg_yrs = 1,   HCR_function = function(x, frp, brp, alpha = 0.05) {     stock_status <- x / brp     if (stock_status >= 1) f <- frp     if (stock_status > alpha && stock_status < 1) f <- frp * (stock_status - alpha) / (1 - alpha)     if (stock_status < alpha) f <- 0     return(f)   },   recruitment_opt = \"mean_rec\",   fmort_opt = \"HCR\" )  out <- get_key_quants(list(mlt_rg_sable_data),                       list(mlt_rg_sable_rep),                       reference_points_opt,                       proj_model_opt,                       \"Model 1\") out[[1]]  # key quantities data.frame out[[2]]  # table plot } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_logistN_Sigma.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","title":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","text":"Helper function generate covariance matrix (\\(\\Sigma\\)) used logistic-normal composition models. structure depends specification comp_like: comp_like = 2: independent identically distributed (iid)     across categories (\\(n_\\mathrm{categories}\\)). comp_like = 3: first-order autoregressive (AR1) correlation     across categories (\\(n_\\mathrm{categories}\\)). comp_like = 4: two-dimensional AR1 correlation across     categories sexes (\\(n_\\mathrm{categories} \\times n_\\mathrm{sexes}\\)).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_logistN_Sigma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","text":"","code":"get_logistN_Sigma(   comp_like,   n_bins,   n_sexes,   theta,   corr_b = NULL,   corr_s = NULL )"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_logistN_Sigma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","text":"comp_like Integer specifying logistic-normal correlation structure: 2 = iid across categories 3 = AR1 across categories 4 = AR1 across categories sexes n_bins Number composition categories (e.g., age length bins). comp_like = 2, 3, covariance matrix dimensioned n_bins. comp_like = 4, dimensioned n_bins * n_sexes. n_sexes Number sexes. Required comp_like = 4. theta Standard deviation parameter controlling overall scale covariance. corr_b Correlation parameter across categories, interval \\((-1, 1)\\). Used comp_like = 3 4. corr_s Correlation parameter across sexes, interval \\((-1, 1)\\). Used comp_like = 4.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_logistN_Sigma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","text":"covariance matrix \\(\\Sigma\\) dimension: n_bins (comp_like = 2, 3) n_bins * n_sexes (comp_like = 4)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_logistN_Sigma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct logistic-normal covariance matrix â€” get_logistN_Sigma","text":"","code":"if (FALSE) { # \\dontrun{ n_cat <- 5 n_sexes <- 2  # iid example (categories only) get_logistN_Sigma(comp_like = 2, n_bins = n_cat, n_sexes = NULL, theta = 0.5)  # AR1 across categories get_logistN_Sigma(comp_like = 3, n_bins = n_cat, n_sexes = NULL, theta = 0.5,                   corr_b = 0.3)  # AR1 across categories and sexes get_logistN_Sigma(comp_like = 4, n_bins = n_cat, n_sexes = n_sexes, theta = 0.5,                   corr_b = 0.3, corr_s = 0.2) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_mcmc_ssb_rec.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive SSB and Recruitment from MCMC using posterior samples â€” get_mcmc_ssb_rec","title":"Derive SSB and Recruitment from MCMC using posterior samples â€” get_mcmc_ssb_rec","text":"Derive SSB Recruitment MCMC using posterior samples","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_mcmc_ssb_rec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive SSB and Recruitment from MCMC using posterior samples â€” get_mcmc_ssb_rec","text":"","code":"get_mcmc_ssb_rec(mcmc_obj, tmb_obj)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_mcmc_ssb_rec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive SSB and Recruitment from MCMC using posterior samples â€” get_mcmc_ssb_rec","text":"mcmc_obj MCMC object tmbstan tmb_obj RTMB object MakeADFUN","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_mcmc_ssb_rec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive SSB and Recruitment from MCMC using posterior samples â€” get_mcmc_ssb_rec","text":"returns dataframe recruitment ssb posterior samples plot ssb recruitment mean, lwr 95 quantile, upr 95 quantile.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_model_rep_from_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","title":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","text":"function collapses MCMC chains RTMB/ADNUTS object, generates model reports posterior draw, extracts specified components report.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_model_rep_from_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","text":"","code":"get_model_rep_from_mcmc(rtmb_obj, adnuts_obj, what, n_cores)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_model_rep_from_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","text":"rtmb_obj RTMB object created via `ADFun`. adnuts_obj `adnuts` object containing MCMC samples. Character vector specifying names components model report extract. n_cores Number cores use","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_model_rep_from_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","text":"named list `data.table`s, one element   ``. table contains melted report component across   posterior samples, additional column   `posterior_sample` indicating MCMC draw index.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_model_rep_from_mcmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract model report from MCMC posterior samples â€” get_model_rep_from_mcmc","text":"","code":"if (FALSE) { # \\dontrun{ model_reports <- get_model_rep_from_mcmc(rtmb_obj, adnuts_obj,                                          what = c(\"SSB\", \"Rec\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_nLL_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get plot of negative log likelihood values â€” get_nLL_plot","title":"Get plot of negative log likelihood values â€” get_nLL_plot","text":"Get plot negative log likelihood values","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_nLL_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get plot of negative log likelihood values â€” get_nLL_plot","text":"","code":"get_nLL_plot(data, rep, model_names)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_nLL_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get plot of negative log likelihood values â€” get_nLL_plot","text":"data List data `SPoRC` rep List n_models `SPoRC` report lists model_names Vector model names","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_nLL_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get plot of negative log likelihood values â€” get_nLL_plot","text":"Plot tables negative log likelihood values across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_nLL_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get plot of negative log likelihood values â€” get_nLL_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_nLL_plot(list(data1, data2), list(rep1, rep2), c(\"Model1\", \"Model2\")) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_optim_param_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Populates an unoptimized parameter list with optimized values â€” get_optim_param_list","title":"Title Populates an unoptimized parameter list with optimized values â€” get_optim_param_list","text":"Title Populates unoptimized parameter list optimized values","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_optim_param_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Populates an unoptimized parameter list with optimized values â€” get_optim_param_list","text":"","code":"get_optim_param_list(parameters, mapping, sd_rep, random)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_optim_param_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Populates an unoptimized parameter list with optimized values â€” get_optim_param_list","text":"parameters Parameter list mapping Mapping list sd_rep Sd report list RTMB random Character vector whether random effects estimated","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_optim_param_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Populates an unoptimized parameter list with optimized values â€” get_optim_param_list","text":"Updated parameter list associated optimized parameters corresponding mapping indices","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_osa.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute OSA residuals for composition data â€” get_osa","title":"Compute OSA residuals for composition data â€” get_osa","text":"Formats observed expected composition data calculates one-step-ahead (OSA) residuals using multinomial, Dirichlet-multinomial, logistic-normal likelihoods. function main interface residual diagnostics, internally calling [run_osa()] perform residual calculations.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_osa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute OSA residuals for composition data â€” get_osa","text":"","code":"get_osa(   obs_mat,   exp_mat,   N = NULL,   DM_theta = NULL,   LN_Sigma = NULL,   years,   fleet,   bins,   comp_type,   bin_label,   comp_like = 0 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_osa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute OSA residuals for composition data â€” get_osa","text":"obs_mat Array observed compositions, dimensioned [region, year, bin, sex, fleet]. May contain NAs, removed filtering years. exp_mat Array expected compositions, dimensioned obs_mat. May contain NAs, removed filtering years. N Input (effective Multinomial) sample size. Dimensions depend comp_type: comp_type = 0 (aggregated): vector length n_years. comp_type = 1 (split region sex): array     [n_regions, n_years, n_sexes]. comp_type = 2 (split region, joint sex): matrix     [n_regions, n_years]. DM_theta Dirichlet-multinomial overdispersion parameter(s). Dimensions must match N: aggregated: scalar split sex: matrix [n_regions, n_sexes] joint sex: vector length n_regions LN_Sigma Logistic-normal covariance matrix. Dimensions depend comp_type: aggregated: matrix [n_bins, n_bins] split region sex: array [n_regions, n_bins, n_bins, n_sexes] joint sex: array [n_regions, n_bins, n_bins] Use [get_logistN_Sigma()] help construct input. years Vector years filter . Must match dimensions obs_mat exp_mat. fleet Fleet identifier (character numeric) filter . bins Vector age length bin labels corresponding composition categories. comp_type Integer specifying compositions structured: 0 = aggregated across regions sexes 1 = split region sex 2 = split region, joint sex bin_label Character label describing whether bins represent ages lengths. comp_like Integer specifying likelihood type (defaults 0): 0 = multinomial 1 = Dirichlet-multinomial 2â€“4 = logistic-normal variants","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_osa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute OSA residuals for composition data â€” get_osa","text":"list one element: res Data frame OSA residuals. Columns include:     fleet, index_label, year, index,     resid, region, sex, comp_type.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_par_est_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for extracting parameter information and names from TMB â€” get_par_est_info","title":"Helper function for extracting parameter information and names from TMB â€” get_par_est_info","text":"Helper function extracting parameter information names TMB","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_par_est_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for extracting parameter information and names from TMB â€” get_par_est_info","text":"","code":"get_par_est_info(parameters, mapping, sd_rep)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_par_est_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function for extracting parameter information and names from TMB â€” get_par_est_info","text":"parameters Parameter list setting TMB object mapping Mapping list setting TMB object sd_rep SD Report TMB obj","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_par_est_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function for extracting parameter information and names from TMB â€” get_par_est_info","text":"list dataframes estimated non-estimated parameter values.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Retrospective Plot â€” get_retrospective_plot","title":"Get Retrospective Plot â€” get_retrospective_plot","text":"Get Retrospective Plot","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Retrospective Plot â€” get_retrospective_plot","text":"","code":"get_retrospective_plot(retro_output, Rec_Age)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Retrospective Plot â€” get_retrospective_plot","text":"retro_output Dataframe generated do_retrospective Rec_Age Age recruitment occurs","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Retrospective Plot â€” get_retrospective_plot","text":"retrospective plot recruitment SSB relative absolute scales, well retrospective plot recruitment cohort (squid plot)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Retrospective Plot â€” get_retrospective_plot","text":"","code":"if (FALSE) { # \\dontrun{ # do retrospective retro <- do_retrospective(n_retro = 7, # number of retro peels to run data = data, # rtmb data parameters = parameters, # rtmb parameters mapping = mapping, # rtmb mapping random = NULL, # if random effects are used do_par = TRUE, # whether or not to parralleize n_cores = 7, # if parallel, number of cores to use do_francis = F, # if we want tod o Francis n_francis_iter = NULL # Number of francis iterations to do ) get_retrospective_plot(retro, Rec_Age = 2) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_relative_difference.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","title":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","text":"Derive relative difference terminal year retrospective analysis.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_relative_difference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","text":"","code":"get_retrospective_relative_difference(retro_data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_relative_difference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","text":"retro_data Dataframe outputted do_retrospective function","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_relative_difference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","text":"Returns data frame relative difference SSB recruitment terminal year","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_retrospective_relative_difference.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Derive relative difference from terminal year from a retrospective analysis. â€” get_retrospective_relative_difference","text":"","code":"if (FALSE) { # \\dontrun{  ret <- do_retrospective(7, data, parameters, mapping, random = NULL, do_par = TRUE, n_cores = 7, do_francis = TRUE, n_francis_iter = 5)  ret_df <- get_retrospective_relative_difference(ret)  ggplot(ret_df %>% filter(Type == 'SSB'), aes(x = Year, y = rd, group = 2024- as.numeric(peel), color = 2024 - as.numeric(peel))) +  geom_hline(yintercept = 0, lty = 2, lwd = 1.3) +    coord_cartesian(ylim = c(-0.4, 0.4)) +    geom_line(lwd = 1.5) +    guides (color = guide_colourbar(barwidth = 15, barheight = 1.3)) +    labs(x = 'Year', y = 'Relative Difference from Terminal Year', color = 'Retrospective Year') +    scale_color_viridis_c() +    theme_bw(base_size = 15) +    theme(legend.position = 'top') } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_selex_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","title":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","text":"Get Fishery Survey Selectivity Plots","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_selex_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","text":"","code":"get_selex_plot(rep, model_names, Selex_Type = \"age\", year_indx = NULL)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_selex_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","text":"rep List n_models `SPoRC` report lists model_names Vector model names Selex_Type Character vector specifying whether output age length-based selectivity (age, length) year_indx Year index selectivity year plot (can integer vector)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_selex_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","text":"Plots terminal year fishery survey selectivity fleet, region, sex across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_selex_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Fishery and Survey Selectivity Plots â€” get_selex_plot","text":"","code":"if (FALSE) { # \\dontrun{ get_selex_plot(list(rep1, rep2), c(\"Model1\", \"Model2\"), year_indx = c(1:30)) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_ts_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Time Series Plots â€” get_ts_plot","title":"Get Time Series Plots â€” get_ts_plot","text":"Get Time Series Plots","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_ts_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Time Series Plots â€” get_ts_plot","text":"","code":"get_ts_plot(rep, sd_rep, model_names, do_ci = TRUE)"},{"path":"https://chengmatt.github.io/SPoRC/reference/get_ts_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Time Series Plots â€” get_ts_plot","text":"rep List n_models `SPoRC` report lists sd_rep List n_models `SPoRC` sdreport lists model_names Vector model names do_ci Boolean whether confidence intervals plotted","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/get_ts_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Time Series Plots â€” get_ts_plot","text":"Plots spawning biomass, dynamic b0, total biomass, recruitment, fishing mortality time-series across models","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/get_ts_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Time Series Plots â€” get_ts_plot","text":"","code":"if (FALSE) { # \\dontrun{   get_ts_plot(list(rep1, rep2), list(sd_rep1, sd_rep2), c(\"Model1\", \"Model2\"), do_ci = TRUE) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/global_BH_Fmsy.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get Global FMSY from a Beverton-Holt (Spatial) â€” global_BH_Fmsy","title":"Title Get Global FMSY from a Beverton-Holt (Spatial) â€” global_BH_Fmsy","text":"Title Get Global FMSY Beverton-Holt (Spatial)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/global_BH_Fmsy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get Global FMSY from a Beverton-Holt (Spatial) â€” global_BH_Fmsy","text":"","code":"global_BH_Fmsy(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/global_BH_Fmsy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get Global FMSY from a Beverton-Holt (Spatial) â€” global_BH_Fmsy","text":"pars Parameter List data Data List","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/global_SPR.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get Global SPR Reference Points (Spatial) â€” global_SPR","title":"Title Get Global SPR Reference Points (Spatial) â€” global_SPR","text":"Title Get Global SPR Reference Points (Spatial)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/global_SPR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get Global SPR Reference Points (Spatial) â€” global_SPR","text":"","code":"global_SPR(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/global_SPR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get Global SPR Reference Points (Spatial) â€” global_SPR","text":"pars Parameter List RTMB data Data List RTMB","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/is_package_available.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to check package availbility â€” is_package_available","title":"Helper function to check package availbility â€” is_package_available","text":"Helper function check package availbility","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/is_package_available.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to check package availbility â€” is_package_available","text":"","code":"is_package_available(pkg)"},{"path":"https://chengmatt.github.io/SPoRC/reference/is_package_available.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to check package availbility â€” is_package_available","text":"pkg package name character","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/local_BH_Fmsy.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get Local FMSY from a Beverton-Holt (Spatial) â€” local_BH_Fmsy","title":"Title Get Local FMSY from a Beverton-Holt (Spatial) â€” local_BH_Fmsy","text":"Title Get Local FMSY Beverton-Holt (Spatial)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/local_BH_Fmsy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get Local FMSY from a Beverton-Holt (Spatial) â€” local_BH_Fmsy","text":"","code":"local_BH_Fmsy(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/local_BH_Fmsy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get Local FMSY from a Beverton-Holt (Spatial) â€” local_BH_Fmsy","text":"pars Parameter List data Data List","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_diag.html","id":null,"dir":"Reference","previous_headings":"","what":"Model diagnostics for MCMC â€” mcmc_diag","title":"Model diagnostics for MCMC â€” mcmc_diag","text":"Model diagnostics MCMC","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_diag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model diagnostics for MCMC â€” mcmc_diag","text":"","code":"mcmc_diag(mcmc_obj, tmb_sdrep, plot = TRUE, pars = NULL)"},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_diag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model diagnostics for MCMC â€” mcmc_diag","text":"mcmc_obj MCMC object tmbstan tmb_sdrep SD report fomr TMB plot Whether plot outputs pars Parameters want plot ","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_diag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model diagnostics for MCMC â€” mcmc_diag","text":"list plots traditional MCMC diagnostics","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_diag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model diagnostics for MCMC â€” mcmc_diag","text":"","code":"if (FALSE) { # \\dontrun{ diagnostic_plots <- mcmc_diag(mcmc_obj, tmb_sdrep, TRUE, pars = 'ln_M') } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_par_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Gets parameter names from mcmc object â€” mcmc_par_names","title":"Gets parameter names from mcmc object â€” mcmc_par_names","text":"Gets parameter names mcmc object","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_par_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gets parameter names from mcmc object â€” mcmc_par_names","text":"","code":"mcmc_par_names(mcmc_obj)"},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_par_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gets parameter names from mcmc object â€” mcmc_par_names","text":"mcmc_obj MCMC object rtmbstan","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_par_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gets parameter names from mcmc object â€” mcmc_par_names","text":"Returns character vector parameter names","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/mcmc_par_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gets parameter names from mcmc object â€” mcmc_par_names","text":"","code":"if (FALSE) { # \\dontrun{ par_names <- mcmc_par_names(mcmc_obj) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Sablefish data for multi region (5 area) case study â€” mlt_rg_sable_data","title":"Sablefish data for multi region (5 area) case study â€” mlt_rg_sable_data","text":"dataset containing necessary elements Alaska sablefish spatial case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sablefish data for multi region (5 area) case study â€” mlt_rg_sable_data","text":"","code":"mlt_rg_sable_data"},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sablefish data for multi region (5 area) case study â€” mlt_rg_sable_data","text":"list multiple components needed multi (5) region sablefish model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sablefish data for multi region (5 area) case study â€” mlt_rg_sable_data","text":"Cheng et al. 2025, Fish Fisheries; Panmictic Panacea? Demonstrating Good Practices Developing Spatial Stock Assessments Application Alaska Sablefish (Anoplopoma fimbria)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_rep.html","id":null,"dir":"Reference","previous_headings":"","what":"Sablefish report for 5 region case study â€” mlt_rg_sable_rep","title":"Sablefish report for 5 region case study â€” mlt_rg_sable_rep","text":"report containing results spatial Alaska sablefish case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_rep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sablefish report for 5 region case study â€” mlt_rg_sable_rep","text":"","code":"mlt_rg_sable_rep"},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_rep.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sablefish report for 5 region case study â€” mlt_rg_sable_rep","text":"Report file 5 region sablefish case study","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/mlt_rg_sable_rep.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sablefish report for 5 region case study â€” mlt_rg_sable_rep","text":"Cheng et al. 2025, Fish Fisheries; Panmictic Panacea? Demonstrating Good Practices Developing Spatial Stock Assessments Application Alaska Sablefish (Anoplopoma fimbria)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_all_basic.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting function for all basic quantities â€” plot_all_basic","title":"Plotting function for all basic quantities â€” plot_all_basic","text":"Plotting function basic quantities","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_all_basic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting function for all basic quantities â€” plot_all_basic","text":"","code":"plot_all_basic(data, rep, sd_rep, model_names, out_path)"},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_all_basic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting function for all basic quantities â€” plot_all_basic","text":"data List n_models `SPoRC` data lists rep List n_models `SPoRC` report lists sd_rep List n_models sd report lists `SPoRC` model_names Character vector model names out_path Path output directory. Users need specify path.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_all_basic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting function for all basic quantities â€” plot_all_basic","text":"series plots compared across models outputted pdf specified directory","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_all_basic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting function for all basic quantities â€” plot_all_basic","text":"","code":"if (FALSE) { # \\dontrun{ plot_all_basic(   data = list(data1, data2),   rep = list(rep1, rep2),   sd_rep = list(sd_rep1, sd_rep2),   model_names = c(\"Model1\", \"Model2\"),   out_path = here::here() ) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_resids.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","title":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","text":"Plots OSA residuals outputs get_osa. Much code taken afscOM package, modificaitons plot features.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_resids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","text":"","code":"plot_resids(osa_results)"},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_resids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","text":"osa_results List object obtained get_osa, contains dataframe residuals aggregated fits.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_resids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","text":"vareity plots OSA residuals (list)","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/plot_resids.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots OSA residuals from outputs from get_osa. Much of this code is taken from the afscOM package, but with modificaitons to plot features. â€” plot_resids","text":"","code":"if (FALSE) { # \\dontrun{ comp_props <- get_comp_prop(data = data, rep = sabie_rtmb_model$rep, age_labels = 2:31, len_labels = seq(41, 99, 2), year_labels = 1960:2024) plot_resids(get_osa(obs_mat = comp_props$Obs_FishAge_mat,                     exp_mat = comp_props$Pred_FishAge_mat,                     N = rep(16.52215, length(1999:2023)),                     years = which(1960:2024 %in% 1999:2023),                     LN_Sigma = LN_Sigma,                     fleet = 1,                     bins = 2:31,                     comp_type = 0,                     comp_like = 0,                     bin_label = \"Age\")) osa_plot <- plot_resids(osa_results) } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/post_optim_sanity_checks.html","id":null,"dir":"Reference","previous_headings":"","what":"Post Optimization Model Convergence Checks â€” post_optim_sanity_checks","title":"Post Optimization Model Convergence Checks â€” post_optim_sanity_checks","text":"Post Optimization Model Convergence Checks","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/post_optim_sanity_checks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post Optimization Model Convergence Checks â€” post_optim_sanity_checks","text":"","code":"post_optim_sanity_checks(   sd_rep,   rep,   gradient_tol = 0.001,   se_tol = 100,   corr_tol = 0.99 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/post_optim_sanity_checks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Post Optimization Model Convergence Checks â€” post_optim_sanity_checks","text":"sd_rep sd report list `SPoRC` model rep report list `SPoRC` model gradient_tol Value maximum gradient tolerance use se_tol Value maximum standard error tolerance use corr_tol Value maximum correlation tolerance use","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/predict_sim_fish_iss_fmort.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict ISS fishery compositions under fishing mortality â€” predict_sim_fish_iss_fmort","title":"Predict ISS fishery compositions under fishing mortality â€” predict_sim_fish_iss_fmort","text":"Uses historical ISS fishery compositions fishing mortality rates estimate ISS compositions projection year. Compositions scaled relative historical maximum fishing mortality linear interpolation minimum maximum observed ISS values. historical values available, defaults mean zero.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/predict_sim_fish_iss_fmort.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict ISS fishery compositions under fishing mortality â€” predict_sim_fish_iss_fmort","text":"","code":"predict_sim_fish_iss_fmort(ISS_FishComps, Fmort, y, sim)"},{"path":"https://chengmatt.github.io/SPoRC/reference/predict_sim_fish_iss_fmort.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict ISS fishery compositions under fishing mortality â€” predict_sim_fish_iss_fmort","text":"ISS_FishComps Array ISS fishery compositions dimensions `[region, year, sex, fleet, sim]`. Fmort Array fishing mortality rates dimensions `[region, year, fleet, sim]`. y Integer, projection year index prediction. sim Integer, simulation index.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/predict_sim_fish_iss_fmort.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict ISS fishery compositions under fishing mortality â€” predict_sim_fish_iss_fmort","text":"Array predicted ISS values year `y`.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rdirM.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Simulate dirichlet multinomial draws â€” rdirM","title":"Title Simulate dirichlet multinomial draws â€” rdirM","text":"Title Simulate dirichlet multinomial draws","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rdirM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Simulate dirichlet multinomial draws â€” rdirM","text":"","code":"rdirM(n, N, alpha)"},{"path":"https://chengmatt.github.io/SPoRC/reference/rdirM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Simulate dirichlet multinomial draws â€” rdirM","text":"n Number sims N Sum observations alpha Concentration parameter","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rho_trans.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Constrains value between -1 and 1 â€” rho_trans","title":"Title Constrains value between -1 and 1 â€” rho_trans","text":"Title Constrains value -1 1","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rho_trans.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Constrains value between -1 and 1 â€” rho_trans","text":"","code":"rho_trans(x)"},{"path":"https://chengmatt.github.io/SPoRC/reference/rho_trans.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Constrains value between -1 and 1 â€” rho_trans","text":"x Numeric value constrain","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rho_trans.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Constrains value between -1 and 1 â€” rho_trans","text":"Constrained value -1 1","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/rinvgauss_rec.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Generate Recruitment Values based on Inverse Gaussian Distribution â€” rinvgauss_rec","title":"Title Generate Recruitment Values based on Inverse Gaussian Distribution â€” rinvgauss_rec","text":"Title Generate Recruitment Values based Inverse Gaussian Distribution","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rinvgauss_rec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Generate Recruitment Values based on Inverse Gaussian Distribution â€” rinvgauss_rec","text":"","code":"rinvgauss_rec(sims, recruitment)"},{"path":"https://chengmatt.github.io/SPoRC/reference/rinvgauss_rec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Generate Recruitment Values based on Inverse Gaussian Distribution â€” rinvgauss_rec","text":"sims Number Simulations recruitment Recruitment vector","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rinvgauss_rec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Generate Recruitment Values based on Inverse Gaussian Distribution â€” rinvgauss_rec","text":"Random variables following inverse gaussian","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rlogistnormal.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate logistic normal variables â€” rlogistnormal","title":"Simulate logistic normal variables â€” rlogistnormal","text":"Simulate logistic normal variables","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/rlogistnormal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate logistic normal variables â€” rlogistnormal","text":"","code":"rlogistnormal(exp, pars, comp_like)"},{"path":"https://chengmatt.github.io/SPoRC/reference/rlogistnormal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate logistic normal variables â€” rlogistnormal","text":"exp Expected values pars Parameters logistic normal (iid == 1 parameter, AR1 == 2 parameters, 2D, age sex == 3 parameters, 3D, age, sex, region == 4 parameters) comp_like Likelihood structure (iid == 2, ar1 == 3, 2d == 4, 3d == 5)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_annual_cycle.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Annual Cycle in Simulation Environment â€” run_annual_cycle","title":"Run Annual Cycle in Simulation Environment â€” run_annual_cycle","text":"Run Annual Cycle Simulation Environment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_annual_cycle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Annual Cycle in Simulation Environment â€” run_annual_cycle","text":"","code":"run_annual_cycle(y, sim, sim_env)"},{"path":"https://chengmatt.github.io/SPoRC/reference/run_annual_cycle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Annual Cycle in Simulation Environment â€” run_annual_cycle","text":"y Year index sim Simulation index sim_env Simulation environment necessary elements run annual cycle","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/run_francis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Iterative Francis Reweighting Procedure â€” run_francis","title":"Run Iterative Francis Reweighting Procedure â€” run_francis","text":"Runs iterative Francis reweighting procedure composition data (fishery survey age- length-compositions). function reweights input data, repeatedly fits model, computes updated Francis weights.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_francis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Iterative Francis Reweighting Procedure â€” run_francis","text":"","code":"run_francis(   data,   parameters,   mapping,   random = NULL,   n_francis_iter = 10,   newton_loops = 0 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/run_francis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Iterative Francis Reweighting Procedure â€” run_francis","text":"data list model input data, including least observed compositions (`ObsFishAgeComps`, `ObsFishLenComps`, `ObsSrvAgeComps`, `ObsSrvLenComps`) corresponding weights (`Wt_FishAgeComps`, `Wt_FishLenComps`, `Wt_SrvAgeComps`, `Wt_SrvLenComps`). parameters list model parameters passed [fit_model()]. mapping list mapping object used specify fixed estimated parameters [fit_model()]. random character string random effects passed [fit_model()]. n_francis_iter Integer. Number Francis reweighting iterations perform. Default `10`. newton_loops Integer. Number Newton loops passed [fit_model()]. Default `0`.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_francis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Iterative Francis Reweighting Procedure â€” run_francis","text":"list three elements: obj fitted model object returned [fit_model()],   including elements TMB object, data, parameters, mapping, random effects specified, report. end_mean_francis summary mean Francis weights first iteration. end_mean_francis summary mean Francis weights final iteration. recorded_weights summary recorded francis weights iteartion.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/run_francis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Iterative Francis Reweighting Procedure â€” run_francis","text":"","code":"if (FALSE) { # \\dontrun{   out <- run_francis(data = data,                      parameters = parameters,                      mapping = mapping,                      random = NULL,                      n_francis_iter = 5,                      newton_loops = 3)   out$obj   out$mean_francis } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/run_osa.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","title":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","text":"Backend function used [get_osa()] calculate one-step-ahead (OSA) residuals observed expected composition data.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_osa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","text":"","code":"run_osa(   obs,   exp,   N = NULL,   DM_theta = NULL,   LN_Sigma = NULL,   fleet,   index,   years,   index_label,   comp_like )"},{"path":"https://chengmatt.github.io/SPoRC/reference/run_osa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","text":"obs Matrix observed compositions (rows = years, columns = bins) exp Matrix expected compositions (shape obs) N Sample size multinomial/Dirichlet-multinomial DM_theta Dirichlet-multinomial overdispersion parameter(s) LN_Sigma Logistic-normal covariance matrix fleet Fleet identifier index Vector composition bins (last entry dropped logistic-normal) years Vector years corresponding rows obs/exp index_label Character describing ages lengths comp_like Integer specifying likelihood: 0 multinomial 1 Dirichlet-multinomial 2-4 logistic-normal variants","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_osa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","text":"list one element: res Data frame OSA residuals columns fleet, index_label, year, index, resid","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/run_osa.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal function to compute OSA residuals for a single composition slice â€” run_osa","text":"multinomial Dirichlet-multinomial, observed proportions scaled counts. logistic-normal, bins zeros removed, compositions renormalized, residuals computed log-ratio space, mapped back original bins.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/safe_extract.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for extracting elements from TMB report â€” safe_extract","title":"Helper function for extracting elements from TMB report â€” safe_extract","text":"Helper function extracting elements TMB report","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/safe_extract.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for extracting elements from TMB report â€” safe_extract","text":"","code":"safe_extract(obj, name)"},{"path":"https://chengmatt.github.io/SPoRC/reference/safe_extract.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function for extracting elements from TMB report â€” safe_extract","text":"obj TMB report object name Name object extracted","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/set_data_indicator_unused.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Data Indicators to Unused for Specified Years â€” set_data_indicator_unused","title":"Set Data Indicators to Unused for Specified Years â€” set_data_indicator_unused","text":"Set Data Indicators Unused Specified Years","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/set_data_indicator_unused.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Data Indicators to Unused for Specified Years â€” set_data_indicator_unused","text":"","code":"set_data_indicator_unused(   data,   unused_years,   what = c(\"Catch\", \"FishIdx\", \"FishAgeComps\", \"FishLenComps\", \"SrvIdx\", \"SrvAgeComps\",     \"SrvLenComps\", \"Tagging\") )"},{"path":"https://chengmatt.github.io/SPoRC/reference/set_data_indicator_unused.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Data Indicators to Unused for Specified Years â€” set_data_indicator_unused","text":"data Data list RTMB model unused_years Integer vector specifying years mark unused. years present data$years considered. Character vector specifying data types modify. Possible values include: \"Catch\" Catch data indicators. \"FishIdx\" Fishery index data indicators. \"FishAgeComps\" Fishery age composition data indicators. \"FishLenComps\" Fishery length composition data indicators. \"SrvIdx\" Survey index data indicators. \"SrvAgeComps\" Survey age composition data indicators. \"SrvLenComps\" Survey length composition data indicators. \"Tagging\" Tagging data associated cohorts.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/set_data_indicator_unused.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Data Indicators to Unused for Specified Years â€” set_data_indicator_unused","text":"modified data object, indicators set 0 specified years tagging cohorts removed relevant.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_dusky_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Dusky data for single region assessment case study â€” sgl_rg_dusky_data","title":"Dusky data for single region assessment case study â€” sgl_rg_dusky_data","text":"data list containing inputs 2024 GOA Dusky Rockfish Assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_dusky_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dusky data for single region assessment case study â€” sgl_rg_dusky_data","text":"","code":"sgl_rg_dusky_data"},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_dusky_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dusky data for single region assessment case study â€” sgl_rg_dusky_data","text":"Data list single region dusky rockfish assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_dusky_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dusky data for single region assessment case study â€” sgl_rg_dusky_data","text":"Omori, K. L., Williams, B. C., Hulson, P.-J., Ferriss, B. 2024. Assessment dusky rockfish stock Gulf Alaska. North Pacific Fishery Management Council, Anchorage, AK.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_ebswp_data.html","id":null,"dir":"Reference","previous_headings":"","what":"EBS Walleye Pollock data for single region case study â€” sgl_rg_ebswp_data","title":"EBS Walleye Pollock data for single region case study â€” sgl_rg_ebswp_data","text":"dataset containing necessary elements EBS Walleye Pollock case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_ebswp_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EBS Walleye Pollock data for single region case study â€” sgl_rg_ebswp_data","text":"","code":"sgl_rg_ebswp_data"},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_ebswp_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"EBS Walleye Pollock data for single region case study â€” sgl_rg_ebswp_data","text":"list multiple components needed single region walleye pollock model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_ebswp_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"EBS Walleye Pollock data for single region case study â€” sgl_rg_ebswp_data","text":"2024 Federal EBS Walleye Pollock Assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Sablefish data for single region case study â€” sgl_rg_sable_data","title":"Sablefish data for single region case study â€” sgl_rg_sable_data","text":"dataset containing necessary elements Alaska sablefish case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sablefish data for single region case study â€” sgl_rg_sable_data","text":"","code":"sgl_rg_sable_data"},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sablefish data for single region case study â€” sgl_rg_sable_data","text":"list multiple components needed single region sablefish model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sablefish data for single region case study â€” sgl_rg_sable_data","text":"2024 Federal Alaska Sablefish Assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_rep.html","id":null,"dir":"Reference","previous_headings":"","what":"Sablefish report for single region case study â€” sgl_rg_sable_rep","title":"Sablefish report for single region case study â€” sgl_rg_sable_rep","text":"report containing results Alaska sablefish case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_rep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sablefish report for single region case study â€” sgl_rg_sable_rep","text":"","code":"sgl_rg_sable_rep"},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_rep.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sablefish report for single region case study â€” sgl_rg_sable_rep","text":"Report file single region sablefish case study","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/sgl_rg_sable_rep.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sablefish report for single region case study â€” sgl_rg_sable_rep","text":"2024 Federal Alaska Sablefish Assessment","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulate_comps.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Age or Length Compositions â€” simulate_comps","title":"Simulate Age or Length Compositions â€” simulate_comps","text":"Generates Observed fish compositions age length given region, year, fleet, simulation iteration. Supports multinomial, Dirichlet-multinomial, logistic-normal likelihoods, optional ageing error applied.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulate_comps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Age or Length Compositions â€” simulate_comps","text":"","code":"simulate_comps(   r,   y,   f,   sim,   Exp,   ISS,   AgeingError,   comp_like,   ln_theta,   corr_pars,   ln_theta_agg,   corr_pars_agg,   comp_type,   n_sexes,   n_regions,   n_cat,   Obs,   age_or_len = 0 )"},{"path":"https://chengmatt.github.io/SPoRC/reference/simulate_comps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Age or Length Compositions â€” simulate_comps","text":"r Integer. Region index. y Integer. Year index. f Integer. Fleet index. sim Integer. Simulation iteration index. Exp Array. Expected compositions (age length) dimensions [region, year, category, sex, fleet, sim]. ISS Array. Sample size (integer) Observed compositions dimensions [region, year, sex, fleet, sim]. AgeingError Array. Ageing error matrix year, dimensions [year, category, category, sim]. comp_like Integer vector. Composition likelihood type per fleet: 0 = multinomial, 1 = Dirichlet-multinomial, 2-4 = logistic-normal. ln_theta Array. Log-variance parameter compositions per region, sex, fleet, dimensions [region, sex, fleet]. corr_pars Array. Correlation parameters logistic-normal likelihood, dimensions [region, sex, fleet, ?]. ln_theta_agg Numeric vector. Log-variance parameter aggregated compositions per fleet. corr_pars_agg Numeric vector. Correlation parameters aggregated logistic-normal likelihood per fleet. comp_type Integer array. Composition type: 0 = aggregated across regions, 1 = split sex, 2 = joint across sexes, dimensions [year, fleet]. n_sexes Integer. Number sexes. n_regions Integer. Number regions. n_cat Integer. Number categories (ages lengths). Obs Array. Observed compositions array fill, dimensions `Exp`. age_or_len Integer. Flag indicate ageing error applied: 0 = apply ageing error (ages), 1 = apply (lengths).","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulate_comps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Age or Length Compositions â€” simulate_comps","text":"Array Observed compositions dimensions `Obs`, updated simulated Observations.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulate_comps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate Age or Length Compositions â€” simulate_comps","text":"function handles three cases based `comp_type`: 1. Split sex (comp_type = 1): compositions simulated separately sex. 2. Joint compositions across sexes (comp_type = 2): compositions simulated jointly multiplied kronecker matrix logistic-normal Dirichlet-multinomial likelihoods. 3. Aggregated across regions (comp_type = 0): applied last region averages across regions sexes. function normalizes expected compositions, applies selected likelihood (`comp_like`), multiplies `AgeingError` applicable.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_data_to_SPoRC.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract simulation data into SPoRC format â€” simulation_data_to_SPoRC","title":"Extract simulation data into SPoRC format â€” simulation_data_to_SPoRC","text":"function subsets reshapes biological, tagging, fishery, survey data simulation environment use SPoRC analyses.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_data_to_SPoRC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract simulation data into SPoRC format â€” simulation_data_to_SPoRC","text":"","code":"simulation_data_to_SPoRC(sim_env, y, sim)"},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_data_to_SPoRC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract simulation data into SPoRC format â€” simulation_data_to_SPoRC","text":"sim_env simulation environment / object (list environment) containing arrays biological quantities, tagging information, fishery data, survey data. y Integer. Number years retain (subset `1:y`). sim Integer. Simulation replicate index extract.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_data_to_SPoRC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract simulation data into SPoRC format â€” simulation_data_to_SPoRC","text":"named list following elements: WAA Weight--age array [region Ã— year Ã— age Ã— sex]. MatAA Maturity--age array [region Ã— year Ã— age Ã— sex]. SizeAgeTrans Sizeâ€“age transition array [region Ã— year Ã— length Ã— age Ã— sex]. AgeingError Ageing error matrix [year Ã— age Ã— error Ã— sim]. tag_release_indicator Tag release indicators (`NULL` tagging used). Obs_Tag_Recap Observed tag recapture array (`NULL`). Tagged_Fish Tagged fish counts (`NULL`). n_tag_cohorts Number tag release cohorts (`NULL`). ObsCatch Observed fishery catch array [region Ã— year Ã— fleet]. ln_sigmaC Log Fishery Catch SD [region Ã— year Ã— fleet]. UseCatch Binary indicator array catch data availability. ObsFishIdx Observed fishery index array [region Ã— year Ã— fleet]. ObsFishIdx_SE Standard error fishery index array. UseFishIdx Binary indicator array fishery indices. ObsFishAgeComps Observed fishery age composition array. ObsFishLenComps Observed fishery length composition array. ISS_FishAgeComps Implied sample sizes fishery age compositions. ISS_FishLenComps Implied sample sizes fishery length compositions. UseFishAgeComps Binary indicator array fishery age comps. UseFishLenComps Binary indicator array fishery length comps. ObsSrvIdx Observed survey index array [region Ã— year Ã— fleet]. ObsSrvIdx_SE Standard error survey index array. UseSrvIdx Binary indicator array survey indices. ObsSrvAgeComps Observed survey age composition array. ObsSrvLenComps Observed survey length composition array. ISS_SrvAgeComps Implied sample sizes survey age compositions. ISS_SrvLenComps Implied sample sizes survey length compositions. UseSrvAgeComps Binary indicator array survey age comps. UseSrvLenComps Binary indicator array survey length comps.","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_self_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Conduct a Simulation Self Test â€” simulation_self_test","title":"Conduct a Simulation Self Test â€” simulation_self_test","text":"function runs self test fitted RTMB model simulating new datasets fitted parameters, refitting model, comparing estimated outputs true values used simulation. can run sequentially parallel.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_self_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conduct a Simulation Self Test â€” simulation_self_test","text":"","code":"simulation_self_test(   data,   parameters,   mapping,   random,   rep,   sd_rep,   n_sims,   newton_loops = 3,   do_sdrep = FALSE,   do_par = FALSE,   n_cores = NULL,   output_path = NULL,   what = c(\"SSB\", \"Rec\") )"},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_self_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conduct a Simulation Self Test â€” simulation_self_test","text":"data list containing model data RTMB object. parameters list fitted parameter values RTMB object. mapping list specifying parameter mappings RTMB object. random Character vector specifying random effects. rep list report values RTMB object (`$rep`). sd_rep `sdreport` object RTMB summarizing parameter uncertainty. n_sims Integer. Number simulation replicates run. newton_loops Integer. Number Newton loops used model fitting (default: `3`). do_sdrep Logical. `TRUE`, compute `sdreport` fitted replicate (default: `FALSE`). do_par Logical. `TRUE`, run simulations parallel (default: `FALSE`). n_cores Integer. Number cores use parallelization (default: `NULL` = detect automatically). output_path Optional file path. provided, simulated datasets written location. Character vector. Names report elements `rep` extract store replicate.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_self_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conduct a Simulation Self Test â€” simulation_self_test","text":"list elements corresponding requested `` values, containing array simulation results across replicates. `do_sdrep = TRUE`, additional element `\"sd_rep\"` included list `sdreport` objects (`NA` replicate fails).","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/simulation_self_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conduct a Simulation Self Test â€” simulation_self_test","text":"","code":"if (FALSE) { # \\dontrun{ # Run a simple self test with 10 simulations, extracting SSB res <- simulation_self_test(   data = model$data,   parameters = model$parameters,   mapping = model$mapping,   random = model$random,   rep = model$rep,   sd_rep = model$sd_rep,   n_sims = 10,   what = \"SSB\" )  str(res$SSB) # look at simulated SSB arrays } # }"},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_BH_Fmsy.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Get FMSY from a Beverton-Holt function (Single Region) â€” single_region_BH_Fmsy","title":"Title Get FMSY from a Beverton-Holt function (Single Region) â€” single_region_BH_Fmsy","text":"Title Get FMSY Beverton-Holt function (Single Region)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_BH_Fmsy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Get FMSY from a Beverton-Holt function (Single Region) â€” single_region_BH_Fmsy","text":"","code":"single_region_BH_Fmsy(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_BH_Fmsy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Get FMSY from a Beverton-Holt function (Single Region) â€” single_region_BH_Fmsy","text":"pars Parameter List data Data List","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_SPR.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SPR reference points (Single Region) â€” single_region_SPR","title":"Get SPR reference points (Single Region) â€” single_region_SPR","text":"Get SPR reference points (Single Region)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_SPR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SPR reference points (Single Region) â€” single_region_SPR","text":"","code":"single_region_SPR(pars, data)"},{"path":"https://chengmatt.github.io/SPoRC/reference/single_region_SPR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SPR reference points (Single Region) â€” single_region_SPR","text":"pars Parameter List data Data List","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/theme_sablefish.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot theme for sablefish â€” theme_sablefish","title":"ggplot theme for sablefish â€” theme_sablefish","text":"ggplot theme sablefish","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/theme_sablefish.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot theme for sablefish â€” theme_sablefish","text":"","code":"theme_sablefish()"},{"path":"https://chengmatt.github.io/SPoRC/reference/theme_sablefish.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot theme for sablefish â€” theme_sablefish","text":"ggplot theme","code":""},{"path":[]},{"path":"https://chengmatt.github.io/SPoRC/reference/three_rg_sable_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Sablefish data for multi region (3 area) case study â€” three_rg_sable_data","title":"Sablefish data for multi region (3 area) case study â€” three_rg_sable_data","text":"dataset containing necessary elements Alaska sablefish spatial case study.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/three_rg_sable_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sablefish data for multi region (3 area) case study â€” three_rg_sable_data","text":"","code":"three_rg_sable_data"},{"path":"https://chengmatt.github.io/SPoRC/reference/three_rg_sable_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sablefish data for multi region (3 area) case study â€” three_rg_sable_data","text":"list multiple components needed multi (3) region sablefish model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/three_rg_sable_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sablefish data for multi region (3 area) case study â€” three_rg_sable_data","text":"Cheng et al. 2025, Fish Fisheries; Panmictic Panacea? Demonstrating Good Practices Developing Spatial Stock Assessments Application Alaska Sablefish (Anoplopoma fimbria)","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/truncate_yr.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","title":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","text":"Helper function truncate data years, parameters, mapping conduct retrospective diagnostics. Called within do_retrospective function.","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/truncate_yr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","text":"","code":"truncate_yr(j, data, parameters, mapping)"},{"path":"https://chengmatt.github.io/SPoRC/reference/truncate_yr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","text":"j years truncate terminal year data Data list used RTMB model parameters Parameter list used RTMB model mapping Mapping list used RTMB model","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/truncate_yr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","text":"List data, parameters, mapping truncated dimensions original data, parameters, mapping list","code":""},{"path":"https://chengmatt.github.io/SPoRC/reference/truncate_yr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper function to truncate data years, parameters, and mapping to conduct retrospective diagnostics. Called within do_retrospective function. â€” truncate_yr","text":"","code":"if (FALSE) { # \\dontrun{ retro_list <- retro_truncate_year(j = 0, data, parameters, mapping) # does not remove any data retro_list <- retro_truncate_year(j = 1, data, parameters, mapping) # removes last year of data } # }"}]
