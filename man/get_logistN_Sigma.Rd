% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Utility_Functions.R
\name{get_logistN_Sigma}
\alias{get_logistN_Sigma}
\title{Construct logistic-normal covariance matrix}
\usage{
get_logistN_Sigma(
  comp_like,
  n_bins,
  n_sexes,
  theta,
  corr_b = NULL,
  corr_s = NULL
)
}
\arguments{
\item{comp_like}{Integer specifying the logistic-normal correlation structure:
\itemize{
  \item 2 = iid across categories
  \item 3 = AR1 across categories
  \item 4 = AR1 across categories and sexes
}}

\item{n_bins}{Number of composition categories (e.g., age or length bins).
For \code{comp_like = 2, 3}, the covariance matrix is dimensioned
\code{n_bins}. For \code{comp_like = 4}, it is dimensioned
\code{n_bins * n_sexes}.}

\item{n_sexes}{Number of sexes. Required when \code{comp_like = 4}.}

\item{theta}{Standard deviation parameter controlling the overall scale
of the covariance.}

\item{corr_b}{Correlation parameter across categories, in the interval
\eqn{(-1, 1)}. Used when \code{comp_like = 3} or \code{4}.}

\item{corr_s}{Correlation parameter across sexes, in the interval
\eqn{(-1, 1)}. Used when \code{comp_like = 4}.}
}
\value{
A covariance matrix \eqn{\Sigma} with dimension:
  \itemize{
    \item \code{n_bins} (\code{comp_like = 2, 3})
    \item \code{n_bins * n_sexes} (\code{comp_like = 4})
  }
}
\description{
Helper function to generate the covariance matrix (\eqn{\Sigma}) used in
logistic-normal composition models. The structure depends on the
specification of \code{comp_like}:
\itemize{
  \item \code{comp_like = 2}: independent and identically distributed (iid)
    across categories (\eqn{n_\mathrm{categories}}).
  \item \code{comp_like = 3}: first-order autoregressive (AR1) correlation
    across categories (\eqn{n_\mathrm{categories}}).
  \item \code{comp_like = 4}: two-dimensional AR1 correlation across
    categories and sexes (\eqn{n_\mathrm{categories} \times n_\mathrm{sexes}}).
}
}
\examples{
\dontrun{
n_cat <- 5
n_sexes <- 2

# iid example (categories only)
get_logistN_Sigma(comp_like = 2, n_bins = n_cat, n_sexes = NULL, theta = 0.5)

# AR1 across categories
get_logistN_Sigma(comp_like = 3, n_bins = n_cat, n_sexes = NULL, theta = 0.5,
                  corr_b = 0.3)

# AR1 across categories and sexes
get_logistN_Sigma(comp_like = 4, n_bins = n_cat, n_sexes = n_sexes, theta = 0.5,
                  corr_b = 0.3, corr_s = 0.2)
}
}
\seealso{
Other Utility: 
\code{\link{fit_model}()},
\code{\link{get_par_est_info}()},
\code{\link{post_optim_sanity_checks}()},
\code{\link{rho_trans}()},
\code{\link{set_data_indicator_unused}()}
}
\concept{Utility}
